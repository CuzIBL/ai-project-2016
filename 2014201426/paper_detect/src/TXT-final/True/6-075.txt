 
ensemble methods like bagging and boosting that combine the decisions of multiple hypotheses are some of the strongest existing machine learning methods. the diversity of the members of an ensemble is known to be an important factor in determining its generalization error. this paper presents a new method for generating ensembles that directly constructs diverse hypotheses using additional artificially-constructed training examples. the technique is a simple  general metalearner that can use any strong learner as a base classifier to build diverse committees. experimental results using decision-tree induction as a base learner demonstrate that this approach consistently achieves higher predictive accuracy than both the base classifier and bagging  whereas boosting can occasionally decrease accuracy   and also obtains higher accuracy than boosting early in the learning curve when training data is limited. 
1 introduction 
one of the major advances in inductive learning in the past decade was the development of ensemble or committee approaches that learn and retain multiple hypotheses and combine their decisions during classification  dietterich  1 . for example  boosting  freund and schapire  1   an ensemble method that learns a series of  weak  classifiers each one focusing on correcting the errors made by the previous one  has been found to be one of the currently best generic inductive classification methods  hastie et al.   1  . 
　constructing a diverse committee in which each hypothesis is as different as possible  decorrelated with other members of the ensemble  while still maintaining consistency with the training data is known to be a theoretically important property of a good committee  krogh and vedelsby  1 . although all successful ensemble methods encourage diversity to some extent  few have focused directly on the goal of maximizing diversity. existing methods that focus on achieving diversity  opitz and shavlik  1; rosen  1  are fairly complex and are not general meta-learners like bagging  breiman  1  and boosting that can be applied to any base learner to produce an effective committee  witten and frank  1 . 
　we present a new meta-learner  decorate  diverse ensemble creation by oppositional relabeling of artificial training examples  that uses an existing  strong  learner 
 one that provides high accuracy on the training data  to build an effective diverse committee in a fairly simple  straightforward manner. this is accomplished by adding different randomly constructed examples to the training set when building new committee members. these artificially constructed examples are given category labels that disagree with the current decision of the committee  thereby easily and directly increasing diversity when a new classifier is trained on the augmented data and added to the committee. 
　boosting and bagging provide diversity by sub-sampling or re-weighting the existing training examples. if the training set is small  this limits the amount of ensemble diversity that these methods can obtain. decorate ensures diversity on an arbitrarily large set of additional artificial examples. therefore  one hypothesis is that it will result in higher generalization accuracy when the training set is small. this paper presents experimental results on a wide range of uci data sets comparing boosting  bagging  and decorate  all using j1 decision-tree induction  a java implementation of c1  quinlan  1  introduced in  witten and frank  1   as a base learner. cross-validated learning curves support the hypothesis that  decorated trees  generally result in greater classification accuracy for small training sets. 
1 ensembles and diversity 
in an ensemble  the combination of the output of several classifiers is only useful if they disagree on some inputs  krogh and vedelsby  1 . we refer to the measure of disagreement as the diversity of the ensemble. there have been several methods proposed to measure ensemble diversity  kuncheva and whitaker  1  - usually dependent on the measure of accuracy. for regression  where the mean squared error is commonly used to measure accuracy  variance can be used as a measure of diversity. so the diversity of the ith classifier on example x can be defined as di x  =  are 
learning 	1 the predictions of the iih classifier and the ensemble respectively. for this setting krogh et al 1  show that the generalization error  e   of the ensemble can be expressed as e = e- d  where e and d are the mean error and diversity of the ensemble respectively. 
　for classification problems  where the 1 loss function is most commonly used to measure accuracy  the diversity of the ith classifier can be defined as: 
		 1  
however  in this case the above simple linear relationship does not hold between e  e and d. but there is still strong reason to believe that increasing diversity should decrease ensemble error  zenobi and cunningham  1. the underlying principle of our approach is to build ensembles of classifiers that are consistent with the training data and maximize diversity as defined in  1 . 
1 decorate: algorithm definition 
in decorate  see algorithm 1   an ensemble is generated iteratively  learning a classifier at each iteration and adding it to the current ensemble. we initialize the ensemble to contain the classifier trained on the given training data. the classifiers in each successive iteration are trained on the original training data and also on some artificial data. in each iteration artificial training examples are generated from the data distribution; where the number of examples to be generated is specified as a fraction    of the training set size. the labels for these artificially generated training examples are chosen so as to differ maximally from the current ensemble's predictions. the construction of the artificial data is explained in greater detail in the following section. we refer to the labeled artificially generated training set as the diversity data. we train a new classifier on the union of the original training data and the diversity data. if adding this new classifier to the current ensemble increases the ensemble training error  then we reject this classifier  else we add it to the current ensemble. this process is repeated until we reach the desired committee size or exceed the maximum number of iterations. 
　to classify an unlabeled example  x  we employ the following method. each base classifier  ci  in the ensemble c* provides probabilities for the class membership of x. if 
pci y x  is the probability of example x belonging to class y according to the classifier ci  then we compute the class membership probabilities for the entire ensemble as: 
where is the probability of x belonging to class y. we then select the most probable class as the label for x i.e. 

1 	construction of artificial data 
we generate artificial training data by randomly picking data points from an approximation of the training-data distribution. for a numeric attribute  we compute the mean and standard deviation from the training set and generate values from the gaussian distribution defined by these. for a nominal attribute  we compute the probability of occurrence of each distinct value in its domain and generate values based on this distribution. we use laplace smoothing so that nominal attribute values not represented in the training set still have a non-zero probability of occurrence. in constructing artificial data points  we make the simplifying assumption that the attributes are independent. it is possible to more accurately estimate the joint probability distribution of the attributes; but this would be time consuming and require a lot of data. 
　in each iteration  the artificially generated examples are labeled based on the current ensemble. given an example  we first find the class membership probabilities predicted by the ensemble  replacing zero probabilities with a small non-zero value. labels are then selected  such that the probability of selection is inversely proportional to the current ensemble's predictions. 

1 experimental evaluation 
1 methodology 
1 	learning to evaluate the performance of decorate we ran experiments on 1 representative data sets from the uci repository  blake and merz  1 used in similar studies  webb  1; quinlan  1 . we compared the performance of decorate to that of adaboost  bagging and j1  using j1 as the base learner for the ensemble methods and using the weka implementations of these methods  witten and frank  1 . for the ensemble methods  we set the ensemble size to 1. note that in the case of decorate  we only specify a maximum ensemble size  the algorithm terminates if the number of iterations exceeds the maximum limit even if the desired ensemble size is not reached. for our experiments  we set the maximum number of iterations in decorate to 1. we ran experiments varying the amount of artificially generated data  rsize  and found that the results do not vary much for the range 1 to 1. however  rsize values lower than 1 do adversely affect decorate  because there is insufficient artificial data to give rise to high diversity. the results we report are for rsize set to 1  i.e. the number of artificially generated examples is equal to the training set size. 
　the performance of each learning algorithm was evaluated using 1 complete 1-fold cross-validations. in each 1-fold cross-validation each data set is randomly split into 1 equalsize segments and results are averaged over 1 trials. for each trial  one segment is set aside for testing  while the remaining data is available for training. to test performance on varying amounts of training data  learning curves were generated by testing the system after training on increasing subsets of the overall training data. since we would like to summarize results over several data sets of different sizes  we select different percentages of the total training-set size as the points on the learning curve. 
　to compare two learning algorithms across all domains we employ the statistics used in  webb  1   namely the win/draw/loss record and the geometric mean error ratio. the win/draw/loss record presents three values  the number of data sets for which algorithm a obtained better  equal  or worse performance than algorithm b with respect to classification accuracy. we also report the statistically significant win/draw/loss record; where a win or loss is only counted if the difference in values is determined to be significant at the 1 level by a paired t-test. the geometric mean error ratio is defined as  where ea and eb are the mean errors of algorithm a and b on the same domain. if the geometric mean error ratio is less than one it implies that algorithm a performs better than b  and vice versa. we compute error ratios so as to capture the degree to which algorithms out-perform each other in win or loss outcomes. 
1 results 
our results are summarized in tables 1. each cell in the tables presents the accuracy of decorate versus another algorithm. if the difference is statistically significant  then the larger of the two is shown in bold. we varied the training set sizes from 1% of the total available data  with more points lower on the learning curve since this is where we expect to see the most difference between algorithms. the bottom of the tables provide summary statistics  as discussed above  for each of the points on the learning curve. 
　decorate has more significant wins to losses over bagging for all points along the learning curve  see table 1 . 
decorate also outperforms bagging on the geometric mean ratio. this suggests that even in cases where bagging beats decorate the improvement is less than decorate's improvement on bagging on the rest of the cases. 
　decorate outperforms adaboost early on the learning curve both on significant wins/draw/loss record and geometric mean ratio; however  the trend is reversed when given 1% or more of the data. note that even with large amounts of training data  decorate's performance is quite competitive with adaboost - given 1% of the data decorate produces higher accuracies on 1 out of 1 data sets. 
　it has been observed in previous studies  webb  1; bauer and kohavi  1  that while adaboost usually significantly reduces the error of the base learner  it occasionally increases it  often to a large extent. decorate does not have this problem as is clear from table 1. 
　on many data sets  decorate achieves the same or higher accuracy as bagging and adaboost with many fewer training examples. figure 1 show learning curves that clearly demonstrate this point. hence  in domains where little data is available or acquiring labels is expensive  decorate has an advantage over other ensemble methods. 
　we performed additional experiments to analyze the role that diversity plays in error reduction. we ran decorate at 1 different settings of rsize ranging from 1 to 1  thus varying the diversity of ensembles produced. we then compared the diversity of ensembles with the reduction in generalization error. diversity of an ensemble is computed as the mean diversity of the ensemble members  as given by eq. 1 . we compared ensemble diversity with the ensemble error reduction  i.e. the difference between the average error of the ensemble members and the error of the entire ensemble  as in  cunningham and carney  1  . we found that the correlation coefficient between diversity and ensemble error reduction is 1   which is fairly strong. furthermore  we compared diversity with the base error reduction  i.e. the difference between the error of the base classifier and the ensemble error. the base error reduction gives a better indication of the improvement in performance of an ensemble over the base classifier. the correlation of diversity versus the base error reduction is . we note that even though this correlation is weak  it is still a statistically significant positive correlation. these results reinforce our belief that increasing ensemble diversity is a good approach to reducing generalization error. 
　to determine how the performance of decorate changes with ensemble size  we ran experiments with increasing sizes. we compared results for training on 1% of available data  since the advantage of decorate is most noticeable low on the learning curve. due to lack of space  we do not include the results for all 1 datasets  but present five representative datasets  see figure 1 . the performance on other datasets is similar. we note  in general  that the accuracy of decorate increases with ensemble size; though on most datasets  the performance levels out with an ensemble size of 1 to 1. 
l
   the p-value is the probability of getting a correlation as large as the observed value by random chance  when the true correlation is zero. 

learning 	1 


figure 1: decorate compared to adaboost and bagging 
1 related work 
there have been some other attempts at building ensembles that focus on the issue of diversity. liu et al  and rosen  simultaneously train neural networks in an ensemble using a correlation penalty term in their error functions. opitz and shavlik  use a genetic algorithm to search for a good ensemble of networks. to guide the search they use an objective function that incorporates both an accuracy and diversity term. zenobi et al  build ensembles based on different feature subsets; where feature selection is done using a hill-climbing strategy based on classifier error and diversity. a classifier is rejected if the improvement of one of the metrics lead to a  substantial  deterioration of the other; where  substantial  is defined by a pre-sct threshold. 
　in all these approaches  ensembles are built attempting to simultaneously optimize the accuracy and diversity of individual ensemble members. however  in decorate  our goal is to minimize ensemble error by increasing diversity. at no point does the training accuracy of the ensemble go below 
1 	learning 

that of the base classifier; however  this is a possibility with previous methods. furthermore  none of the previous studies compared their methods with the standard ensemble approaches such as boosting and bagging  fopitz and shavlik  1  compares with bagging  but not boosting . 
　compared to boosting  which requires a  weak  base learner that does not completely fit the training data  boosting terminates once it constructs a hypothesis with zero training error   decorate requires a strong learner  otherwise the artificial diversity training data may prevent it from adequately fitting the real data. when applying boosting to strong base learners  they must first be appropriately weakened in order to benefit from boosting. therefore  decorate may be a preferable ensemble meta-learner for strong learners. 
　to our knowledge  the only other ensemble approach to utilize artificial training data is the active learning method introduced in icohn et al  1 . the goal of the committee here is to select good new training examples rather than to improve accuracy using the existing training data. also  the labels of the artificial examples are selected to produce hypotheses that more faithfully represent the entire version space rather than to produce diversity. cohn's approach labels artificial data either all positive or all negative to encourage  respectively  the learning of more general or more specific hypotheses. 
1 future work and conclusion 
in our current approach  we are encouraging diversity using artificial training examples. however  in many domains  a large amount of unlabeled data is already available. we could exploit these unlabeled examples and label them as diversity data. this would allow decorate to act as a form of semisupervised learning that exploits both labeled and unlabeled data  nigam et al.  1 . 
　our current study has used j1 as a base learner; however  we would expect similarly good results with other base learners. decision-tree induction has been the most commonly used base learner in other ensemble studies  but there has been some work using neural networks and naive bayes  bauer and kohavi  1; opitz and maclin  1 . experiments on  decorating  other learners is another area for future work. 
learning 	1 　by manipulating artificial training examples  decorate is able to use a strong base learner to produce an effective  diverse ensemble. experimental results demonstrate that the approach is particularly effective at producing highly accurate ensembles when training data is limited  outperforming both bagging and boosting low on the learning curve. the empirical success of decorate raises the issue of developing a sound theoretical understanding of its effectiveness. in general  the idea of using artificial or unlabeled examples to aid the construction of effective ensembles seems to be a promising approach worthy of further study. 
acknowledgments 
this work was supported by darpa eeld grant f1-1. 
