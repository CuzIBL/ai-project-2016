
over the past decade functional magnetic resonance imaging  fmri  has emerged as a powerful technique to locate activity of human brain while engaged in a particular task or cognitive state. we consider the inverse problem of detecting the cognitive state of a human subject based on the fmri data. we have explored classification techniques such as gaussian naive bayes  k-nearest neighbour and support vector machines. in order to reduce the very high dimensional fmri data  we have used three feature selection strategies. discriminating features and activity based features were used to select features for the problem of identifying the instantaneous cognitive state given a single fmri scan and correlation based features were used when fmri data from a single time interval was given. a case study of visuo-motor sequence learning is presented. the set of cognitive states we are interested in detecting are whether the subject has learnt a sequence  and if the subject is paying attention only towards the position or towards both the color and position of the visual stimuli. we have successfully used correlation based features to detect position-color related cognitive states with 1% accuracy and the cognitive states related to learning with 1% accuracy. 
1 introduction 
functional magnetic resonance imaging  fmri  is a powerful imaging tool  which can be used to perform brain activation studies my measuring blood oxygen level dependent  bold  signal  ogawa et al.  1 . human brain carries out various functions at a time. the operations within the brain like   the process of thinking  and  the process of remembering   that affect our mental contents are called as 'cognitive processes' and the person is said to be in the particular 'cognitive state'. our aim is to identify the cognitive state of a human subject that is persistent within a certain interval of time  given the fmri activity within that interval. our motivation in the detection of cognitive states is that this could lead to our understanding of the hidden cognitive states a human passes through while performing a particular task. this could have potential applications in lie detectors  cognitive control of artifacts  cognitive control of mental states  neurofeedback   etc. 
　an fmri scanner measures the value of the fmri signal at all the points in a three dimensional grid  or image every few seconds  1 sec in our data . the voxels  volume pixels  in a typical fmri study have a volume of a few tens of cubic millimeters and the 1d brain image contains 1 1 voxels that constitute the whole brain  thereby resulting in very high dimensional data. since the signals measure tiny fluctuations in the magnetic field  known as the blood oxygen level dependent  bold  response  the signal-to-noise ratio  snr  for fmri data is very low. thus the other characteristic of fmri data is that they are very noisy. this problem domain is quite interesting from the machine learning perspective  as it provides a case study of classifier learning from extremely high dimensional and noisy data. 
　we borrow mitchell's  mitchell  1  definition to state more formally the problem of detection of cognitive states from fmri data.    
definition: a computer program is said to have learned from experience e with respect to some class of tasks t and performance measure p  if its performance at tasks in t  as measured by p  improves with experience e. in our case   t: classification of cognitive state of human subject e: labelled training data mapping fmri scans to the instantaneous cognitive state 
p: performance accuracy of the algorithm over the unseen fmri data. 
　the case study in this paper is a visuomotor sequence learning experiment  miyapuram  1 . human subjects perform a motor task  pressing a key on a keyboard  in response to visual stimuli  having position and colour attributes . the problem that we have attempted in this study is to classify fmri data into a discrete set of cognitive states that are  subject has learnt a sequence    subject did not learn the sequence    the subject is paying attention only towards the position of the visual stimuli  and  the subject is paying attention towards the color and the position of the visual stimuli . the various machine learning algorithms we have applied on this fmri data are gaussian naive bayes classifier  gnb   k-nearest neighbor  knn  and support vector machines  svm . to deal with the high dimensionality of the data we have used three feature selection strategies namely  discriminating features  activity based features and correlation based features. 
1 materials and methods 
1 machine learning classifier techniques  
　a classifier is a function which takes input a set of examples and outputs a class label to each input example  where class label belongs to a discrete set of possible categories. in our case the classifier is a function of the form: f : fmri-sequence t1  t1   cognitivestate where fmri-sequence t1  t1  is the sequence of fmri images collected during the contiguous time interval  t1  t1   and where cognitivestate is the set of cognitive states to be discriminated.
　we explored three classifier training methods: a gaussian naive bayes  gnb   k-nearest neighbor  knn   and linear support vector machines  svm . these classifiers were selected because they have been used successfully earlier by  mitchell et al.  1  1; wang et al.  1  for solving similar problem as well as in other applications involving high dimensional data. for example  naive bayes classifiers  knn and svm have all been used for text classification problems  nigam et al.  1   where the dimensionality of the data is approximately 1  corresponding to the natural language vocabulary. 
1 fmri task procedure 
the fmri experiment consisted of a visuomotor sequence learning task. a set of two circles filled with different colours  yellow  red  green or blue  appeared simultaneously at two distinct positions  top  bottom  left  or right  on a screen. the correct order of the sequence is to be learnt by trial and error based on the spatial positions of the visual stimuli. in one task  p1p   the response was required to be generated according to the position of the stimuli. in another task  p1c  the subjects had to respond using an arbitrary rule with the following mapping: green - top  red - right  blue - bottom  and yellow - left. the entire sequence to be learnt consisted of six such sets. hence this sequence learning task is called a 1 x 1 task. subjects continue to practice the same sequence repeatedly for 1 sessions  1 sequence blocks  of 1 sec each  per session . human brain is involved in many activities at a time. there are many background processes such as respiration  heart beat  mood  etc. that are not related to the task being performed. hence fmri studies must be designed to quantify relative changes in brain activity. for this purpose  the sequence blocks alternated with baseline blocks  1 sec each  in which subjects performed keypresses  using the same rule as in sequence task  viewing visual stimuli presented randomly one at a time. 
1 feature selection and data abstraction 
data preprocessing: the case studies involve fmri data of five normal subjects. as shape and size of brain varies for each individual  images need to be transformed into the coordinate system of a standard brain. this transformation would help in standardization of reporting of co-ordinates of the brain space across different studies. to achieve this  two types of brain images were collected for each subject. the first type of image referred to as a functional image  captures brain activation via the bold response. the second type of image  called the structural image  captures the static physical brain structure at higher resolution. first the structural images of all the subjects were standardized  friston et al.  1  to a template image and the resulting parameters were used for standardizing all the functional images of each subject to the template. the end result of this preprocessing step is that all the image data are in same size and approximately same shape.  
data abstraction: as we are interested in training classifiers that work across subjects and as the strength of the bold response varies from subject to subject  abstracting the data is very important. hence we adopted a normalization method in which the algorithm rescales the data in each scan of every subject such that the mean value of the resulting data is zero  i.e. yt =  xt - meanxt  / stdxt  t = 1 ... n 
where xt's and yt's are the data before and after normalization  respectively and  meanxt and stdxt are the mean and the standard deviation of xt  respectively. 
　the other approach for data abstraction is a method that takes the correlation of the selected features to transform the real image data.  
feature selection: feature selection  as a preprocessing step to machine learning  is effective in reducing dimensionality  removing irrelevant data  increasing learning accuracy  and improving result comprehensibility. however  the increase in the dimensionality of the data poses a severe challenge to many existing feature selection methods with respect to efficiency and effectiveness. the enormity of data may cause serious problems to many machine learning algorithms with respect to scalability and learning performance. for example  high dimensional data  i.e.  data sets with hundreds or thousands of features  can contain high degree of irrelevant and redundant information which may greatly degrade the performance of the learning algorithms. therefore  feature selection becomes very necessary for machine learning tasks when facing high dimensional data. the first two methods  i.e. discrim and active  are the same as used by  mitchell et al.  1  1; wang et al.  1 . select the n most discriminating voxels  discrim : in this method  voxels  features  are selected based on their ability to distinguish one target class from the other. select the n most active voxels  active : in this method  voxels are selected based on their ability to distinguish either target class from the baseline condition.  select the n feature pairs whose correlation discriminates the target classes  corrpair : this technique is inspired from the feature selection algorithm corona  yang et al.  1  which uses correlation information among features to select them. traditional feature subset selection techniques such as recursive feature elimination  ambroise and mclachlan  1  and fast correlation based filter  fcbf   yu and liu  1  lose this information as they use the feature data only. in this method  voxel pairs are selected based on their ability discriminate the target classes. the correlation value between these voxel pairs is then used as feature vector to train the classifiers.  
1 case study  
our case study involves fmri data collected when subjects are enagaged in visuo-motor sequence learning experiments. in these experiments  subjects learn the correct  sequence of response by trial and error and continue to perform it until the end of the experiment. therefore there are task-related changes at the neuronal level occurring continuously in different areas of the brain. these changes are reflected as changes in the activity at different voxels in fmri images.  
1 p1p vs p1c classification study 
firstly  we have considered the problem of training classifiers to detect the cognitive states   the subject is paying attention only towards the position of the visual stimuli  and  the subject is paying attention towards the color and the position of the visual stimuli . when the subject is performing the p1p task he pays attention towards the position of the visual stimuli and responds only according to the position of the stimuli  the color of the stimuli is irrelevant. whereas when the subject is performing the p1c task he pays attention towards the position of the visual stimuli and responds according to the color of the stimuli. hence the essential difference between these two tasks is the way in which the response is generated after seeing the position of the visual stimuli.  

figure 1: the difference in the response generated during p1p and 
p1c tasks  
the assumption here is that since the set of brain areas underlying spatial and color perception are distinct  the cognitive states reflecting the two tasks can be distinguished based on the fmri signals. 
　in this particular case study we have tried to capture this difference in our classifier function. we have used the discriminating features and active feature selection strategies to train a classifier function of the form f : it  cognitivestate  where it is an fmri scan at a single time instance and cognitivestate takes values of p1p or p1c. results of single subject classification are shown in table 1.  
　for multiple subjects  the detection of instantaneous cognitive state using discrim and active features was below random classification. we have successfully used the correlation based feature selection to train the classifier function of the form f:  i1 ... it   cognitivestate where  i1 ... it  is a set of fmri scans taken in a time interval of length t and cognitivestate takes on values p1p and p1c. 
table 1: results of single-subject classifiers detecting instantaneous cognitive states in p1p vs p1c classification study 
feature selection no. of features gnb knn 
 k = 1  knn
 k = 1  svmdiscrim 1 1 1 11discrim 1 1 1 11discrim 1 1 1 11active 1 1 1 11active 1 1 1 11active 1 1 1 11　table 1 shows the results of using correlation based feature selection technique where the average accuracy of the multiple subject classifier is above that of a random classifier  for t taking values 1  1 and 1. the  leave-onesubject-out  strategy was used for training multiple-subject classifiers.
table 1: results of multiple subjects classifiers using corrpair feature selection in p1p vs p1c classification study 
feature selectionno. of features gnb knn 
 k = 1  knn
 k = 1  svmt=1 1 1 1 1.1t=1 1 1 1 1.1t=1 1 1 1 1t=1 1 1 1 11t=1 1 1 1 1t=1 1 1 1 1　all three classifiers  gnb  knn and svm have performed successfully and have given much better results than random-chance classification. using the corrpair  t=1  feature selection method gave the optimal results where the number of features is 1 and the number training samples were 1. the results show the superior performance of gnb and knn  k=1  classifiers over the svm.  
1 early vs late learning study 
in the second phase  we have considered the problem of training classifiers to detect the cognitive states   subject has learnt the sequence  late stage where the performance is smooth and automatic   and  subject did not learn the sequence  early stage where the performance is deliberate and error-prone .  in both the tasks  p1p and p1c  the subjects have to learn the position sequences  or the order in which to press on the keypad  given the visual stimuli . this sequence is learnt by a process of trail and error.  

figure 1: the difference in the response generated during early and late learning periods 
　in this case study we try to detect whether the subject has learnt the sequence or not  irrespective of the task he is performing. it is to be noted that this classification task is potentially more difficult than the earlier one. the assumption here is that the brain processes related to early learning are distinguishable from those engaged in the later part. further  it is also assumed that the cognitive states corresponding to the two learning stages are similar across the p1p and p1c tasks. we have used the discriminating features and the activity based feature selection methods to find a classification function of the form f : it  cognitivestate where it is a fmri scan at a single time instance and cognitivestate takes values as either  early learning  or  late learning . as in previous case study  we were successful in training single subject classifiers.  
table 1: results of single-subject classifiers detecting instantaneous cognitive states in early vs late learning study 
feature selection no. of features gnb knn 
 k = 1  knn
 k = 1  svmdiscrim 1 1 1 1.1discrim 1 1 1 1.1discrim 1 1 1 1.1active 1 1 1 1.1active 1 1 1 1.1active 1 1 1 1.1　we obtained less than random classification for multiple subject classifications using discrim and active features.  we have successfully used the correlation based feature selection to train the classifier function of the form  f:   i1 ... it    cognitivestate  where   i1 ... it   is a set of fmri scans taken in a time interval of length t and cognitivestate takes on values -  early learning  or  late learning .  
　table 1 shows the results of using correlation based feature selection technique where the average accuracy of the multiple subject classifier is above that of a random classifier  for t taking values 1  1 and 1. the  leave-onesubject-out  strategy was used for training multiple-subject classifiers.
table 1: results of multiple subject classification using corrpair feature selection in early vs late: learning study 
feature selectionno. of features gnb knn 
 k = 1  knn
 k = 1  svmt=1 1 1 1 11t=1 1 1 1 1t=1 1 1 1 1t=1 1 1 1 11t=1 1 1 1 1t=1 1 1 1 1　all three classifiers  gnb  knn  k=1  have performed satisfactorily and have given better results than random classification  whereas the performance of the svm was very poor. using the corrpair  t=1  feature selection method gave the optimal results where the number of features is 1 and the number of training samples were 1. the results show the superior performance of gnb and knn  k=1  classifiers over the svm.  
　one important point that we have noticed is that the overall performance of the multi-subject classifier in this case study has decreased as compared to the  p1p vs p1c  case study. one possible reason for this could be that that different subjects learn the sequence at different rates. for this purpose  we have designated the first two sessions of the experiment as the  early learning  period and the last two sessions as the  late learning  period. this criterion might not efficiently account for the subjective variations.  
1 discussion  
　the field of machine learning techniques for classification of data is very huge. we have tried a number of different techniques  singh  1  that are suited for the high dimensional data of fmri. the paper has taken up as a case study data from a real fmri experiment employing visuomotor sequence learning task. here the present state of brain is a function of its previous states and the present input  visual stimuli   a function which is unknown. hence classification in such a dynamically varying situation is a very challenging. the learning task in this paper is inherently different from previous case studies of  wang et al.  1   such as the picture vs sentence study  in which the present state of the brain is just a function of its present input  picture & sentence . as with any cognitive experiments  there will be overlapping and distinct brain areas associated with the respective cognitive processes - position and  colour processing in our case studies. as the focus of the present paper is detection of cognitive states  comparision of our results to the literature in cognitive neuroscience is beyond the scope. 
problems related to artifacts in data have been dealt with appropriate preprocessing techniques commonly used for fmri data. the additional challenge posed by this data was feature selection. hence  we have focused on comparison of different classifiers and also the feature selection strategies. the three difficulties namely  'high dimensionality'  `different shapes & sizes of the brain' and `variations in the activity level across subjects'  are the major reasons for the superior performance of the single-subject classifiers over multisubject classifiers and are primary hurdles in the `feature selection problem'. 
　the existing feature selection algorithms  like fcbf and corona  could not be implemented in such a high dimensional feature space. hence we had to opt the strategies which were described earlier in the section 1. the drawback of these strategies is that we do not know the optimal number of features to select  and hence we have to do a lot of trial and error until we get good result or we conclude that we cannot get any better result further. in spite of these drawbacks  the correlation based strategies outperformed the  activity based or discriminating feature selection methods when tested across subjects. also  this can be successfully used in the absence of a domain expert  who identifies the regions of interest  roi's  in the human brain given the nature of the task and reduces the need of feature selection. 
　the reason for the better performance of the correlation based features as compared to the discriminating features and the activity based features in the multi-subject classifier training scenario is that they are not using the voxel  feature  activity values directly as feature vector to train the classifiers  instead they are abstracting the voxel values and using the correlation between the voxels as the feature vector for training  hence the problem of variations in the activity level across subjects is addressed. whereas the discriminating features and the activity based features use the voxel activity values directly as features to train the classifiers and face the problem of difference in the activity levels across the subjects.  
　the results showed superior performance of gnb and knn over the svm. this was similar to semantic category study of  mitchell et al.  1  where the number of training samples per class was very less  1 . this is quiet opposite to the results obtained in the picture versus sentence study  where the number of training samples per class was 1 and the svm out-performed the gnb and knn. so we speculate that when the training samples are small in number gnb out-performs svm.  
1 conclusions  
the results obtained in the two case studies  i.e.   p1p vs p1c study  and  early vs late learning study   prove that the problem of detection of cognitive states in such a high dimensional feature space is feasible when right choice of features is made along with methods to abstract data  as future work to this project we suggest the following:  
1. the problem of multiple subject classifiers learning to detect the instantaneous cognitive states.  
1. finding new future selection methods for such a high dimensional and periodically changing data.  
acknowledgments 
the fmri data was collected by grants from kawato dynamic brain project  exploratory research for advanced technology  japan. we thank drs. kenji doya and kazuyuki samejima for their help with fmri experiments. 
