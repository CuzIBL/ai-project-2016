 
this paper describes some work in progress aimed at developing an expert system for fault diagnosis on switching mode power supplies. the system being developed is designed to interface with some existing automatic test equipment. results of tests from this test equipment are the main input to the expert system. another input is information about signals at various points in the circuit under test. this information is 
supplied by the user. both deep and shallow knowledge are used in the diagnostic process. the system is developed in kee from intellicorp so the main knowledge representations are rules and frames. the deep knowledge in the system is represented loosely as qualitative reasoning as this is considered to be the way that technicians reason about the causal interactions in a circuit. 
1. introduction 
     electronic fault diagnosis is considered a suitable area for expert systems applications and the research in this area is well documented  l  ...  l1 . it is considered that the best approach to the problem of generating expert systems for troubleshooting electronic circuitry is to incorporate both deep and shallow knowledge in the system . this approach recognizes the usefulness of both types of knowledge and utilizes both in the troubleshooting process. the deep model can be a formal  quantitative model or it may be a qualitative  causal model. at present it is considered that the deep model should have various components and should operate at different levels of detail. the contention is that the deep model should contain a structural and behavioural description of the circuit. a formal  quantitative deep model should be capable of doing simulations of the hardware at various different levels  taking timing criteria into account . 
     in this paper a qualitative reasoning model is proposed as an alternative to this more rigorous deep model. it appears from watching technicians troubleshooting that they use qualitative reasoning as they search for faults. for instance they look for the presence or absence of signals only and rarely study the nature of signals in any detail. this approach of adopting qualitative reasoning for the deep model has an added attraction because it seems impossible to develop models that 
this research was carried out in cooperation with intepro ltd. in 
limerick in ireland. the work has been done using a sperry 
explorer computer and kee software  awarded to trinity college dublin as part of the unisys artificial intelligence grant programme. will do multi-level simulations of a circuit of real size in reasonable time. 
     the basis of this paper is a project to develop an expert system for fault diagnosis of switching mode power supplies  smps . the system is meant to operate in cooperation with some existing automatic test equipment  ate . the system would accept the results of some forty function tests as its primary input and use these and some further information supplied by the operator to diagnose the faults in the circuit. 
1. fault diagnosis in power supplies 
     switching mode power supplies are a particular class of power supply that have both analog and digital components. most smps have the same underlying architecture and this is an important factor in determining the structure of an expert system for fault diagnosis on power supplies of this type. such an expert system should have a knowledge base partitioned into two components: one containing domain knowledge on smps in general and the other containing product specific knowledge on the particular power supply under test. 
     it is worth looking at the smps architecture in some detail since it does have a bearing on the knowledge representation issues with which we are concerned. the main component in the power supply is the transformer and the input to this transformer is a high frequency square wave generated by an electronic power switch. the high frequency switching has the advantage of dissipating very little power in the transformer. in addition the output voltage can be controlled by adjusting the mark-space ratio in the power switch. a block diagram for a typical switching mode power supply  smps  is shown in fig.l. all smps have these basic modules.  for further information on smps see .  
     this uniform structure of all smps means that it has been possible to create standard test programs that will test most smps with just a few extra tests added to account for the peculiarities of particular circuits. power supplies can be tested using function tests only. this means that the power supply unit can be tested as a 'black box' and faults can be identified by measuring input and output parameters under different conditions. it is desirable to develop an expert system that would take the results of these function tests as input and diagnose a fault from this data. in most cases the information from the function tests would not be sufficient on its own to isolate a fault. it would be necessary for the expert system to 
	cunningham 	1 

fig 1. block diagram of a switching mode power supply. 
prompt the user for more information on the nature of signals at various points in the circuit 
　　a fundamental assumption underlying the research described in this paper is that engineers and technicians perform fault diagnosis differently; they bring different types of knowledge to bear on the problem. the knowledge used by the engineer is quite formal and considers the detailed performance of the various modules in the circuit. this might be called 'e-type' knowledge. the knowledge used by the technician is more experiential  incorporating various 'rules of thumb' and might be termed 't-type' knowledge. so  as an example  when a technician is troubleshooting a circuit he would almost never examine the form of a signal in any detail. instead he looks for the presence or absence of a signal at certain points in the circuit. he would conclude that the fault lay in a particular module if that module had signals at all its inputs and no output. implicit in t-type knowledge is the assumption that when things are broken they are badly broken. subtle faults are expected rarely because the assumption is that the circuit has been designed correctly. 
1. deep and shallow knowledge 
　　an expert system for electronic fault diagnosis could be based simply on 'symptom-to-cause' associations and as such would only contain shallow knowledge. alternatively it could be a model based expert system as advanced in the research of davis   and genesereth  . such a system would contain a comprehensive 'deep' model of the circuit. it would also contain some inferencing mechanisms that would determine why the behaviour of the circuit under diagnosis differed from the behaviour predicted by the model. 
　　it is attractive to try and incorporate both deep and shallow knowledge into a knowledge based system for fault diagnosis. the approach proposed here is to generate a set of fault candidates using the 'symptom-to-cause' type shallow knowledge and then to examine in detail how the behaviour of these fault candidates differs from that predicted by the deep model. 
　　the shallow knowledge is the knowledge about fault diagnosis and the deep knowledge is the knowledge about electronic circuitry. the deep model must describe the structure and behaviour of the circuit. given symptoms of misbehaviour  the expert system must be able to determine the structural aberration responsible for the fault from the deep knowledge base. the structural knowledge has two components: a functional part and a physical part. the 
1 	knowledge representation 
functional part is roughly analogous to the schematic of the circuit while the physical part corresponds to the circuit layout. these are both suited to an object oriented representation and could be represented in flavors or frames. 
　　the representation of the behaviour is central to the whole diagnostic process as we are concerned with explaining aberrations in the behaviour of a faulty circuit. one approach to representing behaviour is to develop a special lisp like formalism for describing behaviour . alternatively the behaviour could be represented using interval temporal logic . this second approach seems particularly suitable for digital circuits. there must be some question as to whether such computationally intensive representations will be tractable. 
1. qualitative reasoning 
　　the research in qualitative reasoning in ai stems from the original work on naive physics by p. j. hayes . naive physics can be expressed as a qualitative physics. the goals of qualitative physics are simpler than those of classical physics yet retain all the important distinctions  eg. state  oscillation  gain  momentum  without invoking the mathematics of continuously varying quantities and differential equations . qualitative reasoning is reasoning about physical systems without pursuing quantitative descriptions of system states .... 
　　de klecr argues that a good electrical engineer analyses a circuit symbolically or numerically. he will perform a quantitative analysis only after he understands the circuit at a qualitative level . the contention in this paper is that a technician  when troubleshooting  considers circuits only at a 
　　qualitative level and rarely resorts to a quantitative analysis. this qualitative reasoning that the technician employs can be expressed in production rules as follows :-
if 
a module is of the type that has two inputs and one output and there is no signal on the output and there is a signal on the first input and there is a signal on the second input then 
there is a fault in that module and 
if the signal on the output of the oscillator is  s then the signal on the input of the mark space generator is  s 
　　it can be argued  see   that production rules are not adequate for modeling qualitative reasoning because they lack succinctness. this means that a few rules may be required to describe one causal relationship. this problem has not been acute with the prototype system. there need only be three or four rules like the first rule to isolate the fault to a module. the prototype system that has been built has twenty two qualitative reasoning rules at the module level. 
　　qualitative reasoning at the component level is more difficult because there are more concepts to be considered. the only issue at the module level is the presence or absence of a signal. concepts like: open-circuit  voltage drop and short circuit must be considered at the component level once the faulty module has been identified. 

1. system design 
     the expert system for troubleshooting power supplies is meant to be able to diagnose faults in all smps because all power supplies of this type share a common architecture. the system knowledge base can be divided into two components: a 
     domain knowledge base related to this common architecture  and a product knowledge base describing particular smps. at present the system is implemented in kee so the main knowledge representations arc frames and rules. the structure of the system  see fig.1.  is influenced to a large extent by the fact that the main input to the system is the results of the function tests from the automatic test equipment. 

fig.1. structure of the fault diagnosis expert system. 
     the first input to the expert system is the results of the function tests  approx. 1  from the ate. a set of fault candidates at the module level is generated by forward-chaining with these results through the function test rules base. these function test rules are shallow rules relating failures in tests to possible causes. the results of the function tests may be used again in the final diagnosis but at this stage some extra information is needed for the diagnosis to proceed. 
     the fault candidate list can be reduced using the deep knowledge in the qr module rules. these qr rules represent the causal reasoning that the expert technician uses when tracing signals through a circuit. the fault candidate list can be reduced by backward-chaining through these rules. the advantage of backward-chaining is that the system can query the user for any extra information that is needed. typically  the system would query the user about the presence or absence of a signal at various points in the circuit 
     once the fault candidate list is narrowed down to one or two modules the system can switch to analysis at a component level. most of the function tests on the ate are general tests for smps but in a working situation some tests will be included that are specific to a particular power supply. the results of these tests are used at this stage and the system backward-chains through the qr component rules to isolate the fault within the faulty module. 
1. conclusions 
     this paper is an interim report on a project to develop an expert system for fault diagnosis of power supplies. the project is proceeding by rapid prototyping with periodic revisions. at this stage all of the components of the system have been implemented to some level of detail. 
     the expert system incorporates both deep and shallow knowledge and this paper is concerned with representing the behaviour of the circuit in the deep model using causal reasoning. a fundamental assumption underlying this work is that technicians use qualitative models of circuits during troubleshooting and rarely if ever resort to quantitative reasoning. in the system described here this qualitative reasoning is represented using production rules. this representation is working adequately at this stage. however it is accepted that representing causal relationships using production rules may lack succinctness and it may be necessary to find a better representation at a later stage. 
     the expert system is a general expert system  adaptable for troubleshooting all smps. it contains domain knowledge on smps in general and some product specific knowledge on particular power supplies. this idea of developing a general system was also the approach in developing the automatic test software to which the expert system is connected. this potential for generality depends on the basic architecture that is common to all smps. at present we feel that this similarity between different smps is more marked than the similarities that exist in other product groups. consequently the development of an expert system in this area should be particularly fruitful. 
