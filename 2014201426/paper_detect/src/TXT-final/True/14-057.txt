 
　　　we describe an oncology protocol management system  named oncocin  that is designed to assist physicians in the treatment of cancer patients. the system is actually a set of programs  one of which is a rule-based reasoner that encompasses the necessary knowledge of cancer chemotherapy. representation and control techniques are discussed  and oncocin is contrasted with systems that could be b u i l t using emycin. of particular interest is the need to provide oncocin with an interface that w i l l make the system acceptable to oncologists. 
i introduction 
　　　this report describes an oncology protocol management system  named oncocin after i t s domain of expertise  cancer therapy  and i t s h i s t o r i c a l debt to mycin   1   . the program consists of a set of i n t e r r e l a t e d subsystems  the p r i n c i p a l ones being: 
 1  the reasoner  a rule-based expert consultant that is the core of the system and the major subject of t h i s report; and 
 1  the interviewer  an interface program that controls a high-speed terminal and the interaction with the physicians using the system. 
work on oncocin began in mid-1  and the system was i n s t a l l e d for prelimianry use in may 1. this paper describes only the reasoner  although other system components are mentioned when t h e i r interface with the reasoner is pertinent. we also contrast oncocin with emycin   1     explaining why the emycin formalism was inadequate for our purposes although it did strongly influence the system's rule-based design. 
ii overview of the problem domain 
	oncocin 	is 	designed 	to 	assist 	c l i n i c a l 
--------------------------------------------------
	this 	work 	was 	supported 	by 	the 	national 
library of medicine under program project grant lm-
1 and research career development award lm1. the program was developed on the sumex computer project at stanford university  a shared national resource supported by the biotechnology resources program of the nih under grant rr-1. oncologists in the treatment of cancer patients. because the optimal therapy for most cancers is not yet known  c l i n i c a l oncology research is commonly based on formal experiments that compare the therapeutic benefits and side effects   t o x i c i t y   of proposed alternative disease treatments.  cancer  is a general term for many diseases having d i f f e r e n t prognoses and natural h i s t o r i e s . a treatment that is e f f e c t i v e against one tumor may be i n e f f e c t i v e against another. thus a typical cancer research center may conduct many simultaneous experiments  each concerned with a d i f f e r e n t kind of cancer and i t s optimal therapy   i . e .   the treatment plan with the best chance of cure  remission  or reduction in tumor size  and the least chance of serious side e f f e c t s   . 
	each 	of 	these 	experiments 	is 	termed 	a 
  p r o t o c o l   . patients with tumors of the type being studied  and who are accepted for protocol treatment  are randomly assigned to receive one of two or more possible treatments. the experiment requires close monitoring of each p a t i e n t ' s c l i n i c a l response and treatment t o x i c i t y . these data are t a l l i e d for a l l patients treated under the a l t e r n a t i v e regimens  and in t h i s way the   s t a t e o f - t h e - a r t   is updated over time. 
　　　each protocol is described in a detailed document  often 1 to 1 pages in length  which specifies the a l t e r n a t i v e therapies being compared and the data that need to be collected. no single physician is l i k e l y to remember the d e t a i l s in even one of these protocol documents  not to mention the 1 to 1 protocols that may be used in a major cancer center. although an e f f o r t is made to have the documents available in the oncology c l i n i c s when patients are being treated for t h e i r tumors  it is often the case that a busy c l i n i c schedule  coupled with a complex protocol description  leads a physician to rely on his memory when deciding drug doses or what laboratory tests to order. furthermore  solutions for a l l possible treatment problems cannot be spelled out in protocols. physicians use t h e i r own judgment in t r e a t i n g these patients  r e s u l t i n g in some v a r i a b i l i t y in treatment from patient to patient. thus patients being treated on a protocol do not always receive therapy in exactly the manner that the experimental design suggests  and the data needed for formal analysis of treatment results are not always completely and accurately collected. 
1 

     the problems we have described reach far beyond the oncology clinic at stanford medical center. there are now several institutions designing protocol management systems to make the details of treatment protocols readily available to oncologists and to insure that complete and accurate data are collected . oncocin is superficially similar to some of the developing systems  but its research objectives are unique in ways we describe in the following section. one overriding point requires emphasis: in order to achieve its goals  oncocin must be used directly by busy clinicians; the implications of this constraint have pervaded all aspects of the system design. 
i l l 	design considerations 
     the design of the oncocin system has been influenced by the two parallel thrusts of the project's research aims. the first is to perform research into the basic science issues of applied a r t i f i c i a l intelligence. efforts are being made to improve the tools currently available  and to develop new tools for building knowledge-based expert systems for medical consultation. other areas of ai research include the extension of methods of interaction between rule-based consultation systems and a large database of timeoriented clinical information  decision making based upon trends over time  and the development of techniques for assessing knowledge base completeness and consistency. 
     the second thrust is to develop a clinically useful oncology consultation tool. one of the primary goals of the project is to demonstrate that a rule-based consultation system with an 
explanation capability can be usefully applied in a busy clinical environment. while working to achieve this goal  we hope to establish both an effective relationship with a specific group of physicians  and a scientific foundation  that will together facilitate future research and implementation of computer-based tools for clinical decision making. 
iv 	system overview 
     the oncocin system will eventually contain knowledge about most of the protocols in use at the oncology clinic at stanford medical center. although protocol knowledge is largely specified in a written document  many questions arise in 
	a memo from 	the mit laboratory 	for computer 
science  describes a recent collaboration between mit and oncologists who have been building a protocol management system at boston university . they are planning to develop a program for designing new chemotherapy protocols. to our knowledge  this is the only other project that proposes to use ai techniques in a clinical oncology system. however  the stated goals of that effort are different from those of oncocin. translating the information into a computer-based format. knowledge base development has therefore been dependent on the active collaboration of stanford oncologists. we have started by encoding the knowledge contained in the protocols for treatment#of hodgkins disease and the non-hodgkins lymphomas . 
     in standard use of the system  the physician uses a video display terminal  after examining a patient  to interact with oncocin's dataacquisition program  the interviewer . the session normally includes: reviewing time-oriented data from the patient's previous visits to the clinic  entering information regarding the current visit  and receiving recommendations generated by the 
 reasoner  for appropriate therapy and tests. the reasoner and interviewer are linked with one another as shown in fig. 1. in generating its recommendation  the reasoner uses i n i t i a l data about the patient's diagnosis  data about previous treatment  results of current laboratory tests  plus the protocol-specific information in its knowledge base. before terminating an interaction  the physician can examine the explanation provided with each recommendation . the physician may approve or modify oncocin's recommendation; any changes are noted by the system and kept available for future review. oncocin also provides hard-copy backup to complement the on-line interaction and facilitate communication among clinic personnel. 
	to 	ensure 	that 	busy 	clinicians 	will 	find 
oncocin fast and easy to use  as well as simple to learn   a special terminal interface has been built. this interviewer  fig. 1  includes hardware and software features not often found in current medical systems. a customized keyboard incorporates a keypad for most of the entry and command functions. the interviewer uses a highspeed video display terminal with multiple windows; simulating the appearance of the flowsheet that currently appears in the clinic chart and which is used to record all the data required for adequate protocol analysis. as the physician enters flowsheet information  relevant patient data are passed to the reasoner  which is simultaneously considering the case and preparing a recommendation to pass back to the interviewer for display. the need for a terminal interface that provides rapid response to user type-in  while simultaneously satisfying the computational demands of the reasoning process  has led us to design a complex system architecture with asynchronous processes. 
       we also implemented the complex protocol for treating oat cell carcinoma of the lung. because the oat cell protocol is the most complex at stanford  and it took only a month to encode the relevant rules  we are confident that the representation scheme we have devised will be able to manage  with only minor modifications  the other protocols we plan to encode in the future. 
　　　　we have chosen a representation that will also eventually allow oncocin to offer a justification for any intermediary conclusions that the system made in deriving the advice. 
1 

the reasoner and the interviewer each run in a 
separate fork under the tenex or tops-1 operating systems  therebv approximating a p a r a l l e l processing system . separation of the interface program from the reasoning program allows the user to receive prompt attention when entering flowsheet values; the i n t e r l i s p program  running in background  is not permitted to slow down the i n t e r a c t i o n . 
	for a given parameter 	; 
 1  oncocin does not require many of the c a p a b i l i t i e s provided by emycin. 
 1  because of the nature of the interaction with the interviewer  oncocin needs to operate in a data-driven mode. although emycin has l i m i t e d allowance for forward chaining of r u l e s   it would be 

　　　oncocin's heasoner communicates with the interviewer during a consultation. the need to i n t e r a c t with t h i s specialized interface program is one of several reasons that we chose to b u i l d oncocin from scratch rather than to implement it as a new emycin system   1   . other important differences between oncocin's application and the domains for which emycin systems have been b u i l t include the f o l l o w i n g : 
 1  oncocin requires s e r i a l consideration of each patient at i n t e r v a l s t y p i c a l l y spread over many months. each c l i n i c v i s i t is a new data point  and emycin's data structures do not easily accommodate multiple measurements of the same a t t r i b u t e over time or inference rules based upon assessment of temporal trends 
       another program  the i n t e r a c t o r   handles interprocess communication. there is also a 
       process that provides background u t i l i t y operations such as f i l e backup. the reasoner is w r i t t e n in i n t e r l i s p   the interviewer in sail. 
inconvenient to force a largely datadriven reasoning process into the emycin format. 
	b 	representation 
　　　knowledge about the oncology domain is represented using four main types of data s t r u c t u r e : contexts  parameters  rules  and control blocks. 
　　　contexts represent concepts or e n t i t i e s of the domain about which the system needs s t a t i c knowledge  and aid in organizing the knowledge base. individual contexts are c l a s s i f i e d by type   e . g .   disease  protocol  or chemotherapy  and can be arranged h i e r a r c h i c a l l y . during a consultation  a l i s t of  current  contexts is created as information is gathered. these current contexts together provide a high-level description of the patient in terms of known chemotberapeutic plans. this description serves to focus the system's recommendation process by specifying the s i t u a t i o n when a rule can be applied or when data should be requested. knowledge can be specific to one or more contexts at varying levels of the contextual hierarchy. 
　　　parameters represent the a t t r i b u t e s of patients  drugs  t e s t s   etc. that are relevant for the protocol management task   e . g .   white blood count  recommended dose  or whether a patient has had prior radiotherapy . each piece of information accumulated during a consultation is represented as the value of a parameter. there are three steps in determining the value of a parameter. f i r s t   the system checks to see if the value can be determined by d e f i n i t i o n in the current context. if not  the  normal  method of f i n d i n g the value is used: if the parameter corresponds to a piece of laboratory data that the user is l i k e l y to know  it is requested of the user; otherwise  rules for concluding the parameter are t r i e d . f i n a l l y   the system may have a  possibly context-dependent  default value that is used in the event that the 
         this same point led to the development of the vm system   1     a rule-based program that was influenced by emycin but d i f f e r e n t in i t s detailed implementation because of the need to follow trends in patients under treatment in an intensive care u n i t . the development of similar c a p a b i l i t i e s for oncocin is an active area of research at present. the i n i t i a l persion of the system  however  encodes only the knowledge from the protocols and does not consider other factors that rely on expert judgment. 
1 

normal mechanism f a i l s to produce a value  or the user may be asked to provide the answer as a last r e s o r t . 
　　　rules are the f a m i l i a r productions used in emycin  and other rule-based systems; they may be invoked in either data-driven or goal-directed mode. a rule concludes a value for some parameter on the basis of values of other parameters. a rule may be designated as providing a d e f i n i t i o n a l value or a default value as defined above. the rules are categorized by the contexts in which they apply. 
　　　as in emycin systems  rules are represented in a stylized format so that they may be translated from lisp into english for explanation purposes . this representation scheme more generally allows the system to  read  and manipulate the rules. it has also f a c i l i t a t e d the development of programs to check for consistency and completeness of the rules in the knowledge base   1   . 
	below 	is 	the 	english 	t r a n s l a t i o n 	of 	an 
oncocin rule for determinjng the value for the parameter  attenuated dose  
rule1 
to determine the current attenuated dose for a l l drugs in mopp or for a l l drugs in pave: 
advise 
to make a recommendation about t r e a t i n g the p a t i e n t : 
1  formulate a therapeutic regimen. 
1  determine the tests to recommend. 
1  determine suggestions about the p a t i e n t . 
1  determine the time t i l l the p a t i e n t ' s next v i s i t . 
　　　to summarize the differences between oncocin's rules and those used in mycin and other emycin systems: 
 1  control is separated from domain knowledge  although process information is s t i l l codified in a modular format using control blocks; 
 1  the contextual information  which defines the s e t t i n g in which a rule can be applied  is separated from the main body of the rule and used for screening rules when they are invoked  see next s e c t i o n   ; and 
 1  rules are subclassified to distinguish the major mechanisms by which the values of parameters can be determined 
  d e f i n i t i o n a l   normal  and default r u l e s   . 

i f : 1  this is the s t a r t of the f i r s t cycle after a cycle was aborted  and 
1  the blood counts do not warrant dose attenuation 
then: 	conclude that the current attenuated dose is 1 percent of the previous dose. 
　　　control blocks serve as high-level descriptions of the system's methods for performing tasks. each contains an ordered set of steps to be used for accomplishing a specific task   e . g .   formulating a therapeutic regimen  or calculating the correct dose of a drug . these could be viewed as a s c r i p t of the events which occur when a patient is being treated on chemotherapy   1   . note that t h i s data structure allows us to separate control descriptions e x p l i c i t l y from decision rules  a d i s t i n c t i o n that was often unclear in emycin systems. the design of control blocks was influenced by the prototypes used in the centaur system   1   . the steps in a control block are similar to the prototype's control s l o t . because we wish to be able to explain any action that oncocin takes  control blocks can be translated i n t o english using the same translation mechanism that is used to translate r u l e s . for example: 
　　　　in keeping with the philosophy reflected in other systems we have designed  oncocin is able to produce natural language explanations for i t s recommendations. 
         pave and 	mopp are acronyms 	for two 	of the drug combinations used to t r e a t hodgkins disease. 
	c 	control 
　　　when a user specifies the task that oncocin is to perform  the corresponding control block is invoked. this simply causes the steps in the control block to be taken in sequence. these steps may e n t a i l : 
 1  fetching data  either by loading previously stored data or by requesting them from the user. this causes parameter values to be set  r e s u l t i n g in datadirected invocation of rules that use those parameters  and that apply in the current context . 
 1  determining the value of a parameter. this causes goal-directed invocation of the rules that conclude the value of the parameter  and apply in the current context . d e f i n i t i o n a l rules are applied f i r s t   then the normal r u l e s   and if no value has been found through these means  the default rules are t r i e d . if a rule that is invoked in a goal-directed fashion uses some parameter whose value is not yet known  that parameter's value is determined so that the rule can be evaluated. however  concluding the value of any parameter  either by the action of rules or when information is entered by the user  may cause data-directed invocation of other rules. 
 1  invoking another control block. 
 1  calling a special purpose function  which may be domain-dependent . 
1 

　　　the effects of t h i s control mechanism contrast with the largely backward-chained control used in mycin and other emycin systems. in those systems  a l l rule invocation occurs because the value of a s p e c i f i c parameter is being sought. rules used to determine the value of that parameter can be referenced in any order  although ordering is preserved for the assessment of the parameters occurring in the conditional statements in each r u l e ' s premise. antecedent  data-driven  rules are used when the user's response to a question  or  less commonly  the conclusion from another r u l e   t r i g g e r s one of the system's forward-chained r u l e s . these rules can only be used as antecedent rules and t y p i c a l l y have single conditions in t h e i r premise. 
　　　in oncocin   f i g . 1     on the other hand  i n i t i a l control is derived from the control block invoked in response to the task selected by the user. forward- and back-chaining of rules are intermingled   and any rule can be used in either 
d i r e c t i o n . 

　　　there are t r a d e - o f f s when choosing between a system which is p r i m a r i l y data-driven and one which is goal-directed. back-chained systems use rules to generate questions  thus f a c i l i t a t i n g explanations. the disadvantage  however  is that a goal oriented system may appear slow to get to the main points. on the other hand  data-driven systems are more d i f f i c u l t to implement because they must be able to handle entry of information in a r b i t r a r y order. in the case of oncocin. the use 
       the broken l i n e in f i g . 1 outlines the portion of the oncocin control s t r u c t u r e which is i d e n t i c a l to that found in emycin. 
1 
of a flowsheet structure for data entry has enabled us to develop a data-driven system. the entries on the flowsheet define a l l of the important data for therapy decisions . since the doctors use the interviewer to enter the same data that they would normally record anyway  the potential f r u s t r a t i o n of i n t e r a c t i n g with a goal-directed system is removed. 
vi 	why 	a r t i f i c i a l i n t e l l i g e n c e techniques  
　　　we have learned through the mycin experience  and in building other emycin systems as w e l l   that a major part of each development e f f o r t has been the encoding of poorly understood knowledge. e n l i s t i n g the time and enthusiasm of domain experts has often been d i f f i c u l t   yet progress is usually impossible without active c o l l a b o r a t i o n . thus there is great appeal to a domain in which much of the needed knowledge is already recorded in thorough  a l b e i t lengthy and complicated  documents   v i z .   the protocol descriptions that are w r i t t e n for every cancer therapy c l i n i c a l experiment . much of the appeal of the oncocin problem domain is the a v a i l a b i l i t y of detailed documents that we can study and use for knowledge base development. 
       as we noted e a r l i e r   several other centers have begun to develop protocol management systems  but none has chosen to use techniques drawn from a r t i f i c i a l i n t e l l i g e n c e . complicated though the chemotherapy protocols may be  they are largely algorithmic  and other groups have been able to encode much of the knowledge using less complex representation techniques. our reasons for choosing an ai approach for encoding the knowledge of oncology chemotherapy are varied. it should be stressed that a l l protocols have important loopholes and exceptions; when an aberrant s i t u a t i o n arises for a patient being t r e a t e d   the proper management is t y p i c a l l y l e f t unspecified. for example  the lymphoma protocols with which we have been most involved to date include several rules of the form: 
	i f : 	there is evidence of disease extension 
　　then: refer the patient to lymphoma c l i n i c or: 
i f : there is s i g n i f i c a n t t o x i c i t y to v i n c r i s t i n e 
	then: 	consider s u b s t i t u t i n g velban 
as shown here  the protocols often defer to the opinions of the attending physicians without providing guidelines on which they might base t h e i r decisions. hence there is no standardization of responses to unusual problems  and the v a l i d i t y of the protocol analysis in these cases is accordingly subject to question. our long-term goal is to develop approaches to these more complex problems that characterize the management of patients being 
　　　　the physicians can i n s e r t new items into the o n - l i n e flowsheet  as they presently do by hand with the paper flowsheet. however  these entries are not used when generating a therapy recommendation. 

treated for cancer. it is when these issues are addressed that the need for ai techniques w i l l be most evident. at that point the task domain w i l l begin to look similar in complexity to the decision problems in a system l i k e mycin; rules w i l l have uncertainty associated with them  there is currently no need for c e r t a i n t y weights in the rules in oncocin   and close collaboration with experts w i l l once again be required as new rules are w r i t t e n that are not currently recorded in chemotherapy protocols or elsewhere. even in the short term  however  ai representation and control techniques have permitted us to keep the knowledge base f l e x i b l e and easily modified. they have also allowed us to develop explanation c a p a b i l i t i e s and to separate kinds of knowledge e x p l i c i t l y in terms of t h e i r semantic categories. 
acknowledgments 
　　　the oncocin system described in t h i s report has r e l i e d on the e f f o r t s of several physicians and computer s c i e n t i s t s . we would l i k e to express our gratitude to the following present and past project members: paul chang  jai cho  chuck clanton  larry fagan  phil gerring  patricia pickett  brandy s i k i c   motoi suwa  randy teach  and craig tovey. 
