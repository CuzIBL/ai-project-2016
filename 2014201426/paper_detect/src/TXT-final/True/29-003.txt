 
sds is a discovery system from numeric measurement data. it outperforms the existing systems in every aspect of search efficiency  noise tolerancy  credibility of the resulting equations and complexity of the target system that it can handle. the power of sds comes from the use of the scale-types of the measurement data and mathematical property of identity by which to constrain the admissible solutions. its algorithm is described with a complex working example and the performance comparison with other systems are discussed. 
1 	introduction 
finding regularities in the data is a basis of knowledge acquisition by induction. one such typical and challenging task is inducing quantitative formulae of scientific laws from measurement data. langley and others' bacon systems  langley et a/.  1  are most well known as the pioneering work. they founded the succeeding bacon family. fahrenheit  koehn and zytkow  
1   abacus  falkenhainer and michalski  1   ids 
 nordhausen and langlay  1  and kepler  wu and wang  1  are such successors that basically use similar algorithms to bacon in search for a complete equation governing the data measured in a continuous process. however  recent work reports that there is considerable ambiguity in their results under noisy data even for the relations among small number of quantities  schaffer  1; huang and zytkow  1 . another drawback of the bacon family is the complexity of hypothesis generation. this also limits their applicability to find a complex relation that holds among many quantities. 
　to alleviate these drawbacks  some members of the bacon family  e.g. abacus  utilizes the information of the quantity dimension to prune the meaningless terms based on the principle of dimensional homogeneity. however  this heuristic still leaves many types of equations in candidates. coper  kokar  1   another type of equation finding systems based on a principle of dimensional analysis called  buckingham's ii-theorem  
1 	learning 
 buckingham  1   can significantly reduce the candidate generation by explicit use of the information about the quantity dimension. its another significant advantage is higher credibility of the solution that it is not merely an experimental equation but is indeed a first principle equation. however  these approaches are not applicable when the information of the quantity dimension is not available. this fact strongly limits their applicability to non-physics domains. 
　the primary objective of this study is to establish a method to discover an admissible complete equation governing a complex system where its domain is not limited to physics ensuring as much as possible its property being the first principles. any other technical areas  including system identification theory  ljung  1   have not addressed to automatically derive first principle based models of complex systems from measurement data. our goal if attained will provide an advantageous means not only for the field of scientific discovery but also for the analysis of complex systems in engineering. as a step towards this goal  we developed a quantitative model discovery system  smart discovery system  sds   implementing our new approach. sds utilizes newly introduced constraints of scale-type and identity both of which highly constrain the generation of candidate terms. because these are not heuristics but mathematical constraints  the generated candidates are highly credible. sds also adopts bi-variate equation generation based on data fitting. but what makes sds different from bacon family is that it employs triplet checking of the validity of those bi-variate equations  a quite strong mathematical constraint. it should be emphasized that sds does not require the information about quantity dimension. the information required besides the mear surements is the knowledge of scale-type of each quantity. this feature expands the scope of its applicability since the knowledge of scale-types is widely obtained in various domains including psychophysics  sociology and etc. 
1 	outline of m e t h o d 
sds requires two assumptions on the feature of the objective system to be analyzed. one is that the objective system can be represented by a single quantitative  continuous and complete equation for the quantity ranges of our interest. another is that all of the quantities in the equation can be measured  and all of the quantities except one dependent quantity can be controlled to their arbitrary values in the range. the latter is a common assumption in bacon family. the former is the assumption of the original bacon systems  and is also assumed by other bacon family  i.e.  search made for a complete equation for every continuous region in the objective system . 
　the information required from the user besides the actual measurements is a list of the quantities and their scale-types. the rigorous definition of scale-type was given by stevens  stevens  1 . he defined the measurement process as  the assignment of numerals to object or events according to some rules.'  he claimed that different kinds of scales and different kinds of measurement are derived if numerals can be assigned under different rules  and categorized the quantity scales based on the operation rule of the assignment. the quantitative scale-types are interval scale  ratio scale and absolute scale  and these are the majorities of the quantities. examples of the interval scale quantities are temperature in celsius and sound tone where the origins of their scales are not absolute  and are changeable by human's definitions. its operation rule is  determination of equality of intervals or differences   and its admissible unit conversion follows  generic linear group: x' - kx + c . examples of the ratio scale quantities are physical mass and absolute temperature where each has an absolute zero point. its operation rule is  determination of equality of ratios   and its admissible unit conversion follows  similarity group: x' - kx . examples of the absolute scale quantities are dimensionless quantities. it follows the rule of  determination of equality of absolute value   and  identity group: x' = x . here  we should note that the scale-type is different from the dimension. for instance  we do not know what the force  ratio  divided by the acceleration  ratio  means within the knowledge of scale-types. 
　in the following sections  the details of the algorithm of sds are explained. for clarification purpose  we first focus on the case where the model involves only ratio and absolute scales in the next section. the extension to interval scale is described in the latter section. sds can handle all of the three scale-types. 
1 	equation search based on ratio scale 
1 	bi-variate test 
the algorithm of sds is outlined in figure 1. step  1  significantly reduces the search space of bi-variate equations by using the  scale-type constraint  two wellknown theorems in the dimensional analysis provides the basis of this step  buckingham  1 . 
buckingham ii-theorem //  is a complete equation  and if all of its arguments are either ratio or absolute scale-types  then the solution can be written given a set of ratio scale quantities  rq  and a set of absolute scale quantities  aq  
 1  apply bi-variate test for an admissible equation of ratio scale to every pair of quantities in rq. store the resultant bi-variate equations accepted by the tests into an equation set re and the others not accepted into an equation set n r e . 
 1  apply triplet test to every triplet of associated bi-variate equations in re. derive all maximal convex sets for the accepted triplets  and compose all bi-variate equations into a 
multi-variate equation in each maximal convex set. define each multi-variate equation as a term. replace the merged quantities by the generated terms in rq. 
 1  let aq = aq + rq. given candidate formulae set ce  repeat steps  1  and  1  until no more new term become generated. 
 1  apply bi-variate test of a formula in ce to every pair of the terms in aq  and store them to ae. merge every group of terms into a unique term respectively based on the result of the bi-variate test  if this is possible. replace the merged terms with the generated terms of multivariate equations in aq. 
 1  apply identity constraints test to every bi-variate equation in ae. merge every 
group of terms into a unique term respectively based on the result of the identity constraints test  if they are possible. replace the merged terms with the generated terms of multi-variate equations in aq. go back to step  1 . 
the candidate models of the objective system are derived by composing the terms in aq. 
figure 1: outline of sds algorithm 

	washio & motoda 	1 

these theorems state that any meaningful complete equation consisting only of the arguments of ratio and absolute scale-types can be decomposed into an equation of absolute scale-type quantities having an arbitrary form and equations of ratio scale-type quantities having products form. the former is 
called an  ensemble and the latter  regime's. 
　because we know that any pair of ratio scale quantities in a given complete equation has a product relation if both belong to an identical regime  sds searches bivariate relations having the following product form in 
rq  which is the unique admissible equation that hold figure 1: a circuit of photo-meter in such a regime. 
	 where x  y are ratio scale quantities. 	 1  
the value of the constant a must be independent of any other quantities according to product theorem  while the constant b is dependent on the other quantities in the regime. sds applies the least square fitting of eq. 1 to the bi-variate experimental data of x and y that are measured while holding the other quantities constant  and determines the values of a  its expected standard 
error da  and b. for ease of linear fitting  the logarithmic form of eq. 1  is used instead of eq. 
1 itself. the judgment is made whether this equation fits the data well enough by the following two types of statistical tests. 
 1  f-test of the ratio between variances of regressive component and residual error component 
 1  test if da is larger than the absolute value of a itself. 
the test  1  is to check if the equation accurately fits to the given data in terms of the power  variance  of residual component. the test  1  is to simply check if the value of the constant a is meaningful. when any of the tests fail  x and y are judged not to have the product relation. for identical pair of ratio scale quantities  this procedure is repeated k = 1 times to check the independence of the constant a while holding the other quantities at randomly chosen different values. then the following test is applied to the set of values of a and da to check the independence. 
 1  x1-test of the ratio between variance of the values of a and the average of da over the k data set. 
if all these tests are passed  the pair of x and y is judged to have the admissible product relation. then the bi-variate equation together with the average of a and da i e.  and is stored to re. if any of the tests failed  the bi-variate equation  and are stored to nre. 
　the procedure in step  1 - 1  is now demonstrated by an example of a complex system depicted in figure 1. this is a circuit of photo-meter to measure the rate of increase of photo intensity within a certain time period. the resistance and switch parallel to the capacitor and 
1 	learning 


	washio 1c motoda 	1 


1 	learning 


	washio & motoda 	1 


1 	discussion and related work 
main features of the discovery system sds are its low complexity  robustness  scalability and wide applicability. the basic algorithm of sds consists of two types of procedures. one is the bi-variate test for each pair of quantities and terms in steps  1    1    1  and  1 . the complexity of this type of procedure is 1 n1k  where n  m  k are the number of quantities to represent the objective system  the number of experimental data used for a data fitting and the number of iteration of the data fitting in a bi-variate test  respectively. another is the triplet test for each triplet of quantities and terms in steps  1    1  and  1   where its complexity is 1 n1 . m and k usually do not affect the performance of sds as they are almost independent of the complexity of objective system structure. moreover  the computational cost required in the bi-variate test is much larger than the triplet test because the former involves multiple experiments  data sampling  data fitting and some statistical tests  whereas the latter involves the triplet consistency checking among the given coefficients only. thus  the practical complexity is almost proportional to the second order of n. table 1 shows the performance of sds to discover various physical law equations. the relative cpu time of sds normalized by the first case shows that its complexity is nearly proportional to n1. for reference  the relative cpu time of abacus is indicated for the same cases except for the circuit examples of this pape falkenhainer and michalski  1 . though abacus applies various heuristics including the information of dimension  its complexity is still np-hard. as this feature is shared by bacon family  they can hardly derive the model of the electric circuit of this complexity. 
　the robustness of sds against the noisy experimental environment has been also evaluated. the upper limitation of the noise level to obtain the correct result in the 
1 	learning 
table 1: statistics on complexity and robustness 

cases of more than 1% of 1 trials was investigated for each physical law  and they are indicated in the last column of table 1. the noise levels shown here are the std. of gaussian noise relative to the real values of quantities  and were added to both controlled  input  quantities and measured  output  quantities at the same time. thus actual noise level is higher than these levels. the results show the significant robustness of sds. sds can provide appropriate results under any practical noise condition. 
　the low complexity and the high robustness shown here ensure the significant scalability of sds to engineering problems. many systems in bacon family adopt generate and test in the search. in contrast  the low complexity of sds comes from its straightforward algorithm to apply only product and linear forms in polynomial time order in concert with the highly restrictive but domain independent constraints. by adding some more basic functional equations to ce  the search of sds will become more powerful. the robustness of sds comes from the bi-variate direct fitting to data and the structure of the triplet test. the systems in bacon family repeat formulae fitting to coefficients resulted from the other fitting if it is necessary. this method accumulates the error of data fitting  and derives erroneous results. on the other hand  sds uses only the bi-variate and direct fitting to the given data  and efficiently composes the result in statistically accurate manner. the multiple statistical tests provide quite conservative judgment on the selection of equations  which contributes to reducing the ambiguity of reasoning. but it also requires following up of missed equations. this is done by reconstructing mcss in the triplet test by assuming some missed equations in the derived mcs. 
　the wide applicability is another advantage of sds  as it does not require any information on dimensions of quantities. for example  the following equation is known to be the law of spaciousness of a room in psychophysics kanet a/.  1 . 


where sp   r  li and wi are average spaciousness of a room  room capacity  average light intensity and solid angle of window at the location i in the room. though the dimension of sp is unclear  its scale-type is known to be ratio scale based on its definition. l and r are ratio scale  and w is absolute scale. we applied sds to this system for the case of n - 1  and easily obtained the above expression. the dimension based approach such as coper may not be applicable to this case. 
　the weakness of the approach of sds is some limits on the class of formulae to be discovered. first  the regimes and ensemble formulae must be read-once formulae  where each quantity appears at most once in it. second  the relations among quantities must be arithmetic  where the operators are limited to addition  subtraction  multiplication  division  exponentiation and logarithm because of the limited contents of ce. third  the formula of every pair of quantities searched in the bivariate test is limited to the relation of a simple binary operator. these restrictions should be relaxed  
even though the majorities of the first principle formulae fall into this class. bshouty et al  proposed an approach to find three unary arithmetic functions g x   h y  and /    related by a binary arithmetic operator  e.g.  f g x  + h y   for a given arithmetic relation f x  y . it is based on an invariance principle of this structure under the linear conversion of g x  and h y  bshouty  1 . their approach may not be very adequate for the data-driven discovery  because it assumes an initially given precise relation of f x  y  and its derivatives. however  this invariance principle on the binary relation has a possibility to provide an efficient remedy to the third limitation. the second limitation can be relaxed by increasing the variety of the contents of ce. the first is also a challenging issue  and some invariance or identity principle can be used for the relaxation. all of these issues are left for the future work. 
1 	conclusion 
sds implements newly introduced constraints of scaletype and identity in the algorithm of bi-variate and triplet equation test. this architecture has shown to have low complexity  high robustness  promising scalability and wide applicability. it is true that the most of the scientific discoveries have been made through a large number of experiments and observations. however  the scientists have not solely relied on the data but some admissible conditions such as invariance of light speed  symmetry for time inverse and continuity of relations. the constraints of scale-type and identity are two of such conditions having wide applicability. our future plan is to extend this work to further larger systems and also to seek new laws in non-physical domains. 
