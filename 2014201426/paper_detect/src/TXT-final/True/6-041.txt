 
symmetry breaking in csps has attracted considerable attention in recent years. various general schemes have been proposed to eliminate symmetries during search. in general  these schemes may take exponential space or time to eliminate all symmetries. this paper studies classes of csps for which symmetry breaking is tractable. it identifies several csp classes which feature various forms of value interchangeability and shows that symmetry breaking can be performed in constant time and space during search using dedicated search procedures. experimental results also show the benefits of symmetry breaking on these csps  which encompass many practical applications. 
1 introduction 
symmetry breaking for constraint satisfaction problems has attracted considerable attention in recent years  see the last cp proceedings  the cp'1 and cp'1 workshops on symmetries  and  crawford et al.  1; freuder  1; backofen and will  1; puget  1  for some less recent papers . indeed  many applications naturally exhibit symmetries and symmetry breaking may drastically improve performance 
 e.g.   barnier and brisset  1; meseguer and torras  1; puget  1  . an important contribution in this area has been the development of various general schemes for symmetry breaking in csps  e.g.  sbds  gent and smith  1  and sbdd  fahle et al  1; focacci and milano  1  . unfortunately  these schemes  in general  may require exponential resources to break all symmetries. indeed  some schemes require exponential space to store all the nogoods generated through symmetries  while others may take exponential time to discover whether a partial assignment is symmetric to one of the existing nogoods. as a consequence  practical applications often place limits on how many nogoods can be stored and/or which symmetries to break. 
¡¡this paper approaches symmetry breaking from a different  orthogonal  standpoint. its goal is to identify classes of csps that are practically relevant and for which symmetry breaking is tractable  i.e.  symmetry breaking is polynomial in time and space. it identifies several such classes  which 
constraints 
p. flener  j. pearson  and m. agren 
department of information technology 
uppsala university  box 1 s-1 uppsala  sweden 
encompass many practical applications. these csps feature various forms of value interchangeability and the paper shows that symmetry breaking can be performed in constant time and space during search using dedicated search procedures. the paper also reports preliminary experimental results indicating that symmetry breaking on these csps brings significant computational benefits. finally  the paper introduces the new notions of existential and abstract nogoods  which were used to derive the results for the various csp classes. we believe that these notions are helpful to derive many other classes of tractable symmetries. in particular  they also allowed us to derive classes of tractable variable symmetries  which we cannot include here for space reasons. as such  this paper should be viewed only as a first step in this fascinating area. 
¡¡it is also useful to contrast our approach with the research avenue pioneered by  freuder  1  on value interchangeability. freuder also introduced various forms of value interchangeability. however  his goal was to discover symmetries inside csps and to reformulate them by preprocessing to remove symmetries. unfortunately  discovering symmetries in csps is not tractable for many interesting classes of csps. 
our research  in contrast  assumes that modellers are aware of the symmetries in their applications. it focuses on how to exploit this knowledge during search to eliminate symmetries efficiently. consider  for instance  the scene-shooting problem featured in  van hentenryck  1 . this problem aims at producing a movie  or a series  at minimal cost by deciding when to shoot scenes. each scene involves a number of actors and at most 1 scenes a day can be filmed. all actors of a scene must be present on the day the scene is shot. the actors have fees representing the amount to be paid per day they spend in the studio. the goal of the application is to minimize the production costs. an optimal solution to this problem can be modelled as an assignment of scenes to days which minimizes the production costs. it should be apparent that the exact days assigned to the scenes have no importance in this application and are fully interchangeable. what is important is how the scenes are clustered together. our approach does not aim at discovering this fact; rather it focuses on how to exploit it to eliminate the symmetries it induces. 
¡¡the rest of the paper is organized as follows. after some preliminaries  sections 1  and 1 study three classes of csps for which symmetry breaking is tractable. for space reasons  
1 

only the first class is presented in full detail with proofs. section 1 briefly reports some experimental results. section 1 concludes the paper. 
1 	preliminaries 
this section defines the main concepts used in this paper. the definitions  although they capture the informal meaning of csps  are non-standard and simplify the definitions and proofs considerably. the basic idea is that the set of constraints is abstracted by a boolean function which holds if all the constraints are satisfied  since we are not interested in the constraint structure . solutions are also represented as functions  assignments  from variables to their sets of values. 

algorithms to solve csps manipulate partial assignments. it is often important to reason about which variables are already assigned  the domain of the partial assignment  and the set of values they are assigned to  the image of the assignment . note that domains represent sets of variables in this paper  not values as is traditional   since we use functions to model  partial  assignments. 

1 	value-interchangeable csps 
there are many applications in resource allocation and scheduling where the exact values taken by the variables are not important. what is significant is which variables take the same values or  in other terms  how the variables are clustered. this notion of symmetry is what  freuder  1  calls full interchangeability for all variables and all values. the prototypical example is graph-coloring. another  more complex  example is the scene allocation application mentioned in the introduction. this section shows that symmetry breaking for these problems is tractable and takes constant time and space. we first define value-interchangeable csps. 

in the following  we use icsp as an abbreviation for valueinterchangeable csp. the following theorem is a fundamental characterization of nogoods for icsps. 


lemma 1. let v be an icsp  a be a nogood for v  and 1 be a partial assignment. there exists a linear-time algorithm that tests whether 1 violates any nogood in closure a p . 
proof. direct consequence of lemmas 1 and 1 and the fact that the abstract nogood is linear in ivi. ¡õ 
constraints 	1 

to our knowledge  this paper provides the first formal proof that these algorithms break all the symmetries in their respective problems. to prove the correctness of ilabel  and other related search procedures  it is useful to introduce the concept of compact variable decomposition tree. 

the following lemma  which states that compact variable decomposition trees are complete  follows directly from the examination of the nogoods above. 

our next lemma states that a compact variable decomposition tree never matches any nogood generated during search. 
the correctness of procedure ilabel follows from the two lemmas above. other search strategies  e.g.  lds  also remove all symmetries in constant time and space. 
theorem 1. procedure ilabel breaks all the symmetries in constant time and constant space for an icsp v  i.e.  it never matches any member of the closure of any nogood 
generated during search. 
1 	piecewise-interchangeable csps 
in many applications  e.g.  in resource allocation and scheduling  the values are taken from disjoint sets but they are interchangeable in each set. for instance  in the scene allocation problem  we can easily imagine a version of the problem where days are divided in morning and afternoon sessions. actors probably have strong preferences  and thus different fees for the morning and afternoon sessions  but the day of the session may not matter. this paper captures this  more limited  form of interchangeability by piecewise interchangeable csps. we first define this class of csps formally and then derive similar results as for lcsps. we state the main definitions and theorems only  since the derivation is similar to the one for icsps. as traditional  we use d  + d1 to denote the disjoint union of d  and d1. our definitions and results only 


constraints 	1 

figure 1: a labeling procedure for wicsps. 
theorem 1. procedure wilabel oreaks all the symmetries in constant time and constant space for a wicsp. 
1 	experimental results 
this section gives some preliminary results showing the benefits of symmetry breaking on these classes of problems. table 1 gives results on graph coloring  an jcsp  and on partitioned graph coloring  a picsp. in partitioned graph coloring  the colors are divided in 1 groups and are fully interchangeable in each group. the constraints express the usual graphcoloring property: no two adjacent vertices are colored with the same color. table 1 gives the result of coloring graphs with 1% edge density with at most n/ 1 * log-1  n   colors  where n is the number of nodes. the first column gives the number of nodes  the second column gives the time to color the graphs using the default labeling procedure  and the third and fourth columns report the time to color the graphs and the partitioned graphs with symmetry breaking. note that the default labeling does not exploit symmetries and hence its time is similar for both graph coloring and partitioned graph coloring  second column . the last column gives the ratio of pi label and the default labeling procedure  the gains are too large for coloring to be reported as a ratio . all results are an average of 1 runs in milliseconds under slcstusprolog. they clearly show that symmetry breaking on these csps brings significant benefits. 
1 	conclusion 
this paper studied three classes of csps for which symmetry breaking is tractable. these csp classes feature various forms of value interchangeability and allow symmetry breaking to be performed in constant time and space during search. experimental results also show the benefits of symmetry breaking on these csps  which encompass many practical applications. there are many directions for future research. of particular interest is the study of tractable classes of csps exhibiting variable symmetries where the set v has a special thanks to the reviewers for their very interesting comments. all authors are partly supported by a stint institutional grant 1-1 of stint. p. van hentenryck is partly supported by an nsf itr award dmi-1. the sweden-based authors are also supported by grant 1 of the swedish research council. 
