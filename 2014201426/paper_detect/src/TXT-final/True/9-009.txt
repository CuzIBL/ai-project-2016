 
     an information processing model of some important aspects of inductive reasoning is presented within the context of one scientific discipline. given a collection of experimental  mass spectrometry  data from several chemical molecules the computer program described here separates the molecules into  well-
behaved  subclasses and selects from the space of a l l explanatory processes the  characteristic  processes for each subclass. the definitions of  well-behaved  and  characteristic  embody several heuristics which are discussed. some results of the program are discussed which have been useful to chemists and which lend credibility to this approach. 
introduction 
　　　induction in science has been understood to encompass many different levels of tasks  from theory construction as performed by einstein to everyday non-deductive inferences as made by scientists looking for explanations of routine data. for the most part  it is not well defined however one understands it  a notable exception being statistical inference . although general statements can be made about non-deductive inference  it is unlikely that there exists one general  inductive method  that guides scientific inference at a l l levels. nor does it seem likely that a method of scientific inference at any one level can succeed without recourse to task-specific information  that i s   information specific to the particular science. within these assumptions we are exploring an information processing model of scientific inference in one discipline-
     a unifying theme in our explorations is that induction is efficient selection from the domain of a l l 
possible answers. previous papers on the heuristic dendral program have advanced this theme with respect to hypothesis formation in routine scientific work. recently  we have been exploring this theme with respect to the higher-order task of finding general rules to explain large collections of data . this paper extends the previous work to the task of finding  rules for subclasses of objects  given empirical data for the objects but without prior knowledge of the 
number of subclasses or the features that characterize them. 
the task area 
1 
　　　for reasons discussed previously   the task area is mass spectrometry  a branch of organic chemistry. the rule formation task is to find rules that characterize the behavior of classes of molecules in the mass spectrometer  given the mass spectrometric data from several known molecules. 
　　　the chemical structure of each molecule is known. the data for each molecule are a  the masses of various molecular fragments produced from the electron bombardment of the molecule in the instrument and 
b  the relative abundances of fragments at each mass. the data for each molecule are arranged in a fragmentmass table {fmt   or mass spectrum. typically  there are 1 data points in one fmt. the task is to characterize the experimental behavior of the whole class of molecules. 
   rules which characterize the behavior of the molecules are represented as conditional sentences in our system. the antecedent of a simple conditional rule is a predicate which is true or false of a molecule  or class of molecules ; the consequent is a description of a mass spectrometric action  henceforth  process   which is thought to occur when that molecule is in the experimental context. we have termed these rules  situation-action rules   or  s-a rules  . the rule syntax has been described previously1 and is not c r i t i c a l to an understanding of the present paper. 
   an example of a rule  rewritten in english  is:  if the graph of the molecule contains the estrogen 
skeleton  then break the bonds between nodes labeled 1 and 1.  this process  the consequent of this rule  is named brk1l in table t. the graph of the estrogen skeleton mentioned in the antecedent is shown 
with the conventional node numbering in figure 1. 
   the rules w i l l be used in the heuristic dendral performance program to determine the structure of compounds  reasoning from the mass spectrometric data of each. they are also of use to chemists interested 
in extending the theory of mass spectrometry. 
overview of method 
   the rule formation program contains three major sub-programs  which are described below under the headings data interpretation  process selection  and molecule selection. the control structure for the overall program is described after the discussions of the three major sub-programs. a brief overview of the whole program w i l l be given f i r s t   however  in order to 
set the context. 
   the purpose of the program is to find the characteristic processes which determine separable subclasses of molecules given the experimental data and molecular structure of each molecule. the overall flow of the program  as described below  is shown in figure 1. the three major steps are to reinterpret the experimental data as molecular processes  find the characteristic processes for the given molecules  and select the set of molecules that are  well behaved  
with regard to the characteristic processes. 	the reinterpretation of the data is done once for each molecule in the whole set  and the results are 
summarized once. the second and third sub-programs are called successively until they isolate a well-behaved subclass of molecules and determine the processes which characterize their behavior. the monitor then subtracts the well-behaved subclass from the starting class of molecules  and repeats the successive calls to the second and third subprograms. the whole program stops when there are n or fewer molecules not yet in some well-behaved subclass.  for now  n=1.  
1    the data interpretation program has been described previously with some aspects of the process selection program1. the molecule selection program and class refinement loop in the control sequence are new additions. 
data interpretation 
　　　as mentioned above  the purpose of the data interpretation and summary program  intsum  is to reinterpret the experimentally determined data  the fmt  for each molecule and summarize the results. because the program has been described previously details will be omitted here. it should be noted that the successful apolication of this program to a subclass of estrogens has already been reported in the chemical literature . the intsum program is general in that it w i l l work on fmt's for any class of 
molecules with a common skeletal graph and it is flexible in that the knowledge used by the program is easily changed and there are numerous optionr  controlling the operation of the program. 
　　　the intsum program is called with the i n i t i a l set of molecules and their fmt's  it is also riven the graph structure of the skeleton common to a l l molecules in the i n i t i a l set. the f i r s t step is to search the space of a l l possible processes which could explain data points in the fmt of any molecule with the given skeleton. the space of explanatory processes is combinatorial; simple processes that cut the graph into two fragments are generated f i r s t   followed by pairs of simple processes  t r i p l e s   and so on. the heuristics listed below constrain the search: 
simplicity  occam's razor   
　　　if two or more processes explain the same data point  prefer the simpler one  i . e .   the process involving fewer simple steps. 
chemical constraints. 
　　　 a  break no more than nb bonds in any process  whether simple or multi-step  nb=1 in our current version ;  b  do not allow any process to break two bonds to the same carbon atom;  c  do not allow a fragment to contain fewer than na atoms  na=1 currently ;  d  do not allow any process to contain more than np simple processes  np=1 currently ;  e  break only single bonds  no double or triple bonds . 
     the heuristic search produces a l i s t of plausible processes without reference to the data. the second step of the intsum program is to determine for each 
process and each fmt whether there is evidence for the process in the fmt. 	if so  then that process can explain the data point and the strength of the evidence is saved. 	the final step is to summarize for each process and a l l molecules the freauency  total strength of evidence and number of alternative explanations. 	 freauency for a given process is the percentage of a l l molecules that have evidence for the 
process.  	these statistics are passed to the process 
selection program. 
process selection 
     the process selection program chooses the most characteristic processes for the given class of 
molecules from the l i s t of a. priori plausible processes that are output by the intsum program. it assumes that the molecules given to it are a l l in one 
well-behaved class. thus  it can merely f i l t e r the l i s t of processes to find those which satisfy the criteria for characteristic processes. 
     a process mentioned in a rule statement must satisfy several criteria in order to be counted as a characteristic process for the molecules under consideration. the intsum program provides a summary of statistics for the plausible processes it has chosen from the space of a l l processes. the process selection program applies heuristic criteria to sort out the most likely processes and to distinguish among alternative explanations  when alternatives remain. 	it 
uses the information from the data for f i l t e r i n g   in contrast to the a priori f i l t e r i n g in the intsum program. for example  an a priori simplicity criterion f i l t e r s out processes that break too many bonds. the criteria for  most likely processes  - frequency  strength of evidence  and degree of uniqueness - are discussed 
below. to a large extent the choice of these criteria and particularly the choice of parameter settings are arbitrary. however  the following discussion provides some rationale for our choices. 
frequency. 
     if nature presented clear and unambiguous data to us we could expect a l l and only characteristic processes for a class of molecules to occur 1% of the time. this is what we would like to mean by 'characteristic' process. however  the data contain noise and  more importantly  we are forced to interpret the data in terms of processes that we construct. thus  in the literature one finds discussions of exceptions to rules together with presentation of the rules. a low frequency threshold  1%  is used as a criterion for plausible process instead of a high one because the 
marginal processes which are included at one step can be excluded at a later refinement step if they prove to be uncharacteristic of a class of molecules. 
strength of evidence. 
　　the program considers the strength of evidence found for each process  besides the frequency of 
molecules that show the process. associated with each fragment mass in the experimental data is a measure of the percent of total jons  or ion current  contributed by fragments of that mass.  the evidence from mass spectrometry is not merely binary  i . e .   yes/no  although we have considered it that way in the past.  the total ion current for any molecule can be visualized as the sum of a l l y-values in a bar graph in which the x-values represent fragment masses. the strength of evidence for a process  then  is the percent of the 
total of a l l ion currents  for a l l molecules  that can be explained by the process. the present value of this parameter is 1  i . e .   1% of the data must be explained by any process that w i l l be said to be characteristic of the given molecules. 
　　there may be much information in the weaker data points  but until we can interpret the strong signals  we do not want to start looking c r i t i c a l l y at the weak ones. this is why we have a strength of evidence threshold  although in our t r i a l s we have kept it f a i r l y low . 
degree of uniqueness. 
     the program w i l l discard processes that cannot uniquely explain at least n data points for each molecule. the rationale behind this criterion is that processes that are always  or often  redundant with other processes have no explanatory power of their own. in spite of the intuitive appeal of this criterion  it was not used for the trials reported here in which molecule selection is coupled with process selection. for process selection alone  it is a useful f i l t e r . 
     these three criteria f i l t e r the processes to provide the characteristic processes for the molecules given to the program. however  the processes may s t i l l overlap in the data points that they explain. if two  or more  processes are ambiguous  i . e .   they explain most of the same data points  the program tries to resolve the ambiguity in favor of a single explanation. this is not easy  for the competing explanations have a l l passed the tests for  most likely processes  just discussed. thus  they a l l appear good enough to be rules on their own. 
　　　the resolution of ambiguities among processes is made according to relative values of the criteria used to judge them likely in the f i r s t place. that i s   the values of frequency  strength of evidence and degree of uniqueness are compared - in any order - to determine which process is preferred  if any. 
molecule selection 
　　　molecule selection  by i t s e l f   is a simple program whose purpose is to find a subclass of molecules that are  well-behaved  with respect to a set of processes. its inputs are  a  a class of molecules and  b  a set of processes that are characteristic of those molecules {output of the process selection program just described . 
　　　the processes that are chosen as roughly characteristic of a class of molecules are used by the molecule selection program to refine the extension of the class. several processes w i l l each have a few exceptions - the number permitted depending on the frequency threshold used by the program. but if the same molecules appear as exceptions over and over again  for several processes  then they probably do not belong in the same subclass with the molecules whose behavior is characterized by those processes. 
　　　a molecule is said to be well-behaved with respect to a set of processes  or well-behaved  if it shows evidence for at least mp of the processes. the current 
value of mp is 1% of the number of processes in the 
set. currently this is the only criterion used to identify members of the subclass  although other features of the molecules could also be used for clustering. for example  the structural features of chemical molecules could also help classify molecules which  belong  together. the reason descriptive features such as these are not used during molecule selection is that they constitute a good check  by chemists  on the adequacy of the results of the 
molecule separation procedure. 
control structure of the rule formation monitor 
　　　the overall flow of control has been briefly described and diagrammed in figure 1  and the three major components of the whole program have been discussed. the interaction between process selection and molecule selection is the last important detail in the description of the program. it is shown schematically in figure 1 and selected portions of intermediate output are shown in table i i . 
　　　after the intsum program interprets and summarizes the data for a set of molecules  the process selection program is asked to find a set of processes that characterize those molecules. however  process selection starts with the assumption that the molecules should be characterized a l l together  i . e .   that the molecules are homogeneous  or belong in one class with respect to mass spectrometry. the purpose of the rule formation monitor  and the molecule selection program in particular  is to remove the necessity of working within this assumption. because a class of molecules has a common skeleton  there is reason to believe that they are homogeneous  with respect to mass spectrometry processes . but this is not necessarily true. many of the molecules whose structures contain the graph common to estrogens  e.g.   the equilenins discussed with table ii in the results section  f a i l to exhibit behavior that is characteristic of most estrogens in the mass spectrometer. 
     the monitor begins with the null hypothesis that the i n i t i a l set m of molecules is homogeneous with respect to a l l the relevant processes given as input. with the process selection program it finds plausible processes that roughly characterize the whole class of molecules. it attempts to confirm the hypothesis by finding the subclass s of molecules that are well-
behaved for those processes. if this subclass s is the same as the i n i t i a l set m  then the assumption of homogeneity is taken to be true. in that case  there is no proper subset to be separated. 
　　when the subclass s is different from the starting class m  however  the program loops back to process selection as shown in figure 1. this figure shows the 
procedure for producing one homogeneous subclass of molecules  and the characteristic processes for the 
subclass ; this procedure  rule formation  is i t s e l f used repeatedly in the main program as shown in figure 1. 
　　the inputs to the rule formation procedure are  a  the set rp of relevant processes and statistics for them  v i z .   the output of intsum  and  b  a class m' of molecules  where m' is i n i t i a l l y the same as the entire class of molecules  m  given to intsum. 	m' is used to keep track of the best refinement of m so far. 
     the process selection program selects a set of processes p from rp in the manner described above. p characterizes the class m's insofar as m' can be characterized at a l l . the criteria for characteristic process can be made more restrictive if the class is known to be homogeneous  e.g.  frequency  1%  . in this case  however  the loose criteria listed above are used  e.g.  frequency  1%  in order to allow many exceptions to the  characteristic  processes. 
　　the molecule selection program selects a subclass of molecules s  from m'   that ere best characterized by the processes in p. the subclass s includes molecules that show evidence for most  1% or more  of the processes in p  and excludes molecules that are exceptions to many. thus s is at least as well behaved as m' with respect to p. and since the two measures of selection are not perfectly complementary  s is likely to be better behaved than m' with respect to p   if molecule selection uses less restrictive measures than process selection  then s w i l l be less well behaved than m' and the procedure w i l l f a i l except when the i n i t i a l set of molecules is homogeneous.  
     one interesting part of the procedure is that after processes are selected  all of the molecules are reclassified with regard to the number of times they appear as exceptions to the processes. 	this is shown in figure 1: 	at step 1 of each level a l l molecules in 
the i n i t i a l set  h  not m' or s   are tested against the processes. thus  a molecule can be excluded at one level  because it is an exception to too many of the processes at that level   but be included again at another level for a slightly different set of processes. 
     the condition under which we want the program to stop is that the subclass s of molecules after an iteration is the same as the class m' from which the iteration started  condition 1 in figure 1 . in other words  under this condition the program has found an s and a p such that p characterizes s  s=m'  and s is 
vell-behaved with respect to p. the subclass s is taken to be homogeneous  and the processes in p can be taken to be mass spectrometry rules for molecules in s. 
　　the refinement level in figure 1 is the number of times the procedure has been invoked in trying to find 
1 
one homogeneous subclass of molecules. the second of the stopping conditions tests whether the refinement level is equal to an arbitrary maximum  which is currently 1. this condition is necessary to avoid an infinite loop in the case where the program can find no subclass s that is homogeneous with respect to p. the level 1 has been observed to produce f a i r l y acceptable results: after three iterations through this loop  the subclass s is about as refined as it w i l l get. after more iterations the procedure appears to oscillate in that molecules added to s in one iteration are subtracted  from s in a later iteration. our experience is very limited. because there is no guarantee that the procedure converges  however  some stopping condition like the maximum refinement level is necessary. 
     the last stopping condition shown in figure 1 tests whether there are enough molecules in the subclass to warrant further refinement. if there are fewer than an arbitrary minimum number  =1  of 
molecules in s  then further refinements w i l l be unreliable. this minimum is not completely arbitrary  since it depends to some extent on the frequency 
measures used in process and molecule selection. 	but  
intuitively  when the number of molecules in g is small there is l i t t l e value in breaking s up into subclasses anyway. 
     as shown in the overall flow diagram  figure 1  after the f i r s t major subclass  s  has been defined  a l l molecules in s are removed from any further consideration by subtracting them from m. the entire procedure is then repeated with the new m. it stops only when there are so few molecules left in m  1 or fewer  that process selection is unreliable and 
molecule selection appears pointless. 
     the output of the whole program now is merely the collected set of outputs from a l l iterations  v i z .   the collected s p pairs  as shown in figure 1. future work w i l l focus on automatically generalizing the descriptions of the molecules. this is now done by hand  except when the i n i t i a l class m is homogeneous then the generalized description is the common graph 
structure. 
results 
     the intsum program alone has already provided useful new results for chemists  as reported in the chemical literature . the process selection program  working with output from intsum  but without molecule 
selection   has successfully found sets of characteristic processes for a well-understood class of molecules  estrogens  figure 1  and for classes whose behavior is s t i l l under investigation  e.g.  
equilenins  progesterones  amino acids . for 1 estrogens  which were assumed by both an expert and 
the program to be in one class  rules found by the program agree closely with rules formed by the expert from the same data.  this result is not shown in a 
table  but the comparison with the expert's rules looks much like that shown in table i.  	expert chemists have made suggestions for improvements  but 
were generally in agreement with the processes selected by the program. 
     the rule formation program with molecule selection has been tested on several sets of molecules. the results of running the program on a set of 1 estrogens  a subset of the 1 mentioned above  are shown in table i. the program separated two of the 1 compounds into a second class because they were not as well behaved as the rest - they were exceptions to about 1% of the characteristic processes. however  
the chemist thought the separation was reasonable. the processes selected by the program are shown with indications of the discrepancies between the program's choices and the chemist's. the discrepancies mostly arose from the program's applying different criteria to select one process from viable alternatives. table ii shows the success of the molecule separation part of the program when rule formation was done on data from 1 non-homogeneous estrogenic steroids. the major subclass of chemical interest is the set of 1 equilenins which are identified by common modifications 
to the skeleton shown in figure 1. the structural properties were not used by the program although the chemist did classify the compounds by such features. by selecting well-behaved subclasses of molecules the program grouped four or five  equilenins   molecules #1  1  1  1  and a l l three  1-acetates  {#1  1  l1  in the f i r s t subclass. the f i f t h equilenin  #1  was removed from that subclass on the last refinement 
because it was an exception to 1 of 1 characteristic processes used to determine the subclass. 
     in the third iteration shown in table i i   the program grouped three of the chemist's four  1-benzoates  together  molecules #1  1  1 . in the fourth iteration it grouped together the chemist's two  diacetates  and one  triacetate   molecules #1  1  1 . two iterations produced subclasses with only two members - when put together they encompass two  1-acetates   #1  1   one  1-benzoate   and one  gamma-lactone   #1 . the two molecules remaining unclassified at the end of the procedure were the last 
 equilenin   molecule ′1  and the last  1-benzoate   #1 . 
conclusions 
     building an information processing model of scientific reasoning in mass spectrometry  although not completed  has already led to interesting and useful results. the model incorporates heuristic search in process selection. the procedure for selecting molecules can be thought of as a planning procedure insofar as it reduces the problem of formulating rules for a class of diverse molecules to a number of smaller subproblems  v i z .   formulating rules for smaller classes of well-behaved molecules. however  the molecule selection procedure is highly dependent on process selection  as described in detail. 
　　the incompleteness of the program as a model of the entire rule formation procedure should be readily apparent. we have not described anything that approximates confrontation of rules with new data  for example. but as the results section indicates  the program can separate subclasses of well-behaved molecules and can find characteristic processes for the subclasses with enough accuracy  on a few examples  to gain preliminary acceptance by an expert in the field. 
acknowledgements 
     we have received invaluable assistance from colleagues. in particular  mssrs. william white and stephen reiss have done almost a l l of the programming; 
dr. dennis smith has provided chemical expertise; and professors e.a. feigenbaum and j. lederberg have provided much of the intelligence in the design of the system. financial support is gratefully acknowledged from the advanced research projects agency  sd-1  and from the national institutes of health  rr-1 . 
