
this paper proposes a novel approach to discover simultaneous time differential law equations having high plausibility to represent first principles underlying objective processes. the approach has the power to identify law equations containing hidden state variables and/or representing chaotic dynamics without using any detailed domain knowledge.
1 introduction
a set of well known pioneering approaches of scientific law equation discovery is called bacon family  langley et al.  1 . they try to figure out a static equation on multiple quantities over a wide state range under a given laboratory experiment. some approaches introduced unit dimension constraints and  scale-type constraints  to limit the search space to mathematically admissible equations reflecting the first principles  falkenhainer and michalski  1   washio and motoda  1 . especially  the scale-type constraints have wider applicability since it does not require any unit information of quantities. subsequently  lagrange addressed the discovery of  simultaneous time differential law equations  reflecting the dynamics of objective processes under  passive observations  where none of quantities are experimentally controllable  dzeroski and todorovski  1 . its extended version called lagramge introduced domain knowledge of the objective process to limit the search space within plausible law equations  todorovski and dzeroski  1 . extended ipm having similar functions with lagramge further identified plausible law equations containing  hidden state variables  when the variables are known in the domain knowledge  langley et al.  1 . pret identified  chaotic dynamics  under similar conditions with these approaches where rich domain knowledge is available  bradley et al.  1 . however  scientists and engineers can develop good models of the objective dynamics without using the discovery approaches in many practical cases when the detailed domain knowledge is available. accordingly  the main applications of the discovery approaches are to identify simultaneous time

　　the support of jsps grant-in-aid for scientifc research  no.1 is acknowledged.differential equations reflecting the first principles under passive observation and  little domain knowledge. 
　in this paper  we propose a novel approach called scaletrack  scale-types and state tracking based discovery system  to discover a model of an objective process under the following requirements.
 1  the model is simultaneous time differential equations representing the dynamics of an objective process.
 1  the model is not an approximation but a plausible candidate to represent the underlying first principles.
 1  the model is discovered from passively observed data without using domain knowledge specific to the objective process.
 1  the model can include hidden state variables.
 1  the model can represent chaotic dynamics.
1 outline
1 basic problem setting
we adopt the following  state space model  of objective dynamics and measurements without loss of generality.
and
where the first equation is called a  state equation  and the second a  measurement equation.  is called a state vector  a system function  a process noise vector  a measurement vector  a measurement matrix  a measurement noise and a time index. is not limited to linear formulae in general. is represented by a linear transformation matrix  since the measurement facilities are artificial and linear in most cases. if is column full rank  the values of all state variables are estimated by solving the measurement equation with . otherwise  some state variables are not estimated within the measurement equation  and these variables are called  hidden state variables.  in the scientific law equation discovery  is initially unknown  and even is not known correctly. only a state subvector
and a submatrix are initially known. to derive from   scaletrack must identify the dimension of
at first. then  it searches plausible candidates of from the measurement time series data.
1 entire approach
the entire approach of scaletrack is outlined in figure 1. given a set of measurement time series data  the dimension of is identified through a statistical analysis called  correlation dimension analysis   berge et al.  1 . for each element of   its time trajectory is mapped to a phase space constructed by time lagged values of the element  and the degree of freedom  i.e.  the dimension of   embedded in the time trajectory is estimated by computing the sparseness of the trajectory in the space.
　once the dimension is known  all possible combinations of scale-types of the elements in are enumerated based on scale-type constraints  the known measurement submatrix and the scale-types of the elements in . the representative scale-types of quantities are ratio scale and interval scale. the examples of the ratio scale quantities are physical mass and absolute temperature where eachhas an absolute origin  while the examples of the interval scale quantities are temperature in celsius and sound pitch where their origins are not absolute and arbitrary changed by human's definitions. due to these natures  the quantitative relations among the quantities are strongly constrained  luce  1   and these constraints are used to determine the scale types of the elements in from . after every combination of the scale types in is derived  the candidate formulae of a state equation are generated for each combination based on  extended product theorem   washio and motoda  1  limiting the admissible formulae of the equation based on the scale-type constraints.
　subsequently  through a set of state tracking simulations called  sis/rmc filter  on the given measurement time series data  the parameter values and the states in every candidate state equation are estimated  doucet et al.  1 . this state tracking has many advantages comparing with the other nonlinear state tracking approaches such as the conventional extended kalman filter  haykin  1  and the qualitative reasoning based pret  bradley et al.  1 . the former using the linearization of the state equations does not work well when the equations include some singular points and/or some state regions having strong sensitivity to the tracking error. the latter faces a combinatorial explosion of qualitative states when the dimension and/or the complexity of the state space structure are high. in contrast  sis/rmc filter does not require any approximation to be spoiled by the singularity and the strong nonlinearity  and does not face the combinatorial explosion of the states to be considered  because it tracks the state probability distributions by using its direct and sequential monte carlo integration within bayesian framework. in our approach  the estimated parameter values are rounded off to integers when the values are close enough to the integers within the expected estimation errors  since the parameters tend to be integers in many physical processes. finally  some state equations providing highly accurate tracking in terms of  mean square error  mse   are selected as the plausible candidates of first principle based and dynamic state space models of the objective process.
1 implementation
the evaluation of candidate state equations by the sis/rmc filter is the most time consuming step. any search can not

figure 1: outline of entire approach.
table 1: basic performance.
case h rr11rrh11ri11rih11be skipped  since the search space is nonmonotonic. we experienced that one run of stand alone scaletrack to discover a simple state equation took more than a month even if we used an efficient algorithm. accordingly  the current scaletrack introduced a simple grid computing framework using a pc cluster consisting of a control server and 1 personal computers where each has an athlon xp 1+  1 ghz  cpu and 1gb ram. the server computes the first three steps and then allocates the task to evaluate 1% of candidate state equations to each computer. because this task is mutually independent  and occupies the most of computation in scaletrack  this implementation accelerates the run speed almost 1 times.
1 result
1 basic performance evaluation
the evaluation is made in terms of scale-types of state variables  hidden state variables and measurement noise levels by using the following two dimensional artificial formulae.
where	and	are ratio scale.
figure 1: an attractor of altered rossler chaos.
where	is ratio scale and	interval scale.
table 1 shows the evaluation result. all state variables are observed in rr and ri. whereas  the measurement variable is not available in rrh and rih respectively  and hence a hidden state variable exists in these cases. the correlation dimension analysis properly estimated the dimension of state vectors as nearly in each case. the computation times required for rrh  ri and rih were longer than that of rr  because the variety of admissible formulae containing interval scale variables is larger than that of ratio scale variables. the result in that the formula having the correct shape is top ranked by the accuracy is marked by . if the correct formula is derived within the top five solutions  it is marked by
　  otherwise it is marked by . the table shows that almost relative noise is acceptable for no hidden state cases  while noise less than is required for hidden state cases. since noise is the most widely seen in many applications  the performance of scaletrack is practical for no hidden state cases and some hidden state cases.
1 discovery of chaos
the state equation to be discovered is the following altered rossler chaos equation.
and
this has an attractor in a -phase space as depicted in figure 1. all state variables are interval scale  and can be measured through the corresponding interval scale measurement variables respectively. was obtained in the correlation dimension analysis  and hence the state equations consisting of three state variables were searched. the required computation time was 1 hours  and the following most accurate state equation was resulted. this formula has an identical shape with the original except some discrepancies of coefficients. this indicates the high ability of scaletrack to discover the chaotic dynamics reflecting the underlying first principles.
and
1 conclusion
scaletrack achieved three advantages which have not been addressed in any past work of mathematics  physics and engineering not limited to scientific discovery. the first is the discovery of simultaneous time differential equations having plausibility to represent first principles. the second is the discovery of hidden state variables. the third is the discovery of chaotic dynamics. these discoveries are done without using detailed domain knowledge. these advantages are essentially important in many scientific and engineering fields due to the wide existence of such dynamics in nature.
