
a fundamental problem for artificial intelligence is identifying perceptual primitives from raw sensory signals that are useful for higher-level reasoning. we equate these primitives with initially unknown recurring patterns called motifs. autonomously learning the motifs is difficult because their number  location  length  and shape are all unknown. furthermore  nonlinear temporal warping may be required to ensure the similarity of motif occurrences. in this paper  we extend a leading motif discovery algorithm by allowing it to operate on multidimensional sensor data  incorporating automatic parameter estimation  and providing for motif-specific similarity adaptation. we evaluate our algorithm on several data sets and show how our approach leads to faster real world discovery and more accurate motifs compared to other leading methods.
1 introduction
this paper addresses the problem of unsupervised discovery of perceptual primitives from time-varying sensor data. such data includes sensor readings collected by mobile robots  onbody sensors  surveillance video  econometric data  and industrial diagnostic readings.
　perceptual primitives can be thought of as recurring patterns or motifs of the data; that is  they are sets of subsequences with high similarity. the goal of this work is to discover the motifs and the corresponding occurrences in realvalued  multivariate data. the problem is complicated because little is known about the motifs a priori. the number of motifs  number of occurrences  their length  shape  scale  and the location of each occurrence are all unknown. furthermore  motifs may only appear similar after nonlinear warping  and the data may be corrupted by noise. finally  any discovery algorithm must be efficient  since even small data sets may have anywhere from a few thousand to several hundred thousand sensor readings. thus  algorithms with quadratic space or time complexity are unacceptable for real applications.
　we are influenced by the philosophical position articulated by cohen et al. . in that work  the authors argue that  most of the intellectual work in ai is done not by programs but by their creators  and virtually all the work involved in specifying the meanings of representations is done by people  not programs.  they adopt fred dretske's theory of meaningful representation  positing that an internal state must both indicate a condition and have the function of indicating that condition. applying this theory to robotics  cohen et al. conclude that learning meaningful representations requires the robot to analyze its sensor readings to learn abstractions that informaction. similarly  we seek to design an activity discovery system that learns endogenously meaningful representations via unsupervised analysis of sensor data.
　our contributionsare:  1  to extend the applicability of current discovery algorithms   1  to reduce the domain knowledge required of users  and  1  to improve performance of both discovery accuracy and real-world execution time. applicability is extended by allowing discovery to work directly with multidimensional data  see section 1 . our approach achieves two additional improvements by automatically estimating the size of the neighborhood for each motif. first  the user is no longer required to specify a parameter that is vital to locating correct motif occurrences but which is highly dependenton the domain and the distance metric used to measure subsequencesimilarity. second  automatic estimation allows a different neighborhood size for each motif  something that is extremely difficult to specify manually but which leads to higher quality motifs in empirical tests  see sections 1 and 1 . we also present several evaluation methods for motif discovery and discuss many of the semantic and applicationspecific issues involved in comparing different approaches  see section 1 .
1 related work
activity recognition is a supervised learning problem related to activity discovery. approaches often use complex models  including hidden markov models  hmms   switching linear dynamic systems  and stochastic grammars starner et al.  1; pavlovic et al.  1; minnen et al.  1 . bao and intille  provide a broad survey  comparing several methods for recognizing activities captured by on-body sensors.
　in the bioinformatics community  researchers have developed many approaches for discovering recurring patterns that correspond to binding sites in nucleotide sequences. meme uses expectation maximization  em  to estimate the parameters of a probabilistic model for each motif  bailey and elkan  1 . gemoda unifies several previous discovery methods  but the algorithm has an expected run time quadratic in the size of the data  jensen et al.  1 . finally  the greedy em method developed by blekas et al.  uses incremental mixture learning to discover motifs represented by probabilistic models similar to meme.
　the data mining and artificial intelligence communities have developed methods that work with real-valued sequences. peruse finds recurring patterns in multidimensional data by estimating the parameters of an hmm-like model  oates  1 . tanaka et al.  apply principal component analysis  pca  to multidimensional data  using a minimum description length criterion to select motifs found in the principal component. lin et al.  use hashing and lower-bounding to efficiently search for motifs. chiu et al.  extend lin et al.'s approach by using random projections to quickly find candidate motifs in noisier data.
1 motif discovery via random projection
in this section  we focus on chiu et al.'s probabilistic discovery method   discussing extensions to improve its applicability  effectiveness  and real-world run time. the algorithm operates in five steps  see table 1 for a summary of the user-specified parameters :
1. extract all subsequences of a given length  n  from the time series using a sliding window.
1. convert each subsequence to a string using sax with length w and a unique symbols.
1. build a collision matrix by comparing the strings via several iterations of random projection.
1. select motif seeds as the two subsequences corresponding to the largest entry in the collision matrix.
1. extract motifs by detecting other windows in the neighborhood of each seed. the neighborhood is defined as all sequences within a fixed distance  r  of either seed.
subsequence extraction: subsequences are extracted using a sliding window of user-specified length. each window location corresponds to one subsequence of the time series.
subsequence discretization: each subsequence is discretized using the symbolic aggregate approximation  sax  method developed by lin et al. . sax is a local quantization method that first computes a piecewise aggregate approximation  paa   keogh et al.  1  of the normalized window data and then replaces each paa segment with a symbol. normalization ensures that the subsequence has zero mean and unit variance. paa represents a sequence by dividing it into equal length segments and then storing the mean within each segment. the final sax quantization is based on precomputed breakpoints that divide the data range into equiprobable regions assuming an underlying standard normal distribution. each paa segment is represented by the symbol of the corresponding bin  see figure 1 .
　as presented  sax appears applicable only to univariate data; however  one can use the algorithm with multivariate data by applying it to each dimension independently

figure 1: a real-valued  1d signal is converted into a sax string
 edacb  using five paa segments  bounded by the vertical dotted lines  and five sax symbols.
and then concatenating the resulting strings. this leads to a constant number of symbols and linear increase in string length  keogh  1 .
building the collision matrix: once each subsequence has been converted to a string  the similarity between each pair is efficiently estimated using random projection. the key insight is that while direct comparison is infeasible since there are o t1  pairs given t strings  similar sequences can be identified in o i，t  time using i iterations of randomprojection  see figure 1 . each iteration involvesselecting a random subset of the string positions and building a hash table with the corresponding characters. after all strings are hashed  collisions  equivalent projections from different strings  are taken as evidence of similarity and the corresponding positions in a collision matrix are incremented.
　using random projection to estimate similarity has several important properties. first  it is effective in the presence of shot noise. even if some of the symbols are drastically different  when random projection does not select these positions  the string will still appear similar. second  although the collision matrix could require o t1  time and space in the worst case  realistic data sets produce a linear number of non-zero entries leading to linear time and space requirements with a sparse matrix implementation.. furthermore  the complexity can be controlled online by dynamically changing the number of string positions included in each iteration of random projection  keogh  1 . in a pathological data set  as when the distance between all subsequences is effectively zero  the matrix will still grow prohibitively large despite dynamic projection adaptation. when such a condition is detected  the algorithm can switch to storing row sums rather than the full matrix. our experiments show that this simplification does reduce accuracy  but the penalty may be tolerable to achieve strict linear time and space complexity.
selecting seed motif occurrences: once the collision matrix is built  seed motif occurrences are extracted by locating maximal entries. each entry in the matrix corresponds to a pair of subsequences that can be used to find the other occurrences of the motif. the distance between the seeds must be less than r  they must not temporally overlap previously identified occurrences  and they must not overlap each other  called a trivial match . search for additional motif seeds terminates when the largest entry in the collision matrix is smaller than the expected score  which can be estimated by

figure 1:  a  for each iteration of random projection  a subset of string positions are selected  here  positions one and three .  b c  the remaining symbols are hashed  and  d  equivalent projections are tallied in a collision matrix.
equation 1 in  chiu et al.  1 .
locating additional motif occurrences: the final step of the discovery algorithm is to locate all other occurrences of the motif identified by the seed locations. this is achieved by scanning the original subsequences and selecting those within the neighborhood of the seeds  i.e.  min d wi seed1  d wi seed1  ＋ r  where wi : i （ {1..t} represents each of the original subsequences .
discussion: in our experiments  see section 1   chiu's approach works very well despite the erroneous assumption that all motifs and all motif occurrences have the same length. it is  however  quite sensitive to the various user-specified parameters summarized in table 1. in particular  the neighborhood radius  r  is vital for accurate motif discovery  yet it is very difficult to specify since it depends on the domain  the distance metric  the motif length  and the features selected for processing.
1 motif discovery using automatic neighborhood estimation
before discussing our approach for automatically estimating a per-motif neighborhood radius  we address the issue of applying the discovery algorithm to multidimensional data.
　as discussed previously  we can apply a univariate discretization algorithm to each dimension of a multidimensional subsequence and concatenate the result. if this combined string is used directly for random projection  however  the space requirements will likely be quadratic in the length of the input data. this increase is understandable because projecting columns of the concatenated string is equivalent to defining multidimensional similarity as a logical or between dimensions. thus  two strings are deemed equivalent for a particular iteration if they match in any dimension. instead we implement similarity using a logical and by requiring table 1: user-specified parameters for chiu's algorithm
symboldescriptionnwindow lengthwnumber of paa segments  string length asax alphabet sizerradius of motif neighborhoodthat all dimensions agree for a particular string position. this drastically reduces the effective size of the collision matrix and requires motifs to span all of the dimensions. to our knowledge  no existing algorithm addresses the more general problem of discovering motifs that exist in only a subset of the dimensions.
1 automatic estimation of motif-specific neighborhoods
in order to address the theoretical and practical issues surrounding a user-specified neighborhood radius  we have developed a method for automatically estimating an appropriate value from data. because the radius is not used during the random projection phase  that part of the algorithm proceeds as usual. once a pair of motif seeds has been selected  the distance from each subsequence to the closer of the two seeds is computed using the original  real-valued data. next  the smallest portion of the distances are selected for further analysis1. in the experiments presented below  the smallest 1% are used based on the assumption that 1% is a very loose upper bound on the number of motif occurrences. our empirical results show that this precise size of the portion only has a minor impact on the final estimate  see figure 1 .
　finally  to determine the appropriate neighborhood radius  we sort the distances and seek a  knee in the curve.  the knee correspondsto the change from distances within the motif to those outside. this change is an inflection point of the curve. inflection points can only occur at a zero of the second derivative  which corresponds to an optima of the first derivative. thus  estimating the radius is equivalent to finding the maxima of the derivative  see figure 1   and because we can directly compute the discrete first derivative  no assumptions about the parametric form of the distance curve are necessary.
　the inherent undersampling of the true distribution of motif occurrences causes the observed distances to be quite noisy. therefore  the mode is estimated as the weighted mean of the derivative. this procedure is summarized below:
1. calculate the minimum distance from each subsequence  wi : i （ {1..t}  to a motif seed: di = min d wi seed1  d wi seed   
1. compute  vk  the kth order statistic for
1. select the k smallest distances: di : di ＋ vk 1. sort the distances in ascending order 1. calculate the discrete first derivative:
1. treat the derivative as weighted votes for the best radius and compute the expected value:


figure 1: the radius of each motif neighborhood is estimated from the distance between each potential member and the motif seeds  left . it is equated with the inflection point  which is estimated by the weighted mean of the derivative of the distances  center . the result is automatic motif-specific neighborhood sizes  right .
1 evaluation methods
before evaluating the performance of our approach  we must discuss what it means for one set of discovered motifs to be  better  than another set. as with activity recognition  the efficacy of a discovery system depends on how the results will be used. we have identified three broad approaches for evaluating the quality of discovered motifs: comparison to ground truth  primary utility  and interpretability.
1 comparison to ground truth
when operating on well-understood data  domain experts may be able to manually identify motifs. thus  they can create a set of ground truth labels that identify which motifs exist and where they occur in the data. a discovery system can then be evaluated by comparing the discovered motifs to the  correct  motifs identified by the experts in the same way that supervised recognition systems are evaluated. this approach is often used in the bioinformatic literature where algorithms are tested against nucleotide data for which binding sites area already known.
　although ground truth labels allow for a quantitative  objective measure of performance  evaluation is still complicated by issues such as different kinds of errors   bounded  versus  fluent  activities  and different levels of error analysis  see  minnen et al.  1b  for a detailed discussion . furthermore  the number of discovered motifs may not be the same as what was identified by a domain expert. different error metrics may prefer methods that discover fewer but more accurate motifs  high precision  or those that identify all of the expected motifs but also find unlabeled motifs  high recall . note that these additional motifs are neither correct nor incorrect in general. they may be errors  or they may correspond to real patterns in the data that were simply unexpected.
1 primary utility
the best measure of performance is the utility of the discovered motifs in accomplishing a primary task. the assumption here is that motifs are not discovered for their own sake but rather in the service of a primary goal. for example  when analyzing speech data  a discovery algorithm may identify phonemes as motifs if a short temporal scale parameter is specified. speech recognition systems  however  are not typically evaluated based on their phoneme recognition rates. instead  they are only scored according to their ability to accurately detect higher-level structures such as words  phrases  or sentences. the accuracy of phoneme-level motifs is not important per se: they only matter insofar as the motifs represent useful features for improving word recognition rates.
1 interpretability
discovered motifs can also be qualitatively evaluated by presenting them to a domain expert. the expert can score the results by inspecting either the original data or some other time-synchronized recording such as video or audio. evaluation may consist of manually checking that all occurrences of a motif are semantically similar and that similar events are not split across multiple motifs. the key difference between this approach and a comparison to ground truth is that interpretability is evaluated by inspecting the motifs that were actually discovered  whereas ground truth labels encode an expert's a priori expectations.
1 further issues for evaluation
the quality of the discovered motifs is not the only factor that contributes to the value of a discovery algorithm. other factors matter  such as run time characteristics  including asymptotic performance and expected real world run time   online versus batch processing  and memory requirements. in addition  the overall usability of the system is a major component of its value and is a fundamental source of motivation for our approach. although we will show that motif-specific neighborhood size estimation improves results  even if the difference was negligible  automatic estimation would still be a contribution. the benefit arises because automatic estimation eases the demands on the user to understand the domain before using the discovery system and reduces the need to manually explore the space. a similar idea is discussed in more detail in  keogh et al.  1 ; however  the compressionbased distance metric proposed in that work proved insufficient for detecting motifs in the test data.
1 empirical results
in this section  we evaluate our approach to motif discovery and compare it to existing methods. we compare the discovered motifs to known motifs  for the manually labeled exercise data set   and we also visually present the motifs discovered in public data sets that have been used for empirical evaluation by other researchers  the shuttle and fetal ecg data .
1 exercise data
the exercise data set was captured from an exercise regime composed of six different dumbbell exercises. an xsens mt1 inertial motion sensor was attached to the subject's wrist by fitting it into a pouch sewn to the back of a thin glove. the mt1 was sampled at 1hz and three-axis accelerometer and gyroscope readings were recorded. in total  approximately 1 minutes of data was captured over 1 sequences. for the experiment  the data was resampled at 1hz leading to 1 frames. the data contains six different exercises and 1 total repetitions  roughly 1 occurrences of each exercise . each frame is composed of the raw accelerometer and gyroscope readings leading to a six-dimensional feature vector.
　evaluation was performed by comparing the discovered motifs to the hand labeled occurrences of each exercise. both discovery methods located extra motifs in addition to the six exercises. we do not consider this to be an error  however  as the extra motifs are legitimate clusters of similar subsequences. to quantify performance  we performed analysis over events  individual occurrences  and frames  each of the 1 sensor readings . accuracy  precision  and recall were calculated in both cases considering only the six motifs that most closely correspond to the exercises. for all experiments  the dynamic time warping  dtw  distance was used with a sakoe-chiba band of 1%  which follows standard practice in the field  ratanamahatana and keogh  1 .
　figure 1 shows the result of running chiu's algorithm over a range of values for the neighborhood radius. the chart shows performance for each of the six evaluation metrics along the horizontal axis. for each metric  performance is measured for 1 different radius values ranging from 1 to 1. note that event-level accuracy  which we consider to be the most important overall summary statistic  peaks at 1% with a radius of 1  but it is very unstable as accuracy drops to 1% with a radius of 1. this instability is due to the use of a single neighborhood size across motifs when the motifs actually have different scales  see figure 1 .
　the performanceof our approach is shown in figure 1. for each of the six evaluation metrics  performance is presented across a range of estimation portion sizes. each portion size corresponds to the percentage of the smallest distances used to estimate the neighborhoodsize as explained in section 1. although the portion size does impact overall performance  the results are very stable between the relatively wide range from 1% to 1%. for all of the experiments performed in this section  the generic value of 1% was selected since it is in the center of this stable range. note that a value of 1% leads to superior results on this data set but will likely fail to generalize as well since it is closer to the boundary of the stable region.
　figure 1 shows a direct comparison of our proposed approach to chiu's algorithm on the exercise data. for chiu's algorithm  a radius of 1 was used since it was found to be the optimal choice after manually comparing a range of

figure 1: performance of chiu's algorithm on the exercise data set over a range of radii. note the instability  for example  between the radius values of 1 and 1 for event and frame-based accuracy .

figure 1: comparison of the proposed approach to chiu's algorithm for the exercise data showing superior performance of the proposed approach across all six evaluation metrics.
values. the graph shows that the proposed approach outperforms the previousmethod according to all of the metrics. for event accuracy  the proposed approach achieves 1% compared to 1%  which is a 1% reduction in error. for comparison  another discovery method  which relies on global discretization and a minimum description length criterion to find motif seeds  achieves an event accuracy of 1%  minnen et al.  1a . this approach  however  requires considerably more time to locate the motifs  and it includes a step that is quadratic in the number of motif occurrences.
1 shuttle and fetal ecg data
in order to demonstrate the generality of our approach  we tested on two public data sets commonly used in the motif discovery literature  keogh and folias  1 . in the case of the shuttle telemetry data  see figure 1   the algorithm discovers a single motif with two occurrences. for the fetal ecg data  the algorithm finds thirteen occurrences of the heartbeat  see figure 1 . in both cases  the motif neighborhood size was automatically estimated  and the results are qualitatively equivalent to those presented in the literature  see  for example   tanaka et al.  1  .
1 future work
we are currently investigating several ways of extending our approach. we are particularly interested in generalizing the motif length parameter by incorporating automatic estimation  allowing variable length occurrences within a motif  and

figure 1: performance of the proposed approach on the exercise data set showing stability over a relatively wide range of portion sizes used to estimate the neighborhood  1%-1% .

figure 1: the motif discovered in the 1d shuttle data  the first three dimensions shown . the vertical bars represent the location of the two occurrences of the discovered motif.
detecting motifs at different temporal resolutions. in addition  we are extending our algorithm for discovering motifs that only exist in a subset of the dimensions.
　our other major research focus is on learning higher-level structure from the discovered motifs. our long-term goal is to learn  from signals to scripts ; that is  we wish the discovery system to be able to take raw sensory data from an activity  discover semantically meaningful primitives  and then learn relationships between them that characterize the activity.
1 conclusion
discovering perceptual primitives from sensory data is a fundamental task for intelligent agents. towards this goal  we have presented an approach to real-valued  multivariate motif discoverythat incorporatesautomaticestimation of the size of each motif neighborhood. our approach improves on existing methods by removing a difficult-to-specify parameter and improving overall accuracy. we demonstrated the efficacy of our approach in multiple domains including activity discovery from on-body accelerometer and gyroscope data where the event-level error rate was reduced by 1% compared to a leading method.
