 
　　industry today has a severe problem in the automatic testing of analog cards. at the air force institute of technology  we are developing an expert system based on the structure and function of an analog circuit card to drive automatic test equipment. this system uses the information contained in the schematic diagram of the circuit as well as fundamental knowledge of electronics and past experience in maintaining the card. one of the most important aspects of this system is i t s ability to reason about possible faults based upon the function of the sub-sections of the circuit. this task is accomplished using the type of  second principles  which an electronic engineer would use. 
i introduction 
     testing and fault diagnosis of printed circuit cards is a very important task which is done many times each day. typically this is performed using pre-determined  static and rigidly structured tests. as a result  the testing tends to be inefficient  missing many faulted components and can often isolate faults to only a large group of components. 
     we introduce the  theory of responsibilities  as an approach to automated troubleshooting. using this approach  the understanding of how a circuit works is recorded by assigning responsibilities for parts of the output waveform to subsections of the circuit. these can be assigned manually ro derived from casual simulation. 
     our current efforts are directed at automated troubleshooting of analog circuit cards. our overall system  described in  milne 1  and  ramsey 1   is designed to automatically test and identify faults in an analog card through the use of automatic test equipment. our past implementation and papers have conducted testing based on the structural description of the circuit. in this paper  our approach to functional testing is described. 
     this work differs from others in several significant ways. the work of  cantone 1  has been entirely within the structural area. his algorithm for deciding which test to perform based on the most information gained and possible cost is very helpful to structural reasoning  but can't help us once we can no longer probe within an subcircuit. cantone only uses structural information to isolate the fault to a single functional area. in this paper  we w i l l show how structural information can be used to further propose faults.  de kleer 1  is working to diagnose faults in analog circuit cards from ' f i r s t principles'. that i s   given the low level electronic description of how a capacitor works  it should be possible to deduce how a f i l t e r would work  and consequently  diagnose faults in i t . although it is agreed that this is the most desirable approach  the author feels that there is too much work s t i l l to be done in order to use this approach in testing today. in our work  we start from 'second principles'  that i s   the type of description that an electronics engineer uses to describes various building blocks of circuits. several examples are contained below. 
    davis 1  has done much work in the area of digital troubleshooting based on the function of the components. he relies on computing the function and inverse of each sub-component. in general  it is not possible to compute the inverse of analog functions. also the digital domain has a very simple output form  1 or 1   while the analog domain may have a very rich signal. hence different techniques are called for. in fact the more complex output signal is one of the key differences between the analog and digital domains. 
   the work of  chandrasekaran 1  is most similar to our own. he describes the object to be diagnosed in a formal language and then compiles this description into a set of production rules to perform the diagnosis. in our approach  we use a 
   different formal description and four simple rules of diagnosis  rather than compiling the system into production rules. chandrasekaran's work has not defined a clear role for the interaction of functional and structural reasoning. in our work  structural reasoning plays a dual role. it is f i r s t used to isolate the possible fault to a single functional area. secondly  whenever the output is zero   giving no information   structural rules are used to propose possible faults. 
   qualitative reasoning  forbus 1  is important to justify some of our rules and approaches  but since we are working from second principles  many of these results are compiled into the descriptions. 
ii structure 
　　the traditional role of structure is to isolate the possible fault to one functional nodule. the system f i r s t checks if the output is correct. if it is not  the path of the signal is traced back through the structure of the circuit and a test is chosen which w i l l split the possible fault path in half. this is done until only one functional module is l e f t . 

1 	r. milne 
　　in our work  structure is also used when the output is zero. in this situation  we have no information on which to base the functional diagnosis  so structural reasoning must be used. in an analog c i r c u i t   we are interested in the output current and voltage drop. their relationship is controlled by ohm's law: e=ir. qualitatively  we can see that if e is zero  then i w i l l be zero; and that if i is zero  then e w i l l be zero. we can also know that if r is zero  then e and i w i l l be zero. because of the product of ir  if e is zero we w i l l need two rules  since i or r could be zero. 
     let us look at voltage. we know that we need an r in order to get a voltage drop. if an output is shorted to ground  then r is zero  and hence no output voltage. we can translate this into a diagnosis rule: 
voltage short rule: 
if one component connects the output and ground  
and the output is zero  then that component may be shorted. 
     we could derive this rule from e=ir  but it can be 'compiled' to the above form. this compilation is similar to  chandra. 1  and only needs to be done once for the fault diagnosis system. this rule is an example of the high level knowledge that an electronics engineer may use. we call this an example of a 'second principle'. 
     from krichoff's current law  we know that the current flowing into and out of a node is zero. if there is no current flowing into a node  then there can be no current flowing out of the node. as before  we can compile these facts into a 'second principle'. 
current open rule: 
if one component connects the input and output  
and the output is zero  
then that component could be open 
   we also know that with no current  we w i l l not get a voltage drop. if the output is zero  it could be from no r or no i  based upon ohm's law. because of the dependency between the current and voltage  we cannot be sure  based upon a single zero output  whether we have a short or open  so several hypotheses may be produced. 
   we w i l l use a simple voltage divider as an example of these structure rules. when the circuit is working properly  the outputs are 1 and 1. their respective values are determined by the ratio of rl and r1. if the value of 1 is wrong when 1 is correct  then the ratio r1/r1 is wrong. qualitatively  we cannot t e l l which value is wrong. 
　　if r1 is a short  then 1 w i l l equal 1 and not be zero. this can be predicted by the application of the voltage short rule.  note that ground being zero is only a special case . if rl is open  then 1 w i l l be zero by the current open rule. 1 may or may not be zero depending upon the c i r c u i t . if k1 is shorted  then 1 w i l l be zero by the voltage short rule. if r1 is open  then 1 w i l l be zero by the current open rule. 
　　in this section  we have presented our approach to the use of structure for fault diagnosis. in the traditional way  it is used to isolate a fault  to a single functional module. we also use it to propose faults based upon shorts and opens. these tv/o rules are very powerful and alone w i l l propose the correct fault for most of the examples we have encountered. 
i l l function 
the rectifier circuit: 
   when the structural rules have isolated a fault to a single functional module  we turn to functional 
reasoning. to illustrate the theory of responsibilities presented in this paper  a simple rectifierr circuit w i l l be used. in second principles  the rectifier circuit can be described as follows. to build a rectifier circuit  use a diode to convert each peak in the input waveform to a positive output peak. for a typical sine wave  this means two diodes  one for the positive  and one for the negative peak. the output is then f i l t e r e d . to do this a capacitor is used to store energy and a 
resistor to drain that energy. 
   from this description responsibilities can be assigned: each diode produces a peak in the output  one at the positive peak and one at the negative peak. the capacitor charges  giving us the rising ramp  and the resistor discharges the ranp. we can 
write this formally as: 
 circuit rectifier  varies with time t1-t1  t1-t1 output is peak at positive-nax by diodel 
t l - t 1 output is peak at negative-max by diode1 
 sub-circuit peak  varies with time t1-t1  
to-tl  output is by capacitor rising ramp t1 output is peak by diodex t l - t 1 output is falling ramp by resistor 
	tl 	is at 	input-max  
the diagnosis rules: 
if x is y by z and not y   then z is bad. 
if x is y by z and not x  then use structure rules. 
     in this brief paper  the implementation details have been l e f t out  although the prolog user w i l l recognise the role for unification. 
these are the only troubleshooting rules we need. 
to diagnose a fault  the output waveform is compared with the input waveform. the f i r s t rule w i l l then identify which component is faulted. 
　　the above description was tested on an actual c i r c u i t . when the resistor was faulted to the open position  the output was a constant level. comparing the desired output from the reai output  we are missing the declining ranp  so the resistor is bad. the dc voltage levels are important in this diagnosis  but have been omitted for this paper. 

　　when one of the diodes was opened  the output was missing one of i t s peaks. by comparing the desired output with the r e a l output and the i n p u t   the r u l e can i d e n t i f y c o r r e c t l y which diode has been opened. v/hen the capacitor is opened  the r i s i n g output is not a ramp  so the capacitor is predicted bad. if the r e s i s t o r is shorted  the output is zero  and the s t r u c t u r e r u l e s w i l l c o r r e c t l y propose the f a u l t . it should be note that we are lucky in t h i s case that each component manifests it to a s i n g l e part of the output waveform. in t h i s b r i e f paper  the voltage l e v e l s have been omitted. these are c r i t i c a l to diagnose some f a u l t s . 
iv deep functional reasoning 
　　in the above s e c t i o n s   we have assumed that we understand how to assign r e s p o n s i b i l i t i e s between the parts of the output waveform and the components of the c i r c u i t . in t h i s s e c t i o n   we w i l l see how t h i s can be derived a u t o m a t i c a l l y . 
　　the basic strategy is to simulate the working of the c i r c u i t through our 'second p r i n c i p l e s ' . as each component makes a c o n t r i b u t i o n to the o v e r a l l output  a r e s p o n s i b i l i t y is assigned. we then use the above troubleshooting technique to trace the r e s p o n s i b i l i t i e s to the f a u l t e d component. 
　　　we w i l l use the r e c t i f i e r c i r c u i t as an i l l u s t r a t i o n . we s t a r t with the f o l l o w i n g second p r i n c i p l e s : 
diode: 	if the input is p o s i t i v e   	the output equals the 	i n p u t . 
capacitor: 	a capacitor with a r i s i n g input w i l l charge 
capacitor: a charged capacitor with a l o a d   and not a r i s i n g input w i l l discharge. 
wire: when two wires meet  the output is the sum of the two i n p u t s . 
     we also assume low level rules that provide for the a d d i t i o n of signal waveforms  the t e s t i n g for r i s i n g and f a l l i n g voltage l e v e l s and give the voltage across a c a p a c i t o r . the input to the c l i p p e r is in the form of a sine wave from a transformer. when we apply the diode r u l e   the sine wave is transformed i n t o a postive half-wave followed by zero. the second diode is in reverse p o l a r i t y   so it produces a zero output followed by a half-wave. r e s p o n s i b i l i t y to each half-wave is then assigned. next  the two wires add  g i v i n g us a 
     half-wave r e c t i f i e d waveform. 
　　how the s i g n a l a r r i v e s at the capacitor and the input s i g n a l is r i s i n g . by the capacitor r u l e   the capacitor now charges. the r i s e in the output voltage is assigned the c a p a c i t o r . when the signal stops r i s i n g   the c a p a c t i t o r has a load  so discharges. this decreasing output voltage is assigned to the r e s i s t o r . 
　　in t h i s very b r i e f e x p l a n a t i o n   we have seen how the v/aveforn gets b u i l t up from second p r i n c i p l e s and the r e s p o n s i b i l i t i e s are assigned. using t h i s technique  i t i s possible t o derive the r e s p o n s i b l i t i e s from a c i r c u i t and then perform troubleshooting based upon these. 
	r. milne 	1 
v conclusion 
     in t h i s paper  the  theory of r e s p o n s i b i l i t i e s   has been o u t l i n e d . this states that we can perform f a u l t diagnosis by assigning r e s p o n s i b i l i t i e s for parts of the output to various parts of the c i r c u i t . these r e s p o n s i b i l i t i e s are derived from a casual simulation of the function of the c i r c u i t . it has also demonstrated how t h i s works on a t y p i c a l b u i l d i n g block c i r c u i t . in our work we have s t a r t e d from 'second p r i n c i p l e s '   that i s   the p r i n c i p l e s which an e l e c t r o n i c engineer would use to describes each s u b - c i r c u i t . this approach has proved to be very e f f e c t i v e in diagnosing f a u l t s in analog c i r c u i t s . 
     if one has only a l i m i t e d understanding of the c i r c u i t   then r e s p o n s i b i l i t i e s can only be assigned in a l i m i t e d way  and hence the c a p a b i l i t y to diagnose f a u l t s w i l l be l i m i t e d . if one has a thorough understanding of the c i r c u i t   can do a better job of assigning the r e s p o n s i b i l i t i e s . however  because of l i m i t a t i o n s w i t h i n the domain  it w i l l not always be possible to describe the c i r c u i t in such a way as to i s o l a t e f a u l t s to one component. this l i m i t a t i o n   however  p r i m a r i l y comes from the l i m i t s of being able to diagnose a 
     c i r c u i t as a black box. this technique has been applied to f i l t e r s   r e c t i f i e r s   voltage doublers and wave generators. because of the modularity of most c i r c u i t s   it works even on seemingly complex c i r c u i t s   by dealing w i t h the s u b - c i r c u i t s . 
　　although t h i s technique is very powerful  there is much to be done. it should be possible to derive our second p r i n c i p l e s from f i r s t p r i n c i p l e s . we have found that we can generally prove the second p r i n c i p l e s in t h i s v/ay  but we c a n ' t do it a u t o m a t i c a l l y   y e t . a more detailed d e s c r i p t i o n of t h i s work is in  milne 1 . 
