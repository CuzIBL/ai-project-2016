 
we propose a new approach for stereo matching in autonomous mobile robot applications. in this framework an accurate but slow reconstruction of the 1d scene is not needed; rather  it is more important to have a fast localization of the obstacles to avoid them. all the methods in the literature are based on a punctual correspondence  but they are inefficient in realistic contexts for the presence of uniform patterns  or some perturbations between the two images of the stereo pair. our idea is to face the stereo matching problem as a matching between homologous regions  instead of a point matching. the stereo images are represented as graphs and a graph matching is computed to find homologous regions. we present some results on a standard stereo database and also on a more realistic stereo sequence acquired from a robot moving in an indoor environment  and a performance comparison with other approaches in the literature is reported and discussed. our method is strongly robust in case of some fluctuations of the stereo pair  homogeneous and repetitive regions  and is fast. the result is a semi-dense disparity map  leaving only a few regions in the scene unmatched. 
1 introduction 
a pair of images acquired from a stereo camera contains depth information about the scene: this is the main assumption of stereo vision  based on the binocular parallax property of the human visual system. the main difficulty is to establish a correspondence between points of the two images representing the same point of the scene; this process is called disparity matching. the set of displacements between matched pixels is usually indicated as disparity map.
　all the approaches  in the literature  are based on this punctual definition of the disparity. in this paper we propose an extension of that concept  namely we define a disparity value for a whole region of the scene starting from the two homologous views of it in the stereo pair. the main reason of this extension is that a punctual approach is redundant for autonomous mobile robot  amr  applications. in fact  in amr applications  it is not very important to have a good reconstruction of the surfaces  but it is more important to identify adequately the space occupied by each object in the scene  as soon as possible to avoid collisions   even by just assigning to it a single disparity information. moreover the punctual approaches are lacking in robustness in some realistic frameworks  especially for video acquired from a mobile platform. the algorithms based on correlation  which are available in off-the-shelf systems  are unable to deal with large uniform regions or with vibration of the cameras. on the contrary  some efforts have been done in the literature to improve the robustness of the algorithms  but in despite of the running time. our method estimates the average depth of the whole region by an integral measure  and so has less problems with uniform regions than other methods have. the estimate of the position of the regions is sufficiently accurate for navigation  also in the mentioned cases  and it is fast enough for real time processing. 
　now  we report a brief description of several methods to show better the limits of punctual approaches. for more details  there is a good taxonomy of dense two-frame stereo correspondence algorithms  recently proposed by scharstein and szeliski   and a survey on stereo vision for mobile robot by zhang . there are two major types of techniques  in the literature  for disparity matching: the areabased  also known as correlation-based  and feature-based techniques. moreover  the area-based algorithms can be classified in local and global approaches.  
　the local area-based algorithms  kanade and okutomi  1; fusiello and roberto  1; veksler  1  provide a correspondence for each pixel of the stereo pair. they assume that a pixel is surrounded by a window of pixels with the same disparity  and these windows of pixels are matched. they produce a dense disparity map  excessive for amr aims. furthermore  they can be quite unreliable not only in  homogeneous regions  but also in textured regions for an inappropriately chosen window size.  
　on the other side  the global area-based approaches try to propagate disparity information from a pixel to its neighbors  marr and poggio  1; zitnick and kanade  1   or they define and minimize some energy function over the whole disparity map  geiger et al.  1; roy  1; boykov et al.  1 . they have a better performance in homogeneous regions  but they frequently have parameters which are difficult to set  and are highly time-consuming. 
　the feature-based approaches  marr and poggio  1; grimson  1; candocia and adjouadi  1  detect and match only  feature  pixels  as corner  edges  etc. . these methods produce accurate and efficient results  but compute sparse disparity maps  only in correspondence to the feature points . therefore  amr applications require more details  in fact some information about the size; also a rough shape of the objects is needed for guiding a robot in the environment or for basic recognition tasks  e.g. in industrial applications  or for platooning of robots . 
　all the proposed methods  as already said  look for a punctual matching in the stereo pair. therefore  some constraints both on the scene and on the input images have been introduced  since the first works on the stereopsis by marr and poggio  1   in order to guarantee good results and to reduce the complexity. to guarantee these constraints  the stereo pair is supposed to be acquired from a sophisticated system  so that the energy distributions of the two images are as similar as possible. moreover  a preprocessing phase is needed  before the correspondence finding step  to compensate the hardware setup  calibration phase   or to assume an horizontal epipolar line  epipolar rectification . unfortunately  in realistic applications of mobile robot these constraints are not easy to guarantee. the two images of the stereo pair could have a different lighting  the motion of the mobile platform on a rough ground should produce mechanical vibrations of the cameras  and consequently local or global perturbations between the two images  that could undermine the initial phases of calibration and rectification. we want to relax some constraints on the input images in order to consider a more realistic acquiring system  and consequently we add some constraints on our goal. 
　in this paper we propose  as said before  an extension of the disparity concept. the main idea is to determinate a unique disparity value for a whole region of the scene and not for a pixel. in fact  even if we can suppose an unique correspondence between each pixel in the left and right images from an optical point of view  as said by the uniqueness constraint   in some cases we can not have enough information to find this correspondence looking just at a single pixel. let us consider  for example  pixels inside homogeneous areas  or belonging to repetitive patterns  or pixels suffering from perspective or photometric distortions. 
we prefer to have a 1d and 1 representation of the scene  assigning a constant disparity value to a whole region and only to some significant regions. therefore  we propose a new stereo matching approach based on a region segmentation of the two images and a graph representation of these regions  to face the matching problem as a graph matching problem. the computational process is simpler and faster  because we consider only some significant regions  i.e. big areas  or some areas selected by a specific target. the result is more robust in a realistic context  because an integral measurement of the disparity for the whole region can mitigate some local and global fluctuations between the two images.  
　this paper is organized as follows: section 1 presents an overview of our approach; section 1 is devoted to the segmentation and the graph representation of the stereo pair; section 1 shows the graph matching between the left and right image and section 1 shows the disparity computation. finally  in section 1 there is a discussion of experimental results on standard stereo database and also on our stereo video sequence. conclusions are drawn in section 1. 
1 overview of our approach 
the main idea of our approach is to obtain a disparity map looking at the distance between homologous regions  instead of pixels  in the stereo images. let these regions be called blobs. in this way the computation of the disparity map is carried out on a set of pixels having the same spatial and color proprieties  producing a more robust performance with respect to local and global perturbations in the two images.  

figure 1: a scheme of our approach. 
　it should be noted that a blob is not an object; objects are decomposed into several blobs  so the overall shape of the object is however reconstructed  except for uncommon pathological cases. an example of pathological case can be a uniform object almost along the line of sight  but it has been satisfactorily dealt with only by global criteria optimization  which is extremely time consuming. 
　in our approach  see figure 1   the left and right images are segmented and each area identifies a node of a graph  see section 1 . the segmentation process is simple and very fast. in fact  we are not interested in a fine segmentation  because we do not pursue a reconstruction aim. anyway  we need similar segments between the left and right image in order to correctly find homologous regions. this objective is possible  in fact the stereo images are likely similar because they represent two different view points of the same scene. moreover  the segmentation process does not influence the rest of algorithm  because a recursive definition of the matching  see section 1  and a performance function  see section 1  guarantee a recovery of some segmentation problems.  
　a bipartite graph matching between the two graphs is computed in order to match each area of the left image with only one area of the right image. this process yields a list of reliably matched areas and a list of so-called don't care areas. by calculating a vertical displacement between the corresponding areas  a depth is found for those areas of the reference image  i.e. left image . the list of the don't care areas  instead  could be processed in order to refine our result  see section 1 . 
　as it is clear  this approach is robust even in case of uniform texture and it does not need a strong calibration process because it looks for area correspondence and not pixel correspondence. on the other hand  an effort is required in graph matching to assure real-time requirements. the application time is reduced using some constraints for a quicker computation of the bipartite graph matching  see section 1 . our method can be classified as a systemic approach  jolion  1   in fact we consider constraints coming from the scene  from the objective and from the observer. in particular  with regard to scene constraints  we assume a strong continuity constraint for each selected region  and the compatibility and the uniqueness constraints are applied on the whole region and not longer on each pixel. the horizontal epipolar line constraint is generalized in a horizontal epipolar band  see section 1   to take the nature of the mobile observer into account. moreover  the observer is supposed to move in an indoor environment and not too fast. finally  the objective is considered to be realtime and highly related to the amr applications. therefore  all these constraints are taken into account to achieve our goal. 
1 segmentation and graph representation  
the first phase of the algorithm is the segmentation of the stereo images and their graph representation. we need a very fast segmentation process that produces similarly segmented areas between the left and right images. we have used a simple multi-threshold segmentation. it is essentially based on the quantization of the histogram in some color ranges  of the same size . the left and right segmentations are very similar  considering an adaptive quantization for each image according to its lighting condition. a connected component detection procedure is applied on each segmented image to obtain 1-connected areas of the same color. each connected area  blob  is then represented as a node of an attributed graph. each node has the following attributes: 
 colmean: the rgb mean value of the blob  m r  m g  
m b ; 
 size: the number of pixels in a connected area;  coord: the coordinates of the box containing the blob 
　 top  left  bottom  right ;  blobmask: a binary mask for the pixels belonging to the blob.  
　it is easy to understand that a segmentation yielding many segments can be more accurate but creates lots of nodes  consequently requiring a more expensive graph matching process. on the other hand  a rougher segmentation process generates matching nodes that are very dissimilar in size and shape. as a compromise  we consider a segmentation process tuned to over-segment the image  and subsequently we filter the image in order to discard small noisy areas. 
1 graph matching 
formally our matching algorithm can be described in the following way. a number of nodes is identified in each frame  left and right image  and a progressive label is associated to each node  blob . let gl = {n1l ... nnl} and gr = {n1r ... nmr} be the two graphs representing the left and right image respectively. the solution of the spatial matching problem  between two stereo frames  is an injective mapping between a subset of gl and a subset of gr. the problem at hand can be represented by using a matrix whose rows and columns are respectively used to represent the nodes of the set gl  and the nodes of the set gr  correspondence matrix . the element  i j  of the matrix is 1 if we have a matching between the element nil with the element njr  it is 1 otherwise. each row contains no more than one value set to 1. if the j-th row or the i-th column contains only zeros  it means that it is a don't care node. the bijective mapping : gl  gr solves a suitable weighted bipartite graph matching  wbgm  problem. a bipartite graph  bg   baier and lucchesi  1  is a graph where nodes can be divided into two sets such that no edge connects nodes in the same set. in our problem  the first set is gl  while the second set is gr. before the correspondence is determined  each node of the set gl is connected with each node of the set gr  thus obtaining a complete bg. in general  an assignment between two sets gl and gr is any subset of gl  gr  i.e.  any set of ordered pairs whose first elements belongs to gl and whose second elements belongs to gr  with the constraint that each node may appear at most once in the set. a maximal assignment  i.e. an assignment containing a maximal number of ordered pairs is known as a matching  bgm   kuhn  1 . 
　a cost function is then introduced  so that each edge  nil  njr  of the complete bipartite graph is assigned a cost. this cost takes into account how similar are the two nodes nil and njr. the lower is the cost  the more suitable is that edge. if the cost of an edge is higher than a threshold  thrmatch   the edge is considered unprofitable and is removed from the graph  its cost is considered to be  . let us now introduce the cost function: 

where width and height are the dimensions of the frame. the matching with the lowest cost among the ones with maximal cardinality is selected as the best solution. the problem of computing a matching having minimum cost is called weighted bgm  wbgm . this operation is generally timeconsuming; for this reason the search area  that is the subset of possible couples of nodes  is bounded by the epipolar and disparity bands  see figure 1 .  
l 
　figure 1: epipolar and disparity bands: some constraints to optimize the wbgm. 
 
　these constraints come from stereo vision geometry  but in our case they represent a generalization. the epipolar band is a generalization for epipolar line  that is the maximum horizontal displacement of two corresponding nodes  generally its value can be a few pixel . disparity band  instead  is a vertical displacement  so a node of the right image can move on the left almost of *maxdisparity pixels  with  a small integer . these two displacements are computed with respect to the centers of the bounding box  of the two blobs. 
　the graph matching process yields a list of reliably matched areas and a list of so-called don't care areas. the matched areas are considered in the following section for the disparity computation. the list of the don't care areas  instead  is processed in order to group adjacent blobs in the left and right image and consequently reduce split and merge artifacts of the segmentation process. finally  a new matching of these nodes is found. the recursive definition of this phase assures a reduction of the don't care areas in few steps  but sometimes this process is not needed because don't care areas are very small. 
1 disparity computation 
　the disparity computation is faced superimposing the corresponding nodes until the maximum covering occurs. the overlapping is obtained moving the bounding box of the smallest region into the bounding box of the largest one; precisely  the bounding box with the minimum width is moved horizontally into the other box  and the bounding box with the minimum height is moved vertically into the other box. the horizontal displacement  corresponding to the best fitting of the matched nodes  is the disparity value for the node in the reference image  left image .  
 
 
　figure 1: some examples of matched regions. in grey color the region from the right image and in white color the region from the left image. 
		 
　figure 1: the overlapping process minimizes the mismatching between the two matched regions. 
 
　a lot of objects have some appendices  see figure 1  depending on the different segmentation between left and right image. however  this process finds the correct value for the disparity  minimizing the mismatching between the two matched regions. moreover  we propose a performance measurement for the disparity computation in order to consider also some cases with larger errors coming from both segmentation and matching process. 
max fitting
performance  
max sizel sizer 
 it is the percentage value of the best fitting area size  maxfitting  with respect to the maximum size of the two matched regions  sizel and sizer . 
		 
　figure 1: on the left side our disparity map; on the right side a graphical representation of the performance function  a brighter region has the upper value of performance . 
 
　the result of our algorithm can be represented in a graph  the so-called disparity graph  and  as it is clear from the figure 1  the nodes of this graph can have a don't care attribute or  alternatively  the couple of disparity and performance attributes. therefore  we could select a minimum performance value  and label the regions below this value as don't care. all these don't care areas could be processed again in the wbgm  as say in the section 1  if we should need to refine the result. anyway  in our experimental results  we use a simple post-filtering in order to reduce don't care regions. each 1-connected don't care area is labeled choosing the most frequent among the disparities of the adjacent regions. this assumption comes from the continuity constraint  but it is clear that it is applicable only inside a region and not between two different regions  so it is checked that most of the adjacent regions have the same disparity value. an example of the post-filtering use is shown in the figure 1. 

　figure 1: on the left side the original disparity map; on the right side the result after applying the post-filtering. 
1 experimental results 
in the literature  tests are usually performed with standard databases composed of static images  well-calibrated and acquired in uniform lighting. the web site of scharstein and szeliski  middlebury web site  is a good reference for some stereo images and to compare some stereovision algorithms. in this section we want to show our qualitative results and discuss some errors of the best algorithms in the literature  when applied to real cases. nowadays  in amr applications it is not defined a quantitative measurement for performance evaluation. on middlebury web site it is proposed a quantitative performance evaluation for disparity map but in case of reconstruction aims. the following figure presents a stereo pair from the tsukuba data set.  
 
　figure 1: the reference image  on the left  and the ground truth  on the right   from tsukuba data set. 
 
　the second image in figure 1 represents the ground truth of the disparity map. an object has a higher grey level  corresponding to a high disparity between the two images  the closer it is to the camera  i.e. the lamp is in front of the statue that it in front of the table  etc.  
　the following figure 1 shows our result on the tsukuba db and a comparison with other approaches. we have selected the best methods in the literature: squared differences  ssd   dynamic programming  dp  and graph cuts  gc   scharstein and szeliski  1 . the first is a local area-based algorithm  the other two ones are global area-based algorithm. the experiments have been performed on a notebook intel p1.1 ghz  1 mb ram  and we have considered a resolution of 1 pixel. 

	ssd: time   1 sec  	dp: time 1 sec         

   graph cut: time 1 sec our: time 1 sec figure 1: a comparison with other approaches. 

	ssd: time   1 sec	our: time 1 sec 
 
figure 1: ssd and our approach after a vertical translation of 1 pixels. 
　in figure 1 it is clear the robustness of our approach in relation to the loss of the horizontal epipolar constraint. 

	    ssd: time   1 sec           	 	dp: time 1 sec 

	graph cut: time 1 sec 	our: time 1 sec
figure 1: results on our stereo pair: it is characterized by only one homogeneous object. 
the presence of texture-less regions  very frequent in real contexts  causes serious problems to the best algorithms of the literature.  
1 conclusions 
we have presented a stereo matching algorithm that is especially oriented towards amr applications  providing a fast and robust detection of object positions instead of a detailed but slow reconstruction of the 1d scene. the algorithm has been experimentally validated showing an encouraging performance when compared to the most commonly used matching algorithms  especially on realworld images. furthermore  we are working on a further improvement of the performance by defining an hybrid approach  i.e. we can apply our algorithm only to the large homogenous regions  and use traditional dense stereo matching for the rest. 
