
in this paper we introduce a new dynamic bayesian network that separates the speakers and their speaking turns in a multi-person conversation. we protect the speakers' privacy by using only features from which intelligible speech cannot be reconstructed. the model we present combines data from multiple audio streams  segments the streams into speech and silence  separates the different speakers  and detects when other nearby individuals who are not wearing microphones are speaking. no pre-trained speaker specific models are used  so the system can be easily applied in new and different environments. we show promising results in two very different datasets that vary in background noise  microphone placement and quality  and conversational dynamics.
1 introduction
automatically modeling people's spontaneous  face-to-face conversations is a problem of increasing interest to many different research areas. yet there is very little data available that captures truly spontaneous speech-speech recorded in situ as people go about their lives. portable devices capable of such recording have grown in storage capacity while becoming smaller  cheaper  and more powerful. but obstacles to gathering spontaneous speech still remain  and perhaps no other obstacle is as prominent as privacy.
　collecting truly spontaneous speech requires recording people in unconstrained and unpredictable situations  both public and private. there is little control over who or what may be recorded. uninvolved parties could be recorded without their consent-a scenario that  if raw audio is involved  is always unethical and often illegal. recording spontaneous data in real-world situations will require protecting the privacy of those involved by not always storing complete audio. more specifically  any data that is saved must not allow the linguistic content of a person's speech to be reconstructed.
　while that limits the analyses that can be done on the data  it does not render the data useless. a broad range of inferences can be made from privacy-sensitive features. there are many applications that would benefit from increased access to spontaneous speech data while not needing to know the content of the speech.
　for example  research in speech and emotion often uses only information about pitch  volume  or duration  schuller et al.  1 . but the data used in such research has been either acted speech  campbell  1  or datasets gathered in constrained situations  greasley et al.  1; douglascowie et al.  1; ang  1 . acted speech is known to poorly reflect natural emotion  batliner et al.  1 ; and the constrained datasets are recorded in relatively unnatural settings  television shows  interviews  that are not representative of ordinary human communication. there is a demand for more natural data sets for the study of speech and emotion  douglas-cowie et al.  1a .
　a second example is the study of social networks. traditional social network analysis has relied on data gathered either through surveys  which are vulnerable to known biases  bernard et al.  1; marsden  1   or third party observers  which is costly  labor intensive  and does not scale. recent studies have used automatically gathered data about on-line interactions  mccallum et al.  1; kossinet and watts  1   but there are few studies involving automatically recorded face-to-face conversations-despite the fact that face-to-face communication remains people's dominant mode of interaction  baym et al.  1 . to study social networks  it is sufficient to know only who spoke with whom  not what was said.
　finally  non-linguistic aspects of spoken communication are also useful features in medical and meeting understanding applications. speaking rate is an indicator of mental activity  hurlburt et al.  1  and a behavioral symptom of mania  young et al.  1 . abnormal conversation dynamics are symptoms of asperger syndrome  wing and gould  1  and autistic individuals often speak in a high-pitched voice or lack intonation  tager-flusberg  1 . in meetings  interruptions and speaking time can reveal information about status and dominance  hawkins  1  and gender specific differences in interruptions and the consequences of those differences are active topics of research  tannen  1 . none of these features require access to linguistic content  and all of these applications would benefit from increased access to natural speech data.
1 problem description
our specific long-term goal is to model the evolution of spontaneous face-to-face interactions within groups of individuals over extended periods of time. in order to protect the privacy of both research subjects and the non-subjects with whom they come into contact  we must ensure that the acoustic information that is saved cannot be used to reconstruct intelligible speech. the stored features must contain enough information to serve as input to models of conversational and social dynamics  but at the same time have insufficient information to reconstruct what is being said  or to positively identify individuals who are not wearing microphones.
　the work presented in this paper is the first step toward our goal. we present an unsupervised approach to separating speakers and their turns in a multi-person conversation  relying only on acoustic features that do not compromise privacy. the features employed are useful for modeling conversational dynamics-who is speaking and how-but are not sufficient for speech recognition.
　our work is novel in several ways. the key contribution is a joint probabilistic model that combines streams of acoustic features from a set of individuals wearing microphones  infers when there is speech present  separates the different speakers from each other  and also detects when other individuals around them-who are not equipped with microphones- are speaking. it does not require pre-trained speaker specific models  and thus scales to any number of users and can be used with new speakers and in new environments. our model can be extended to a dynamically varying number of speakers  where new audio streams come and go whenever a new person enters or exits a group. we also introduce a novel feature set that is useful for segmenting speakers and for modeling conversation attributes  but that cannot be used to transcribe the actual words spoken during a conversation.
1 related work
most of the work in modeling spoken conversations has been done in the domain of meeting understanding  nist  1; dielmann and renals  1 . one of the goals in meeting understanding is speaker diarization: determining who spoke when  reynolds and torres-carrasquillo  1 . all of the work that we have found in this domain assumes access to the full audio and that it is not necessary to remove information that can be used to transcribe speech.
　much previous work has been done in linguistic conversation analysis  ochs et al.  1; sacks  1 . clearly  that work relies almost solely on information about the words that are spoken  and not the basic acoustics of speech. as such  the model presented in this paper is complementary to traditional conversation analysis. however  inasmuch as conversations are considered turn taking between speakers  our

figure 1: the source-filter model for speech production.
model's ability to infer speaker turns can be seen as a necessary low-level enabler for higher level conversation understanding.
　finally  as previously mentioned  there has been much research into recognizing emotions associated with speech  douglas-cowie et al.  1b . many of these emotionrecognition applications may not need to know the words that are spoken.  shriberg  1  mentions the importance of modeling natural speaking behavior and identifies it as a fundamental challenge for spoken language applications.
1 speech features and privacy
we begin by giving a very simple description of speech production based on the source-filter model  quatieri  1   see figure 1 . most speech sounds can be modeled with two independent components:  i  the source sound generated in the glottis and  ii  the filter  the vocal tract  that shapes the spectrum of the source sound. the source can be either voiced with fundamental frequency f1  the pitch  or unvoiced with no fundamental frequency. prosodic information about speech  intonation  stress  and duration  is described by how the fundamental frequency and energy  volume  change during speech. the frequency response of the vocal tract- particularly the resonant peaks  the formants -contains information about the actual phonemes that are the basis for words. to reproduce speech intelligibly  information on at least three formants is required  donovan  1 . any processing of the audio that removes information about the formants will ensure that intelligible speech can not be synthesized from the information that remains  and privacy will be preserved.
　to detect speech  and specifically  voiced speech  and model how something is being said  we extract features that contain information about the source and prosody but not about the formants. three features that have been shown to be useful for robustly detecting voiced speech under varying noise conditions are:  i  non-initial maximum autocorrelation peak   ii  the total number of autocorrelation peaks and  iii  relative spectral entropy  basu  1  computed on 1 ms chunks of audio. because of the periodic components of voiced speech  see figure 1   the autocorrelation will have a small number of sharp peaks. similarly  the relative spectral entropy between the spectrum at time t and the local mean spectrum  1 ms window  will be high for voiced speech even in the presence of indoor and outdoor noise  e.g. wind  fan .
　beyond detecting the spoken regions  the system needs additional information to separate the different participants in

figure 1: dbn model for multi-person conversation
the conversation. we found two features to be useful for this purpose:  i  the absolute energy  and  ii  the entropy of the energy distribution across the different microphones  described in more detail in section 1 .
　summarizing  the complete list of acoustic features that must be saved for our model are:  i  non-initial maximum autocorrelation peak   ii  the total number of autocorrelation peaks   iii  relative spectral entropy  and  iv  energy.
1 multi-person conversation model
let us assume there are n individuals wearing microphones. given acoustic features from these n microphones  we want to detect when one of the wearers is speaking as well as when the microphones are picking up speech from others in the area not wearing microphones. a dynamic bayesian network  dbn   dean and kanazawa  1  is a flexible way to combine all of the features into a unified model used to infer who is speaking when. the state factorization of dbns makes it relatively simple to express complex dependencies between different variables in the system. figure 1 depicts our dbn model for inferring both spoken segments as well as identifying the speaker of those segments  n = 1 in this example . the shaded nodes are the observed variables whose values are inputs to the system and the hidden nodes are the variables whose values are to be inferred.
　each time step in the dbn corresponds to a small chunk  or frame  of audio data. in all of our experiments we used frames with a length of 1 ms 1 ms of overlap with the previous frame.
　below we describe how the different variables are specified and the dependencies between them.
group state gt
the group node gt determines who is holding the floor or taking a turn to speak. it is a discrete random variable with cardinality n +1: one state for no speaker  silent regions   one state for each of the n people wearing microphones  and one state for any other speakers not wearing microphones.
probability p
the group statesitions between speakers. at time gtg|gtt depends on1  encodes the probability of turn tran-gt t= 1  and the conditionalall states are equally
likely: p g1  = 1/ n + 1 . the group node allows us to constrain the individual states described below  and reduces the complexity of the conditional probability table  cpt  we would otherwise have to model to capture dependencies between speakers.
state of the individuals wearing microphones mit
the binary random variable mti indicates whether the i-th individual wearing a microphone is speaking. the conditional probability p mti|gt  is set to be semi-deterministic:
p mti = 1|gt = g  「 1 when g = i  and 「 1 otherwise.
this imposes the constraint that-most of the time-people do not talk simultaneously during a conversation. note that it is still possible  though highly unlikely  for multiple mti variables to be true while gt is held to a single speaker.
state of unmiked others ut
similar to mti  the unmiked other node ut is a binary random variable that indicates whether anyone not wearing a microphone is speaking. if there are multiple unmiked persons present  they are all modeled by this node. ut is conditioned on the group node gt and the aggregate voicing node avt which indicates whether any microphone detected voiced speech  and is described in more detail below . the conditional probability p ut|gt avt = 1  is defined identically to p mti|gt   and p ut = 1|gt avt = 1  「 1.
voicing states vti and aggregate voicing avt
the voicing states vti are binary variables that indicate whether microphone i has recorded sound consistent with voiced human speech. the parents of vti are mti and the previous. since each microphone can pick up speech from its wearer as well as other speakers nearby  the conditional probabilities of the vti nodes are defined as p vti = 1|mti = 1  「 1 and p vti = 1|mti = 1  = 1. in other words  if person i is speaking it is highly likely her microphone will record voiced speech  and if she is not speaking there is a uniform probability that her microphone will record voiced speech.
　the node avt is an aggregate voicing node that is the deterministic logical or of all the vti nodes. we describe below how avt helps distinguish other individuals speaking from silent regions.
observations oit  ei jt   and het
the observed variables obtained from the acoustic features of the n microphones are included at various points in the dbn as children of mti  ut  and vti.
　oti is a three-dimensional variable that includes the three features previously mentioned as having been useful for detecting voiced speech  non-initial maximum autocorrelation peak  number of autocorrelation peaks  and relative spectral entropy . p oti = o|vti = v  is modeled by a 1d gaussian with full covariance matrix. the p oti|vti  parameters are learned from a set of labeled data  where vti is given  containing speakers who are not present in any of the data we evaluated here. learning these features in this manner has been shown to be speaker-independent and robust across different environmental conditions  choudhury and basu  1 .
　eti j is a two-dimensional variable containing the log energies of microphones i and j averaged over a 1 ms window centered at time t. the conditional distribution

figure 1: pairwise log energies.
speaker aspeaker bspeaker aunmiked speaker1
	1 1
 1
	1 	1 	1 	1 	1 	1 
time  seconds 
figure 1: log entropy of energy distribution across microphones.
p eti j|mti mtj  is modeled with a full covariance 1d gaussian. this pairwise energy feature associates voiced regions with their speaker. if person i speaks at time t  then her energy should be higher than j's  and vice versa . when both i and j speak  both of their microphones have high energy and when neither speaks both of their microphones have low energy. figure 1 illustrates an example of this.
　hte is the entropy of the log-energy distribution across all n microphones. this feature is useful for determining whether voiced regions come from a speaker not wearing a microphone. when a person wearing a microphone speaks  his microphone will be significantly louder than the others' and the entropy will be low. when a person not wearing a microphone speaks  her energy will be spread more uniformly across all microphones and the entropy will be high. figure 1 illustrates an example of this.
　hte is computed as follows. first  all microphones' energies are normalized to a distribution: .
then hτ is computed as the entropy of pe τ . finally  hte is the average of hτ over a 1 ms window centered at time t. we use the log of hte and model that with a 1d gaussian random variable conditioned on ut.
　although hte is a useful feature for distinguishing whether speech comes from a person wearing a microphone or from one who is not  it does not help distinguish between when an unmiked person is speaking and when no one is speaking. entropy is high in both of those cases. however  information about the voicing states vti taken together with the entropy can distinguish those situations. if there is voicing and the entropy is high then it is likely that someone else  i.e. someone not wearing a microphone  is speaking. it is here that the aggregate voicing node avt is useful. we define p ut|gt = u avt = 1  「 1  where u is the state of node gt that indicates an unmiked person is speaking   and or if avt = 1. loosely  this
means that the model will only infer an unmiked speaker if at least one microphone picked up voiced speech and that speech cannot be assigned to any of the miked speakers.
1 parameter learning and inference
learning is done in an entirely unsupervised manner using expectation maximization  em . unsupervised learning is important for this application  given the privacy constraints associated with recording spontaneous speech. raw audio will not be available for labeling speaker-specific data  so the model must be able to fit itself to unlabeled data.
　however  with a large number of parameters  em can often converge to values that do not result in accurate inferences. to prevent this  we clamp most of the above parameters to their pre-defined or pre-trained values. indeed  only the gaussians associated with the energy-based observations  p eti j|mi mj  and p hte|ut   are learned during em.  as mentioned  the gaussians associated with the voicing observations are pre-trained in a speaker-independent way.  all of the transition probabilities and semi-deterministic conditional probabilities are fixed at predefined values. we did experiment with leaving more parameters free and the resulting inferences were much less accurate.
　once the free parameters are learned with em  exact inference is done using the junction tree algorithm. during decoding  we infer the most likely state sequence for the group node g  speaker nodes mti and ut  and voicing nodes vti. we use the graphical models toolkit  gmtk  for all of our learning and inference  bilmes and zweig  1 .
1 experiments and results
experimental evaluations were performed on two datasets:  i  the publicly available scripted meeting corpus  m1  from idiap  mccowan et al.  1  and  ii  a labeled dataset of natural interactions that we collected. the m1 corpus contains 1 four person meetings  each of them about five minutes long. the dataset has audio recordings from 1 microphones-one 1 microphone array and 1 lapel microphones. the speakers in each recording followed a script for certain meeting-wide activities  e.g.  discussion  argument  monologue  but were not told what to say. in our experiments  we used data only from the lapel microphones as it most closely resembles our data collection setup. overall  this dataset is quite clean and does not have much background noise. we evaluated the performance of our model on 1 randomly selected meetings from this corpus.
　the dataset we collected is much more challenging. it has a significant amount of background noise and distant speech. there are 1 conversations collected in 1 different locations: a meeting room  an elevator  a hallway  and a loud and noisy atrium. the speakers were told where to go but not what to talk about. they are all friends and had no trouble filling

figure 1: two people wearing our portable recording equipment. the sensing unit is at their right shoulders.
the time with spontaneous conversation. for recording  we used an inexpensive condenser microphone  which is part of a multi-modal sensing unit  dimensions: 1 mm x 1 mm x 1 mm   welbourne et al.  1 . the sensing unit is clipped to the strap of a small over the shoulder bag. the unit sits near the upper right shoulder  but can move so the microphone is not always at a fixed location from the mouth. a pda in the bag records the audio data. figure 1 shows two people wearing the equipment. unlike the m1 data  where all lapel microphones are tethered to the same recording computer  each person in our data carries with her all the equipment needed for recording. thus  our participants can move about independently and interact in a more natural manner.
　to evaluate the speaker segmentation performance  we learned the unclamped parameters of the model in an unsupervised manner for each meeting independently. once the learning was done  we inferred the most likely state sequence for the group state node gt and speaker nodes mti and ut.
　we compute four evaluation metrics that compare the inferred value of gt to ground truth.  i  the per frame error rate is the fraction of frames in which the value of gt does not match the ground truth speaker. we do not consider frames that have more than one ground truth speaker.  ii  the diarization error rate  der  is a standard metric used by nist  nist  1  to measure the performance of speaker segmentation systems. it is a relaxed version of frame error rate that merges pauses shorter than 1 s long and ignores 1 s of data around a change in speaker. these relaxations account for perceptual difficulties in labeling speech at such a fine time granularity.  iii  precision is the fraction of the total number of inferred speaker frames that are correct.  iv  recall is the fraction of truly spoken frames for which any speaker is inferred  in other words  the accuracy of basic speech-detection .
　the results for the m1 corpus are in table 1 and the results for our dataset are in tables 1 a  and 1 b . in both datasets  all participants wear microphones. to test the performance of our model with unmiked speakers  we selectively ignored the data from some participants' microphones. results shown for
micsframe err.derprec.recall1.1.1.1.111111.1.1.1.1table 1: results for the m1 corpus. all meetings had 1 participants.
speakersmicsframe err.derprec.recall111111.1.1.1.11.1.1.1.11.1.1.1.11.1.1.1.11.1.1.1.1 a  quiet environments.
speakersmicsframe err.derprec.recall111111.1.1.1.11.1.1.1.11.1.1.1.11.1.1.1.11.1.1.1.1 b  noisy environments
table 1: results on our data.
cases with fewer microphones than speakers are the averages of results for all permutations of that number of microphones across that number of speakers.
　the first thing to note is that the der scores on the m1 data are comparable with current speaker diarization results. 1 is currently the best der  achieved with features that do not preserve privacy  for meeting data  nist  1 .  unfortunately the dataset used in that evaluation is not generally available  so we cannot compare our results directly.  to the best of our knowledge  there is only one other published diarization result for the m1 corpus  ajmera et al.  1 . that technique has better frame error rates  1%  but lower precision and recall  their reported average of the two is 1  our average of the two is 1 -thus making for an inconclusive comparison. that technique also used features  low order cepstral coefficients  that contain information about the words spoken  so it does not protect privacy.
　our error rates are significantly better on the m1 dataset than on the dataset we collected. our dataset  however  has substantially more difficult characteristics than m1. our data includes significantly more background noise  and the conversations are more fluent and fast paced with much more speaker overlap. for example  the m1 data's mean turn duration is 1 s  median: 1 s . for our dataset the mean turn duration is 1 s  median: 1 s . clearly  more work remains to be done in handling noisy environments and conversations with faster  or even variable  pacing  but the results are still quite promising.

figure 1: model history
1 discussion
our goal of separating the different speakers in conversations and identifying when they speak while not preserving information from which intelligible speech can be reconstructed led us to explore many different variations of the model proposed in this paper. having the correct graphical structure and acoustic features is critical in solving this problem.
　a number of variations were attempted along the way. this is depicted in the development history plot shown in figure 1. we started by using only pairwise relative energy ratios along with the voicing features for our observations  a . this performed quite poorly  failing in cases where no one was speaking and small absolute changes in energy caused large changes in their ratios. in  b   we modeled the full distribution of pairwise energies which significantly improved our error rates. next  we experimented with the effect of making the individual speaker variables mti deterministically dependent on gt which worsened things  c  and lead to the semideterministic cpt we ultimately used. in  d  and  e  we tried adding various energy statistics as children of ut to determine when unmiked persons were speaking. for  d  we added the maximum microphone energy  and in  e  we added the mean and variance of all the energies  but these models were not appreciably better. removing these energy observations and using an aggregate voicing indicator avt alone in model  f   did help- f  is 1% lower than  b . model  g  was an attempt to add back the mean and variance of energy  but those features  even after normalization  continued to hurt performance. this suggests that those features are not sufficiently discriminative which causes em to converge to unhelpful parameter values. lastly  model  h  uses the smoothed log entropy of the energy distribution  as described earlier in section 1.
1 future work
there are many ways that our model could be extended. currently  it requires at least two microphones  and we are exploring ways to allow it to work with only one microphone. and while the model is theoretically capable of inferring overlapping speakers  the semi-deterministic conditional probabilities from the gt node prevent it from reliably doing so. we are exploring ways of adding a switching node  bilmes  1  to explicitly represent changes in speaker turns as well as interruptions and interjections. additionally  we have not experimented with very many different values of the pre-defined parameters. it may be possible to learn some of these from other data  as we do with the voicing parameters  or to allow em to learn them within given bounds. learning better turn transition probabilities will probably help our results the most  since turn lengths seem to vary with conversation type. we also plan to apply this model to the analysis of a much larger data set. we have recently collected over 1 hours of data from 1 subjects over the course of 1 months. the subjects wore our data collection equipment and all feature extraction was done in real-time on the pda.  the data also contains features beyond those listed in this paper  but none from which intelligible speech can be reconstructed.  we hope to use our model  along with other techniques  to study the evolution of the subjects' conversational styles and social network. to the best of our knowledge  this is the most detailed study of face-to-face social interactions ever done using automatically gathered data. we would not have been able to collect this data without the privacy guarantees provided by our feature set.
1 conclusion
we have presented a dbn and privacy-sensitive feature set that are capable of inferring who was speaking when in a conversation. the feature set does not include any information that could be used to reconstruct intelligible speech. in clean data  its performance is comparable to that of systems that use much richer features from which the original speech can be reconstructed. even though other features useful for speech synthesis and recognition could have been used  we believe there is a huge advantage to protecting privacy. in the long run  this will allow us to collect and model more interesting and spontaneous conversations and extend this work to capture richer conversation dynamics and handle varying numbers of speakers and overlaps.
acknowledgements
this work was supported by national science foundation grant iis-1.
