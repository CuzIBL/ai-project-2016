 
　　　　the recovery of straight picture edges from digitisations of scenes containing polyhedra  'line finding'  is central to the functioning of scene analysis programs. while recognising that recovery properly involves a computational mobilisation of a great deal of knowledge-supported context  there remain some  basic issues of representation which govern the way in which the primary data - grey levels - are addressed. the paper describes a parametric representation of straight picture edges and its procedural deployment in the recovery of edges from digitisations of scenes whose contents arc essentially polyhedra with 
strong visible shadows. 
1. 	scene analysis 
       contemporary thinking in scene analysis is focussed primarily upon efforts to deploy 
higher level knowledge  e.g. of support  lighting and scene composition1 to achieve an 'integrated' interpretation of pictures in the form of grey scale data from tv cameras or comparable picture digitisers. the need to involve such knowledge has  become progressively more apparent as line and region finders1 1 have demonstrated that a pass-oriented approach to the recovery of edges and surfaces is only partially successful. 
　　　　our own studies are focussed primarily upon this same endeavour: a crucial feature of our research is the formulation of a task in which there is a rich  but hopefully tractable range of knowledge which could  be 
mobilised in such an integrated analysis. the task had its origins in part in the dictum we attribute to guzman1 'if you 
recognize a foot you know where  in the picture  to look for a leg  ' the scenes we are working on are polyhedral in content but polyhedra constrained to form a puppet figure  fig.l  in so doing we hope to bring to bear just that sense of context which guzman evokes  in order to assist the processing of some picture or scene fragment. contemporary programs e.g. falk♀ do just this but within the restriction that context can only be mobilised to help in identifying the elements of a single body  of which falk has 1 distinct models  except for the contextual inferences provided by the requirement that bodies be simply supported. winston's account1 of finin's work goes beyond falk in precisely the direction we have adumbrated although it is unclear what range of architectures is being contemplated 
beyond the 'arch' he describee. 
notwithstanding these attempts to 
reformulate approaches to scene analysis as integrated or ' heterarchical'  as epposed to   hierarchical' pass-oriented schemes  there remains a clear requirement for procedures 
which are capable - with or without context of recovering three-dimensionally significant entities in the primary picture data. one recent attempt to mobilise context to assist a line finder is described by shirai1 . after an initial 'pass' to recover an outer contour of the group  or groups  of objects visible in the scene  the line finder is d'reefed to significant locations e.g. concavities  in this contour as the origin of a search for further edges. heuristics of various sorts e.g. 'jock for an edge parallel to one already found' are used to further constrain the direction of the search. the search itself proceeds from the immed iate vicinity of that location. inspection of typical scenes suggests that at many such locations on an edge  the evidence may be meagre although elsewhere along its length the evidence is much stronger. thus a search 
initiated by a program such as shirai's may 
i'ail because it has a very myopic way of addressing the picture space to find edges. this paper is concerned primarily with a study of an alternative to this locai search strategy  by exploiting the collinearity of the feature points making up a straight 
picture edge as an addressing mechanism. 
　　　　the exploitation of this property to find straight lines is not in itself original. both duda and hart* and griffith1  describe a parameter!sation of feature-point data which is of assistance in recovering straight lines. indeed our own work derives directly from that of duda and hart. these earlier workers 
however leave many problems unresolved  e.g. duda and hart p.1 col. 1  not least of which is the nature of the methods by which the 
parameterised data is to be concatenated into 1ines. the study which we have carried out provides a fresh perspective from which to view the 'myopia' of line finders and gives at the same time a more detailed picture of the difficultjes that remain. 
1. the line finding process 
1. the data. 
　　　　the data with which we have worked derive from positive photographs of scenes lit by a single light source. our primary concern is with scenes involving the puppet figure 
which is painted a uniform matt grey  althougi we have done some work on matt white polyhedral blocks. the photograph is digitised by a flying spot scanner* with a linear 
1 +we are grateful to dr. j.r.parks of the national physical  laboratory for making this scanner available to us. 
response t o r e f l e c t e d l i g h t quantised i n t o 1+ grey l e v e l s . in p r a c t i c e the range is at out 1 grey l e v e l s . i n s p e c t i o n of the d i g i t i s a t i o n s reveals t h a t over p e r c e p t u a l l y u n i f o r m regions of the p i c t u r e the v a r i a t i o n in grey l e v e l between adjacent p i c t u r e p o i n t s   ' n o i s e '   increases approximately l i n e a r l y w i t h average grey l e v e l to an e x t e n t  about 1+ u n i t s peak-peak at a grey l e v e l of 1  which becomes a nuisance in computing the b r i g h t ness d i f f e r e n t i a l w i t h i n the b r i g h t areas of the p i c t u r e . we have not attempted to 
i d e n t i f y the source of t h i s ' n o i s e ' nor the extent t o which i t o r i g i n a t e s i n the p h o t o m u l t i p l i e r system or in the photographic process. 
1 . 1 . mappingthe data i n t o r . a space. 
       as i n d i c a t e d in s e c t i o n i we wish to use the ' g l o b a l ' c o l l i n e a r i t y o f f e a t u r e p o i n t s as a major f a c t o r in r e c o v e r i n g s t r a i g h t p i c t u r e edges r a t h e r than t h e i r c o n t i g u i t y . f o l l o w i n g duda and hart1 we capture t h i s p r o p e r t y by using a v a r i a n t of the s o - c a l l e d hough t r a n s f o r m a t i o n . a s t r a i g h t p i c t u r e 
       edge is t r e a t e d as l i n e in the p i c t u r e plane  parameterized  by a the o r i e n t a t i o n of  and r the l e n g t h of the normal from the o r i g i n to the l i n e . the equation of the l i n e is then 
		1 
a l i n e is thus completely s p e c i f i e d  except f o r i t s extent - an important c o n s i d e r a t i o n in the present task  by a   r   a   p a i r . a 
p o i n t   x   y   in the p i c t u r e plane may be thought of as the common p o i n t of i n t e r s e c t ion of a f a m i l y of l i n e s   each member of t h i s f a m i l y having an o r i e n t a t i o n a in the range  1＜  and a value of r determined by   1   . 
a p o i n t t h e r e f o r e corresponds to a f a m i l y of   r   a   p a i r s . a set of c o l l i n e a r p o i n t s in the two-dimensional space of the p i c t u r e has a set of l i n e f a m i l i e s wjth. a. common   r   a   . member. the basic p r i n c i p l e of the technique described by duda and hart1 and r e l a t e d methods such as the so-calledhough t r a n s f o r m a t i o n is to accumulate evidence f o r such common members by mapping p i c t u r e p o i n t s i n t o   r   a   space. 
       the p i c t u r e edges of i n t e r e s t are associated w i t h l o c a l changes i n p i c t u r e b r i g h t n e s s   f e a t u r e p o i n t s   and thus the p o i n t s which form these edges are   x   y   l o c a t i o n s in the p i c t u r e where t h e g r a d i e n t g o f the p i c t u r e b r i g h t n e s s s i g n i f i c a n t l y exceeds the values of g associated w i t h l o c a t i o n s in uniform areas of the p i c t u r e . we can compute g at the l o c a t i o n  m n  by o b t a i n i n g a measure of the gradient in the x and y d i r e c t i o n s   d x   d y     as estimated from a 1 x 1 g r i d centered on   m   n   : 


       the term smn is a scale f a c t o r which reduces the magnitude of g f o r b r i g h t e r p i c t u r e p o i n t s to combat the noise  described e a r l i e r   encountered in b r i g h t areas of the p i c t u r e . in t h e p i c t u r e s we have studied w e l l over 1% of the p i c t u r e l o c a t i o n s give e f f e c t i v e l y zero values f o r g as can be seen by imposing a t h r e s h o l d which e l i m i n a t e s these 
p o i n t s . the r e s u l t displayed two-dimensionally   f i g . 1   contains most of the p i c t u r e edges of i n t e r e s t . it is only the values of g f o r these l o c a t i o n s t h a t are used in the recovery of p i c t u r e edges. the t h r e s h o l d in a f i x e d 
one which can be regarded as a constant in the p i c t u r e - t a k i n g and p i c t u r e - d i g i t i s i n g process. for each p i c t u r e l o c a t i o n so i d e n t i f i e d we could compute the f a m i l y of r a p a i r s it determines and begin to accumulate evidence by incrementing the a p p r o p r i a t e counters in a two 
dimensional a r r a y   where each counter w i l l record the number of l o c a t i o n s g i v i n g r i s e to a value of r a l y i n g w i t h i n the range appropri a t e to t h a t c o u n t e r   a range dr da  which is 
determined by the q u a n t i s a t i o n we impose on the r fi- space. we depart from t h i s method of accumulating evidence  the method described by duda and hart1  in two important r e s p e c t s . 
       f i r s t l y by making use of l o c a l evidence to determine u n i q u e l y the value of a. this l o c a l evidence can be d e r i v e d from the r a t i o dx/dy which gives the d i r e c t i o n in which the g r a d i e n t l i e s . since the g r a d i e n t should be p e r p e n d i c u l a r to the p i c t u r e edge a is given 
by 	dy 
	tan a 	= ffc 	 1  
       there is of course a r i s k that t h i s e s t i m a t i o n w i l l b e imprecise e s p e c i a l l y f o r example at j u n c t i o n s between contiguous 
p i c t u r e edges  but much of the u n c e r t a i n t y a r i s e s f o r p i c t u r e p o i n t s where the value of g is low  which we have a l r e a d y excluded from c o n s i d e r a t i o n by t h r e s h o l d i n g g. that these l o c a l estimates are c o n s i s t e n t and reasonably r e l i a b l e may be judged from f i g . 1   which d i s p l a y s the d i r e c t i o n of g at each of the p o i n t s where g exceeds t h r e s h o l d . if a  x and y are a l l known then r is determined  it can however be computed in two ways given t h a t a is going to b o q u a n t i s e d . that i s   r can be computed e i t h e r d i r e c t l y from the value of a given by  1  or after that value has been q u a n t i s e d . the two a l t e r n a t i v e s give the r a counters d i f f e r i n g g e o m e t r i c a l f i e l d s o f view: we s h a l l not pursue t h i s p o i n t of d e t a i l here save to say t h a t we have adopted the second approach  namely we quantise a before computi n g r. the q u a n t i s a t i o n steps used are da=1＜ and dr=1 p i c t u r e rows  columns . 
1 	the 	second p o i n t 	of departure r e l a t i v e to 
the method of duda and hart1 is to increment the counter  by the magnitude of g r a t h e r than 
 by one f o r each c o n t r i b u t i n g p i c t u r e l o c a t i o n . our m o t i v a t i o n in so doing is to ensure that we r e a d i l y f i n d s t r o n g p i c t u r e edges  at the r i s k to be sure of masking weak ones  and to ensure t h a t those counters f o r which a is a c c u r a t e l y computed from the l o c a l evidence  because g is l a r g e   are emphasised. 
       the r e s u l t i n g histogram h   r   a   f o r the d i g i t i s a t i o n o f f i g . l i s given i n f i g . 1 . the o r i g i n of c o o r d i n a t e s is in the centre of the p i c t u r e  row 1  column 1 of f i g . 1     it is t h i s p-oint from which r is measured. in the piurely a l g e b r a i c i n t e r p r e t a t i o n of the t r a n s f o r m a t i o n a ranges between 1＜ and 1＜; the method of computing a from the l o c a l evidence y i e l d s values which range between 1＜ and 1 since we wish to d i s t i n g u i s h which side of the p i c t u r e edge is the d a r k e r . thus f o r a g i v e n o r i e n t a t i o n of the p i c t u r e edge there are two possible values of a corresponding to one or other side being the darker. we have 
l a b e l l e d the a a x i s of the histogram according to the convention i'or d i s p l a y i n g a used in f i g . 1 as w e l l as in the more conventional way  so t h a t it is p o s s i b l e to pick out correspondences between peaks in the histogram w i t h bands of p i c t u r e p o i n t s in f i g . 1 . when one does t h i s e . g . f o r the b i n r = 1  a = 1＜   i d e n t i f i e r ' i '   corresponding to the shadow of the puppet's shoulders  we immediately grasp the f a c t t h a t the b i n in no sense represents the l i n e s we see in f i g . 1 . for t h i s b i n contains both these p i c t u r e edges although they are not j o i n e d   because t h e i r c o n s t i t u t e n t p i c t u r e l o c a t i o n s have the same r   a values associated w i t h them: they are c o l l i n e a r . the q u a n t i s a t i o n also has i t s e f f e c t too in d i v i d i n g a s i n g l e edge between adjacent histogram  bins; f o r example the p o i n t s f o r m i n g the lower edge of the l e g shadow in f i g . 1 do not all have the same o r i e n t a t i o n and are t h e r e f o r e a l l o c a t e d to d i f f e r e n t histogram b i n s . elsewhere i n the p i c t u r e p a r a l l e l edges which are close toget h e r have been a l l o c a t e d to the same b i n . the l a t t e r two defects can be exposed more r e a d i l y if we consider the l o c a t i o n s c o n t r i -
b u t i n g to each histogram b i n . for conveniens l e t u s r e s t r i c t a t t e n t i o n t o only those bins of f i g . 1 whose magnitude exceeds 1. we can now assign an i d e n t i f i e r   chosen again froiii the c h a r a c t e r set of the l i n e p r i n t e r   to each bin and d i s p l a y in the two-dimensional format of f i g . 1 the l o c a t i o n s which belong to each of these major b i n s . the r e s u l t   f i g . 1   i l l u s t r a t e s the p o i n t s we have been making o n l y too w e l l . at the same time the l i s t s of c o n t r i b u t i n g p o i n t s f o r each b i n   r e f e r r e d t o h e r e a f t e r as the c o n t r i b u t i n g p o i n t s l i s t  cpl   provides a b a s i s f o r surmounting the f i r s t ' devices - of r e c o v e r i n g sub-sets of the l o c a t i o n s c o n t r i b u t i n g t o the histogram: subsets which correspond as c l o s e l y as p o s s i -
ble w i t h the l i n e s we would sketch in on f i g . l . the s t a r t i n g point f o r the search i s a c p l from a major b i n . the method is i t e r a t i v e : search f o r a new l i n e always begins w i t h the l a r g e s t b i n remaining i n the h i s t o gram  and search terminates when no b i n exceeds the a r b i t r a r y value of 1. these subsets which we s h a l l c a l l p u t a t i v e l i n e l i s t s   p l l     are recovered in a s e r i e s of s t e p s . 
       1 . 1 . 1 . recovery of p u t a t i v e l i n e l i s t s . the c p l of the l a r g e s t b i n in the histogram is taken as a basis f o r forming a p l l . a l i s t of the p o i n t s in the c p l is made  ordoral on e i t h e r x value   f o r a /|f ＜ or a l-j1＜  or 
y value 	  |fj＜   a   l 1 ; j ＜   . 	this l i s t 	is now 
scanned from one end w i t h a view to f i n d i n g 
o t h e r c p l ' s c o n t a i n i n g p o i n t s which c o n t r i b u t e to the edge. for each p o i n t in the l i s t we compute g  a f o r those neighbours of the point which are not already in the l i s t . by n e i g h bours of a p o i n t we mean the e i g h t l o c a t i o n s which immediately bound the p o i n t . for each of. those neighbours having a g above threshold 
and a value of a. not more than 1＜ d i f f e r e n t from t h a t o f the i n i t i a l c p l   the c p l c o n t a i n i n g each such neighbour is merged i n t o the l i s t and the scan is resumed. d u r i n g t h i s scan gaps in the l i s t are t e s t e d i'or. a gap occurs when the next p o i n t on the l i s t has an 
x value   i f the l i s t is ordered on x  or y value   i f the l i s t is ordered on y  which d i f f e r s from that of the c u r r e n t p o i n t by more than some constant which at present is set at 1 u n i t . if a gap is found then the p o i n t s in the l i s t beyond the gap are assumed to be from a d if f e r e : i t   c o l l i n e a r   edge  and are discarded. 
       since t h i s scan adds c p l ' s to the l i s t the beginning of the l i s t may have been extended  and it is possible t h a t t h i s extension contains gaps. i t i s t h e r e f o r e necessary t o scan the l i s t again in the reverse d i r e c t 1 on l o o k i n g f o r a gap. as b e f o r e   p o i n t s   i f any  
beyond the f i r s t gap found are d i s c a r d e d . 
　　　the points remaining in the l i s t a f t e r these two scans are the r e q u i r e d p l l . they are removed from the appropriate c p l ' s of the 
histogram and the value of h f o r each c p l decremented a c c o r d i n g l y . recovery of p l l ' s then continues w i t h the c p l from the new l a r g e s t bin in the histogram as a b a s i s . the recovery process in terminated when there art-
no bins l e f t w i t h magnitude g r e a t e r than 1. 
                                                                 f i g . j is 	i l l u s t r a t e d in fig.1   	again u s i n g a two problems posed by the 	  r   a   	transformation. unique 	 new  	i d e n t i f i e r f o r each p l l ; 
the data s t r u c t u r e we r e f e r to as the h i s t o gram h   r   a   c o n t a i n s f o r each b i n a l i s t        the set of p l l ' s e x t r a c t e d from the d i g i t i s a t i o n of f i g . l and the histogram of 

 the 	c p l   	o f the 	  x   y   	l o c a t i o n s c o n t r i b u t i n g to t h a t b i n as w e l l as the summed magnitude h 
of the 	c o n t r i b u t i o n s of those l o c a t i o n s . 
1 . 1 . recovering s t r a i g h t l i n e s from the r   q h i s t o g r a m . 
　　　the 	recovery of bounded s t r a i g h t l i n e s from the histogram centres upon a process at 	t h i s stage f u l l of crude r a t h e r ad  hoc 
       1 . 1 . 1 . converting p u t a t i v e l i n e l i s t s i n t o l i n e s . the ordered l i s t o f p o i n t s 
emerging from the procedure described above 
i s subjected 	t o two t e s t s t o determine 	i t s 
a c c e p t a b i l i t y . i t s ' s t r e n g t h * i s assessed b y summing the values of g f o r the p o i n t s 
contained i n the l i s t . 	i f t h e i r summed value 
is l e s s than 1  	the p l l is r e j e c t e d . 
1 　　　the next step is to f i t a l i n e to the p o i n t s of the p l l using a l e a s t squares 
approximation with each point weighted by i t s g value. 
     the quantisation on r sometimes causes points from adjacent parallel edges to f a l l into the same  bin. the algorithm for recovering p l l ' s cannot at present handle this situation and produces a single p l l for the edges. such p l l ' s can be detected from the large spread of points about the f i t t e d l i n e . the measure used for this is the variance of the perpendicular distances of the points from the l i n e . w h e r e a s i s used to reject a p l l   the value of the 
variance computed is not  since the p l l and the line f i t t e d are structurally significant objects which other programs can be expected to make use of. 
　　　the accepted p l l ' s now have to be assigned end points. the technique involved f i r s t reorders the points of the p l l in the direction of the line f i t t e d to them  i . e . orders them according to their perpendicular distance from a normal to the l i n e . the extremum points of this l i s t are not usually very good candidates as end points; the lists tend to have t a i l s with extremum points some distance off the f i t t e d l i n e . the method adopted is to scan the l i s t noting on which side of this line the points l i e   u n t i l the f i r s t cross-over is noted. this cross-over point approximates to the intersection of the line with a boundary around the set of points  and is taken as the endpoint. the procedure is repeated at the other end of the l i s t . 
　　　the line segments superimposed on the p l l ' s in pig.1 were obtained from those p l l ' s by the above method. pig.1 is a plot of the same lines produced using the groats graphical system1; for ease of inspection lines whose 
variance exceeds 1 units are shown dotted. results for other pictures of this same type  using the same parameter settings  are i l l u s trated in fig.1. 
　　　1.1. 	program details. 	the program was implemented in algol 1 on an icl 1a  and 
uses 1k of core memory. the processing time depends on the complexity of the pictures  and varies from about 1 seconds for simple 
blocks scenes to about 1 seconds for the more complicated puppet pictures. 
1. 	results 
　　　perhaps the most obvious question to ask of this line finder is 'does it work ' unfortunately such a question can only be answered relative to the success or failure achieved in using the line data for some recognition or interpretation task. at the time no such evaluation has been attempted; the interpretation routines simply do not exist. however  we can adopt the requirements that some reported scene analysis system would appear to impose upon i t s line finder  and assess performance on that basis. a good candidate is shirai's program1 since the context free phase of line finding is rather well defined in that program  being aimed at the recovery of the scene contour. that is the set of 'outer' edges of the object or group of overlapping objects visible in the scene. the pictures we are working with  unlike those used by s h i r a i   contain substant i a l areas of visible shadow which can be regarded as augmenting this contour  for example the lines in pig.1 numbered 1  1  1  
1  1  1  	1 ignoring 	internal 
contours  e.g. 1  1  1 in fig.1  we can form a simple numerical measure of success by comparing the number of picture edges in the outer contour estimated by eye for the data  with the number of these edges appearing as lines in the output data. 	in table 1 these counts are l i s t e d for five scenes. 

　　　the results suggest - relative to shirai who apparently never f a i l s to recover the complete outline - a rather disappointing performance. there is however a major difference between the data for the two line finders namely that shirai was working with matt white blocks on a black velvet support plane whereas we are working with matt grey polyhedra  the puppet  on a matt white support plane. moreover the optical quality especi a l l y focus of some of our photographs is 
much inferior to that of shirai  our scenes extend over a greater spatial extent . thus our worst cases 1  1  suffer from very badly defocussed shadows where many outline picture edges are missed  
　　　a more fragmentary analysis of performace can be given by looking at some well-defined mistakes. specifically a number of picture edges are missed due to design defects of the algorithm which are potentially easily r e c t i f i e d . we can identify three main causes for missing  or mis-positioning  a picture edge. 
　　　 a  edges which are short and/or lacking in contrast. the vast bulk of missed edges f a l l into this category. por example the edge completing the top of the puppet's head in f i g . l  the missing line joining the junction of 1 and 1 with the junction of 1 and 1k in f i g . 1   . this is clearly visible in the differentiated data  fig.1  i t s magnitude however is too low for the histogram bin  r = +1  a- = 1＜  to exceed c r i t i c a l threshold for line finding  so that it never appears in the cpl's for thib data  fig.k . 
　　　 b  a similar case of considerable interest because of i t s potential value in any 1-d interpretation of the data  occurs as part of 'tee junction' formed by the occlusion of the trunk shadow by the nearer 'arm' in 
f i g . l . two of the edges - lines 1 and 1 in pig.1 - are recovered; the t h i r d is clearly visible in the d i f f e r e n t i a t i o n pig.1  and at f i r s t 1ight it seems odd that it does not 

1 



same   r   a   . it is clear that the adjacency c r i t e r i o n we have adopted makes it a very crude edge-follower. 
　　　there are basically two things one is trying to do with the cpl in i t s simple form or i t s form as augmented by other cpl's merged due to proximity in  r a  space or  x f y  space. the f i r s t is to find the end points of edges. at present we do this by examining the l i s t . however most interesting picture edges end in junctions. thus the fact that an edge terminates usually if not always implies that another edge is 'pointing' at that termination point. thus many 'gaps' perhaps a majority could be marked not from a consideration of the edge cpl per se but from a consideration of 'neighbouring'   tn some sense  c p l ' s . in horn's paper he describes a 
phase which we have not yet studied called  concocting v e r t i c e s ' . this phase follows on from the formation of bounded lines to represent recovered edges: the proposal sketched informally above would in the context of the binford-horn line finder amount to a merge of two processes  line f i t t i n g and vertex concoction  which are at present sequential. the procedures for carrying this out in the r a parameterisation have not been detailed as yet. 
　　　the second objective in processing a significant cpl is to ascertain whether the 
picture locations which l i e in the 'mark' as against the 'space' between gaps  satisfy some c r i t e r i o n of'edge-ness' realised in the present program by s t r i c t sequentiallyaddressable picture contiguity. perhaps less search-dominated c r i t e r i o n would be simply to assess the spatial density of points on the cpl in the putative 'mark' between gaps. again we have not pursued this notion to the point of programming i t . 
　　　the crucial question is that of deciding how much work should be done on attempting to remedy some of these defects - perhaps along the lines suggested - as against accepting the existing performance and leaving other routines to remedy these omissions and errors. our current preference and intention lies almost wholely in the l a t t e r direction. 
acknowledgements 
　　　we are grateful to alan mackworth and john francis for discussions and especially for suggesting the use of locally-computed values of a in forming the histogram and to john francis who implemented an early version of that suggestion. 
　　　we are grateful to both alan mackworth and stuart sutherland for comments on the draft of this paper. 
　　　the research is part of a project supported by the science research council. 
