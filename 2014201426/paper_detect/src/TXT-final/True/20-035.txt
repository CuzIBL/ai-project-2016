 
this paper addresses the issue of color constancy  which is the the perceptual ability of the human visual system to assign the same colors to objects under different lighting conditions. we propose a method  based on finite-dimensional linear models of reflectance and illumination  which allows the transformation  r g b  images into color constant images. in contrast to previous work  we show that good results can be obtained using a 1-receptor system and some knowledge about the spectral properties of natural materials and illuminants. in the method developed  an estimate of illuminant in the scene is computed  which allows the computation of color constant descriptors of the pixel values in the image. in addition  we show a method of computing the actual reflectances of the materials in the scene out of the computed color descriptors. 
	1 	introduction 
one of the most interesting perceptual abilities of the human visual system is to assign the same colors to objects under different lighting conditions. in other words  a human observer looking at a certain scene perceives the colors of surfaces in a consistent way  although the spectral distribution of the illuminant may vary considerably. this degree of independence of perceived object color on the illuminating spectrum is called color constancy. 
　　in this paper  we describe an algorithm for generating color constant descriptors of surfaces. the idea is to transform an input image representing the intensities reflected from objects into a color constant image which is a representation of reflectances  therefore independent of illumination effects. when put formally  the problem is to find a conversion matrix a that transforms the original  r g b  values of the image into color constant descriptors 1. if the original  r g b  values of the image are defined as pr  pg  and pb  denoted as then the following relation can be formulated: 
		 i  
the main goal of the work described in this paper is to find the values of the vector which for each pixel  is a set of  three  numbers representing the color descriptors of the material  regardless of the illumination. 
　　the approach we take is similar to the one forwarded by buchsbaum . thus  it is a two-step process: estimating the illuminant  and using the estimated illuminant to obtain the descriptors. the method makes use of a finite-dimensional linear model which represents light sources and reflectances. using this model  we show how an estimate to the illuminant is obtained  and consequently  color constant descriptors. in 

* also  canadian institute for advanced research. 
contrast with buchsbaum's work  we base our choice of basis functions on statistical measurements of naturally occurring reflectances and illuminants. in addition  our approach shows that a 1-sensor input  red  green  blue  is sufficient for the estimation of the illuminant and reflectances in the scene  in contrast with the method suggested by maloney . 
	1 	finite-dimensional linear models 
the model which will be used for the description of surface spectral reflectances and illumination is a finite-dimensional linear model  1 . the idea behind this model is to describe the surface reflectances and light sources through a weighted sum of a fixed set of basis functions. the reflectances and illuminants generated by the model must be physically realizable  otherwise they will not represent real-life phenomena. the basis functions need not be physically realizable  and their only constraint is that they be linearly independent. since the quantity being measured is the reflected intensities  this implies that the physical interaction of light and surface reflectance has to be captured by sensor s  with some spectral sensitivity curves. thus  a third component to be included in the model is the response functions of the sensor in use  which introduces a third set of linearly independent functions. 
　　we now turn to the choice of the appropriate basis functions. the easiest one is the sensitivity functions. as mentioned above  if we are to deal with the human visual system  then such curves have already been determined in many different ways. if the sensor is other than the eye  such as optical scanners for digitized images  then one can easily find out the specifications of the filters used in the process of capturing the scene onto a device. whatever sensor is being used  these sensitivity curves will be denoted as 
 corresponding to red  green  and blue sensitivity curves  and 

　for the purpose of finding a finite-dimensional linear model of surface reflectance  one has to measure a large number of spectral reflectances of materials and derive the appropriate set of functions. one such study was conducted by cohen   who computed the characteristic vectors of 1 munsell chips randomly selected from a total of 1 chips. in the analysis it turned out the the first three vectors accounted for 1% of the variance in the fit to the data. we will therefore use these three vectors  which will be denoted as where and 
　　similarly  it is possible to determine a basis set which will describe typical daylight conditions. in a study carried out by judd  mac adam  and wyszecki   spectral distributions of 1 samples of daylight have been subjected to characteristic vector analysis. the study showed that the mean and two characteristic vectors accounted for most of the variance in 
	gershon  jepson  and 	tscotsos 	1 

the data leading them to suggest a linear model of light with three degrees of freedom. therefore our choice of three basis functions describing the luminance will be the mean and first two characteristic vectors  which will be denoted as  where 
　　to combine the basis functions into the linear model  we take the product of the three functions. this is due to the fact that reflection is a product of illumination and reflectance  and to measure the reflection one needs sensitivity curves to filter the reflected intensities. therefore a three-dimensional tensor is defined as: 
it is important to note that the tensor is a fixed system of constants  and does not depend at all on the materials being viewed. 
	1 	estimating the illuminant 
buchsbaum  proposed a partial solution for the recovery of the illuminant: he assumed that the average reflected intensities system along the lines of  corresponds to the one obtained from the actual illuminance acting on a standard homogeneous field  internally embedded in the model. this standard internal reflectance was assumed to approximate the entire field average reflectance. there are two assumptions buchsbaum made which weaken the solution considerably:  1  the tensor was picked in an ad hoc manner  without any relevance to naturally-occurring reflectances and illuminants;  1  a fixed internal reflectance vector for the overall actual field average was built into the system. this vector was chosen to be equal reflectance at all wavelengths  implying that the overall mean pixel values of all images are grey. moreover  there is no indication to whether this vector should be updated if the scene is known to be very different from normal rich scenes  e.g.  a forest full of green colors . 
　　the way we suggest to estimate the illuminant is to match a system representing a general model of material reflectances with an average of reflected intensities exhibited by the materials within a given image. this poses two problems which we address in the following sections: 
1. what can be considered as a  general  set of materials which includes  with high probability  most of the materials found in scenes  
1. how should the image average reflectance be generated such that it will exhibit dependency on the illuminant and represent all materials equally  
1 	  i d e a l   m a t e r i a l space 
in order to be able to treat most of the naturally occurring materials  one has to find a large ensemble of materials and record their spectral properties. one such study was conducted by krinov   who measured and documented the spectral sensitivity curves of 1 materials of various types  such as soil  vegetation  and water. this sample is  ideal  since the more materials it contains  the closer its average will be to the average of the sample being examined  the image . as mentioned in section 1  the characteristic vectors suggested by cohen  represent a good approximation of reflectances. therefore we suggest to represent this ideal material space with the three characteristic vectors  and to compute the average of this ideal space in terms of the characteristic vectors. thus  if is 
1 	perception 
the k-th material in krinov's sample set  then its representation using cohen's basis functions is: 
where 
thus the average of all materials 1 is a vector computed as: 
		 1  
yielding a triplet of numbers which are the average of the ideal material space as represented by three characteristic vectors. 
1 	average image reflectance 
there are two main requirements being imposed on the average image reflectance. the first requirement is that it should depend on the illumination and its effects on the scene. the motivation behind this requirement is that different light sources will affect the scene differently  resulting in different reflected intensities. it is therefore desirable to generate an average which will be sensitive to these changes and represent each light source differently. the second requirement is that all materials should be represented equally  no matter how large a region they occupy in the image. this is due to the fact that in the ideal material space presented in the previous section  each material is represented only once. since our technique tries to find correspondence between the ideal space and the image space  it is desirable that the image space be sampled in the same manner. 
　　to satisfy both requirements  we chose a method which segments the image into regions which differ from each other in their chromatic appearance. the averaging of the image reflectance is computed by segmenting the image into regions which differ from each other according to some criterion of homogeneity  set by the segmentation scheme . each meaningful region is then averaged  and this average is added up to the total average of the image reflectance. the total average is computed for all three dimensions  i.e.   r g b   and will be denoted as  details regarding the segmentation are given in  1}. 
	1 	the algorithm 
we now turn to describe the actual algorithm for computing color descriptors in detail. as mentioned before  the proposed technique consists of two steps: estimating the illuminant vector e  and finding the transformation matrix a  which will enable the conversion from  r g b -space to color constant space  which will be referred to as c-space. the two steps will be discussed in detail below. 
1 	step 1 - computation of 
1. compute the average image reflectance 
 a  segment the image into regions using some homogeneity criterion. 
 b  for each region  compute the average  r g b  values and add to the average reflectance 
1. compute 
 a  define the 1 x 1 matrix to be a representation of the reflectances in the image space in terms of 

figure 1: the real and estimated illuminant. 
c-values were computed for each material. the absolute error in the c-values compared to the true c-values are given in table 1. as can be observed from the figure  given the a priori 
 1  	knowledge about the materials  the results of the algorithm are accurate. 

	1 	experiments 
in order to evaluate the effectiveness of the algorithm  a few experiments were designed and carried out on simulated and real images. although each experiment was designed with a different goal in mind  the overall goal was to demonstrate the robustness and accuracy of the algorithm. 
1 	constancy under different illuminants 
in this experiment the goal was to verify that the c-values generated by the algorithm were indeed constant under different illumination conditions. therefore a simple method was used: the same scene was photographed and digitized under two different illuminants; the first was illuminated with white 
	gerahon  japaon  and taotaos 	1 

	1 	summary 
this paper dealt with the problem of color constancy  or the fact that the perceived color of surfaces tends to remain constant despite changes in illumination that alter the intensities reflected off the surfaces. we have presented an algorithm which generates color constant descriptors for different surfaces. there are two steps in the algorithm: the first estimates the illuminant present in the scene  and the second step makes use of the estimated illuminant to generate the color descriptors. we have shown that by computing an image average reflectance  the algorithm can estimate the illuminant present in the scene and with it  produce color descriptors for each of the surfaces in the image. although the same materials may exhibit different reflected intensities under different illumination conditions  the algorithm produces the same descriptors in each case. the main result of the algorithm is that it allows the treatment of surfaces independent of the spectral power of the light source affecting them. 
