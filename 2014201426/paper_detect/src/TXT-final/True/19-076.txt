 
   experience gained through building a causal network for interpretation of electromyographic findings has shown that probabilistic inference is a realistic possibility in networks of non-trivial size. the use of nodes with many internal states has made it possible to make a conceptually simple and compact representation of knowledge.  deep knowledge  in the form of pathophysiological models are used to reduce the problem of estimating thousands of conditional probabilities to a manageble size. the network has built-in mechanisms that will detect when the network is confronted with a situation outside the limits of its own knowledge and it handles conflicting evidence in a simple and consistent way. 
introduction 
   in some medical expert systems  causal networks have proven themselves as a helpful tool in the organisation of the knowledge of a domain  for references see e.g. szolovits 1 . concepts in the domain are represented as nodes in the network and their interaction is represented as causal links between the nodes. 
   we have chosen electromyography  emg   the diagnosis of muscle and nerve diseases through analysis of bioelectrical signals from muscle and nerve tissue  as our application domain. out of 1 distinct types of knowledge  required to carry out an emg examination  1 can conveniently be represented in a causal network  andersen et al. 1 . 
   only few expert systems have used a probabilistic approach  and to our knowledge none of the systems based on causal networks have exploited recent progress in algorithms for propagation of probabilistic evidence  kim and pearl  1; pearl  1 . 
   this paper reports on experience gained by building a small  but non-trivial prototype expert system for emg  using a causal probabilistic network  munin * - muscle and nerve inference network. 
   after outlining the functions and limitations of the prototype several issues will be discussed: 
* this work is supported in part by the eec esprit programme  project p1 
** coincidentally  according to norse mythology munin is one of two ravens  whispering intelligence into the ear of the god  odin. 
- the knowledge representations 
- the experience gained with knowledge acquisition and verification 
- the interaction of empirical  surface  knowledge and causal understanding as exposed in textbooks  deep knowledge  
- handling of conflicting evidence 
- performance of the system  when confronted with evidence lying outside the knowledge of the network 
functions and limitations of the prototype 
　　in earlier publications  andersen et al. 1  andreassen et al. 1  it was proposed that a causal network contains the information necessary for a unified approach to three of the main tasks of a medical expert system: diagnosing  planning of data acquisition  and explanation of the systems reasoning. in this paper we shall only deal with diagnosis  while implementation and some aspects of planning and explanation are considered by jensen et al.  1 . at the beginning of a diagnostic session the disease node is initialised with a priori probabilities corresponding to the observed frequencies of the diseases in patients referred for emg examinations  figure 1 . the number of diseases is restricted to three  each with two to four states  corresponding to gradations and/or different varieties of the diseases. in addition the patient may be in one of the states normal  no disease with neuro-muscular symptoms  or other  a neuro-muscular disorder other than the three mentioned diseases   giving a total of eleven different  disease  states. an algorithm for propagation of evidence in causal networks was developed by kim and pearl  1 . the algorithm was adapted to this network and supplemented by a method for coherent initialisation of probabilities  jensen et al. 1 . 
　　using these methods the a priori distribution of diseases can be used to generate expectations for the pathophysiological changes caused by the diseases. the pathophysiological changes in a given muscle are described by eight pathophysiological nodes  mu.loss through 
denervation  each of them with from two to nine states. 
since almost half of the patients are  normal   the expectations for the pathophysiological nodes are largely normal. the pathophysiological nodes in turn generate expectations for the 1 findings nodes through their causal links  either directly or through an intermediate node  mup.conclusion . mup.conclusion does not have a natural patho-
physiological interpretation. it only serves the purpose of integrating the information from the three findings mup.amplitude  mup.duration and mup.poly-
phasic. these three findings are all obtained from the same emg test: analysis of motor unit potentials. 

　　beyond the already mentioned reductions on the number of diseases  the prototype is also restricted in other ways: multiple simultaneous diseases are not considered and the network does not handle measurement of nerve signals  which are as important as measurement of muscle signals. furthermore  it only considers findings from one muscle. the interesting interaction between the causal network and the ncuroanatomical knowledge  which has a mainly topological nature and is not readily represented in a causal network  is therefore not considered in this paper. the authors think that solutions to each of these problems can be found  without violating the rigorous probabilistic approach used for the prototype. 
　　the diagnostic task consists of adjusting the probabilities in all nodes as the findings are entered into the findings nodes. in figure 1 findings corresponding to a typical case of 
 moderate chronic axonal neuropathy  have been entered. a finding entered into a findings node is indicated by a broken horizontal 1% bar. the network correctly indicates a large probability for moderate to severe axonal neuropathy  it generates distributions for the pathophysiological nodes that are consistent with  moderate chronic axonal neuropathy  and offers predictions of the outcomes of the remaining findings  should the physician chose to perform the appropriate emg-tests. 
representation of uncertain 
knowledge 
　　the medical knowledge is embedded in the causal network in three ways. through the choice of the number and character of the nodes  through the assignment of causal links between the nodes  and since we have chosen a probabilistic approach  through the conditional probabilities associated with the causal links. 
　　as an example  consider the causal links from the disease node to the pathophysiological node  loss of motor units  mu.loss   which reflects the percentage of nerve fibres that still survive and reach the muscle. a motor unit is the muscle fibres  typically several hundred  that are innervated by one and the same nerve fibre. in figure 1 the conditional probabilities for mu.loss  given some of the states in the disease node are shown. 
the table states that 1% of all  normal  patients will have 
 no  loss of motor units  1%  moderate  and 1%  severe  loss of motor units  while virtually nobody  1%  will have  total  loss of motor units. 1% will present with a different picture that can not be described in terms of  mu.loss  see section on ignorance and conflicts . 

the last line  other  represents the expected loss of motor units  when something else but unknown is wrong with the patient. the relative lack of information is reflected in a relatively even distribution of the probabilities over all the possible states. examples of how the conditional probabilities are acquired and verified are given in the next section of knowledge acquisition and verification. 
　　for the findings with continuous outcomes the probabilities are replaced by probability densities. in figure 1 the conditional probability densities which are assumed to have 
a normal distribution are plotted for each of the states in 
mup.conclusion. 
some of the nodes have more than one parent  i.e. there 

　　figure 1 the conditional probabilities p mu.loss i disorder  for the states of mu.loss  given 1 different disorders. 
　　as can be seen from the second line  patients with  mild chronic axonal neuropathy  are much more prone to loss of motor units  with only 1% having  no  loss of motor units. 
moderately and severely affected patients are even worse off. are two or more  parent nodes  with causal links to a  child node . examples are  force  and  atrophy  that both have mu.loss and mu.structure as parents. this requires filling out a conditional probability matrix that specifies p force i mu.loss  mu.structure  for all 1x1 combinations of force  mu.loss  and mu.structure. from the point of view of knowledge acquisition it is not a trivial task to determine the 1 conditional probabilities in this three dimensional matrix. 




　　once models have been developed for all nodes  we have tried to verify the network in two different ways. one way is to generate expectations corresponding to a single disorder. for example  the expectations corresponding to  moderate chronic axonal neuropathy  may be presented to a medical expert  figure 1  who is asked to identify discrepancies between his expectations and the expectations generated by the network. the other way of verifying the network is by entering findings typical of different diseases  and asking the medical expert to identify differences between the probabilities computed by the network and his own diagnosis. in figure 1 findings corresponding to a case of chronic axonal neuropathy were entered. in that case the probabilities computed by the network were satisfactory. 
　　discrepancies between the network and the medical experts lead to revision of the model parameters and occationally to revision of inaccurate or incomplete models. occationally  it may even be necessary to modify the structure of the network  adding or deleting states or nodes. the current version of the network represents the third major revision. in our hands the revision process has so far been  benign   with improvement in performance for each revision and without unexpected side-effects of revisions. when the network is expanded to handle a range of clinically realistic cases  a more formal testing involving a number of clinical experts is planned. 
ignorance and conflicts 
even if a dedicated effort is made by the builders of the 
munin system to collect and describe a large number of diseases to the system  there will still be a residual number of diseases that arc either unknown or incorrecdy described to the system. how should the system behave when confronted with a disease unknown to it  if there is a disease known to the system that fits the findings of the case poorly  although with a better fit than all other diseases  then bayesian systems tend to give a strong statement in favour of the disease with the least poor fit. to avoid this behaviour we have introduced the state  other   both in the disease node and in some of the pathophysiological nodes. in figure 1 a set of findings have been entered. the network is confused by these findings  so are the authors   and the network indicates its reservations by giving  other  a high probability. 



　　the network may also get confused at the pathophysiological level  if conflicting findings are entered. in figure 1 mu. structure receives input from ta.conclusion supporting  very large  and from  mup.conclusion  supporting  very small . 
mu.structure states its confusion by assigning a high probability to  other . there are two interpretations of the  other  state. maybe the findings entered into the network faithfully represents the states of the muscle  although this would be very difficult to imagine from a medical point of view. in that case a  hole  in the knowledge of the network has been uncovered and one or more of the models in the network will have to be modified. it may even be necessary to add new states to excisting nodes  to add new nodes or to add new causal links. 
　　the alternative interpretation is that erroneous findings have been entered. generally  the appearance of  other  in a node signals that conflicting and possibly erroneous input has been given to the network. 
　　whichever interpretation is correct the situation is handled in a reasonable way. once the status of mu.structure is  other   it does not lend support to any disease. basically  the node is largely ignored until the conflict is resolved. 
conclusion 
　　a network for the interpretation of emg finding has been constructed. we expect a network of this type to be an important building block in an expert system for emg. although the network is small and in its current form has only limited functions  it has allowed us to reach a number of conclusions: 
　　1  with present algorithms for propagation of evidence in causal probabilistic networks  probabilistic inference is a feasible approach. since the computation time of the algorithms is increasing approximately linearly with the number of states in the network  we expect that probabilistic inference can also be used in networks considerably larger than the current network. 
　　1  the shift from nodes with only two states  yes no  to nodes with multiple states has given a conceptual simplicity that makes knowledge acquisition and verification easier. it also makes the knowledge representation very compact. 
　　1  the use of  deep knowledge  in the form of models has reduced the almost intractable problem of estimating thousands of probabilities to the much more tractable problem of adjusting a much smaller number of model parameters. the models have the added virtue that they can be explained through pathophysiological reasoning similar to the reasoning done by an expert. 
　　1  lack of knowledge in the system and conflicting evidence is handled in a simple and consistent way by adding the state  other  to some of the nodes. this way the network can signal  when it reaches the limits of its knowledge. 
acknowledgements 
the work on the munin expert system is part of 
esprit project p1  an expert assistant for 
electromyography  and is partially supported by the european 
commision. all members of the munin group  annelise rosenfalck at nuc  aalborg   and finn verner jensen  uffe 
kjamilff and anders rieck sorensen at judex datasystems  aalborg  are thanked for their valuable contributions. the other partners in the esprit project  computer resources international  copenhagen   national hospital of nervous 
diseases  london  and logica  cambridge  are thanked for valuable discussions. 
