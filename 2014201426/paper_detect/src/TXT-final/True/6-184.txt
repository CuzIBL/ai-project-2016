 
this paper focuses on temporal constraint problems where the objective is to optimize a set of local preferences for when events occur. in previous work  a subclass of these problems has been formalized as a generalization of temporal csps  and a tractable strategy for optimization has been proposed  where global optimality is defined as maximizing the minimum of the component preference values. this criterion for optimality  which we call  weakest link optimization   wlo   is known to have limited practical usefulness because solutions are compared only on the basis of their worst value; thus  there is no requirement to improve the other values. to address this limitation  we introduce a new algorithm that rc-applies wlo iteratively in a way that leads to improvement of all the values. we show the value of this strategy by proving that  with suitable preference functions  the resulting solutions are pareto optimal. 
1 introduction 
the notion of softness has been applied to either a constraint or planning goal  indicating that either can be satisfied to matters of degree. it is not hard to find applicable real world problems for such a notion. for example  in an earth orbiting spacecraft  sensitive instruments like imagers have duty cycles  which impose restrictions on the amount of use of the instrument. a duty cycle is typically a complex function based on both the expected lifetime of the instrument  as well as short term concerns such as the amount of heat it can be exposed to while turned on. duty cycles impose constraints on the duration of the periods for which the instrument can be on  but it is natural to view this duration as flexible. for example  this restriction might be waived to capture an important event such as an active volcano. thus  the flexibility of the duty cycle  softens  the constraint that the instrument cannot be on beyond a certain duration. reasoning about soft constraints for planning or scheduling is for the purpose of finding a solution that satisfies the constraints to the highest degree possible. 
　for temporal reasoning problems  a simple method for evaluating the global temporal preference of a solution to 
temporal reasoning 
kristen brent venable 
;ment of pure and applied mathematics 
university of padova via g.belzoni.1 
1 padova  italy 
a temporal csp involving local temporal preferences was introduced in  khatib et at  1   based on maximizing the minimally preferred local preference for a time value. because the locally minimally preferred assignment can be viewed as a sort of  weakest link  with respect to the global solution  we dub this method  weakest link optimization   wlo   in the spirit of the television game show. wlo can be formalized using a generalization of simple temporal problems  stps   called stps with preferences  stpps   that preserves the capability to tractably solve for solutions  with suitable preference functions associated with the temporal constraints . unfortunately  as often occurs  this efficiency has a price. specifically  wlo offers an insufficiently fine-grained method for comparing solutions  for it is based on a single value  viz.  the  weakest link.  it is consequently easy to conceive of examples where wlo would accept intuitively inferior solutions because of this myopic focus. although it is possible to consider more robust alternatives to a wlo strategy for evaluating solutions  it is not clear whether any of these methods would preserve the computational benefits of wlo. this impasse is the starting point of the work described in this paper. 
　we propose here to make wlo more robust by combining it with an iterative strategy for solving stpps. the process involves repeatedly restricting temporal values for the weakest links  resetting their preference values  and applying the wlo procedure to the reduced problem that results from these changes. the intuition is a simple one  and we motivate this technique with an example from a mars rover planning domain. in section 1  we summarize the soft constraint problem solver based on wlo introduced previously. we then illustrate in section 1 the deficiencies of wlo on a simple example  which also reveals the intuition underlying the proposed strategy for overcoming this deficiency. the main contribution of this paper is discussed in sections 1 and 1  which formalize this strategy and prove that any solution generated by an application of this strategy is in the set of pareto optimal solutions for the original problem. 
1 reasoning about preferences with soft constraints 
this section reviews the material first presented in  khatib et al.  1 . there  a class of constrained optimization prob1 

lems  called temporal constraint satisfaction problems with preferences  tcspps   was first defined. a tcspp is a generalization of classical tcsps which allows for a representation of soft constraints. in classical tcsps  dechter et al.  1   a unary constraint over a variable x representing an event restricts the domain of x  representing its possible times of occurrence; the constraint is then shorthand for 
	similarly  a 
binary constraint over x and y restricts the values of the distance in which case the constraint can be expressed as 
a uniform  
binary representation of all the constraints results from introducing a variable  for the beginning of time  and recasting unary constraints as binary constraints involving the distance 

　a soft temporal constraint is a pair  where / is a set of intervals  of temporal values  and / is a function from  ui to a set a of values. intuitively  / expresses local preferences for temporal values based on the value it assigns from a. for example  the soft constraint represented by  can be interpreted to mean that the 
temporal assignments must be selected from either of the intervals in the set  and the function min assigns a greater preference to smaller values. the cardinality of the set a  i.e.  the number of distinct preference values  reflects the ability to discriminate among degrees of preference for temporal assignments. the class of tcspps in which each soft constraint consists of a single interval is called simple temporal problems with preferences  stpps . 
　local preferences combine to form global preferences for complete assignments. to formalize these operations  a can be structured in the form of a c-semiring  bistarelli et al.   
1 . a semiring is a tuple  such that 
  a is a set and 1  a: 
  +  the additive operation  is commutative  associative and 1 is its identity element  a+1= a ; 
  x  the multiplicative operation  is associative  distributes over +  1 is its identity element and 1 is its absorbing element  ax 1 = 1  . 
a c-semiring is a semiring in which + is idempotent  i.e.  a + a = a a  a   1 is its absorbing element  and x is commutative. the semi-ring representation of operations on preference values is used as part of the proof of tractability for restricted sub-classes of tcspp  which occurs below. 
　a solution to a tcspp is a complete assignment to all the variables that satisfies the temporal constraints. an arbitrary assignment of values to variables has a global preference value  obtained by combining the local preference values using the semiring operations. a c-semiring induces a partial order relation over a to compare preference values of arbitrary assignments; a b can be read b is more preferred than a. classical temporal csps can be seen as a special case of tcspp  with  soft  constraints that assign the  best  preference value to each element in the domain  and the  worst  value to everything else. the optimal solutions of a tcspp are those solutions which have the best preference value in terms of the ordering  

　as with classical  binary  csps  tcspps can be arranged to form a network of nodes representing variables  and edges labeled with constraint information. given a network of soft constraints  under certain restrictions on the properties of the semiring  it can be shown that local consistency techniques can be applied in polynomial time to find an equivalent minimal network in which the constraints are as explicit as possible. the restrictions that suffice for this result apply to 
1. the  shape  of the preference functions used in the soft constraints; 
1. the multiplicative operator x  it should be idempotent ; and 
1. the ordering of the preference values   s must be a total ordering . 
the class of restricted preference functions that suffice to guarantee that local consistency can be meaningfully applied to soft constraint networks is called semi-convex. this class includes linear  convex  and also some step functions. all of these functions have the property that if one draws a horizontal line anywhere in the cartesian plane of the graph of the function  the set of x such that f x  is not below the line forms an interval. semi-convexity is preserved under the operations performed by local consistency  intersection and composition . stpps with semiring swlo can easily be seen to satisfy these restrictions. 
1 	temporal reasoning 　the same restrictions that allow local consistency to be applied are sufficient to prove that stpps can be solved tractably. finding an optimal solution of the given stpp with semi-convex preference functions reduces to a two-step search process consisting of iteratively choosing a preference value   chopping  every preference function at that point  then solving a stp defined by considering the interval of temporal values whose preference values lies above the chop line  semi-convexity ensures that there is a single interval above the chop point  hence that the problem is indeed an stp . figure 1 illustrates the chopping process. it has been shown that the  highest  chop point that results in a solvable stp in fact produces an stp whose solutions are exactly the optimal solutions of the original stpp. binary search can be used to select candidate chop points  making the technique for solving the stpp tractable. the second step  solving the induced stp  can be performed by transforming the graph associated 

figure 1: the stpp for the rover science planning problem where t is any timepoint 
with this stp into a distance graph  then solving two singlesource shortest path problems on the distance graph.  the solutions to these provide upper and lower time bounds for each event. if the problem has a solution  then for each event it is possible to arbitrarily pick a time within its time bounds  and find corresponding times for the other events such that the set of times for all the events satisfy the interval constraints.  for n nodes and e edges  the complexity of this phase is 1{en   using the bellman-ford algorithm  cormen et al  1  . 
1 	the problem with wlo 
formalized in this way  wlo offers what amounts to a coarse method for comparing solutions  one based on the minimal preference value over all the projections of the solutions to local preference functions. consequently  the advice given to a temporal solver by wlo may be insufficient to find solutions that are intuitively more globally preferable. for example  consider the following simple mars rover planning problem  illustrated in figure 1. the rover has a sensing instrument and a cpu. there are two sensing events  of durations 1 time units and 1 time unit  indicated in the figure by the pairs of nodes labeled ins   ins1e and ins1  ins1e respectively . there is a hard temporal constraint that the cpu be on while the instrument is on  as well as a soft constraint that the cpu should be on as little as possible  to conserve power. this constraint is expressed in the stpp as a function from temporal values indicating the duration that the cpu is on  to preference values. for simplicity  we assume that the preference function min on the cpu duration constraints is the negated identity function; i.e.  min t  =  thus higher preference values  i.e. shorter durations  are preferred. because the cpu must be on at least as long as the sensing events  any globally preferred solution using wlo has preference value -1. the set of solutions that have the optimal value includes solutions in which the cpu duration for the second sensing event varies from 1 to 1 time units. the fact that wlo is unable to discriminate between the global values of these solutions  despite the fact that the one with 1 time unit is obviously preferable to the others  is a clear limitation of wlo. 
　one way of formalizing this drawback of wlo is to observe that a wlo policy is not pareto optimal. to see this  we reformulate the set of preference functions of a stpp  as criteria requiring simultaneous optimization  and let s = and s' = be two solutions to a given stpp. s' dominates s if for each j  
and for some in a pareto optimization problem  the pareto optimal set of solutions is the set of non-dominated solutions. similarly  let the wlo-optimal set be the set of optimal solutions that result from applying the chopping technique for solving stpps described above. clearly  applying wlo to an stpp does not guarantee that the set of wlo-optimal solutions is a pareto optimal set. in the rover planning problem  for example  suppose we consider only solutions where the cpu duration for the first sensing event is 1. then the solution in which the cpu duration for the second sensing event is 1 time unit dominates the solution in which it is 1 time units  but both are wlo-optimal  since they have the same weakest link value.1 
　assuming that pareto-optimality is a desirable objective in optimization  a reasonable response to this deficiency is to replace wlo with an alternative strategy for evaluating solution tuples. a natural  and more robust alternative evaluates solutions by summing the preference values  and ordering them based on preferences towards larger values.  this strategy would also ensure pareto optimality  since every maximum sum solution is pareto optimal.  this policy might be dubbed  utilitarian.  the main drawback to this alternative is that the ability to solve stpps tractably is no longer apparent. the reason is that the formalization of utilitarianism as a semiring forces the multiplicative operator  in this case  sum   not to be idempotent  i.e.  a + a # a   a condition required in the proof that a local consistency approach is applicable to the soft constraint reasoning problem. 
　of course  it is still possible to apply a utilitarian framework for optimizing preferences  using either local search or a complete search strategy such as branch and bound. rather than pursuing this direction of resolving the problems with wlo  we select another approach  based on an algorithm that interleaves flexible assignment with propagation using wlo. 
1 	an algorithm for pareto optimization 
the proposed solution is based on the intuition that if a constraint solver using wlo could iteratively  ignore  the weakest link values  i.e. the values that contributed to the global solution evaluation  then it could eventually recognize solutions that dominate others in the pareto sense. for example  in the rover planning problem illustrated earlier  if the weakest link value of the global solution could be  ignored   the 
wlo solver could recognize that a solution with the cpu on 

temporal reasoning 	1    'this phenomenon is often referred to in the literature as the  drowning effect.*' 

figure 1: stpp solver wlo+ returns a solution in the pareto optimal set of solutions 
for 1 time unit during the second instrument event is to be preferred to one where the cpu is on for 1 or 1 time units. 
　we formalize this intuition by a procedure wherein the original stpp is transformed by iteratively selecting what we shall refer to as a weakest link constraint  changing the constraint in such a way that it can effectively be  ignored   and solving the transformed problem. a weakest link  soft  constraint for a wlo set of solutions is one in which the preference value of its duration in all the wlo solutions is the same as the chop level v of the optimal stp using wlo. for example  after applying wlo to the problem in figure 1  the cpu duration constraint associated with the first sensing event will be a weakest link  since it now has a fixed preference value of -1. however  the cpu constraint for the second event will not be a weakest link since its preference value can still vary from -1 to -1. 
　we also define a weakest link constraint to be open if v is not the  best  preference value  i.e.   where 1 is the designated  best  value among the values in the semi-ring . 
　formalizing the process of  ignoring  weakest link values is a two-step process of restricting the weakest links to their intervals of optimal temporal values  while eliminating their wlo restraining influence by resetting their preferences to a single   best  value. formally  the process consists of: 
  squeezing the temporal domain to include all and only those values which are optimally preferred; and 
  replacing the preference function by one that assigns the most preferred value  i.e. 1  to each element in the new domain. 
the first step ensures that only the best temporal values are part of any solution  and the second step allows wlo to be re-applied to eliminate pareto-dominated solutions from the remaining solution space. 
　the algorithm wlo+  figure 1  returns a simple temporal problem  stp  whose solutions are contained in the wlo-optimal  parcto-optimal solutions to the original stpp  p. where c is a set of soft constraints  the stpp is solved  step 1  using the chopping approach described earlier. in step 1  we denote the soft constraint that results from 
the two-step process described above as where  is the interval of temporal values that are 

figure 1: relationships between solution spaces for stpps that are wlo or pareto optimal 
optimally preferred  and fbest is the preference function such that for any input value v. notice that the run time of times the time it takes to execute 
solve v  cp   which is a polynomial. 
　we now proceed to prove the main result  in two steps. in this section we assume the existence of weakest links at every iteration of the  algorithm  and show that the subset of solutions of the input stpp returned by  is contained in the intersection of wlo-optimal and pareto-optimal solutions. in the next section we show that  given additional restrictions on the shape of the preference functions  such weakest links can be shown to always exist. 
given an stpp p  let  be 
 the set of wlo-optimal  respectively  pareto-optimal  solutions of p  and let 
proof: 
   first note that after an open weakest link is processed in steps  1  to  1   it will never again be an open weakest link  since its preference is reset to  since the theorem assumes a weakest link constraint is found at each stage of  the algorithm will terminate when the weakest link constraint is not open  i.e.  when all the soft constraints in cp have wlo preferences that equal the best  1  value. 
　now assume s since the first iteration reduces the set of solutions of  v  cp  to and each subsequent iteration either leaves the set unchanged or reduces it further  it follows that .s  now suppose  then s must be dominated by a pareto optimal solution .s'. let c be a soft constraint in c for which  is superior to s. thus  the preference value of the dura-
tion assigned by s to c cannot be 1. it follows that at some point during the course of the algorithm  c must become an open weakest link. since s is in  it survives until then  and so it must provide a value for c that is equal to the chop level. however  since s' dominates s  s' must also survive until then. but this contradicts the assumption that c is a weakest link constraint  since s' has a value greater than the wlo chop level. hence  s is in  and so in 
　next suppose the original stpp p has at least one solution. to see that is nonempty  observe that the modifications in steps  1  to  1   while stripping out solutions 

1 	temporal reasoning stp p is defined in terms of an assignment to each variable  it also determines a value  for each edge e  given by  =  where x and y are the start and end variables 
of r  respectively. we will use this notation in what follows. 
now consider any consistent stp p. the minimal net-
	figure 1: a unique wlo+ solution. 	work  dechter et al.  1 corresponding to p is another stp 
                                                           p'. the constraints between any two points x and y in p' are that are not wlo optimal with respect to  do retain formed by intersecting the constraints induced by all possible all the wlo optimal solutions. clearly  if there is any so- paths between x and y in p. 
lution  there is a wlo optimal one. thus  if the in in the following  a preference function / is said to be conany iteration has a solution  the in the next iteration vex if  is a convex set. the claim of the will also have a solution. since we are assuming the first existence of weakest links can be stated as follows: 
 -  v  c   has a solution  it follows by induction 
theorem 1 let p be an stpp with continuous domains and 
is nonempty.  convex preference functions. then there will he at least one 
　the theorem shows that it is possible to maintain the weakest link constraint for the wlo optimal set of solutions. tractability of wlo-based optimization while overcoming some of the restrictions it imposes. in particular  it is pos- proof: 
sible to improve the quality of the flexible solutions gener- consider the  minimal  stp  that corresponds to the ated within an stpp framework from being wlo optimal to optimal chopping level for p  as described in the wlo algo-
being pareto optimal. 	rithm . suppose there is no weakest link constraint. then for 
　although the algorithm determines a nonempty set of so- each edge constraint c there is a solution  such that lutions that are both wlo optimal and pareto optimal  the set  where / is the preference function for the might not include all such solutions. consider the example edge.1 in figure 1. assume the preference function for all soft con- let s be the average of all the sc solutions  i.e. 
straints is given by / t  = t  i.e.  longer durations are preferred  signified by the max label on the edges . the algorithm will retain a single solution where bc and cd are both 1. however  the solution where bc = 1 and cd = 1  which is excluded  is also both pareto optimal and wlo optimal.  note that ab  with a fixed value of 1  is the weakest link.  
　many optimization schemes seek what is known as utilitarian optimality  where the objective is to maximize the sum of the local preferences. however  the wlo+ solutions are not necessarily utilitarian optimal with respect to all solutions or even the wlo solutions. for example  in figure 1  if the preference function is f t  -  a utilitarian optimal wlo solution would be given by bc - 1 and cd = 1  but will still return the solution where bc and cd are both 1. 
　we can summarize the position taken in this paper by saying that utilitarian strategies  while attractive in many ways  are apparently intractable. the  approach provides 
some of the same benefit at lower cost. for example  noncompeting constraints are fully optimized by for competing constraints  tends to divide the preferences as equally as possible. in some applications  this might be more desirable than a utilitarian allocation. the operations in the wlo+ algorithm preserve the convexity property of the preference functions. each stage of 
1 	existence of weakest links 	repeats a wlo calculation. thus  theorem 1 implies 
in this section we show that under suitable conditions  a corollary 1 suppose p is an stpp with continuous doweakest link constraint always exists. this involves a mains and convex preference functions. then a weakest link stronger requirement than for wlo: the preference functions is found at each iteration of  must be convex  not merely semi-convex. this would include 
an example of why the existence result does not apply more 
linear functions  cycloids  and upward-pointing parabolas  for generally to semi-convex functions is found in figure 1. the example  but not gaussian curves  or step functions.  later on  we will see this requirement can be relaxed somewhat so 1to avoid excessive subscripting  we suppress the implied e subthat gaussians can be permitted.  script on / here and in what follows. in all cases  the applicable 
	before proceeding  we note that while a solution .s of an 	preference function will be clear from the context. 
temporal reasoning 	1 


figure 1: an stpp with no weakest link 
stpp in the figure contains two semi-convex step-like functions with optimal preference values associated with durations t and t'. assume the stpp is minimal  and that the assignment e = t  e' = t' is inconsistent. then the highest possible chop point is p  and no weakest link exists  i.e.  for neither e nor e' is it the case that  for every solution s  p is the value returned by the preference function associated with that constraint for the duration assigned by s. 
1 	discussion and related work 
an examination of the proof of theorem 1 shows that the weakest link constraint exists under a somewhat less restrictive condition than convexity: it is enough  assuming semiconvexity  to require that plateaus  subintervals of non-zero length where the preference function is constant  can only occur at the global maximum of the preference function. this means  for example  that the theorem is applicable in principle to any semi-convex smooth function such as a gaussian curve. 
　however  in the practical setting of a computer program where numbers are computed to a finite precision and continuous curves are approximated  some adjustments may need to be made. note that a representation as a discretized step function does not satisfy the no-plateau condition. an alternative is to treat a discretized function as corresponding to a piecewise linear function where the linear segments join successive points on the discretized graph. even there  the long tails of a gaussian curve may get approximated by horizontal segments. however  generally we can trim the domain of the curve to eliminate the flat tails without excluding all the solutions. in that case  the discretized gaussian is acceptable.  note that figure 1 could be simulated by an example involving extreme gaussians where the tails are essential for the solution.  
　note that preferences such as longest or shortest durations  or closest to a fixed time  which appear to be the most useful in practice  can be easily modeled within this framework. 
　wlo+ has been implemented and tested on randomly generated problems  where each semi-convex preference function is a quadratic with randomly selected parameters and a 1. we compared the best solution found after applying wlo+ with the quality of the earliest solution found using the chop solver  using the utilitarian measure of quality  i.e.  summing preference values . an average improvement of between 1 and 1% was observed  depending on constraint density  more improvement on lower density problems . future research will focus on the application of wlo+ to the rover science planning domain. 
　the results described here are clearly relevant to any effort whose objective is representing and reasoning about preferences and utility. a detailed survey of this vast literature is clearly beyond our scope; here we provide pointers to work that exhibits significant overlap. first  the idea of extending csps to solve multi-criteria optimization problems is proposed in  torrens and faltings   1 ; this work also uses pareto-optimaiity as a criterion for ordering solutions. second  the idea of applying the notion of degrees of satisfaction to solving temporal reasoning problems has been applied previously  dubois and prade   1 . third  a number of graphical-based representations of local preferences have appeared; in  bacchus and grove   1   for example  an approach is taken based on drawing connections between preferences and probabilities  as expressed in a bayesian network. finally  for a survey of al-based approaches to preferences and utility  with an emphasis on qualitative approaches  the reader is referred to  doyle and thomason   1 . 
1 	summary 
this paper has presented a reformulation of problems in the optimization of temporal preferences using a generalization of temporal csps. the practical context from which this effort arose is temporal decision-making in planning  where associated with domains representing temporal distances between events is a function expressing preferences for some temporal values over others. the work here extends previous work by overcoming limitations in the approach that arose when considerations of efficiency in reasoning with preferences resulted in coarseness in the evaluation procedure for global temporal assignments. 
references 
 bistarelli et al.  1  s. bistarelli  u. montanari  and f. rossi. semiring-based constraint solving and optimization. journal of the acm  1 : 1  march 1. 
 bacchus and grove   1  f. bacchus and a. grove. graphical models of preferences and utility. proceedings of the eleventh conference on uncertainty in artificial intelligence  1  morgan kaufmann  1. 
 cormen et a/.  1  t.h. cormen  c.e. leiserson  and r.l. rivest. introduction to algorithms. mit press  cambridge  ma  1. 
 dcchter et al  1  r. dechter  i. meiri  and j. pearl. temporal constraint networks. artificial intelligence  1  1  1. 
 doyle and thomason   1  j. doyle and r. thomason. background to qualitative decision theory. ai magazine  1  summer  1. 
 dubois and prade   1  d. dubois and h. prade. processing fuzzy temporal knowledge. ieee transactions on systems  man  and cybernetics  1   1. 
 khatib et al. 1  l. khatib  p. morris  r. morris and f. rossi. temporal reasoning about preferences. in proceedings of ijcai-1. morgan kaufman  1. 
 torrens and faltings   1  m. torrens and b. faltings. using soft csps for approximating pareto-optimal solution sets. 
in aaai workshop proceedings p