
current research on qualitative spatial representation and reasoning usually focuses on one single aspect of space. however  in real world applications  several aspects are often involved together. this paper extends the well-known rcc1 constraint language to deal with both topological and directional information  and then investigates the interaction between the two kinds of information. given a topological  rcc1  constraint network and a directional constraint network  we ask when the joint network is satisfiable. we show that when the topological network is over one of the three maximal tractable subclasses of rcc1  the problem can be reduced into satisfiability problems in the rcc1 algebra and the rectangle algebra  ra . therefore  reasoning techniques developed for rcc1 and ra can be used to solve the satisfiability problem of a joint network.
1 introduction
originating from allen's work on temporal interval algebra  ia   allen  1   the qualitative approach to temporal as well as spatial information is popular in artificial intelligence and related research fields. this is mainly because in many applications precise numerical information is usually unavailable or not necessary.
¡¡while allen's interval algebra is the principal formalism of qualitative temporal reasoning  there are more than a dozen of formalisms that deal with different aspects of space in qualitative spatial reasoning  qsr . spatial relations are usually classified as topological  directional  and metric. metric relations have a nature of semi-quantitative and fuzziness. in this paper  we are concerned with topological and directional relations between plane regions.
¡¡most earlier research on topological and directional relations focuses on one single aspect. the most influential formalism for topological relations is the region connection calculus  rcc   randell et al.  1 . as for directional relations  there are several well-known formalisms  e.g.  frank  1; goyal and egenhofer  1 .
¡¡in natural language and many practical applications  topological and directional relations are used together. for example  when describing the location of titisee  a famous tourist sight in germany  we might say  titisee is in the black forest and is east of the town of freiburg. 
¡¡in this paper we extend the rcc1 constraint language to deal with topological as well as directional information. we first formalize the four cardinal directional relations between plane regions  viz. west  east  north  south  and then define nine basic relations by using the usual relational operations of intersection and complementation.
¡¡an important reasoning problems is to decide when a network of topological and directional constraints is satisfiable  or consistent . given a network of topological  rcc1  constraints ¦¨ and a network of directional constraints ¦¤  we try to decide when the joint network  is satisfiable.
¡¡since topological and directional information is not independent   may be unsatisfiable despite that both ¦¨ and ¦¤ are satisfiable. our main result states that  if topological constraints are all in one of the three maximal tractable subclasses of rcc1  renz  1   then the satisfiability of the joint network can be determined by considering the satisfiability of two related networks in  resp.  rcc1 and the rectangle algebra  ra   where ra is the two-dimensional counterpart of ia  balbiani et al.  1 .
¡¡the rest of this paper proceeds as follows. section 1 introduces basic notions and well-known examples of qualitative calculi. the cardinal direction calculus dir1 is introduced in section 1. section 1 describes and proves the main result. a new subclass  amax  of ia is identified  which is closed under converse  intersection  and composition. we show satisfiable interval networks over amax has a maximal instantiation in the sense of  ligozat  1 . section 1 concludes the paper.
1 qualitative calculi
the establishment of a proper qualitative calculus is the key to the success of the qualitative approach to temporal and spatial reasoning. this section introduces basic notions and examples of qualitative calculi  cf.  ligozat and renz  1  .
1 basic notions
let u be the universe of temporal/spatial/spatial-temporalentities  and set rel u  to be the set of binary relations on u. with the usual relational operations of intersection  union  and complement  rel u  is a boolean algebra.
¡¡a finite set b of nonempty relations on u is jointly exhaustive and pairwise disjoint  jepd for short  if any two entities in u are related by one and only one relations in b. write b for the subalgebra of rel u  generated by b. clearly  relations in b are atoms in the algebra b. we call b a qualitative calculus on u  and call relations in b basic relations of the calculus.
¡¡there are several general  but optional  restrictions on the choice of b. write idu for the identity relation on u. for a relation ¦Á ¡Ê rel u   write ¦Á¡« for the converse of ¦Á  which is defined as  x y  ¡Ê ¦Á¡« iff  y x  ¡Ê ¦Á. many qualitative calculi require the identity relation idu to be a basic relation. in this paper  we relax this restriction  and require that  i  idu is contained in one basic relation; and  ii  b is closed under converse  i.e. if ¦Á is a basic relation  then so is ¦Á¡«.
¡¡note that the composition of two relations in b is not necessarily in b. for  the weak composition  ligozat and renz  1  of ¦Á and ¦Â  written as ¦Á  w ¦Â  is defined to be the smallest relation in b which contains ¦Á ¦Â.
¡¡an important reasoning problem in a qualitative calculus is to determine the satisfiability or consistency of a network ¦£ of constraints of the form x¦Ãy  where ¦Ã is a relation in b. a constraint network ¦£ = {vi¦Ãijvj}ni j=1 is satisfiable  or consistent  if there is an instantiation {ai}ni=1 in u such that  ai aj  ¡Ê ¦Ãij holds for all 1 ¡Ü i j ¡Ü n.
¡¡consistency of a network can be approximated by using an o n1  time path-consistency algorithm  pca . a network ¦£ = {vi¦Ãijvj}ni j=1 is path-consistent if  i  ¦Ãii is the basic relation in b that contains; and  iii  ¦Ãij   ¦Ãik  w ¦Ãkj for all i j k.
¡¡the essence of a pca is to apply the following rules for any three i j k until the network is stable.
¦Ãij¡û¦Ãij ¡É ¦Ãji¡« 1 ¦Ãij¡û¦Ãij ¡É ¦Ãik  w ¦Ãkj 1 if the empty relation occurs during the process  then the network is inconsistent  otherwise the resulting network is pathconsistent.
1 interval algebra and rectangle algebra
the interval algebra ia  allen  1  is generated by a set bint of 1 basic relations between time intervals  see table 1 . ia is closed undercomposition i.e. the compositionof any two interval relations is in ia. nebel and bu¡§rckert  nebel and bu¡§rckert  1  identified a maximal tractable subclass h of ia  called ord-horn subclass  and showed that applying pca is sufficient for deciding satisfiability for h.
¡¡ligozat  ligozat  1  introduced a partial order   on bint  see fig. 1   and termed  the interval lattice. for ¦Á ¦Â ¡Ê bint  we write  ¦Á ¦Â  for the union of relations between ¦Á and ¦Â. note that  ¦Á ¦Â  is nonempty iff. for example   o  oi  is the relation ¡È{o  s  f  d  eq  di  fi  si  oi}. an interval relation is called convex if it is of the form  ¦Á ¦Â  table 1: the set of basic interval relations bint  where x =  x  x+  y =  y  y+  are two intervals.
relationsymb.conv.meaningdimprecedesppix+ y 1meetsmmix+=y 1overlapsooix  y+ x+ y+1startsssix =y  x+ y+1duringddix  y  y+ x+1finishesffiy  x  x+=y+1equalseqeqx =y  x+=y+1pi

mi

di 
oi
  
fi  f
  
      p m o s d
figure 1: the interval lattice .
with ¦Á ¦Â ¡Ê bint. for ¦Á ¡Ê bint  dim ¦Á   the dimension of ¦Á  is defined  ligozat  1   see table 1 . the dimension of a non-basic relation is the maximal dimension of its basic relations.
¡¡the following convex relations are of particular importance in this paper:
=¡È{m  o  s  f  d  eq  di  fi  si  oi  mi} 1 =¡È{s  d  eq  f} 1 =¡È{fi  di  eq  si} 1 ¡¡the rectangle algebra  ra  is the two-dimensional counterpart of ia. ra is generated by a set of 1 jepd relations between rectangles.1 write brec for this set  i.e.
	brec = {¦Á   ¦Â : ¦Á ¦Â ¡Ê bint}	 1 
¡¡for a rectangle r  write ix r  and iy r  as  resp.  the xand y-projection of r. the basic rectangle relation between two rectangles a b is ¦Á   ¦Â iff  ix a  ix b   ¡Ê ¦Á and  iy a  iy b   ¡Ê ¦Â. the dimension of a basic rectangle relation ¦Á   ¦Â is defined as dim ¦Á   ¦Â  = dim ¦Á  + dim ¦Â . the dimension of a non-basic rectangle relation is defined to be the maximal dimension of its basic relations.
¡¡note that if s is a tractable subclass of ia  then s   s = {¦Á   ¦Â : ¦Á ¦Â ¡Ê s} is also tractable in ra. a tractable subclass of ra larger than h   h is also obtained in  balbiani et al.  1   where h is the ord-horn subclass of ia.
table 1: the set of rcc1 basic relations btop  where a b are two plane regions and a  and b  are  resp.  their interiors.
relationsymb.meaningequalseqdisconnecteddcexternally connectedecpartially overlappotangential proper parttppnon-tangential proper partntpp1 rcc1 algebra
a plane region  or region  is a nonempty regular closed subset of the real plane. the relations in table 1 and the converses of tpp and ntpp form a jepd set  randell et al.  1 . these are rcc1 basic relations. write btop for this set. the rcc1 algebra is. we write p and pp  resp.  for tpp ¡È ntpp ¡È eq and tpp ¡È ntpp.
¡¡renz  renz  1  showed that there are only three maximal tractable subclasses of rcc1 that contain all basic relations. these subclasses are denoted as. for these subclasses  applying pca is sufficient for deciding the satisfiability of a network  and there is an o n1  algorithm for finding an atomic refinement of any path-consistent network.
1 the cardinal direction calculus dir1
for a bounded plane region a  define supx a  = sup{x ¡Ê r :   y  x y  ¡Ê a}  infx a  = inf{x ¡Ê r :   y  x y  ¡Ê a}. the definitions of infy a  and supy a  are similar. we call m a  = ix a ¡Áiy a  the minimum bounding rectangle  mbr  of a  where ix a  =  infx a  supx a   and iy a  =  infy a  supy a   are the x- and y-projection of a.
¡¡for two bounded plane regions a b  if supx a    infx b   then we say a is west of b and b is east of a  written as awb and bea; and if supy a    infy b  then we say a is south of b and b is north of a  written as asb and bna. when a is neither west nor east of b  then
 . in this case  we say a is in x-contact with b  written as acxb. similarly  if a is neither north nor south of b  then we say a is in y-contact with b  written as acyb.
¡¡the boolean algebra generated by n s w e  written as dir1  has nine atoms  see table 1 . although it is very simple  dir1 is sufficient for expressing directional information in many situations. moreover  dir1 is a subclass of ra.
remark 1. let bint1 be the jepd set. the algebra  is in fact the interval algebra a1 studied in  golumbic and shamir  1 . let  where  is the universal relation. note that h1 = a1 ¡É h. golumbic and shamir proved that h1 is a maximal tractable subclass of a1. since a1 a1 is exactly dir1  see table 1   h1 h1 is a tractable subclass of dir1 it will be our future work to find maximal tractable subclasses of dir1.
table 1: nine cardinal directional relations  where a b are two bounded plane regions.
relationsymb.meaningranorthwestnwanb and awbp   pinorth and x-contactncanb and acxb  pinortheastneanb and aebpi   piy-contact and westcwacyb and awbp  y-contact and x-contactccacyb and acxb y-contact and eastceacyb and aebpi  southwestswasb and awbp   psouth and x-contactscasb and acxb  psoutheastseasb and aebpi   p1 main result
suppose v = {vi}ni is a collection of spatial variables   are  resp.  a topological  rcc1  and a directional  dir1  constraint network over v . our problem is when the joint network  is satisfiable.
¡¡without loss of generality  in this section we assume  i  ¦Èii = eq for all i and eq for all; and  ii  ¦Äii = cc and ¦Äij = ¦Äji¡« for all i j.
¡¡the following example shows that topological and directional constraints are not independent.
example 1. let v = {v1 v1}  ¦È1 = ec  ¦Ä1 = nc.
both ¦¨ and ¦¤ are trivially satisfiable. for any two regions a b  if aecb  then bywe know  hence ancb cannot hold. therefore  is inconsistent.

¡¡given ¦¨ and ¦¤  we define an rcc1 network ¦¨ and an ra network ¦¤ as follows:
dc 	if cc ¡É ¦Äij =  ; otherwise.
	eq 	if ¦Èij = eq;
	 	if eqp;
	 	if eq  p¡«;
          	if dc ¡É ¦Èij =  ;  ¦Äij 	otherwise.
note that ¦Èij   ¦Èij and ¦Äij   ¦Äij for any two i j. this means

¦¨ is a refinement of ¦¨ and ¦¤ is a refinement of ¦¤  in ra .
lemma 1.  is satisfiable iff  is satisfiable.

as for example 1  by ¦Ä1 = nc we know ¦È1 = ec ¡É
dc =  . therefore the joint network is inconsistent.
¡¡the main contribution of this paper is to show that if ¦¨ is a path-consistent rcc1 network over one of the three maximal tractable subclasses of rcc1  viz.  then  is satisfiable iff ¦¨ and ¦¤ are satisfiable.
to prove this result  we need two further lemmas.
for r =  x  x+  ¡Á  y  y+  and  we write
for . for two rectangles r1 r1  if no edges of r1 are in line with any edge of r1  then we can expand the two rectangles a little without changing their rectangle relation. in general  we have
lemma 1. let be a collection of rectangles  where no two points in either x =  are identical. set  to
be the smaller one of 
. suppose {ai}ni=1 is a
collection of bounded plane regions such that ri   m ai   
. then the basic rectangle relation between m ai  and m aj  is the same as that between ri and rj for any i j.
¡¡for an rcc1 basic network ¦¨ and a collection of rectangles is in a sense 'compatible' with ¦¨  then a realization can be foundsuch that m ai   is almost identical with ri for each i.
definition 1. a collection of rectangles are compatible with an rcc1 basic network ¦¨ = {vi¦Èijvj}ni j=1 if for any i j we have
  if ¦Èij = eq  then ri = rj;
dc  then ri ¡É rj is a rectangle  i.e. the interior of ri ¡É rj is nonempty;
  if ¦Èij   pp  then ri is contained in the interior of rj.
lemma 1. let ¦¨ = {vi¦Èijvj}ni j=1 be a satisfiable rcc1 basic network. suppose is a collection of rectangles that are compatible with ¦¨. then we have a realization such that each ai  is a bounded region and
  where is the positive number
as defined in lemma 1.
proof. the proofis similar to that given for rcc1  cf.  renz  1; li  1b; li and wang  1  . first  we define l i   the ntpp-level of vi  inductively as follows:
  l i  = 1 if there is no j such that ¦Èji = ntpp;
  l i  = k + 1 if there is a variable vj such that  a  l j  = k and ¦Èji = ntpp  and  b  ¦Èmi = ntpp implies l m  ¡Ü k for any variable vm.
¡¡write eik  k = 1 ¡¤¡¤¡¤  1  for the four corner points of ri.  or po  then choose two new points pij and pji in the interior of ri ¡É rj. set n to be the set of these points  and set ¦Ä to be the smallest distance between two points in n. clearly . for each point p in n  construct a system of squares {p  p+ p 1  ¡¤¡¤¡¤  p n } as in
fig. 1  where p n  is a square centered at p with the length of ¦Ä/1  and p  and p+ are two smaller squares that meet at p.
now we construct n bounded regions as follows.
;
 :
¡¡¦Èij = po}; is tpp or ntpp};  and   j  ¦Èji	=
ntpp and.
. moreover  we have ri  
now we prove our main result.
theorem 1. let ¦¨ be a path-consistentrcc1 network over
   and let ¦¤ be a dir1 network. then  is satisfiable iff ¦¨ and ¦¤ are satisfiable.

figure 1: an illustration of the ntpp-chain centered at pij.
proof. we take as an example. the proofs for the other two maximal tractable subclasses are similar.
¡¡suppose ¦¨ and are satisfiable. since ¦¨ is a pathconsistent network over h1  we can construct an atomic rcc1 network ¦¨  as follows  renz  1 .
  if dc   ¦Èij  then set ¦Èij  = dc;
  else if ec   ¦Èij  then set ¦Èij  = ec;
  else if po   ¦Èij  then set ¦Èij  = po;
  else if tpp   ¦Èij  then set ¦Èij  = tpp;
  else if ¦Èij = ntpp then set ¦Èij  = ntpp;
  else if tpp¡«   ¦Èij then set ¦Èij  = tpp¡«;
  else if ¦Èij = ntpp¡« then set ¦Èij  = ntpp¡«.
byfor any i j  we know ¦¨  is an atomic refinement of ¦¨ and ¦¨. moreover  for any two i j  ¦Èij   p iff ¦Èij    p.

¡¡we claim that the satisfiable ra network ¦¤ has a realization that is compatible with ¦¨ . in other words  ¦¨  and {ri} satisfy the conditions of lemma 1. since the proof is quite complex  we defer it to the next subsection.
¡¡now  by lemma 1 we can find a realization of ¦¨  such that. by lemma 1  {ci} is
also a realization of ¦¤. therefore   is satisfiable.	
¡¡recall that applying pca is sufficient for deciding satissubclass h   h. we have the following corollary  where h1 fiability for rcc1 subclasses h1  c1  and q1  and for ra
is defined in remark 1.
corollary 1. let ¦¨ be an rcc1 network over either one of
  and let ¦¤ be a dir1 network over h1 h1. then deciding the satisfiability of  is of cubic complexity.

proof. it is of quadratic complexity to compute ¦¨ and ¦¤.
note that ¦¤ is a rectangle network over amax amax   h  h  and applying pca to ¦¨ and ¦¤ is of cubic complexity. 
¡¡the next example shows  however  if ¦¨ is not over any one of  and q1  then the result may not hold.
example 1. let v = {v1 v1 v1}  ¦È1 = ¦È1 = dc  ¦È1 = tpp ¡È tpp¡«  ¦Ä1 = nc  ¦Ä1 = cw  ¦Ä1 = cc. both ¦¨ and ¦¤ are satisfiable  but not .
1 maximal instantiation of rectangle networks

for an rcc1 network ¦¨ and a dir1 network ¦¤  suppose ¦¨ and ¦¤ are satisfiable  and ¦¨  is the atomic refinement of ¦¨ constructed in the proof of theorem 1. we show ¦¤ has a rectangle realization that is compatible with ¦¨ . we first define an auxiliary subclass amax of ia.
definition 1. an interval relation ¦Á is in amax if
  ¦Á is convex;
  m   ¦Á only if o   ¦Á  and mi   ¦Á only if oi   ¦Á;
  s   ¦Á only if d   ¦Á  and si   ¦Á only if di   ¦Á;
  f   ¦Á only if d   ¦Á  and fi   ¦Á only if di   ¦Á.
note that all amax relations except eq are of dimension 1.
¡¡by the definition of amax  it is easy to see that amax is closed under converse and intersection. the following lemma further asserts that amax is closed under composition.
lemma 1. if ¦Á ¦Â ¡Ê amax  then ¦Á   ¦Â ¡Ê amax.
proof.  sketch.  since the composition of two convex relations is still convex  ¦Á   ¦Â is convex too.
¡¡if m   ¦Á   ¦Â  then there exist two basic relations a b such that a   ¦Á  b   ¦Â  and m   a   b. by checking the composition table of ia  allen  1   we have o iff  i  a = m and b ¡Ê {s  eq  si}; or  ii  a ¡Ê {f  eq  fi} and b = m.
by a   ¦Á ¡Ê amax and b   ¦Â ¡Ê amax  we know o   ¦Á or o   ¦Â. by the composition table we have o   o   b or o   a   o  hence o   ¦Á   ¦Â. this means m   ¦Á   ¦Â only if o   ¦Á   ¦Â. symmetrically  we can show mi   ¦Á   ¦Â only if oi   ¦Á   ¦Â. the proofs for the remaining four cases are similar. in this way we know ¦Á   ¦Â is also in amax. 
¡¡we next characterize when a composition of two relations in amax can contain eq.
lemma 1. for two interval relations ¦Á ¦Â ¡Ê amax  if eq ¦Á   ¦Â  then eq   ¦Á ¡É ¦Â or  o  oi    ¦Á   ¦Â.
proof. by lemma 1 we know ¦Á   ¦Â is in amax. if eq ¡Ê ¦Á ¦Â  then there exist two basic relations a b such that a   ¦Á  b   ¦Â  and eq   a   b. this is possible iff b is the converse of a. suppose eq. there are two possible situations. if a ¡Ê {p  o  d  di  oi  pi}  then by the composition table we know  o  oi    a   b. if a ¡Ê {m  s  f  fi  si  mi}  then a   b is f ¡È eq ¡È fi or s ¡È eq ¡È si. since ¦Á   ¦Â ¡Ê amax  we know d  di are contained in ¦Á ¦Â. checking fig. 1  we know  o  oi  is the smallest convex relation which contains both d and di. therefore  o  oi  is contained in the convex relation ¦Á ¦Â. 
¡¡the following lemma characterizes when an eq relation can be obtained as the intersection of two relations in amax.
lemma 1. for two amax relations eq andeq  if ¦Á ¡É ¦Â = eq  then ¦Á = ¦Â¡« and ¦Á is either  or .
proof. if ¦Á is neither   then  o  oi  is contained in ¦Á. note that in this case  by ¦Á ¡É ¦Â = eq  we have ¦Â = eq. this is a contradiction. so ¦Á is  or . the same conclusion also holds for ¦Â. clearly  ¦Á is the converse of ¦Â.	
¡¡we will next show when a  or  relation can be generated by the composition of two amax relations.
lemma 1. for two amax relations eq and eq  if ¦Á   ¦Â =  then ¦Á = ¦Â =; if  then.
proof. by lemma 1 we know eq   ¦Á ¡É ¦Â. since ¦Á is not eq  either  or  is contained in ¦Á. the same conclusion holds for ¦Â. by ¦Á   ¦Â = and eq   ¦Á ¡É ¦Â  we know ¦Á and ¦Â can only be .	
as a corollary of the above two lemmas  we have
 corollary 1. for three amax relations eq  is .
¡¡since  o  oi  is the smallest convex relation in amax which strictly contains   we have the following result.
lemma 1. for ¦Á ¦Â ¡Ê amax  if ¦Á ¡É ¦Â =  then either one is ; if ¦Á ¡É ¦Â =  then either one is .
¡¡let ¦£ = {vi¦Ãijvj}ni j=1 be a rectangle  or interval  network  and let be a realization of ¦£. we say {ai} is a maximal instantiation of ¦£ iff dim ¦Ãij  is equal to the dimension of the basic relation between ai and aj for all i j  ligozat  1; balbiani et al.  1 .
theorem 1   ligozat  1  . let ¦« be an interval network that contains only preconvex relations. if ¦« is pathconsistent  then there is a maximal instantiation of ¦«.1
¡¡the path-consistency condition in the above theorem is necessary. for example  if ¦« is the constraint network {x 
  then ¦« is satisfiable but has no maximal instantiation: by applying pca we obtain x eq y eq z eq x.
¡¡but when only relations in amax are concerned  we have the following result.
theorem 1. let ¦« be an interval network that contains only relations in amax. suppose ¦« is satisfiable and for all i j k we have  a  ¦Ëij = eq iff i = j;  b  ¦Ëij = ¦Ëji¡«;  c 
. then ¦« has a maximal instan-
tiation.
proof. suppose by applying pca the network will be stable after m steps. we prove by induction that at no step this introduces new  or eq constraints. this means that  for each step 1 ¡Ü p ¡Ü m only if ¦Ëpij = ¦Ëij  where ¦Ëpij is the relation between xi and xj after the p-th step. suppose this holds for p ¡Ý 1. we show it holds for step p + 1. note that ¦Ëpij+1 = ¦Ëpij ¡É ¦Ëpik   ¦Ëpkj for some k or ¦Ëpij+1 = ¦Ëpij ¡É ¦Ëpji¡«. we take the first case as an example.
¡¡if ¦Ëpij+1 = eq  then by corollary 1 we know ¦Ëpik = ¦Ëpkj = ¦Ëpij¡« is  or . by the induction hypothesis we know ¦Ëik = ¦Ëkj = ¦Ëji are all  or . this contradicts the third condition.
therefore.
if  ¦Ëpij  then by lemma 1 we have ¦Ëpik  
. but according to lemma 1  this is possible iff both ¦Ëpik and ¦Ëpkj are . by the induction hypothesis and the third condition  we know ¦Ëik = ¦Ëkj = and ¦Ëij =. this is a contradiction. hence.
similarly  we can show that if  then.
¡¡now  since ¦« is satisfiable  applying pca on ¦« will obtain a path-consistent network ¦«   which is still over amax and satisfies the following condition: for any  ¦Ëij  is contained in ¦Ëij and of dimension 1. by theorem 1 we know ¦«   hence ¦«  has a maximal instantiation. 
since each   is of dimension 1  by the above
theorem  we know ¦« has a realization such that xi   x+i   xj   x+j are different for any.
theorem 1. suppose ¦¨ is an rcc1 network  and ¦¤ is a dir1 network. if ¦¤ is satisfiable  then ¦¤ has a maximal instantiation.
proof. suppose is a realization of ¦¤. define an interval network  as follows. for all i set eq. for all then
; otherwise  set to be the basic dir1 relation in which ai and aj are related.
we note that ¦¤ satisfies  i ;
kj	.
¡¡moreover  each has the form ¦Ëxij   ¦Ëyij  where ¦Ëxij ¦Ëyij are interval relations in amax. write ¦«x = {xi¦Ëxijxj}ni j=1 and ¦«y = {yi¦Ëyijyj}ni j=1. for all we have dim ¦Ëxij  = dim ¦Ëyij  = 1 and dim .
¡¡it is easy to see that ¦¤ is satisfiable iff both ¦«x and ¦«y are satisfiable. since they satisfy the conditions given in theorem 1  both ¦«x and ¦«y have maximal instantiations. suppose are  resp.  maximal instantiations of ¦«x and ¦«y. set ri = iix ¡Áiiy for i = 1 ¡¤¡¤¡¤  n. then is a rectangle realization of ¦¤  hence a realization of ¦¤ and ¦¤. for  the basic relation between ri and rj is of dimension 1. therefore i is maximal. 

¡¡by the definition of ¦¤ and the maximality of i  as constructed above   we know i is compatible with ¦¨ . theorem 1. suppose ¦¨ is a path-consistent rcc1 network let ¦¨  be the atom ic refinement of ¦¨ as in the proof of theoover either of h1  c1  q1  and suppose ¦¤ is a dir1 network.
rem 1. if ¦¨ and ¦¤ are satisfiable  then ¦¤ has a realization that is compatible with ¦¨ .
1 conclusion
in this paper  we have investigated the interaction between topological and directional constraints. we have showed that  for the three maximal tractable subclasses of rcc1  the problem of deciding the satisfiability of a joint network of topological and directional constraints can be reduced to two simple satisfiability problems in rcc1 and ra.
¡¡an earlier attempt to combiningtopologicaland directional information was reported in  li  1a   where we introduced a hybrid calculus that combines dir1 with rcc1. a preliminary result was obtained  which states that the consistency of atomic networks in the hybrid calculus can be decided in polynomial time.
¡¡sistla and yu  sistla and yu  1  considered a similar problem of reasoning about spatial relations in picture retrieval systems  where mereological relations inside  outside  overlaps  and directional relationsleft  above  behind are considered. the constraint languageconsidered there is rather restrictive. it can express neither genuine topological relations  e.g. tangential proper part and externally connected to  nor negations of some relations  e.g. neither left nor right .
