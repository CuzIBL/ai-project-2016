
coronary heart disease can be diagnosed by measuring and scoring regional motion of the heart wall in ultrasound images of the left ventricle  lv  of the heart. we describe a completely automated and robust technique that detects diseased hearts based on detection and automatic tracking of the endocardium and epicardium of the lv. the local wall regions and the entire heart are then classified as normal or abnormal based on the regional and global lv wall motion. in order to leverage structural information about the heart we applied bayesian networks to this problem  and learned the relations among the wall regions off of the data using a structure learning algorithm. we checked the validity of the obtained structure using anatomical knowledge of the heart and medical rules as described by doctors. the resultant bayesian network classifier depends only on a small subset of numerical features extracted from dual-contours tracked through time and selected using a filterbased approach. our numerical results confirm that our system is robust and accurate on echocardiograms collected in routine clinical practice at one hospital; our system is built to be used in real-time.
1	introduction
early detection  along with prevention  is an excellent way of controlling coronary heart disease  chd . chd  along with congestive heart failure  can be detected by measuring and scoring the regional and global motion of the left ventricle  lv  of the heart; chd typically results in wall-motion abnormalities  i.e.  local segments of the lv wall move abnormally  move weakly - known as hypokinesia  not at all known as akinesia  or out of sync with the rest of the heart known as dyskinesia   and sometimes motion in multiple regions  or the entire heart  is compromised. the lv can be imaged in a number of ways. the most common method is the echocardiogram - an ultrasound video of different 1-d crosssections of the lv. echocardiograms are unfortunately notoriously difficult to interpret  and even the best of physicians can misdiagnose heart disease. hence there is a tremendous need for an automated  second-reader  system that can provide objective diagnostic assistance  particularly to the lessexperienced cardiologist.
　in this paper  we address the task of building a computeraided diagnosis system that can automatically detect wallmotion abnormalities from echocardiograms. our goal is to develop a real-time system to assist physicians to interpret wall motion scores  and thereby reduce variability and improve diagnostic accuracy of wall motion analysis. section 1 provides some medical background on cardiac ultrasound and the standard methodology used by cardiologists to score wall-motion abnormalities. in section 1 we describe our real-life dataset  which consists of echocardiograms from leading healthcare institutions to diagnose wallmotion abnormalities. sections 1 and 1 provide an overview of our proposed system which we built on top of an algorithm that detects and tracks the inner and outer cardiac walls  georgescu et al.  1; zhou et al.  1; comaniciu  1; comaniciu et al.  1 . it consists of a classifier that classifies the local region of the heart wall  and the entire heart  as normal or abnormal based on the wall motion. we describe our methodology for feature selection and classification  followed in section 1 by our experimental results. we reference some related work in section 1  and conclude with some thoughts about our plans for future research in section 1.
1	medical background knowledge
1	what is coronary artery disease 
coronary artery disease  cad  results from the development of plaque within one or several of the arteries that feed the muscle surrounding the left ventricle of the heart. early signs of cad include perfusion abnormalities which would indicate the lack of oxygenated blood going to tissue. as cad progresses  it will manifest itself as wall motion abnormalities  which can be detected by echocardiography. finally  cad will lead to angina  or chest pain. this changing manifestation of cad is described by picano et al.  picano et al.  1; picano  1  as the  ischemic cascade . accurate regional wall motion analysis of the lv is an essential component of interpreting echos to detect this effect  particularly for early disease.
　heart disease has no gender  geographicor socio-economic boundaries. cardiovascular disease  cvd  is a global epidemic that is the leading cause of death worldwide  1 mil. deaths per year   world health organization  1 . since 1  cvd has been the no. 1 killer in the usa every year except 1. it claims more lives each year than the next 1 leading causes of death combined  which are cancer  chronic lower respiratory diseases  accidents  and diabetes mellitus  american heart association  1 . coronary heart disease  chd  accounts for more than half the cvd deaths  roughly 1 mil. deaths worldwide every year  and 1 of every 1 deaths in the us   and is the single largest killer in the world. accurate early diagnosis of chd - primarily with cardiac ultrasound - has been identified as a critical factor in improving patient outcomes for chd.
1	divisions of the heart
there are many imaging modalities that have been used to measure myocardial perfusion  left ventricular function  and coronary anatomy for clinical management and research; for this project we chose to use echocardiography. the cardiac imaging committee of the council on clinical cardiology of the american heart association has created a standardized recommendation for the orientation of the heart  angle selection and names for cardiac planes and number of myocardial segments  cerqueira et al.  1 . this is the standardization used in this project.
　echo images are collected from four standard views: apical 1 chamber  a1c  figure 1 b    apical 1 chamber  a1c  figure 1 c    parasternal long axis  plax  or apical 1 chamber  a1c  figure 1 d    and parasternal short axis  psax  figure 1 a.1 a.1  . these views result from cutting the heart along different 1-d planes.
　the left ventricle  lv  is divided into 1 myocardial segments  1 of which are measurable. the short-axis view which results in a circular view of the lv can be taken at 1 locations  near the apex  apical   at the middle  mid-cavity  figure 1 a.1    or near the base  basal  figure 1 a.1  . the most desirable being the mid-cavity cut. if one lays these 1 resultant rings against one another  all segments of the heart are visible in relationship to one another  as shown in figure 1  modified from reference  cerqueira et al.  1  . the left anterior descending lad  feeds segments 1  1  1  1  1  1 and 1  the right coronary artery  rca  feeds segments 1  1  1  1 and 1  and the left circumflex coronary artery  lcx  feeds segments 1  1  1  1 and 1.
1	understanding the data
the data is based on standard adult transthoracic b-mode ultrasound images collected from the four standard views described previously. the echos are in 1 gray scale color  with a resolution in the order of magnitude of about 1 mm. currently we utilize the three apical views - a1c  a1c  and a1c - which show all 1 segments of interest these provide all the information needed to achieve our goal of classifying hearts.
　even though we have images at different levels of stress  resting  low-dose stress  peak-dose stress  recovery  this work is based on images taken when the patient was resting. the goal is to automatically provide an initial score  or classi-

figure 1: echocardiographic views for wall motion evaluation. in the short-axis view  at the base and midventribular levels  the left ventricle is divided into anterior septum  1  and anterior free wall  1   lateral  1   posterior  1   inferior free wall  1   and posterior septal  1  segments. these same wall segments are seen in apical views as indicated  plus the anterior 1   septal  1   inferior  1   and lateral  1  apical segments are seen. modified from reference  textbook of clinical echocardiography   segment numbers have been corrected to reflect standard naming conventionbeing used .
fication  to determine whether a heart is normal or abnormal given the resting ultrasound.
　the data consists of 1 cases for which we have associated images as well as ground truth and 1 cases for which we only have ground truth  no images ; all of which were generated using pharmacological stress  which allows the physician to control the amount of stress a patient experiences  in this case induced by dobutamine . all the cases have been labeled at the segment level by a group of trained cardiologists; this is what we refer to as  ground truth . each of the 1 segments were labeled 1 - 1  1 = normal  1 = hypokinetic  1 = akinetic  1 = dyskinetic  1 = aneurysm   for simplification purposes we converted this 1-class problem to a binary class problem  1 = normal  1 - 1 = abnormal .
1	preparation of the data
our application consists of two main parts: image processing  and classification. in this paper we will focus only on the classification portion  details of the image processing part can be found in the referenced papers. the echos are run through an algorithm which detects and automatically tracks both the interior  endocardial  and exterior  epicardial  borders of the lv  comaniciu  1; comaniciu et al.  1 . motion interferences  e.g. probe motion  patient movement  respiration  etc.  are compensated for by using global motion estimation based on robust statistics outside the lv  this is done so that only the heart's motion is analyzed. then numerical feature

figure 1: display  on a circumferential polar plot  of the 1 myocardial segments and the recommendednomenclaturefor tomographic imaging of the heart. modified from reference  standardized myocardial segmentation and nomenclature for tomographic imaging of the heart .
vectors  which are extracted from the dual-contours tracked through time  form the basis for the regional wall motion classification.
1	image processing
the first step toward classification of the heart involves contour generation of the lv  georgescu et al.  1 . ultrasound is known to be noisier than other common medical imaging modalities such as mri or ct  and echocardiograms are even worse due to the fast motion of the heart muscle and respiratory interferences. the framework used by our algorithm is ideal for tracking echo sequences since it exploitsheteroscedastic  i.e. location-dependent and anisotropic  measurement uncertainties.
　the algorithm takes a hand-initialized border and tracks it from one frame to the next through the entire video clip. the inner and outer contours are treated as a single shape for coupled double-contour tracking.  intuitively  a double-contour approach can propagate information from the endocardium to guide the localization of the epicardium  or vice versa   thus achieving more robust tracking of the two borders than tracking them independently   details in  zhou et al.  1  . the global motion estimation can be seen in figure 1 as a vertical line near the center of the image. after tracking  numerical features are computed from the dual-contourstracked through time. the features extracted are both global  involving the whole lv  and local  involving individual segments visible in the image   and are based on velocity  thickening  timing  volume changes  etc.
1	extracted features
a number of features have been developed to characterize cardiac motion in order to detect cardiac wall motion abnormalities  among them: velocity  radial and circumferential strain  local and global simpson volume  global and local

figure 1: one frame from an a1c image clip with the outer and inner contour control points shown. the  red  vertical line shows use of global motion compensation  and the two squares denote the centers of the individual contours.
ejection fraction  ef  ratio  and segmental volume. some of these features  including velocity  circumferential strain  and local ef ratio  are based on the inner  endocardial  contour.
　due to the patient examination protocol  only the systole  i.e. contraction phase of the heart  is recorded for some patients. in order for the features to be consistent  the systole is extracted from each patient based on the cavity area change. for each frame  the lv cavity area can be estimated accurately based on the inner  endocardial  contour of that frame. the frame corresponding to the maximal cavity area that is achieved at the end of diastolic phase  expansion phase of the heart  is the frame considered to be the beginning of systole. the frame corresponding to the minimal cavity area  achieved at the end of systolic phase  is the frame assumed to be the end of systole. for the time being  all features are computed based only on the systolic phase. however  the methods used to calculate the features are generally applicable for the diastolic phase as well. the following is a basic description of some of the features:
  velocity features: determines how fast any pair of control points change in the x and y coordinate system per frame.
  circumferential strain features: also called fractional shortening  measures how much the contour between any two control points shrinks in the systolic phase. this is measured along the parameter of the contour.
  radial strain features: also called thickening  measures how much the contour shrinks for each control point between any two time frames. this is measured along the radius from a calculated  center  of the lv.
  local and global simpson volume features: determine the volume as computed by the simpson rule  with 1 disks  for each frame  and for the systolic phase of the heart as a whole  this gives the global ef  which captures the whole heart's contraction abnormalities .
  segmental volume features: determine the volume per segment per frame  and the segmental ef values  i.e local efs  which aim to capture the local cardiac contraction abnormalities .
in general  the global version of certain features  e.g. radial strain  circumferential strain  etc  can be calculated by taking the mean  or standard deviation  of the 1 segment's respective feature values from any one view. all in all we had 1 local and global features for each of the 1 views  1 total   all of which were continuous. the limitations of present wall motion analysis programs  e.g. color kinesis and blood pool  is that they only evaluate wall motion and not heart wall thickening  which is the hallmark of ischemia. our program takes both into account.
1	segment classification
our data mining process which starts with the raw data  ultrasound videos  and ends with a robust classifier that predicts/ assesses heart wall motion for the 1 segments of the heart  can be summarized as follows:
1. the image sequences are pre-processed to extract thearea of interest  i.e. the lv . intensity normalization and an appropriate resizing are applied.
1. given the initial contour  the border tracking is performed as described in section 1  item 1.
1. a set of features is extracted from the tracked contoursas described in section 1.
1. using the provided ground truth  assessments from thedoctors   a network structure is learned that represents the correlations among segments  this process is explained in detail in section 1.
1. for each segment  a subset of relevant features for classification is selected  section 1   as a result the classifiers we obtain only depend on a small number of numerical features extracted from the dual-contours tracked through time. having classifiers depending on a small number of features not only improves performance time but also results in better generalization.
1. this subset of numericalfeaturesis providedas evidencefor the networks' variables of interest  the 1 heart segments  to provideclassification for each segment and the whole heart. the entire process is diagrammed in figure
1.
1	feature selection
one of the difficulties in constructing a classifier for this task is the problemof feature selection. it is a well-knownfact that a reduction on classifier feature dependence can improve the classifier's generalization capability. however  the problem of selecting an  optimal  minimum subset of features from a large pool  in the order of hundreds  of potential original features is known to be np-hard. in this paper we use a very simple but efficient filter-based approach. in general  filterbased methods aim to select features based on simple auxiliary criteria  such as feature correlation  to remove redundant features. we used the kolmogorov-smirnov test  ks-test 

figure 1: diagramof process  fromraw data to final classifier.
 biesiada j.  1; chakravarti and roy  1  to measure the maximum difference between the empirical cumulative distributions of the two classes according to a given feature  in other words  the ks-test measures the difference between the two histograms of the two classes with respect to all the available features. this test is a nonparametric method and it makes no assumptions about the underlying distributions of the two classes being tested .all the available features are ranked by the score given by the ks-test and only the features at the top of the list are selected for classification. note that a high rank according to the ks-test implies that the corresponding empirical cumulative distributions of the two classes according to these features are considerably different  making these features desirable for discrimination between the two classes.
1	bayesian networks
bayesian networks or belief networks  bns  are directed graphical models  e.g.  see  cowell et al.  1  for an overview : the bn structure is a directed acyclic graph  dag   and the bn parameters are conditional probabilities  represented by a contingency table in case of discrete variables. the directed edges in the graph can often be interpreted in an intuitive way  namely as causal relationships  requiring additional assumptions   p. spirtes and scheines  1 .
　we applied bns to automatically detecting heart abnormalities to utilize the structural knowledge of the heart segments in hopes of improving the classification accuracy for the whole heart. in this paper  the following representation will be used
  numbers between 1 and 1 will be used to name the respective heart segment being referred to.
  arrows  for example: ○   ★  are used to denote the direction of causality. an arrow is drawn from the cause  parent  node to the effect  child  node. example: 1 ○ 1 should be read as 1 causes/influences 1  here 1 is the child node and 1 is the parent node.
  two segments are called  neighbors  if they share a

figure 1: structure learned by bnt using multi-class labels.
common boundary. for example: the neighbors of 1 are 1  1  and 1  as shown in figure 1 . 1 and 1 are not neighbors since they lie diagonal to 1 and share only a point of contact with 1. they could only be influenced by 1 via one of the neighbors.
prior domain knowledge expressed as rules
we derived prior knowledge from prior clinical research - moir & marwick  moir and marwick  1  are well-known cardiologists who have provided some basic rules about reading echos in standard views. according to our cardiologist collaborators  two rules of thumb that most doctors use while reading a patient's echos have to do with neighboring segments and shared coronary artery territory. neighboring segments influence each others behavior. and if two segments are fed by the same coronary artery  one is abnormal and the other unknown  then it is better to err on the side of caution and classify the unknown segment as abnormal.
learning bayesian network structure from data
to find a network structure that represents the relations among the heart segments from the data  we used kevin murphy's bnt algorithm  murphy  1 . we applied a structure discovery method because creating a structure by hand using only physical knowledge of the heart would have resulted in a cyclic graph. for learning the structure we used the gt from both the training cases and the 1 non-image cases. it is important to note that the structures that we found using the data  actually mirrored the physical relationships within the heart but without creating cycles  furthermore  the resulting structure coincides with our cardiac knowledge extracted from literature. the obtained structure can be seen in figure 1. overlaying the structural relationships learned on the circular diagram of the heart segments  see figure 1  shows the logical sense of them with respect to the physical heart.
1	testing learned bn models
to test the bns we learned  we transferred the final networks to a well-known bayesian networks commercial software  netica  norsys: software corp.  1  and did parameter training using 1 training cases with images  and 1 cases without images  i.e. a subset of the same cases used

figure 1: structural relationships learned by bnt using multi-class labels overlayed on physical heart diagram
to do structure learning; note that the 1 cases without images were only used during training since they incorporated the relationship between segments in their gt . the test set was 1 cases  with images  held out specifically for this purpose. the testing process involved entering all available evidence into the compiled network  running inference  and querying all variables of interest simultaneously. in our case  the evidence given to the network were the 1 best segment specific features found by the kolmogorov-smirnov test  all continuous attributes   and the variables of interest that were queried were the nodes that represented each heart segment  s1  s1  ...   s1; all discrete attributes . after the structure between the segments was learned off of data via the bnt method described above  we manually added the evidence variables using a naive bayesian methodology  each node representing a segment specific feature was influenced only by the correspondingsegment's nodein the network  e.g. s1 ★ s1 a1c segvol ef .
　as an alternative to this naive bayes method  we also tried to learn a general bayes net  i.e.  without any constraints on the network structure   allowing a feature node to be possibly connected to several segment nodes. however  when learning the structure between the imaging-feature nodes and the segment nodes  the number of available training cases with images  namely 1  was very small compared to the number of 1 feature nodes in the bayes net. this let to large uncertainty concerning the learned structure  and possibly to overfitting. not surprisingly  we found that  on the test set  the general bayes net learned from this small amount of training data actually gave results inferior to the ones of the naive bayes method
　all continuous valued features were discretized using recursive minimal entropy partitioning  dougherty et al.  1   a method based on minimal entropy heuristic  presented in  catlett  1; fayyad and irani  1 . this is a supervised algorithm that uses class information entropy of candidate partitions to select bin boundaries for discretization. we tested the network using a subset of selected features

	1
	1.1	1.1

	1
	1.1	1.1
　　　　　　　　　1 specificity	1 specificity figure 1: test roc curves for segments 1 through 1: bnt.
described above.
1	numerical experiments
since the trade-off between false positives  fp  i.e. wrongly labeling the heart abnormal  versus false negatives  fn  i.e. wrongly labeling the heart normal  depends on the clinical context were the system is being used  we decided that the more objective way to measure the performance of our classifier is to measure the area under the roc curve  auc .
　our classifier was trained using 1 cases  and was tested on 1 cases. it's result can be seen in the roc curves of four segments in figure 1. our feature selection resulted in each segment being dependent on six features  both global and local . table 1 shows the aucs for the testing set. as the results show  the classifier did well on each segment  and on the whole achieved high sensitivity  between 1% and 1%  for 1% specificity on most segments.
table 1: aucs for test set
segment1 seg bntsegment1 seg bnts1.1s1.1s1.1s1.1s1.1s1.1s1.1s1.1s1.1s1.1s1.1s1.1s1.1s1.1s1.1s1.1	related work
there is currently no system that tries to do a similar sort of analysis as our system; our approach is novel in this regard. in the past  systems have attempted to extract and display only one parameter of interest. for example  the current stateof-the-art hewlett-packard's acoustic quantification extracts and displays volume  and their color kinesis system displays motion. the problems with both these systems are that their segmentation is unreliable and they only display one feature  which is insufficient to capture wall motion. our work has robust segmentation and is the first to combine all features of interest. there is only one other paper that mentions similar work:  automated classification of wall motion abnormalities by analysis of left ventricular endocardial motion patterns  by johan g. bosch  francisca nijland ph.d.  steven c. mitchell  g. van burken  boudewijn p.f. lelieveldt ph.d.  otto kamp ph.d  milan sonka ph.d.  and johan h.c. reiber ph.d in the journal of the american society of echocardiography  ase   1. but they had very limited results with their system. due to the limited nature of past systems  we do not have any numerical results that compare our system to other approaches.
1	future work
in the future we plan on expanding our classification to identify different levels of chd severity at the segment level  incorporating the use of other standard echocardiographyviews and including images from other levels of stress  e.g.: peak dose . we would also like to apply a ranking algorithm to take advantage of multi-class scores for classification. we are currently studying the effects of perturbation of the border initialization on the final predictions. we also hope to address the question of the sensitivity of results to errors in the border initialization.
1	conclusion
in this paper we address the task of building an objective classification application for heart wall motion analysis  based on features calculated off of echocardiograms. the simple but effective feature selection technique that was used results in a classifier that depends on only a small subset of the calculated features  and their limited number makes it easier to explain the final classifier to physicians in order to get their feedback. although we only had a relatively small number of cases with images and ground truth  we were able to leverage a large number of additional cases - namely data without images  but with ground truth only - to improve performance. and the learned structure that resulted showed that it was possible to learn the same relationships as described in literature. using a simple and publically available algorithm we achieved sensitivity performance in the mid-1's. currently we are looking into how these encouraging results can help less-experienced cardiologists improve their diagnostic accuracy; as it stands now  the agreement between less-experienced cardiologists and the experts is often below 1%. as a top cardiologist put it:  it is awesome! this will be a major advance to patient care... this will be a real killer application...! .
