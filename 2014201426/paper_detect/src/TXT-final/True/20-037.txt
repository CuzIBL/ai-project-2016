 
an object recognition system is presented that it designed to handle the computational complexity posed by a large model base  an unconstrained viewpoint and the structural complexity and detail inherent in a single view. the design is based on two ideas. the first is to compute descriptions of what the objects should look like in the image  called predictions  before the recognition task begins. this reduces actual recognition to a 1d matching process  substantially speeding up recognition time for 1d objects  with manageable storage overhead . the second is to represent all the predictions by a single  combined isa and part-of hierarchy called a prediction hierarchy. the nodes in this hierarchy are partial descriptions that are common to views and hence constitute shared processing subgoals during matching. many of the problems encountered with large model bases and complex models are reduced by subgoal sharing: projections with similarities explicitly share the representation and recognition of their common aspects. the original contribution of this paper is the automatic compilation  from a 1d model base  of a prediction hierarchy that can be used to recognise objects. a prototype system based on these ideas is demonstrated using a set of polyhedral objects and projections from an unconstrained range of viewpoints. 
1 . 	i n t r o d u c t i o n 
　　object recognition is a central aspect of the process of understanding visual information  helping us to relate what we are seeing to what we have experienced in the past. in spite of much progress in this area  there are crucial problems that have not received adequate attention. one problem is that of representing information about 1d objects in a way that makes matching them to 1d image data efficient and reliable. that is  the geometric analysis required to relate an arrangement of 1d image features to the structure and pose of 1d objects should be sufficient for recognition and yet not involve massive amounts of computation during the time-critical recognition task. another problem is ensuring that the storage and time complexity grows only slowly with respect to the size of the model base and the complexity of the models. we emphasize efficiency for model-based vision because of the remarkable ability of humans to rapidly recognize a large number objects from a range of viewpoints  biederman1 . also  while there are other sources of information that seem to be important  specifically scene context  biederman1  weymouth1  and model-independent understanding of 1d structure  marr 1   these useful cues may quite often be unavailable  unreliable  or merely a first step towards a full interpretation. 
　　techniques for relating 1d model information to 1d image data can be partitioned into two basic approaches: prediction 
this research was supported in part by the by the air force office of 
scientific research under contract number afosr-1. thanks to al hanson  ed riseman michael boldt and john dolan for comments  support and help with the figures. 
cycling and pre-recognition view analysis. in the former  represented by  brooks1   the system iteratively cycles through a process of prediction!  deciding which projected model structure to search for in the image and what it looks like; observation  searching for image data that match the prediction; and back constraining  using additional properties of the matched data to further constrain the possible 1d poses and structural variations in the object. this approach could be computationally inefficient for large model bases since the prediction step would involve computing what is common about the projections of a large and possibly complex class of objects from a range of viewpoints. similarly  manipulation of partially constrained poses during the back-constraining step can be involved  lowe1 . 
　　in the alternative approach  pre-recognition view analysis  all expectations of what to look for in the image are generated before the actual recognition task. recognition then becomes a 1d matching problem followed by object pose analysis and verification. the characteristic-view based schemes of chakravarty   the property spheres of fekete   the scerpo system of lowe   the principal views of cooper  and the image-based descriptions of the visions system developed in  weymouth1  all roughly follow this method. additionally  this approach has similarities with the photometric stereo interpretation system of ikeuchi . 
　　another basic idea incorporated into our design is the use of is-a and part-of hierarchical representations   marr1    brooks1l    mulder1  and  weymouth1  . we developed a single  combined is-a and part-of hierarchy called a prediction hierarchy. the nodes in this hierarchy are partial descriptions that are common to views and hence constitute shared processing subgoals during matching. many of the problems encountered with large model bases and complex models are reduced by subgoal sharing: projections with similarities explicitly share the representation and recognition of their common aspects. 
　　the original contribution of this paper is the automatic compilation  from a 1d model base  of a prediction hierarchy that can be used to recognize objects. a prototype system based on these ideas is demonstrated using a set of polyhedral objects and projections from an unconstrained range of viewpoints. a fuller treatment can be found in  burns1 . 
1. 	o v e r v i e w 
　　the problem currently being studied is the compilation and use of a prediction hierarchy to recognize polyhedral objects using straight-line segments detected in the image. the actual objects used to demonstrate the design are shown in figure 1. the objects have differences and similarities in various dimensions and part of the problem is to take advantage of both. the similarities in their visual structure  such as occurrences of parallelograms or of certain types of line junctions  must be utilized by the recognizer to make the search for a match efficient. the differences in visual structure  such as height-to-width proportions  must be utilized to discriminate between the objects. addition-
	bums and kitchen 	1 

   fig. 1. 1d objects uued to demonstrate prediction hierarchy compiler and matcher {tall box  cube  triangular prum  house  tetrahedron . 
ally  the variations in visual appearance caused by variations in the camera must be taken into account while doing the structural analysis. 
　　the camera geometry used is as follows. the viewpoint of the camera is taken to be the position of the image origin in the object coordinate system. currently  the projection is taken to be normal perspective  brooks1l   i.e. orthographic projection with scaling. also  since the objects are expected in any pose  all predictions generated are invariant to re-scaling  translation and rotation in the image plane. this means that there are only two degrees of camera variation that have a significant effect on the projections being described by the predictions  the two angular components of the viewpoint that sweep out a viewing sphere about the object. 
a top-level view of the algorithm is as follows-
  compile the prediction hierarchy from the set of 1d models given  before the recognition task begins. the hierarchy is compiled by starting with a small set of simple and very general structural predictions and then iteratively searching for commonly occurring combinations or specializations of these predictions across all objects and views  eventually isolating predictions that characterize the projections of fairly specific objects from a range of views 
  match predictions to input image. during the recognition phase  look for matches between segment descriptions and actual sets of image segments by a combined search of the prediction hierarchy and image data base. the hierarchy is used as an organized network of recognition subgoals. 
  refine the pose estimate. for each promising match  calcu-late the pose more precisely given the image-model mapping and an initial estimate of the pose implied by the prediction matched  i.e.  some typical viewpoint from the set of those that could satisfy the prediction matched . for pose estimation refinement  the iterative method described in  lowe1| is used 
　　the integration of these three processes could be more sophisticated. however  the pressing issue at this point concerns the basic design of these steps; investigating further how they might fit together is outside the scope of this paper 
　　following a description of the nature of the predictions and their representation  section 1   the processes that compile them and use them for matching are discussed  sections 1 and 1 . 
1 . 	p r e d i c t i o n s a n d t h e i r r e p r e s e n t a t i o n 
　　a prediction is a statement concerning some structural aspect of the image of an object. for example  this may be as simple and general as an assertion that there exists a pair of parallel segments in the projection; or as complex as a description of an image unique to some object. a prediction is represented here as a relational graph; the elements in the graph are projected straight-line segments. the relations associated with arcs in the graph mutually constrain the orientations  positions and sizes of pairs of segments. 
　　a relation between a pair of projected segments used in the predictions is represented by ranges of four relational measures  u  v  a and s. call one segment s  and the other 1 the vector  u v  is the position of segment 1 relative to si: it is the displacement of an endpoint of 1 from an endpoint of s-  measured along s  and normal to s1 divided by the length of s . the angle between them  a  is measured counterclockwise from s1 to 1; and s is the relative scale or length ratio of 1 over 1 a relation is defined as an extent box  i.e. a set of ranges in u  v  a 
　　and 1  in order to capture the variation over ranges in viewpoint. for instance  projecting a pair of parallel object segments over all possible viewpoints will generate a set of measurements that have a single value  zero  in the a dimension but some extent in the others. similarly  the family of projections of a pair of object segments that share an endpoint can be represented by a relation that has the value zero in both position components  u v . a relation between projected segments is considered useful if it is valid over a wide range in viewpoints and its extent box is small in volume  for example  consider the two view-invariant relations just mentioned  the latter property is important if the relation is to help characterize an object's projection with a specificity sufficient to discriminate the object from a large number of other objects and from chance arrangements of image segments. although invariant relations are clearly useful  lowe1   they alone are in general not enough to fully characterize projections for instance  proportions are often strong characterizations of ob-
ject structure  but the length measurement ratios that represent them are often not strictly view invariant for example  the tall box in figure 1 has a height to width ratio that is significantly different from the cube over a large range in views  no other property can be used to differentiate them 
　　it should be clear from the above discussion that a prediction may be valid only over a restricted set of views for a given object a prediction instance is a set of model segments  a mapping from the model segments to the segments of the prediction's relational graph and the range of viewpoints from which the prediction is valid for these segment bindings for a given model base  each prediction has a set of such instances and a cumulative visibility  the total area of all their visibility regions on the viewing sphere  across all objects. 
　　any given prediction in the prediction hierarchy is implicitly some relational graph  but explicitly it is almost always described as some combination or specialization of other predictions  see figure 1 . in such cases  it is a derivative of the other predictions a prediction is a specialization of another if it can be described by adding new relations or narrowing the extent boxes of existing ones. for example  the square can be described by adding a relation between the bottom and side segments of the more general parallelogram prediction that constrains their ratio of length to one. a prediction is a combination of other predictions if it can be described as a conjunction of these other predictions. predictions may be combined in various ways  depending on the segment mappings between the whole prediction and its parts. see  for example  the triangular prism prediction of figure 1. the mappings are collectively called the arrangement of the combination. 
1. prediction hierarchy compiler 
　　the compiler attempts to build a prediction hierarchy that is composed of predictions that are commonly occurring combinations or specializations of other predictions. an added prediction should occur commonly enough that its satisfaction tends to dichotomize the instances of the prediction it is derivative of; and thus allow the recognizer to efficiently search for matches to ob-
jects and views. a useful way to build such a structure is by starting with a small set of simple and very general structural predictions and then iteratively searching for the commonly occurring combinations or specializations  eventually isolating predictions that characterize the projections of specific objects. by using this iterative construction approach we limit the combina-

torial complexity  and hence processing time  to a manageable 
1 	perception 

r  define parallelogram  s1 s1 s1 s1  
 and  coincident sl-head s1-head  
 coincident s 1 - t a i l s1-head   coincident s l - t a i l s1-head   coincident s 1 - t a i l s1-tail  
 parallel s l - t a i l s1-tail   parallel s 1 - t a i l s1-tail  
   
 define triangle  si s1 s1  
 and  coincident sl-head s 1-tail  
 coincident s1-head s 1-tail   coincident s1-head s 1-tail  
   
 define triangular-prism  s1 s1 .. 1 
 and  parallelogram s1 s1 s1 s1  
 parallelogram s1 s1 s1 s1   triangle 1 1  
   
 define square  s1 s1 s1 s1  
 and  parallelogram s1 s1 s1 s1   same-size 1  
   
   fig. 1. predictions of other predictions. 
level. this is because the system is never performing subgraph isomorphism analysis over large graphs it is always comparing combinations of small numbers of parts 
　　for the experiments reported here  parallelism and endpoint coincidence are used as the initial set of simple and general pre-
dictions; and the iterative process is stopped when all of the predictions without derivatives  the ones at the top of the hierarchy  are either associated with single objects or  if they are satisfied by projections of more than one object  there are no debcribable differences between their projections the prediction hierarchy compiler implemented iteratively combines predictions and then follows this up with specialization of the prediction to discriminate between objects that cannot be distinguished by parallel and end-point coincidence relations alone. 
　　for each iteration of the combination process  the system isolates frequent combinations by  1  finding predictions that often appear together in the same projections and then  1  characterizing and representing the arrangement of the combination. the co-occurrences are found in the following fashion. all instances of all predictions are stored in data structures called visibility maps. there is a visibility map for each object; the maps are ar-
rays of cells indexed by the two viewpoint parameters  making a discrete sampling of the view sphere about the object. each cell lists prediction instances visible from the associated viewpoint and object; and with each prediction is a list of cells that contain it. to find frequent co-occurrences between some prediction p and other predictions  the system looks for predictions that appear in the same cells as p and accumulates the total number of cells for each that do. to keep the number of combinations analysed down to a manageable size  we consider only co-occurring pairs in whose arrangements the part-to-whole mappings overlap for at least one whole segment. 
　　the combinations selected during a given iteration are those that are frequently occurring. additionally  a heuristic is used to throw out predictions whose satisfaction during recognition creates dead ends in the matching process. the details of this heuristic can be found in  bums1 . very briefly  it dictates that the compiler adds a given prediction p only if  when p is satisfied by the projection of some object  that satisfaction almost always leads to a match of a derivative of p that is unique to that object. 
　　the prediction hierarchy compiler design was tested on the models in figure 1. the resulting hierarchy is shown in figure 1. 

as specialisations or combinations 
there are six levels of the hierarchy; the average path length between the initial nodes and goal nodes  object matches  is 1. the total number of nodes  predictions represented  is fifteen. considering that the hierarchy is capable of being used to distinguish five objects from almost all viewpoints  with an average of 1 segments per view  - and the predictions are represented efficiently as combinations of simpler ones  this appears to be a reasonable result. 
　　the iterative combination left the tall box and cube objects indistinguishable. this was corrected by the specialization process by adding segment length-ratio relations between two pairs of segments. this conjunction of two proportional relations was satisfied by the tall box projections over most of the view sphere  and satisfied by none of the projections of the cube. 
1. r e c o g n i t i o n 
　　the object recognizer finds correspondences between segments detected in a given image and the segments of some model in the model base by an organized search of the prediction hierarchy and image data base. like parsing and other interpretation problems  there are many ways to perform such a search  e.g.  
top-down  bottom-up or some combination of both . a fairly straight-forward method of search was implemented for the purpose of demonstrating the usefulness of the prediction hierarchy. the search proceeds in a bottom-up fashion by iteratively selecting a previously satisfied prediction  an image-prediction match   attempting to find additional evidence in the image to satisfy its derivative predictions  i.e.  testing new constraints on already matched image segments for specializations and searching for parts for combinations   and storing any new image-prediction matches for further expansion. figure 1 shows the results of this matching process using the hierarchy in figure 1 and a synthetically generated set of image segments. 
1. c o n c l u s i o n 
　　an object recognition system is presented that is designed to handle the computational complexity posed by a large model base  an unconstrained viewpoint and the structural detail inherent in a single view by extensive view analysis and the organization of predicted data into a part-of/is-a structure called a prediction hierarchy. the original contribution of this paper is the automatic compilation  from a 1d model base  of a prediction hierarchy that can be used to recognize polyhedral objects. this 
	burnt and kitchen 	1 
fig. 1 the resulting prediction hierarchy compiled predictions and arrows indicate combination and specialisation links. the predictions are represented graphically by segments and dashed lines for parallel relations. 
research has been done in conjunction with studies of the visual properties of continuous surfaces |callahan1  for the purpose of recognizing objects with curved parts and convexities. further experiments will involve larger model bases  more complex models  and image noise. current design refinements are centered on the cost/benefit analysis of adding a prediction to the hierarchy and the matching control strategies   weymouth1  and  draper1    including the use of image context for match selection. 
