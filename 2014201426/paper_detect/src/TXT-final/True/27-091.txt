 
a model based diagnosis procedure traces connections between components only where these are provided explicitly in the system description. consequently structure faults fall between the meshes. this problem has been known since research started in this field   davis 1    but no general solution has been presented so far. we present a procedure to diagnose structure faults  based on a scheme to detect hidden interactions guided by the observation that structure faults lead to discrepancies in apparently unrelated areas and which in contrast to  preist. welham 1  modifies the system description dynamically. like davis' approach the one presented in the paper is based on the principle that an interaction can occur only where components are adjacent in some way   davis 1  . unlike davis1 approach we introduce an explicit representation scheme for hidden interactions. a hidden interaction model links a required contextual  behaviour independent constellation to the impact of the interaction on the overall system behaviour. in order to control hidden interaction hypotheses we exploit the structure of diagnoses based on behavioural mode assignments. 
1. introduction 
look at figure 1. pitilessly it reveals that kind of sore spot of model based diagnosis systems we want to tackle in this paper: how to cope with structural faults in a model based diagnosis framework. it shows a ballast tank system as needed on off-shore plants or ships to keep the balance. some of the tanks are built on top of each other. a hole in the bottom/top of such a pair of tanks caused by corrosion results in an additional flow between them and hence in a change of the structure of the system. a conventional consistency-based diagnosis system  gde.  dekleer  williams 1   generates diagnosis candidates based solely on a model of the correct function of the system. from a 
this work was started at the fraunhofer institute for 
information- and dataprocessing  fhg/iitb  in karlsruhe  germany  supported by the bundesminister fur forschung und technologic joint project pt-fkz:1 iw 1 b:1 and finished during a temporary research stay at the lipn  supported by the eu under the contract chblct1 in the context of the human capital and mobility program. 
1 	qualitative reasoning and diagnosis functional point of view the particular constellation of the tanks is not relevant. the model of the correct function will treat the two tanks as independent entities. therefore an additional connection causing one tank to act as a source of a material flow into the other leads to discrepancies in apparently unrelated areas:  tankl loses water  and  tank1 gains water . the corresponding con-
flicting assumption sets imply a multiple fault candidate. the actual single fault location is hidden. 

　　　　　　figure 1: a defective ballast system however  the information about hidden interaction paths can be extracted from these multiple fault candidates. we presuppose  that a particular type of interaction between components requires some specific kind of neighbourhood depending on its type and results in changing the behaviour of the components to specific modes. we present hide&seek  hidden interaction detection   an approach to extend model-based diagnosis frameworks to include such a procedure. 
   the problem of dealing with structural faults has been recognised  as soon as research started in this field   davis 1  . similar to the approach proposed by  davis 1  hide&seek is based on the integration of contextual knowledge to hypothesise structural model modifications. davis' approach however is tailored to the diagnosis of 
ttl-circuits based on a constraint suspension framework and has not been adapted to other domains. furthermore  we can profit from recent work refining the notion of diagnosis   dekleer  williams 1  . instead of just stating which component correctness assumptions are consistent  we exploit a notion of diagnosis which associates consistent behavioural modes to each component. 
　　 preist. welham 1  propose a solution based on the explicit representation of all potential unintended interaction paths. due to the increase of model complexity  this 

approach has a very limited scope of applicability. one has 	to 	pay 	for 	potential 	faults 	with 	increased computational cost in every diagnosis case even if structure faults are known to appear seldom. in contrast hide&seek modifies the system description at runtime and only when it has to consider a structural fault. 
　　hide&seek is based on the two presuppositions  that unintended interactions lead to apparently unrelated discrepancies and that the law of parsimony is a reasonable diagnosis preference criterion. structural faults are consid-
ered only  if no single fault can be found. if forced to  those multiple faults which match a structure fault constellation are preferred. 
   to this end we introduce a representation for patterns of structural faults called hidden interaction models  a 
hidden interaction model has to serve two tasks. first  it specifies the structural fault constellation to be matched. this former task has two further aspects. on the one hand it specifies a required contextual constellation  e.g. a description of the physical layout of the components in-
volved. the constellation specification acts as an interface to a constellation recognition module. usually such kind of information is much easier to get than behavioural models. on the other hand  besides the constellation  the behavioural modes of the respective components have to be matched. e.g. a structural fault  leak between tanks  should be hypothesised only when the behavioural modes 
corresponding to a material flow /leak are actually consistent with the current observations. as a second task  the hidden interaction model provides basic information for how the system description has to be changed  i.e. a characterisation how the interaction affects the overall system 
behaviour. 
　　in section 1 we introduce a ballast system as an example to be used throughout the paper. the diagnostic framework is sketched in section 1. section 1 describes the extension of the diagnostic procedure to include the method sketched above and introduces the definition of a hidden interaction model. in section 1 we show how our procedure copes with the application example and finally  
we reconsider the notorious bridge fault  davis 1 . 
1. 	the example 
a ballast system consists of a set of ballast tanks distributed over the plant  connected by pipes with pumps. in order to stabilise the plant  valves are opened and closed to pump sea water in or out of the tanks according to the external requirements  sea motion  changing load . a conventional system consists of up to 1 ballast tanks. we shall restrict ourselves to a minimal configuration which is quite representative  however  since only a small number of tanks is allowed to be connected by open valves at any time. 
   the main components included in our simplified presentation comprise ballast tanks  tank vent pipes  valves which can be opened/closed automatically or by hand  pipes  a pump  a filter  pressure sensors  control valve  and the sea tank  see figure 1  for details see  ruemelin 1 . 
   the following gives a rough approximation of the behaviour of each component. besides the correct behaviour two fault modes are relevant for each. we shall discuss 
	bottcher 	1 


figure 1: valve behaviour 
   the system description consists of a collection of local behavioural models for each component and descriptions of the connections between the components. 
 dekleer williams 1  and  strussjdressler 1  show how to profit from a system description differentiating between the different possible behavioural modes of each component. in the context of hide&seek this kind of structuring the system description into component modes and models is crucial. it provides a basis for controlling when to hypothesise a structural fault as we shall see in section 1. 
   then a diagnosis is defined as an assignment ii of behavioural modes to the components of the system such that it is consistent with the current set of observations  obs  and the system description. 
   for complex systems the system description may contain even more structure. each component can be described at different levels of structural detail and each mode can be described at different levels of abstraction   struss 1} . it is profitable to exploit such structure during a diagnosis process in form of model switch operations such as structural decomposition or behavioural refinement   hamscher et al. 1} . to control the activation of those parts of the system description relevant in a particular stage of the diagnosis process  we adopt a technique as described in  bottcher  dressier 1 . as the other approaches mentioned above  this one views a diagnosis as an assignment of behavioural modes to components. but additionally it introduces a handle to control the partial activation of the system description and  hence  the diagnosis process. this will be the starting point to control the process of hypothesising hidden interactions. 
 the approach assumes that each piece of model can be addressed in a form such as 

where modg is a conjunction of working hypotheses characterising that piece of model and mode component  corresponds to the assumption that the component is in that particular behavioural mode. adding the attached working hypotheses to a current set of working hypotheses  w-hyp  activates the related model constraint and allows testing the component mode assumption. 
   for example consider modelling a tank as used in the ballast system  section 1 . if a tank is ok  the quantitative description of the water level h can be inferred from the static pressure p based on the gravity acceleration g and the density of water p: 
1 	qualitative reasoning and diagnosis quantitative-view a ok tank  -  h = pl pg  by adding the working hypothesis quantitative-view to the current set of working hypotheses  the related pieces of the model are activated and the component mode assumption is tested. 
   focusing strategies based on simplifying diagnostic hypotheses  e.g.  no multiple faults*'  can be easily integrated into such a control framework as well. then a diagnosis under w-hyp is an assignment n of behavioural modes to the components of the system such that  
       hyp is consistent in general given a set of observations many mode assignments may fulfil this requirement. we assume that for each component each of its behavioural modes is weighted according to its diagnostic relevance  e.g. probability  risk   i.e. for every component a partial ordering is defined on the set of all its modes. the mode of the correct function precedes all other. then only the most plausible or critical mode assignments in this sense satisfying the condition above are of real interest. hence  the diagnosis search will focus on the so-called preferred diagnoses. 
   a mode assignment is preferred over another ii. tor all components ci n assigns a mode mji whice precedes or is equal to m;;* assigned by 
ii 
   then a diagnosis is a preferred diagnosis under whyp. if no other diagnosis is strictly preferred over it   dressier  struss 1  . 
   this characterisation implies that as long as no discrepancies have been detected  the mode assignment ..all components work correctly  is the most preferred one. only if a preferred mode assignment has been refuted  i.e. turned out to imply discrepancies  successors are considered. then the diagnostic process has to identify those mode assignments which deviate as few as possible from the previous one while being consistent with the observations  the system description and the current set of working hypotheses. that is. a preferred diagnosis stating  component c is consistent with mode m  actually says  c is consistent with a mode m and we don't know about less preferred ones yet . 
   the key to control the diagnosis process is the set of working hypotheses. changing it activates different parts of the system description and results in a different set of diagnoses. a catalogue of partial preferences between subsets of working hypotheses representing general diagnostic and domain specific control knowledge  is used to guide the choice of an adequate set of working hypotheses in a 
given situation   bottcher  dressier 1  . 
1. 	integrating interaction detection into the diagnosis process 
the problem of the diagnosis approach sketched above is  that it depends on the system description which may be inadequate. besides specifying how components behave and are connected  the system description states implicitly where interactions are not allowed. structural faults violate the closed world assumption inherent in the model. 
in order to integrate the consideration of structural 

faults two issues have to be addressed 
- when to consider a violation of the closed world assumption and how to control it  
- how to change the system description to reflect the violation and how to control that. 
our answer is based on the presumption that an interaction hidden with respect to a model results in apparently unrelated discrepancies and  hence  in multiple fault candidates. as long as no multiple fault diagnosis has to be generated  according to the known discrepancies and current working hypotheses   the diagnosis process proceeds in the usual way1. if we are forced to consider multiple faults  we should still prefer a single explanation. therefore  we shall look for an interaction acting as a single cause. 
1 	hidden interaction models 
for that purpose we introduce an explicit representation for interaction types: the hidden interaction model. the question is. what has to be included in such a model. 
   consider the ballast system example. if working correctly  the water level of each tank can be changed only by a flow across th 1 in section 1 : h'=i/f. 
now the structure of the system is changed by an additional flow-interaction between two tanks. this means  the behavioural modes of each of the tanks is changed. each behaves according to an additional influence on the water level. due to the hidden interaction path these additional influences constrain each other. finally the character of the hidden interaction is a result of the particular construction of the tanks  i.e. one on top of the other  so as to share a steel plate between them. considering all this  the flow interaction between the tanks is represented in the following way. 

the constellation description marks the interface to a module for recognising contextual  behaviour independent constellations such as a facility to represent and reason about geometrical or spatial information. what kind of 
constellation description is required or from what properties a constellation specification is made up of depends only on the application domain. the basic hidden interaction procedure described herein is independent of a particular choice. the only requirement is a facility to answer queries about which interaction types are consistent with a 
given set of components. 
for the ballast system domain we used a special tool 
 space-box  which provides a facility to recognise spatial 
1 single fault diagnoses which are related to an unintended interaction between a component and an external part are not covered by this scheme. but in principle they could be abstracted into a single faulty behavioural mode. 
configuration patterns. for the ballast system domain simple qualitative spatial relations such as  on-top-of'  and quantitative relations such as  distance  were sufficient  for details see  schick et al. 1    bottcher  schick 1  . a more complex application might require additional technical properties such as  the plate connecting the tanks has to be made of steel   and  hence  a more complex tool. other applications may come along with simpler languages and reasoning to check a constellation. 
1 	controlling hidden interaction hypotheses 
forced to consider multiple faults  but provided with a set of hidden interaction models representing relevant interaction types  we want to look for diagnoses which can be related to a single problem source. that is  if a preferred diagnosis has been inferred which matches the structure 
fault pattern of a hidden interaction model  we want to explore the consequences of the respective interaction  i.e. to change the system description so as to represent the influence of the hidden interaction on the overall system behaviour. 
   given the structure of a hidden interaction model as introduced above and the framework to control the diagnosis as introduced in section 1  the system description change is realised by activating the related working hypothesis  in this case the related hidden interaction hypothesis. activating a working hypothesis means adding it to the current set of working hypotheses. the decision when to switch to what set of working hypotheses is guided by a 
catalogue of partial preferences between subsets of working hypotheses   bottcher  dressier 1  . this is the place where to state when to hypothesise a hidden interaction. 
   before specifying the control preference rule to add  we have to precise  what is meant by a matching structure 
fault pattern. we introduce a predicate potential-interaction to describe that a particular hidden interaction hypothesis /z ci ... cn  is a potential candidate to represent an interaction between suspect components ci ... cn in the context of a mode assignment n. to be valid  we require on the one hand that the components are arranged corresponding to the constellation description of the hidden interaction type in question. furthermore  we exploit the fact  that preferred diagnoses indicate which behavioural modes have been refuted already. we require that the behavioural modes assigned to the components by the diagnosis in question are  consistent  with those required by the interaction. given the definition of preference between mode-assignments and of preferred diagnoses  section 1    consistent  has to be read as  for each component the mode assigned by the diagnosis has to be more preferred or equal to that mode resulting from the interaction wrt. the partial mode ordering local to that component : 





figure 1: a bridge between lines 
   davis proposed a procedure to cope with bridge faults which starts with the assumption that the structure of the system is correct. if no single component fault can explain the observed behaviour  the assumption is relaxed and the procedure falls back on some special mechanism. the mechanism hypothesises structural modifications between components  if a particular pattern of values of the variables describing the components  has been derived and if they are neighboured in a particular way. the behaviour patterns required are specific for bridge faults and for the ttl technology. 
   the difference between the approach introduced by davis and our lies in the notion of a diagnosis. in the former framework a diagnosis is viewed as a single component supposed to be not ok. on the one hand this implies that the single fault assumption is built into it. more im-
portant  however  is the fact  that it ignores the notion of behavioural modes. the knowledge about the behaviour of bridged components can be exploited in a  compiled  form only. that is  it is used beforehand to derive a particular pattern of variable values. so the pattern can be viewed as a result of changing the behavioural modes of the components in question and connecting them. 
   common to both his and our approach is the presumption that a bridge leads to a multiple fault candidate and the insight to enhance the search for structure fault candidates by referring to the knowledge about adjacency between components. 
1. 	conclusions 
we presented hide&seek  a method to hypothesise hidden interactions based on an analysis of the context of components. we defined a hidden interaction model representation scheme which links a required contextual constellation to the description of the impact of an interaction on the overall system behaviour. we showed how to integrate the search for hidden interaction hypotheses into a diagnosis process control framework thereby exploiting the information about behavioural modes of components 
contained in candidate diagnoses to guide the search. 
　　a straightforward solution to cope with structural faults would be to incorporate all potential pathways of interaction explicitly into the model.  preist  welham 1  shows that for applications where these kinds of faults are the actual problem and not the exception such a procedure is feasible but time consuming  hence  of limited scope of applicability. similar to  preist.welham 1  we build our procedure on basis of an explicit representation of an  interaction . our approach  however  dynamically activates additional interactions as needed. 
   davis* approach is tailored to the diagnosis of ttl-circuits and hard to adapt to other domains   davis 1   section 1 . but in some way our approach can be viewed as an extension of it. analogous to that approach we based our procedure on the integration of contextual knowledge to hypothesise structure modifications. additionally we exploit the structure of a diagnosis as a behavioural mode assignment. 
   our procedure is based on the assumption that unintended interactions lead to discrepancies in unrelated areas. it seems that this assumption is useful to treat structural faults resulting from unintended interactions between system components in some domains. it is. however  not obvious for what kind of applications this assumption is satisfied. characterising the difference between a multiple fault hiding an interaction between system components and one hiding a interaction with some external part  or a 
fault  single or multiple  hiding an interaction with an external part from an ordinary fault still needs to be done. so future work will comprise characterising classes and properties of structural faults in different domains. 
   the procedure has been implemented in allegro common lisp on a sun sparc workstation and tested on the ballast system example. 
acknowledgements 
thanks to philippe dague. oskar dressier. francois levy  
karsten poeck. peter struss and the anonymous referees for commenting on earlier versions of this paper  and last but no least to matthias schick who provided the space box as the basis of this work. 
