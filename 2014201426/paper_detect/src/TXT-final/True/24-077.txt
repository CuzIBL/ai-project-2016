 
we develop a qualitative method for understanding and representing phase space structures of complex systems. to demonstrate this method  a program called maps has been constructed that understands qualitatively different regions of a phase space and represents and extracts geometric shape information about these regions  using deep domain knowledge of dynamical system theory. given a dynamical system specified as a system of governing equations  maps applies a successive sequence of operations to incrementally extract the qualitative information and generates a complete  high level symbolic description of the phase 
space structure  through a combination of numerical  combinatorial  and geometric computations and spatial reasoning techniques. the high level description is sensible to human beings and manipulable by other programs. we are currently applying the method to a difficult engineering design domain in which controllers for complex systems are to be automatically synthesized to achieve desired properties  based on the knowledge of the phase space  shapes  of the systems. 
1 introduction 
analysis of dynamical systems via phase space structures plays an increasingly important role in experimenting  interpreting  and controlling complex systems  abelson and sussman  1a; abelson et al  1b . nonlinear systems usually fall outside the domain of traditional analysis  such as fourier analysis for linear systems. however  most of the important qualitative behaviors of a nonlinear system can be made explicit in the phase space with a phase space analysis. 
   *this paper describes research done at the artificial intelligence laboratory of the massachusetts institute of technology  supported in part by the advanced research projects agency of the department of defense under office of naval research contract n1-j-1  and in part by the national science foundation grant mip-1. the author is also supported by a g.y. chu fellowship. 
1 	qualitative reasoning 
　we have constructed a program  maps1  for understanding and representing qualitative structures of phase spaces through a combination of numerical  combinatorial  and geometric computations and techniques of spatial reasoning. maps uses theoretical knowledge about nonlinear dynamical systems. we will illustrate our techniques of extracting and representing the qualitative features of the phase space structures with two and three dimensional systems. the techniques presented in this paper also apply to higher dimensional systems. 
　complex systems are often nonlinear and high dimensional. our theoretical knowledge about nonlinear dynamical systems is far from complete. therefore  many engineering applications reply on extensive numerical experiments. a numerical simulation typically generates an immense amount of quantitative information about a complex system. to interpret the numerical result and to use the information for engineering designs  it is essential to develop qualitative methods that automatically analyze the system  extract the qualitative features  and represent them in a high level description sensible to human beings and manipulable by other programs. 
　this paper demonstrates a qualitative method for automatically understanding and representing the  shapes  of dynamical systems. our ultimate goal is to develop a class of intelligent and autonomous controllers that understand the phase spaces of complex systems  sense the world  synthesize control commands  and affect the processes. for example  an intelligent controller would balance an inverted pendulum that is mounted on a moving cart pulled by a motor  through qualitatively analyzing the pendulum system  monitoring the motion of the system  and commanding the motor  much like what one would do to balance a broom on its end with a hand. accomplishing such difficult tasks by autonomous robots would be hard to imagine without their understanding of the qualitative behaviors of the systems  especially when the systems are of high order and operate in nonlinear regimes. we are particularly interested in automating the control analysis and synthesis for a class of nonlinear systems that do not lend themselves easily to traditional analysis and design techniques. 
1
　　maps stands for modeler and analyzer for phase spaces. see  zhao  1a  for more detailed discussions on the program. 
1 automated qualitative analysis of phase space structures 
the phase spaces of nonlinear dynamical systems often consist of qualitatively different regions. the  shapes  of dynamical systems refer to the geometric information about the structures and spatial arrangements of these regions. a key component of the qualitative analysis of the  shapes  is to determine the stability regions of the dynamical system. the geometric information about the stability regions is extremely useful in analyzing stabilities of control designs for complex systems  such as electric power systems and mechanical control systems  as well as in economics  ecology  etc. 
　maps understands qualitatively different regions and extracts and represents geometric shape information about these regions. given a dynamical system specified as a system of governing equations  maps generates a complete  high level symbolic description of the phase space structure as the result of the analysis. the high level description can be used as input to other programs for further computations. 
1 	the qualitative phase space structures 
we are interested in representing the qualitative features of dynamical systems for engineering analysis and design. for this purpose  the qualitative phase space structure of a dynamical system within the phase space region of interest is characterized by the equilibrium points and limit cycles and their stability types  the geometric structures of stability regions associated with the attractors  and the spatial arrangement of the equilibrium points  limit cycles  and stability regions. 
　we review some of the basic concepts in dynamical system theory in order to describe the qualitative phase space structures. the equilibrium points of a dynamical system x1 = / x u   where u is a parameter  are the zeros of the vector field f x u  : rn -  rn. structurally stable systems  guckenheimer and holmes  1  can have equilibrium points of three types: stable equilibrium points  attractors   unstable equilibrium points  repellors   and nonstable equilibrium points  saddles   whose local behaviors in phase spaces are shown in figure 1. an attractor is an equilibrium point that nearby trajectories approach in forward time. a repellor is the one that repels nearby trajectories and can be thought of as an attractor in reverse time. trajectories approach a saddle in some directions and leave it in the other directions. for example  the downward resting state of a damped pendulum is an attractor and the upward state is a saddle. the equilibrium points are asymptotic behaviors of dynamical systems. the other classes of asymptotic behaviors are limit cycles  quasi-periodic orbits  and chaotic attractors. although our techniques apply to limit cycles and quasi-periodic orbits  we shall not discuss them in detail in this paper. 
　the collection of trajectories approaching an equilibrium point is called the stable trajectories of the point; and the collection of trajectories leaving an equilibrium point is called the unstable trajectories of the point. a saddle has stable trajectories along some directions and 

figure 1: equilibrium points:  a  attractors   b  repellors  and  c  saddles. 
unstable trajectories along the other directions. the union of the stable trajectories of an attractor is its stability region  often called the basin of attraction. the important concept of stability is associated with the stability regions. the stability region of an attractor is a simply connected and open region  either bounded or unbounded. every trajectory starting in the region will be attracted to the attractor  by definition. the boundary of the region contains saddles or repellors only. the region is unbounded if the boundary contains no repellors. 
1 	automated qualitative analysis 
our algorithm for determining stability boundaries is based on a crucial theoretical result characterizing the stability boundaries of a fairly large class of dynamical systems. under certain weak conditions the result of chiang et al  chiang ct al.  1  shows that the stability boundary for an attractor consists of the stable trajectories of equilibrium points and limit cycles whose unstable trajectories approach the attractor. this allows us to numerically determine a collection of trajectory points on the stability boundary through calculations of the stable and unstable trajectories. 
　we need to extract the geometric information about the stability regions from the numerical results about the stability boundaries  and represent it parsimoniously so as to facilitate further computations. for example  the representation is to be used to estimate the volumes of the stability regions  to reason about the spatial relations with the stability boundaries  to compute topological properties of the regions  to extract information about trajectory flows  etc. given a set of trajectory points on the stability boundary  the minimal representation- the one with fewest edges and preserving topological structures-is the polyhedron having those boundary points as vertices. furthermore  the polyhedron is contained in the convex hull of the boundary points. 
　the geometric information about a stability region is represented as a polyhedron  tightly stretched over the trajectory points on the stability boundary. extraction of the polyhedral approximation proceeds in two steps: computing a triangulation of the convex hull containing the polyhedron  and eliminating exterior triangles. the convex hull is computed and tessellated with simplices  triangles  tetrahedra  etc.  by a triangulation method- the delaunay triangulation. the polyhedral approximation is then extracted by a  sculpture method  used in visual information representation  boissonnat  1 . simplices exterior to the polyhedron are eliminated by heuristic rules. 
	zhao 	1 

1 	the algorithm 
we present the following algorithm for analyzing  extracting  and representing qualitative features of a dynamical system of any order in the phase space. 
 i  identify qualitative behaviors: 
 a  locate equilibrium points/limit cycles and classify their stability types; 
 b  compute stable and unstable trajectories for each saddle/limit cycle; 
 c  identify those saddles/limit cycles whose unstable trajectories approach an attractor; 
 d  the stability boundary for the attractor is the union of the stable trajectories of those saddles/limit cycles identified in  c ; 
 e  check if consistency rules are violated. if yes  look for missing equilibrium points/limit cycles and go to step  a . otherwise  go to the next step. 
 1  extract geometric structures: 
 a  for each attractor  	collect stability boundary points; 
 b  tessellate the convex hull of the boundary points with a triangulation; 
 c  extract a polyhedral approximation to the stabil-ity region. 
 1  summarize qualitative behaviors: 
 a  compile the phase space data structure from step 1 into a relational graph; 
 b  augment the graph with the geometric structure from step 1; 
 c  report the graph as the output. 
　the set of consistency rules specify the conditions for the stability boundaries and are used in the algorithm to automatically locate missing saddles. 
1. the existence rule: every stability region of an attractor has a boundary in a phase space with multiple attractors; 
1. the separation rule: separatrices either form a closed surface or become unbounded on all ends. 
　the first rule states the existence of stability boundaries in a phase space with multiple attractors. the second rule describes the separation property of multiple stability regions. the separatrices are stability boundaries that separate two stability regions. 
　the first step of our algorithm is based on a numerical method proposed by parker and chua  parker and chua  1  for numerically determining stability boundaries of planar systems. we have augmented their method with the set of consistency rules they suggested to automate the locating of saddles. since the newton-raphson method used in finding equilibrium points requires an initial guess  parker-chua's method uses a grid to set up initial guesses and is able to find all the stable and unstable equilibrium points under normal circumstances. however  they require that the initial guesses for saddles be provided manually by the user. we seek to automate saddle locating by focusing the search for missing saddles on the most likely places using partial boundary information already obtained  or by refining the initial guesses 
1 	qualitative reasoning 

for the newton-raphson method. we want to emphasize that our algorithm is valid for higher dimensional systems as well and generates a symbolic description of the phase space structure. parker-chua's method is designed for numerically analyzing planar systems only. 
　maps uses our algorithm to analyze the qualitative behaviors of nonlinear dynamical systems. it is implemented in scheme  a dialect of lisp. all the numerical routines are implemented in scheme as well. figure 1 shows the flow chart of maps. the input to maps is a system of governing equations for a dynamical system. 
1 	the main illustration 
we illustrate how maps is used to compute the high level description of a dynamical system with an example. consider a 1nd order nonlinear system 
	 1  
where u is a parameter. for the parameter value u = 
1  the vector field within the region 
and is shown in figure 1 a . we use the algorithm to analyze the qualitative behavior of the system within this region. 
　the equilibrium points of the system are found by the newton-raphson method. maps locates four equilibrium points within the region and classifies their stabilities by inspecting the eigenvalues of jacobians at the equilibrium points: two attractors at and  1 1  and two saddles at  1 1  and 

　　　　　　all shown in figure 1 b   attractors: +; saddles: the stable and unstable trajectories of the saddle are then computed by integrating the system from a small neighborhood of the saddle in the directions of the stable and unstable eigenvectors backwards and forwards  respectively. 
   since one of the unstable trajectories of each saddle goes to the attractor at  1 1   the stability boundary of the attractor consists of the stable trajectories of both saddles. similarly  the stability boundary of: the attractor at  1 1  consists of the stable trajectories of the saddle at  1 1   one of whose unstable trajectories goes to the attractor. however  within the region of interest there are trajectories that leave the bounding box. these trajectories can be conveniently thought of as the stable trajectories of an attractor at infinity. therefore  the stable trajectories of the saddle at  1 -1  form the stability boundary for the at tractor at infinity  for one of the unstable trajectories of the saddle leaves the bounding box. consistency rules are checked and satisfied. at the end of this step  maps finds three qualitatively different regions associated with the three attractors and internally represents the phase space structure in a data structure: the attractors are connected with each other via saddles and associated with stability boundaries  figure 1 c  . 
　the second step extracts a polyhedral approximation to each stability region preserving the gross features of the shape of the region. consider the stability region of the attractor at  1 1 . the stability boundary is numerically approximated by a collection of trajectory points relatively uniform and dense on the boundary; see figure 1 d . 
   a delaunay triangulation is performed on this set of points. as the result  the convex hull of the points is tes sellated with triangles; see figure 1 e . under our condition that the points are reasonably dense and uniform on the boundary  the polyhedral shape of the stability region is contained in the triangulation of the convex hull. in order to extract the polyhedron  triangles exterior to the polyhedron have to be eliminated. we note two facts. first  the circumcircles of exterior triangles are larger than the circumcircles of the interior triangles  boissonnat  1   since the interior triangles respect the local geometries of the boundary they approximate  whereas the exterior ones do not. second  only certain type of triangles are the candidates for elimination: the triangles with exactly one edge and two vertices on the boundary of the convex hull in two dimensions. therefore  we can focus the search and eliminate the exterior triangles by deleting the candidate triangle with the largest circumcircle  until the number of points on the boundary of the polyhedral approximation is the same as that of the original set of the boundary points or there are no more candidates for elimination  figure 1 f  . we reiterate that the condition on the distribution and density of the boundary points has to be checked with respect to the shape of a region  to ensure that the circumcircle heuristic rule for elimination works. 
　maps compiles the data structure from step 1 into a relational graph  augments it with the polyhedral ap-

	 a  	 b  

	  c   	 d  

	  e   	  f   
figure 1: the analysis of a 1nd order nonlinear system:  a  vector field;  b  equilibrium points;  c  boundary and connecting trajectories;  d  points on the stability boundary for one of the attractors;  e  triangulation of the convex hull;  f  polyhedral approximation. 
proximation  and reports to the user the following findings: 
 equilibrium-points: 
 1. saddle at: 1 -.1  
 1. attractor a t :   1 . 	1.  1. saddle at: 1 .1  1. attractor a t :   1 . 	 1    relational-graph: 
1. stability-region for attractor a t : * i n f i n i t y * : stability-boundary: 
trajectory 1: from * i n f i n i t y * to  1 -.1   trajectory 1: from * i n f i n i t y * to  1 -.1   
connecting-trajectories: trajectory 1: from  1 -.1  to * i n f i n i t y *   
1. stability-region for attractor a t :   1 . 	1 .   : stability-boundary: 
trajectory 1: from * i n f i n i t y * to  1 	.1   trajectory 1: from * i n f i n i t y * to  1 .1   
	zhao 	1 

trajectory 1: from *infinity* to  1 -.1   trajectory 1: from *infinity* to  1 -.1   
connecting-trajectories: trajectory 1: from  1 .1  to  1. 1.   trajectory 1: from  1 -.1  to  1. 1.   
1. stability-region for attractor at: 1. .1 : stability-boundary: trajectory 1: from *infinity* to  1 .1   trajectory 1: from *infinity* to  1 .1   
connecting-trajectories: 
trajectory 1: from  1 .1  to  1. .1    
1 	other examples 
we have run maps on several other nonlinear examples  some with greater complexity and some of higher order. 
　the dynamical system for a buckling column under compressive force 

is a 1nd order system. 	for the parameter values a = 
- 1  b = 1  and c = -1 and the phase space region 
 maps finds two 
attractors at  1 1  and  -1 1  and a saddle at the origin  and generates a description of the phase space geometries: two banded stability regions associated with the two attractors  separated by the stable trajectories of the saddle at the origin. figure 1 a  shows stability boundaries and connecting trajectories of two stability regions  and figure 1 b  shows the polyhedral approximation to one of the regions. 
　since the stability regions are interleaved  the geometric extraction algorithm using the circumcircle heuristic described earlier terminates before all the exterior triangles are eliminated. a more expensive procedure is then used to eliminate the remaining exterior triangles: a triangle is in a stability region of an attractor if the trajectory starting at the centroid of the triangle approaches the attractor in the limit or enters another triangle already in the stability region. 
　our algorithm works for higher dimensional systems as well. consider the following 1rd order nonlinear system 

maps locates an attractor at  1 1  1  and a saddle at  -1 1 1  within the region  
1  and de-
termines that the stable trajectories of the saddle form the stability boundary for the attractor. the stability boundary is a two dimensional surface and is approximated by a set of relatively evenly spaced trajectories. maps then tessellates the phase space with tetrahedra and extracts a polyhedral approximation to the stability region of the attractor  see figure 1 . 
1 hierarchical representation 
we have described and demonstrated our algorithm for analyzing a dynamical system through successive computations on the system  starting from its system equa-
1 	qualitative reasoning 

	 n  	 b  
figure 1: the analysis of a buckling column:  a  stability boundary and connecting trajectories;  b  polyhedral approximation. 

	  	n 	  	  b   
figure 1: the analysis of a 1rd order nonlinear system:  a  projection of stability boundary and connecting trajectories in x-z plane;  b  projection of polyhedral approximation in x-z plane. 
tion representation. maps generates a high level description of the dynamical system at the end of the analysis. to bridge the large semantic gap between the deduced symbolic description and the system equation representation of the input  we have employed multiple intermediate representations for the dynamical system  shown in figure 1. 
　maps extracts the information incrementally  applying a set of operations to each intermediate representation. at each level of the representation  implicit properties of the system at different scales are made explicit and thus can be accessed and manipulated by the operators at the next level of the representation. in the order of analysis  maps generates a local description of equilibrium points  limit cycles  and their eigenstructures  a relational description of equilibrium points  limit cycles  and their interactions  polyhedral approximations to stability regions  and a high level description of the phase space structure. 
　the internal representation of the phase space description as a relational graph captures the qualitative aspects of the phase space structure. in the relational graph  nodes are attractors and arcs denote the relations between their stability regions. each node has information about the attractor it represents  the associated stability region and its polyhedral approximation  and the boundary trajectories and boundary equilibrium points 


figure 1: a multi-layered representation for a dynamical system. and limit cycles. 
1 related work 
yip has constructed a program  kam  for automatically analyzing hamiltonian systems with two degrees of freedom in planar phase sections  yip  1 . the program uses techniques from computer vision to cluster point sets in phase sections and classifies phase portraits into meaningful categories. our method applies to a large class of dissipative dynamical systems of any order in continuous phase spaces  in contrast to hamiltonian maps on planar phase sections in kam. since we are interested in using maps to automatically synthesize controllers in phase spaces  maps also extracts and represents stability regions with geometric pieces  as opposed to a point set representation in kam. 
　sacks' poincare program analyzes planar systems through a partition algorithm on phase spaces and a bifurcation analysis on one parameter  sacks  1 . the partition algorithm is based on the properties of two dimensional flows that do not generalize to higher dimensions. maps differs from sacks' partition algorithm in that our method is able to analyze phase spaces of any dimensions  based on a general theoretical result on dynamical systems. maps generates a relational graph for a dynamical system characterizing the spatial arrangement of phase space structures and containing geometric information about stability regions. 
1 conclusions 
we have developed a qualitative method for automatically analyzing phase space structures of nonlinear dynamical systems and have constructed maps to demonstrate the method. maps looks at the phase spaces  finds qualitatively different regions-the stability regions  and extracts and represents the qualitative features. it employs deep domain knowledge about dynamical system theory to recognize the qualitative structures of phase spaces. it computes a high level description of a dynamical system through a combination of numerical  combinatorial  and geometric computations and represents the phase space structure with a relational graph. 
　we are currently using our method to develop a novel control synthesis strategy for nonlinear control systems  with which a controller for a nonlinear system can be automatically synthesized in the phase space  zhao  1b . the strategy relies on the knowledge of phase spaces obtained from maps  made possible by the internal representation of the phase space structures. it generates control laws by synthesizing shapes of dynamical systems and planning and navigating system trajectories in the phase spaces. more specifically  the control strategy consists of a global control path planner and a local tra-
jectory generator. the global path planner finds optimal paths from an initial state to the goal state in the phase space  consisting of a sequence of path segments connected at intermediate points where control parameter changes. the high-level description of the phase space is used to guide the search for the global paths. the local trajectory generator uses the flow information about the phase space regions to produce smoothed trajectories. because of the human accessible aspect of the high level description  maps can also assist engineers in designing controllers for complex systems. 
