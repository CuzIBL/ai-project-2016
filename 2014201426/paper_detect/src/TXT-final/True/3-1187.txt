
this paper describes an ontology for inland water features built using formal concept analysis and supervaluation semantics. the first is used to generate a complete lattice of the water domain  whereas supervaluation semantics is used to model the variability of the concepts in terms of threshold parameters. we also present an algorithm for a mechanism of individuation and classification of water features  from snapshots of river networks  according to the proposed ontology.
1 introduction
there are at least three main aspects of an ontology for geographical information systems  gis : the ontology at the data level  whereby features of how raw data  either from sensor images or geographic surveys  are expressed in terms of numeric an symbolic information; the ontology at the expert level  that incorporates scientific knowledge about geographical objects; and the ontology at the user level  which should in some way specify the meanings of the vague and ambiguous geographic terminology which is used to describe the world in natural language. the present work is an investigation of an ontology of the latter kind for inland hydrographic features.
　the ontology of inland water features proposed in this work is based on the waters 'lexical field' presented as an example in  ganter and wille  1 . however  we shall analyse the domain in greater detail. in particular we shall explicitly model the intrinsic vagueness and ambiguity in water feature terms  such as pond and lake  by means of a variant of supervaluation semantics as proposed in  fine  1; bennett  1a; 1b . the methods developed in this work  however  are not restricted to the water feature domain  but can be applied to any ontology for gis or  indeed  any complex domain containing vague concepts.
　we argue in this work that formal concept analysis  fca  and supervaluation semantics complement each other for building ontologies of na： ve geography. on the one hand  fca provides constructive tools for extracting complete lattices for any particular domain. therefore  formal aspects of

 
	currently at centro universitario da fei  s＞	ao paulo  brazil. the ontology can be assessed using the tools of lattice theory; moreover  there are also automatic methods for building lattices from a set of terms. therefore  the problem of going from elements of a domain to the formal structure of this domain is solved by formal concept analysis. on the other hand  fca does not handle changes in the interpretation of terms in the ontology due to intrinsic vagueness in the meaning of the corresponding concept. supervaluation semantics provides rigorous methods for handling such changes of 'standpoint' while providing the machinery to make reliable inferences involving vague concepts. this ability to derive the reliable consequences of vague knowledge is the main advantage of supervaluation semantics over fuzzy logic  elkan  1 .

figure 1: vagueness in water features: three lakes or a meandering river 
　figure 1 shows an example of the kind of vagueness we are going to be dealing with in this work. this figure may depict either three lakes connected by channels or a meandering river stretch. the decision of one interpretation from another depends on the standpoint of the observer  i.e.  on how the set of parameters distinguishing rivers from lakes are determined by the observer's judgement. therefore  not only is vagueness pervasive to the feature definitions but also on how the features are individuated. it is worth pointing out also that this work concentrates on sorites vagueness  which is an indeterminacy in the boundaries of applicability of a term. this can be distinguished from conceptual ambiguity where a term has several qualitatively different interpretations.
　the ontology of water features and the supervaluation semantics are encoded into a prototype implementation whose purpose is precisely to individuate qualitatively distinct features from a snapshot of a river network. each individual feature is  thus  classified according to the definitions in the ontology  taking into account parameters handled by the supervaluation semantics.
　this paper is organised as follows: section 1 overviews some basic definitions of formal concept analysis and introduces the conceptual domain of inland water features  section 1 . supervaluation semantics is discussed in section 1. section 1 describes our prototype implementation and section 1 concludes this work.
1 formal concept analysis
formal concept analysis  fca   ganter and wille  1  is a powerful tool for formalising conceptual domains by means of algebraic structures such that the set of concepts can be represented as complete lattices.
1 overview
the basic ideas underlying formal concept analysis are those of  formal context  and  formal concept  that are introduced below1. informally  a context refers to the formal structure that characterises a conceptual domain and a concept within a context is composed of the ontology terms and their attributes. terms in an ontology are called objects in formal concept analysis terminology  in this work we use these words interchangeably.
formal contexts and concepts
a context k is a triple k 《 hg m ii in which g is the set of terms in the context k  m is the set of attributes of the context and i is an incidence relation between g and m. let's assume g （ g and m （ m  then gim is read as   the term g has attribute m .
　in order to obtain the set of all attributes m  m （ m  common to a particular subset of objects  a  a derivation operator is defined as follows:
a1 = {m （ m | gim for all g （ a}.
　this operator is overloaded to refer to the set of all objects g （ g that have all of their attributes in a particular subset of m. formally:
b1 = {g （ g | gim for all m （ b}.
　given a context hg m ii  a concept is identified with a pair  a b   where a   g  b   m  such that a1 = b
　and b1 = a. the sets a and b are called  respectively  the extent and the intent of the concept  a b .
　given two concepts c1 =  a1 b1  and c1 =  a1 b1   we say that c1 is a subconcept of c1  equivalently  c1 is a superconcept of c1   or simply  a1 b1  ＋  a1 b1   if a1   a1. the set of all concepts of a particular context  ordered in this way  forms a complete lattice in which infimum and supremum are  respectively 1:
	 	    1
	 at bt  =  	at  	bt    
	t（t	t（t	t（t
and
	 	  1  
	 at bt  =   	at   	bt .
	t（t	t（t	t（t
many-valued contexts and scaling
until now we have been describing the basic machinery of formal concept analysis without taking into account values of attributes with respect to objects. in fact  the definition of context described above only deals with cases of one-valued attributes where objects either have a particular attribute or not. however  in order to deal with the many-valued attributes found in the water feature domain  such as  flow  and  depth    many-valued contexts should be taken into account.
　a many-valued context is a quadruple hg m w ii where g is a set of objects  m is a set of many-valued attributes  w are the attributes values and i is a ternary relation of g 〜
m 〜 w.
　in order to represent many-valued contexts as complete lattices  they have to be reduced to one-valued contexts. this is done by means of partitioning each many-value attribute into a finite number of one-value attributes that are distinguished from one another by a set of thresholds. this partitioning process is named scaling and the set of partitions of an attribute is called the conceptual scale of that attribute in fca terminology. a scaling can be understood as an interpretation of each of the attributes of a many-valued context by means of a context of attributes. a scale for a many-valued attribute m is a one-valued context sm = hgm mm imi with m g    gm. in practise  every many-valued attribute m of a context is replaced by the one-valued scale attributes relative to m g   for any object g （ g.
1 the context of inland water features
in this section we propose a context for inland water recalling the lexical field waters introduced in  ganter and wille  1 . the present context is constituted of a set of objects  or water features : g = {river  stream  canal  reservoir  lake  marsh  pond} whose set of attributes is m={linearity  size  origin  flow  depth}.
　the scale assumed for the linearity attribute partitions its values into linear and non linear according to a threshold on a linearity coefficient. the linearity coefficient assumed in this work is defined as the ratio between the diameters of the minimal bounding circle and the maximal internal circle w.r.t. the feature's border.
　in an ideal world  where lakes have the shape of discs and rivers the shape of lines  rivers and lakes could be identified as features whose linearity ratio are  respectively  different from and equal to one. however  this idealistic distinction does not hold for lakes that are elongated or for wide river stretches  for instance. in order to cope with this issue  we assume a threshold on the linearity ratio  called the linearity threshold  whereby if the ratio of a water feature is greater or equal than this threshold  this feature is linear. it will be considered nonlinear otherwise. this is in fact a simplification of the actual threshold used in the implementation presented in section 1. the actual definition  however  needs concepts that will be introduced later on this paper.
　size is partitioned into four categories: large linear  small linear  large non-linear and small non-linear. the linear sizes are determined according to a threshold on the maximum length of linear features  maximum linear length threshold   whereas the non-linear sizes take into account thresholds on both: the maximum non-linear length and the maximum non-linear width1. the distinct size thresholds for linear and non-linear features is due to the intrinsic dissimilarity between judgement of sizes regarding objects in these two classes  for instance  a small lake does not necessarily have the same dimensions as a small river .
　flow is scaled as flowing or stagnant given a threshold on the average flow of the feature. likewise  depth is partitioned into deep and shallow according to a threshold on depth. finally  origin is partitioned into natural and artificial.
　all of the scales used in this work partition the many valued attributes into mutually exclusive partitions  so called nominal scales  ganter and wille  1 . other possibilities for scales could also be considered in this context depending on the level of granularity required for the attributes in the application domain. in this work  however  we are not going to get into details about the diverse possibilities of scales.

figure 1: concept lattice of inland water features.
　the context of inland water features can  thus  be represented as the lattice shown in figure 1.
extracting definitions from the water feature formal context
the lattice in figure 1 can be easily translated into definitions that could be handled by the supervaluation semantics  as discussed in section 1 below.
　in order to present the definitions of water features we first introduce the following functions on features. let x be a water feature  then linearity ratio x   average flow x   average depth x   max length x  and max width x  are mappings from the feature x to real values representing  respectively  its linearity ratio  average flow  average depth  maximum length and maximum width. with these functions  and appropriate thresholds  it is now possible to define the attributes of a inland water feature  f   as presented in definition 1.
definition 1  relations of the domain water feature 

　in this paper we do not stipulate the actual thresholds for definition 1. future research may use machine or user surveying to determine appropriate default values corresponding to an intuitive classification.
　we now can define the inland water features  as presented in definition 1.
definition 1  inland water features  let each of the objects of the inland water feature context be a predicate symbol. the terms of the ontology are defined as follows.

　the next section introduces the supervaluation semantics and discusses how it can handle variations in the meaning of the definitions above.
1 supervaluation semantics
the formalisation of the inland water feature domain presented above used thresholds to define partitions on the values of attributes. however the implications of varying the values of these thresholds is not accounted for by the formal concept analysis. in fact  distinct sets of values for the thresholds may result in distinct  sometimes incompatible  definitions of the context objects. it is desirable to view such variations as standpoints on the vague definitions of features. we assume the supervaluation semantics  fine  1  to provide a formal framework for standpoints on feature definition.
　supervaluation semantics views a vague language as a set of distinct precise versions of itself. each of these versions is called a precisification. formally  each precisification p is identified with a particular interpretation ip of the language. a supervaluation model is defined as a set of precisifications. therefore  given a supervaluation model Υ we can talk about propositions that are unequivocally true  i.e. are true in every interpretation ip （ Υ  and propositions that are in some sense true  i.e. are true in some interpretation ip （ Υ .
　in this work the scales applied to attributes of the inland water feature domain compose one particular precisification. therefore  the definitions of the inland water feature domain may vary according to the multiple meanings that the vague concepts might assume  or multiple values that the thresholds can assume. for instance  the two possible interpretations for the scenario in figure 1 correspond to two distinct precisifications whereby the particular linearity thresholds dictate whether the scenario depicts three lakes or a meandering river. in fact  the apparatus of supervaluation semantics allows for logical relationships between vague concepts to be represented by quantifying over the  possibly infinite  space of precisifications  bennett  1a .
　moreover  attributes in formal concepts can be used as predicates in the bodies of horn clauses and the context objects as arguments in the clause heads of logic-based axioms. a set of such clauses can be fed in a system allowing logic reasoning about elements of the ontology. in other words  the methods of generating concept lattices provided by the formal concept analysis can be adapted to generate logical axioms that could be used within a logic-based reasoning system encoding supervaluation semantics.
　the next section presents a prototype implementation of these ideas.
1 implementation
in this section we discuss a prototype implementation of the inland water feature ontology with supervaluation semantics. the purpose of this prototype is to automatically individuate and classify different geographical features within twodimensional images of river networks  e.g. river stretches  lakes and ponds . in a general way  the process of individuation and classification of water features involves the construction of the medial axis  or skeleton  of the river network and further translate it into a data structure. this data structure provides the basis for feature segmentation/classification. the elements involved in this process are described below.
1 individuation and classification of features
by individuation in the context of water features we mean the process of identifying qualitative distinct stretches of river networks. in this work  this distinction is accomplished in three phases. first  the medial axis  or skeleton  of a river network is obtained by an off-the-shelf image processing method. second  the axis thus obtained is processed into a data structure from which qualitative distinct features from the network can be identified by observing changes in the width along the axis. finally  the distinct stretches are classified according to the definitions proposed in sections 1 and 1 above.
skeletonisation and data structure
the medial axis  or skeleton   blum  1  is commonly defined as the locus of the diameters of all maximal discs enclosed in a jordan curve1 that touch at least two points of the curve's boundary. the best known application of skeletonisation is in the field of image processing  where the skeletons of object's images are used as an abstraction of the two dimensional shape of the objects depicted  as surveyed in  loncaric  1 . in fact  a linear algorithm has been proposed that computes the medial axis of simple polygons1 in linear time  chin et al.  1 .
　the idea of representing river networks by their medial axis is not new. to the best of our knowledge the first work that attempts such endeavour is  mcallister and snoeyink  1   where the skeletons of river networks are used to identity opposite points in river banks  to connect the centreline of the networks with original river bank data  to calculate the areas of rivers and  finally  to automatically obtain the ordering of tributaries along the network. the problem of using the skeletons for the individuation and classification of water features  such as the identification of rivers and lakes in a single river network as proposed in the present paper   however  was only hinted in that work. we believe that the tasks of segmentation and classification of such features cannot be accomplished without a precise and consistent body of definitions such as those presented in sections 1 and 1.
　in this work  we use a divergence-based method  dimitrov et al.  1  as an off-the-shelf method for extracting the medial axis of river network snapshots. this method is based on considering a 1d region  representing the image of a shape boundary  as gradient fields of the region's distance transform. the skeletal points are  thus  identified as singularities in the net outward flux of the vector field relative to the region where each pair of points in opposite borders shrinks to a point.
　skeletons produced by the divergence-based method are transformed into an 1-connected list whereby each cell is subdivided into 1 registers. these registers encode each skeletal point in its middle register and pointers to any of its 1 cardinal neighbours. it is worth pointing out that  along with the skeletal point  the middle register also encodes the distance from this point to the nearest point in the shape's boundary  thus providing a measurement of the width of the water feature .
　the task now is to sweep the 1-connected list  segmenting the river-network skeleton into stretches. these stretches are  thus  classified according to appropriate thresholds based on the water-feature ontology.
integrated classification and individuation
points where the skeleton branches and points where there are abrupt changes in the width of a river network  according to a threshold  are used to provide a means of obtaining a protosegmentation of the data into candidate water features. the initial set of segments may further be concatenated or split according to the definitions in the ontology. this provides  as a result  the segmentation of the river network into water features  according to formal definitions.
　in order to summarise these ideas in an algorithm we first need to introduce the ideas of branching point  sample stretch and nexus point.
　a branching point is a discontinuity in the orientation of the boundary of a shape1. in a skeleton encoded as a 1connected list  branching points are identified as a cell with more than two neighbours.
　a sample stretch of a skeleton at a given point p is an ordered set of skeletal points with p as the mid-point and which extends a certain number of points either side of p. the sample stretch ratio is the ratio of the length of the sample stretch to the width of the water body at the sample point  i.e. the width at the mid-point of the stretch . we have found that a reasonable segmentation can be obtained by taking the sample stretch ratio as 1  so that the stretch has the same length as the with of the river.
　we call a nexus point a point where two or more linear chains in the medial skeleton meet.
　we can then define an  approximately  linear sample stretch of water as one where the minimum and maximum width along the stretch lie within a certain variation threshold relative to the width at the mid-point. more specifically a sample stretch s is linear according to a given stretch linearity ratio threshold  slr thresh  just in case:

　the lake-river segmentation and classification algorithm can be summarised as follows:
algorithm: lake-river segmentation and clas-
sification
input: a bitmap depicting a river network output: a set of segments of the river network classified according to the water-feature ontology
  first  a matrix output by the divergence-based skeletonisation is converted to a set of prolog facts - one for each point in the skeleton. these identify the coordinates of the skeleton point and its distance from the nearest edge point of the water body;
  prolog predicates are defined that test whether a point is an end point  a nexus point or a mid point of a chain. this is simply done by counting the number of points of the surrounding 1 pixes that are also skeleton points;
  for each chain of mid points the algorithm checks that the point is on a chain that extends for a distance in each direction that is at least equal to the width at that point;
  a list of points corresponding to the sample stretch is collected;
  maximum and minimum widths along the sample stretch are computed;
  the ratio of the maximum and minimum widths to the width of the mid point are computed;
  if the ratio's lie within the given stretch linearity ratio threshold  according to statement 1  the point is marked as a point on a linear stretch; otherwise  it is marked as belonging to a non-linear segment.
  in the case of a linear segment  the linearlength/width thresholds are taken into account to decide whether the given segment is a river or a stream; in the case of a non-linear segment  the non-linear size thresholds are used to decide between a lakes or a pond.
　changes in the stretch linearity ratio threshold  and on the linear and non-linear size thresholds  allow for variations of the feature segmentation and classification. this provides a rigorous account of multiple standpoints in the classification of river  lakes  stream and pond features in a river network.
1 prolog implementation
the algorithm outlined in the previous section has been partially implemented in prolog.
　the following screen dump shows the output for an artificial example which was constructed to illustrate some key problems of lake/river discrimination. note that the example contains a wide river and a much narrower river that could be interpreted either as a stream or as a river depending of an observer's standpoint. moreover  the narrow river is broken by a small lake  or pond  and in this case the small lake/pond has a maximum diameter which is much smaller than the width of the wide river.
　figure 1 presents an output of the prototype implementation whereby linear stretches are indicated by thick black lines and non-linear parts of medial skeleton are shown as thin gray lines. a new classification  according to a distinct standpoint  is obtained by simply providing a new set of thresholds. junctions between distinct rivers  however  were misclassified by the prototype  as shown by the junction between the thin and the wide rivers in figure 1.  mcallister and snoeyink  1  presents a possible solution for this problem  which shall be further exploited within the framework proposed in the present paper.

figure 1: river stretch identification using sample stretches with sample length ratio 1 and sample variance ratio 1.
1 further work
several aspects of the proposed ontology require further work to provide a more discriminating and flexible conceptualisation. in particular the articulation of size thresholds on water bodies requires further refinement to identify the relevant metrics. for instance  area and width measures should be distinguished.
　more importantly  further work needs to be done on the integration between individuation and classification  which is only sketched in the present work. it will probably be necessary to introduce a further layer of definitions that alow features to be constructed by aggregating several components. specifically  we would like to define the way in which a 'river' may be composed from several river stretches which may be joined in complex ways. an adequate treatment of this may require information on water flow to be integrated within the classification.
1 conclusion
in this paper we presented an ontology for inland water features constructed using formal concept analysis and supervaluation semantics. the former allows a rigorous account of the domain structure by means of a complete lattice of concepts and their attributes. the latter formalises multiple interpretations of ontology terms owing to vagueness in the relative concept. the key for the integration of formal concept analysis and supervaluation semantics is the process of scaling. scaling partitions many-value attributes of features into onevalue ones  which permits a lattice representation of the domain. these partitions are defined by means of thresholds on the attribute values. supervaluation semantics is used in this work to formalise variations on these thresholds modelling multiple possible interpretations of vague terms. analysis of the hydrographic domain brings out the fact that vagueness not only affects the definitions of features but also how these features are individuated.
　we proposed an algorithm for individuation and classification of water features according to the ontology presented.
the basic idea of this algorithm is to use the medial axis of a river network  extracted via an off-the-shelf divergence-based skeletonisation algorithm  to identify stretches of the network where there is relatively small variation in width. i.e.  the process is to look at the variance along the axis checking that the maximum and minimum width values lie within some percentage variation threshold. this threshold can be regarded a
supervaluation semantics parameter  and may vary according to any particular interpretation of the feature. this interaction between supervaluation semantics and the actual algorithmic feature individuation is the main contribution of this paper.
acknowledgements
this work was partially supported by the ordnance survey.
　thanks to the five anonymous reviewers for the constructive criticisms on this paper.
