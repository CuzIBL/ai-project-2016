
this paper presents a representation system for maintaining interacting durative states to replicate realistic emotional control. our model  the dynamic emotion representation  der  integrates emotional responses and keeps track of emotion intensities changing over time. the developer can specify an interacting network of emotional states with appropriate onsets  sustains and decays. the levels of these states can be used as input for action selection  including emotional expression. we present both a general representational framework and a specific instance of a der network constructed for a virtual character. the character's der uses three types of emotional state as classified by duration timescales  in keeping with current emotional theory. the system is demonstrated with a virtual actor.
1 introduction
emotion is a popular topic in ai research  but most of existing work focuses on the appraisal of emotions or mimicking their expression for hci  see review below . our research is concerned with their role in evolved action selection mechanisms. in nature  emotions provide decision state which serves as a context for limiting the scope of search for action selection  ledoux  1 . this state is sustained more briefly than traditional  life-long  learning  but longer than simple reactive response. to study the role emotions play in intelligence  and to improvethe realism of virtual reality characters  we have developed a mechanism for modelling both the temporal course of emotional state and the interactions between such states  which can be both positive and negative. our work is based on current emotion theory.
　our model  the dynamic emotion representation  der   assumes other mechanisms for eliciting emotional responses from an agent's environment  but keeps track of emotion intensities changing and interacting over time. modellers can specify the numberand descriptions of fundamental emotions and express how they interact. each emotion has characteristic intervals of onset  sustain and decay  and each emotion may either excite or inhibit any other. in this respect  the der can be used as spreading activation system  maes  1  e.g.  which might be taken as the root of the agent's goal structure. the future state of a der depends on its current state as well as its environment. note that in this fully modular system  additional 'higher order' emotions may either be interpreted as emerging from the interactions of fundamental emotions  or they can be introduced with explicit representations - the choice is left to the developer or experimenter.
　althoughthis system could be used to represent any similar durative action selection state  such as drives like hunger   for the purpose of development and evaluation we have focused on emotional state. after presenting the der framework  we present also here an instance of a der model. this model explores theories which postulate three types of emotional state changing over three different timescales - emotional behaviours activations  conventional emotions  and moods. for evaluation  we have integrated this system into an emotionally expressive facial animation system  ee-fas  used to drive a 'talking head' virtual actor. this paper shows that the system provides more diverse visual speech deliveries according to the original state of the der.
1 representing emotional state
computational emotion models should include two parts:
  mechanisms eliciting emotions from external and internal stimuli  including potentially the agent's own goals  beliefs and standards;
  emotion representations keeping track of the emotional states and their changes over time.
　in the design of emotion models the distinction between mechanisms eliciting emotions and emotion representations is useful; the assessment of an emotional event can be the same but its impact on the actions and future emotional state of the virtual actor can vary according to its current emotional state. for instance the event of knocking over a cup of tea might make somebody already angry lose their temper  whereas if this person was happy in the first place this negative event might have little impact  just a slight reduction of happiness. an appropriate emotion representation can enable programmers to reduce the complexity of mechanisms eliciting emotions by assessing an identical event in the same way.
　most existing emotion theories are concerned with mechanisms eliciting emotions  plutchik  1; lazarus  1; frijda  1; izard  1; sloman  1 . in contrast  the duration of emotions and their interactions are not the focus of much research. the same imbalance is found in computational models of emotions - the focus is on the mechanisms eliciting emotions and on their expression  but their representation is typically trivial. the dynamic emotion representation  der  model described in this paper is novel because:
  it can represent any number of persisting states  such as moods  emotions  drives;
  any emotion impulse can affect any state positively or negatively;
  state responses to emotional impulses are influenced by the other states represented in the der;
in addition  the der focuses on usability - it is totally customisable through an xml file.
　besides simplifying the emotion elicitation process  the der makes it easier to generate variety in the behaviour of real-time interactive character-based ai systems  since the same stimuli can result in significantly different  but locally coherent  responses  depending on the agent's emotional state. the der also greatly simplifies scripting for virtual actors by decomposing the problems of specifying the emotionally salient events from describing the agent's individual reaction to or expression of characteristic emotional states. for instance  a script could specify the action of grabbing an object but characteristics of this action  such as its space and effort  badler et al.  1   would be modified per the current der state producing different animations and adding different interpretations. finally  the der presents a powerful mechanism for specifying virtual agent personalities  by allowing developers to for example specify moods or other emotion-related attributes such as tension level.
1 three responses to one series of events
before explaining the details of the der we will first clarify its utility with a concrete example. this example involves a specific instance of a der system  described below  where there are representations correspondingto three differenttime courses:
  behaviour activations: happy  angry. these correspond most directly to emotion-related behaviours such as smiling. behaviour activations trigger pre-organised behaviours with different intensity levels which follow their own time course after their activations.
  emotions: happiness  anger. these build more slowly in response to events and provide a context influencing the current actions.
  mood variables: tension  energy. these change very little during the period of the demonstration  but differentiate the various conditions. they are the most persistent of the three state types.
　figure 1 shows a der in three different mood contexts responding to the same series of six emotional impulses  three happiness impulses followed by three anger impulses. graph d shows these impulses  while graph a shows the response in a negative mood  high tension  low energy   b a neutral mood  and c a positive mood  high energy  low tension . the

figure 1: changes of der states due to six emotional impulses in three contexts. graphs a  b and c show state changes in the contexts of negative mood  neutral mood and positive mood  respectively. graph d shows the emotional impulses sent over time to the der.
happy and angry graphs have + symbols on them when they result in signal being sent to the ee-fas system to generate a facial expression  see figure 1 . the ee-fas also contains a muscle model which results in smoothing between expressed states.
　figure 1 shows the ee-fas output. the intensities of the behaviour activations determine the strength of the displayed facial expressions. however the durations of facial expressions are innate characteristics and do not relate to the duration of behaviour activations  which are triggers influenced by other der states. between each screen shot shown figure 1 expressions decay slowly to return to its neutral position  or to be replaced by a new expression. typically a happy expression is shown by raising the lip corners and low-eyelids;

figure 1: the top through bottom rows show ee-fas screenshots of the negative  neutral and positive mood  corresponding to charts a  b and c of fig. 1. columns correspond to the time when an emotional impulse is sent to the der.
and an angry expression is represented by eyebrow frowns and tight lips.
　in this example  emotional impulses could be due to the appraisal of six declarations from the employer of the character:  you are our best employee  first happiness stimulus   you have helped us tremendously  second stimulus  and i should increase your salary  third ; however i can't do this  first anger stimulus  - the company is not doing well  second anger   so we will need to work harder  third  . this sequence of events produces various reactions  such as a smile  dependingon the agent's mood  but they also changethe emotional state of the character. this could in turn influence the character's next action.
　in row 1  the first screen-shot shows some response to the happiness impulse. however this response is reduced due to the influence of negative mood. the next two impulses show no response because the happiness impulse intensities are too low. in the neutral mood context  row 1  the first happiness impulse produces a stronger response than in the context of negative mood. here the second impulse also produces a response but the intensity of the third impulse is still too low to generate a response. the positive mood  row 1  amplifies the happiness impulses  therefore they all produce facial expressions  and these expressions have stronger intensities than in the previous contexts.
　the effects of anger impulses are influenced by mood states but in addition  they are also influenced by the level of the emotion happy generated by the previous happiness impulses. in row 1  all three anger impulses produce responses  showing an expression of anger represented by an eyebrow frown and tight lips. the different impulse intensities  1%  1% and 1%  produce different strengths of expression  but the differences are not marked since the effect of negative mood and the building anger amplifies the lower intensity impulses.
　in row 1  the neutral mood  the response of the first anger impulse is more stronger than the responses of the two other anger impulses. in fact  figure 1 shows that no behaviour activation has been triggered by the second anger impulse  therefore no facial expression should be displayed. the expression shown at the time of the second anger impulse is due to the visual momentum of the expression produced by the first anger impulse which is still fading. the third anger impulse does produce an emotional expression  since happiness has decreased. the difference between these is the emotional momentum produced by the previous happiness impulses. happiness impulses increase the level of happiness  which takes time to disappear and inhibits the effects of anger impulses. in contrast  the negative agent  row 1  never became very happy in the first place. while for the positive agent   row 1  no anger impulses produce any behavioural response. this is due to two reasons. first  the positive mood reduces the effects of anger impulses. second  the happiness momentumproducedby the previoushappiness impulses also reducethe effects of angerimpulses. the largestimpact of the bad news is the reduction of happiness which had previously soared.
1 the der basic representation
the basic unit of the der model is a modular representation based on the picard description of emotion intensity and emotion filters  picard  1 . a der network consists of a system of modules connected by filters.
　we assume an emotion appraisal mechanism  such as those based on the occ model  ortony et al.  1   classifies events  actions and objects  outputting emotion types and intensities. we call this output emotional impulses. emotional impulses are defined by the name of an emotion  an intensity value and a valence  which can be 1  1 or -1. the valence specifies whether an emotional impulse is positive  neutral or negative.
　emotional impulses are transformed by the der into emotion stimuli. the stimuli include timing information typical of an emotion type and represent intensity changes over time. the activation curve representing emotional stimuli  shown at the bottom of figure 1  was chosen to represent the slow decay of emotion intensity  picard  1 . the effects of small emotional events are cumulative. therefore emotional stimuli are summed to compute the intensity of an emotion  as shown by the top curve in figure 1.
　as shown in the example  section 1   the effect of an emotional event depends on an agent's current emotional state. this is implemented in the der by connecting modules through a system of dynamic filters. sigmoid functions have been chosen for this role because they describe  a large variety of natural phenomena   picard  1 . the use of sigmoid functions is inspired by the description of the influence of mood on these functions given by picard  picard  1 . the sigmoid function parameters can be modified depending on the der model's state  resulting  for example  in a shifted sigmoid curve as show in figure 1. this effect simulates the change of sensitivity  e.g. emotion threshold activation  to

figure 1: emotional stimuli are summed to compute the intensity of an emotion.

figure 1: sigmoid functions are used as dynamic filters by changing their parameters.
particular emotional stimulus in relation to the current emotional state of a person.
　in the der model  we refer to each module as a dimension. a dimension may represent for instance a particular emotion or a particular behaviour activation. dimensions consists of a list of dynamic filters. one dynamic filter modifies one parameter of a particular type of emotional stimulus  for example its peak intensity. some characteristics  such as the decay duration  can be modified. in figure 1  the horizontal axis represents the input value  such as the peak intensity of an emotional stimulus  and the vertical axis represents the output value  such as a new peak intensity value.
　modules influence each other by passing their output to a bus which modifies the parameters of other module's dynamic filters. this bus is the same one conducting the emotional stimuli; the influence on other modules occurs through their 'input' filter. figure 1 shows states affected by two types of emotional stimulus  anger and happiness  and whether the influence is positive or negative for each type of emotional stimuli. for instance  happy stimuli affect positively the emotional state of happiness and negatively the state of anger. this figure also shows that the emotional state happiness amplifies the effects of happy stimuli and reduces the effects of angry stimuli. in practise  the higher the level of the emotional state happiness  the more the sigmoid func-

figure 1: example of a network of influences between emotional states and emotional impulses in the der model. d.f. stands for dynamic filters.
tions controlling the effects of emotional stimuli anger are shifted to the right. this mechanism decreases the positive effect of anger stimuli on the emotional state anger. this simulates the effects of good and bad news on different moods as demonstrated above.
　the system can be configured such that any type of emotional impulse can affect any emotional state and any emotional state can influence the effects of emotional impulses on any emotional state. for the instance of the der model integrated in the ee-fas  described below   the tuning has been carried out using heuristic values and visualisation software plotting the resulting sigmoid functions as well as the modified emotional stimuli.
1 an embedded instance of a der
using the representations just described  we created an instance of a der and integrated it into the ee-fas. as mentioned earlier  this der is composed of three types of modules: behaviour activations  emotions and moods. each represents persisting states changing on different timescales. figure 1 shows a graphical representation of this der.
　the behaviour activations are generated by the der due to emotional impulses  which currently can be either scripted or provided in real time through button presses on a gui interface. each behaviour activation is displayed by the ee-fas as one of the ekman'semotionalfacial expressions. however  the duration of an emotional facial expression is different to the duration of the corresponding behaviour activation  they have their own innate time courses. the graphs a  b and c in figure 1 show the behaviour activations happy and angry. emotions  such as happiness and anger  also produced by emotional impulses  last longer than behaviour activations. in the ee-fas  emotions are also used to select facial signals corresponding to communicative functions  e.g. semi-

figure 1: a der composed of three types of state changing on different timescales: behaviour activations  emotions and moods.
deliberate facial expressions synchronised with the speech  such as emphasis or deliberate smiles. mood changes on a slower timescale than emotions and it influences and is influenced by the effects of emotional impulses on the der state. more detail on the design of this der can be found elsewhere  tanguy  1 . these include details of experiments on the human perception of emotion from components of facial expressions which were conducted using this tool.
1 discussion and related work
a fundamental concept of the der model is the division of emotion models into mechanisms eliciting emotions and emotion representations. this greatly simplifies scripting or direction for characters  since once the der is set and an initial mood described  the script or direction can describe communicative actions abstractly rather than describing precise facial expressions. for agents situated in long-term real-time domains such as web pages or interactive environments  this also provides a mechanism for greater variety of behaviour per scripted response  since the mood can depend on the recent interaction history.
　emotion models are heavily researched now; of these a number of researchers have made systems to which the der is more or less similar. the main advantage of the der is its modularity  flexibility  ease of configuration and relative autonomy  lack of required direction  once completed. it's main disadvantage is that it takes some time  out of the box  to configure  but this is partially addressed by the fact we distribute it with the ee-fas instance described earlier. the der can a  represent any number of emotions  b  represent emotions or other forms of durative state with different time scale  c  define interactions between emotions  and d  customise the influences of emotional impulses on each emotion.
　the der is inspired by the various appraisal theories  lazarus  1; ortony et al.  1; plutchik  1; frijda  1; izard  1   and the pioneering work of several influential researchers  picard  1; sloman  1 . many systems use appraisal to influence the decision processes and behaviours of virtual actors  can amero  1; gratch and marsella  1; andre＞ et al.  1; delgado-mata and aylett  1 .
　relatively few systems providedynamicemotion representations on multiple time scales like the der  and none of these are as configurable as our system. paiva et al.  paiva et al.  1  present an emotion model which assigns a decay function to each emotion elicited with a value higher than a personality threshold. in contrast to the der  paiva et al.'s work does not implement any interaction between emotions in its emotion representation. egges et al.  egges et al.  1  describe a generic emotion and personality representation composed of two types of affective states  moods and emotions. any number of moods and emotions can be represented. in the implementation of their model the only influences between states is the influence of mood on emotions. egges et al. compute the intensity of affective states by linear functions through the use of matrix operations. in the der  sigmoid functions are used to control and change the influences of emotional stimuli on emotions and the influences between emotions. this mechanismproducenon-linear behaviours closer to natural phenomena.
　the duy bui does use a decay function to represent the durations of emotions  but the effects of new emotional impulses on an emotion are influenced by the intensity of the other emotions. their decay functions are also influenced by personality parameters  the duy bui  1 . vela＞squez's representation  the computation of the intensity changes of an emotion takes into consideration the intensity of other emotions  the decay in intensity and the previous intensity of the emotion itself  vela＞squez  1 . the influences of emotions on others are of the types inhibitory or excitatory. the der model differs less from these  however it is customisable; any durative state  such as mood  and any numberof emotions can be represented; influences of emotional stimuli on emotions can also be defined by the researcher. the main advantage of the der model is that its representation can be adapted to different emotion theories and to different mechanisms eliciting emotions from the agent's environment. it is a tool that can help the community to model different emotion theories.
　compared to some systems though we have simplified the system slightly to make it more generic. our definition of emotional impulses carries less information than the emotional structures described by reilly  which also contain the cause or referent of the emotions  reilly  1 . reilly and colleagues' interest was primarily in creating 'believable' agents  like classic animated cartoon characters which exist to entertain and communicate. we have focussed instead on realistic models  which are more useful for experiments and long-term plotless semi-autonomous applications. the der model focuses on the duration and interaction of emotions  cognitive referents can be tracked in other parts of an agent's intelligence  or the definition of impulse can be expanded.
in our system every emotions decays over time. an emotion such as hope could persist as long as the situation is the same. in fact  we take the position that hope will decay even if the situation stays the same. however new appraisal of the same situation produces new emotional stimuli increasing the level of hope. similarly  our system could be used to represent drives like hunger. the only requirement is inverting the levels and decay function. a drive slowly increases over time  but then consumatory actions  ratherthan emotional impulses  such as eating can abruptly reduce its level.
1 conclusion
this paper has presented a representationalsystem for the relatively persistent action selection state often associated with moods  emotions and drives. the dynamic emotion representation enables a programmer to represent any number of persisting states and the interactions between them  whether excitatory or inhibitory  linear or not. the system integrates these with ordinary temporal decay. we also presented a working system using these representations. in this paper we have emphasised the use of the der to simplify the programming of realistic real-time emotional agents. the integration of a der within a virtual character architecture simplifies the requirements for emotion elicitation and the production of varied behaviour. in future work  we hope to extend the system to integrate emotions and drives into the goal structure of artificial life agents. we hope with this to achieve more realistic and perhaps more optimal high-level goal arbitration  while leaving detailed action selection to more simple representations.1
