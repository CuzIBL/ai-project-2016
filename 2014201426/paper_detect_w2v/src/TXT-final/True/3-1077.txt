
this paper  motivated by functional brain imaging applications  is interested in the discovery of stable spatio-temporal patterns. this problem is formalized as a multi-objective multi-modal optimization problem: on one hand  the target patterns must show a good stability in a wide spatio-temporal region  antagonistic objectives ; on the other hand  experts are interested in finding all such patterns  global and local optima . the proposed algorithm  termed 1d-miner  is empirically validated on artificial and real-world datasets; it shows good performances and scalability  detecting target spatiotemporal patterns within minutes from 1+ mo datasets.
1	introduction
spatio-temporal data mining is concerned with finding specific patterns in databases describing temporally situated spatial objects. many approaches have been developed in signal processing and computer science to address such a goal  ranging from fourier transforms to independent component analysis  hyvarinen et al.  1   mixtures of models  chudova et al.  1  or string kernel machines  saunders et al.  1   to name a few. these approaches aim at particular pattern properties  e.g. independence  generativity  and/or focus on particular data characteristics  e.g. periodicity . however  in some application domains  the above properties are not relevant to extract the patterns of interest. the approach presented in this paper is motivated by such an application domain  functional brain imaging. non invasive techniques  specifically magnetoencephalography meg   ha：mala：inen： et al.  1   provide measures of the human brain activity with an unprecedented temporal resolution  time step 1 millisecond . this resolution enables researchers to investigate the timing of basic neural processes at the level of cell assemblies  pantazis et al.  1 . a key task is to find out which brain areas are active and when  i.e. to detect spatio-temporal regions with highly correlated activities. it is emphasized that such regions  referred to as stable spatio-temporal patterns  stps   are neither periodic nor necessarily independent. currently  stps are manually detected  which  besides being a tedious task  severely hampers the reproducibility of the results. this paper addresses the automatic detection of stable spatio-temporal patterns  i.e. maximal spatiotemporal regions with maximal correlation. this detection problem cannot be formalized as a multi-objective optimization  moo  problem  deb  1   because experts are interested in several active brain areas: an stp might be relevant though it corresponds to a smaller spatio-temporal region  with a lesser correlated activity than another stp. the proposed approach thus extends moo along the lines of multi-modal optimization  li et al.  1   defining a multiobjective multi-modal optimization framework  momoo . momoo is tackled by an evolutionary algorithm termed 1dminer  using a diversity criterion to relax the multi-objective search  as opposed to diversity enforcing heuristics in moo  e.g.  corne et al.  1; laumanns et al.  1 ; more on this in section 1 . to the best of our best knowledge  both the extension of evolutionary algorithms to momoo  and the use of multi-objective optimization within spatiotemporal data mining are new  although moo attracts increasing attention in the domain of machine learning and knowledge discovery  see  e.g.   ghosh and nath  1; francisci et al.  1  . experimental validation on artificial and real-world datasets demonstrates the good scalability and performances of 1d-miner; sought stps are found within minutes from medium sized datasets  1 mo   on pcpentium 1 ghz. the paper is organized as follows. section 1 formalizes the detection of stable spatio-temporal patterns as a multi-modal multi-objective optimization problem  and motivates the use of evolutionary algorithms  ba：ck  1; goldberg  1  for their detection. section 1 gives an overview of 1d-miner. section 1 describes the experiment goals and setting. section 1 reports on the extensive validation of 1d-miner on artificial and real-world data. section 1 discusses the approach with respect to relevant work  and the paper ends with perspectives for further research.
1	position of the problem ; notations  criteria
1	notations and definitions
let n be the number of measure points. to the i-th measure point is attached a spatial position1 mi =  xi yi zi  and a temporal activity ci t  t （  1 t . let i =  t1 t1     1 t 

figure 1: magneto-encephalographydata  n = 1  t = 1 
be a time interval  and let c．ii denote the average activity of the i-th measure point during i. the i-alignment σi i j  of measure points i and j over i is defined as:
	where
as the sought patterns do not need to be spheric  ellipsoidal distances are considered. only axis-parallel ellipsoids will be considered throughoutthe paper. for each weight vector w =  a b c   w （ ir+1   distance dw is defined on the measure points as:

dw i j  = qa xi   xj 1 + b yi   yj 1 + c zi   zj 1
1	multi-objective formalization
a pattern x = {i i w r} isi  an ellipsoidal distancecharacterized by a centerdwpoint  and a radiusi  i （  1 nr     a time interval1. the spatial neighborhoodb i w r  is defined as the set of measure points j such that dw i j  is less than r. the spatial amplitude of x  noted a x   is the number of measure points in bnumber i w r of. thetimetemporalsteps inamplitudeinterval i.ofthex  noted ` x   is the
spatio-temporal alignment of x  noted σ x  is defined as the average  over all measure points in b i w r   of their ialignment with respect to the center i:

　interesting spatio-temporal patterns  according to the expert's first specifications  show maximal spatial and temporal amplitudes together with a maximal spatio-temporal alignment. specifically  a solution pattern is such that i  increasing its spatial or temporal amplitude would cause the spatiotemporal alignment to decrease; ii  the only way of increasing its spatio-temporal alignment is by decreasing its spatial or temporal amplitude. it thus comes naturally to formalize the stp detection in terms of multi-objective optimization problem  see  deb  1  and references therein;  de la iglesia et al.  1; bhattacharyya  1  for related data mining approaches .
　the three a ` and σ criteria induce a partial order on the set of patterns  referred to as pareto domination.
definition 1.  pareto domination 
let c1 ...ck be k real-valued criteria defined on domain    and let x and y belong to  .
x pareto-dominates y   noted is greater or equal ck y   for all k = 1..k  and the inequality is strict for at least one k1. 	and
 the set of non-dominated solutions after a set of criteria is classically referred to as pareto front  deb  1 .
1 multi-modal multi-objective formalization however  the above criteria only partially account for the expert's expectations: a stp might have a lesser spatiotemporal alignment and amplitude than another one  and still be worthy  providedthat it correspondsto another active brain area. therefore  not all sought stps belong to the pareto front.
　multi-modal optimization  interested in finding global and local optima of the fitness landscape  has been extensively studied in the ec literature  li et al.  1 . based on the multi-modal framework  a new framework extending multiobjective optimization and referred to as multi-modal multiobjective optimization  momoo   is thus proposed. formally  let us first define a relaxed inclusionrelationship  noted p-inclusion. definition 1.  p-inclusion 
let a and b be two subsets of set    and let p be a posi-
tivea defining adequately the realp	|	 p |（  1 support1  .	of a-includedcandidate solutionin b  notedx
 see below  multi-modal pareto domination can be defined as follows:
definition 1.  multi-modal pareto domination 
with same notations as in def. 1  x mo-pareto dominates y  
  iff the support of y is p-included in that of x  and x pareto-dominates y .

in the case of stps  the support of x =  i i w r 
suppis naturally x   defined 1 ncorne〜as 1supp tet al. .  x  1; laumanns  = b i dw r et al.〜 i  1  with 
　in contrast with who use diversity-basedheuristics for a better sampling of the pareto front  diversity is thus used in momoo to redefine and extend the set of solutions.
1	discussion
functional brain imaging sets two specific requirements on spatio-temporal data mining. first  the expert's requirements are subject to change. much background knowledge is involved in the manual extraction of stable spatio-temporal patterns  e.g. about the expected localization of the active brain areas. a flexible approach  accommodating further criteria and allowing the user to customize the search  in particular  tuning the thresholds on the minimal spatial or temporal amplitudes  or spatio-temporal alignment  is thus highly desirable.
　second  the approach must be scalable with respect to the data size  numberof measure points and temporal resolution . although the real data size is currently limited  the computational cost must be controllable in order to efficiently adjust the user-supplied parameters; in other words  the mining algorithm must be an any-time algorithm  zilberstein  1 .
　the approach proposed is therefore based on evolutionary algorithms  eas ; these are widely known as stochastic  population-based optimization algorithms  ba：ck  1; goldberg  1  that are highly flexible. in particular  eas address multi-modal optimization  li et al.  1  and they can be harnessed to sample the whole pareto front associated to a set of optimization criteria  with a moderate overhead cost compared to the standard approach  i.e.  optimizing a weighted sum of the criteria gives a single point of the pareto front   deb  1 . last  the computational resources needed by eas can be controlled in a straightforward way through limiting the numberof generations and/or the populationsize.
1	overview of 1d-miner
this section describes the 1d-miner algorithm designed for the detection of stable spatio-temporal patterns.
1	initialization
following  daida  1   special care is devoted to the initialization of this evolutionary algorithm. the extremities of the pareto front  where stps display a high correlation  respectively  a low correlation  on a small spatio-temporal region  resp. a wide region   do not fulfill the expert's expectations. accordingly  some user-supplied thresholds are set on the minimal spatio-temporal amplitude and alignment.
　in order to focus the search on relevant stps  the initial population is generated using the initialization operator  sampling patterns x =  i w i r  as follows:
  center i is uniformly drawn in  1 n ;
  weight vectorare based on euclidean distance ;w is set to  1 1   initial neighborhoods
  intervaldistribution ini =  t1 t t1  is such that; the lengthtt1 is drawn with uniformt1 minof ij`is drawn ac- min`/1   cording to a gaussian distribution n 1.
where min` is a time length threshold
  radiussuppliedrthresholdis deterministicallyminσ  corresponding tocomputed fromthe minimala user-
i-alignment desired. r = mink{dw i k  s.t. σi ki   minσ }
all patterns x whose spatial amplitude a x  is less than a user-supplied threshold mina are non-admissible; they will not be selected to generate new offspring. the user-supplied thresholds thus govern the proportion of usable individuals in the initial population.
wherethepcomputationalis the populationcomplexitysize  nisisintheonumber p 〜 nof〜measuremin`   points and min` is the average length of the intervals.
1	variation operators
from parent x =  i w i r   mutation generates an offspring by one among the following operators:
  replacingb i w r ; center i with another measure point in
  mutating ba：ck  1w and ;	r using self-adaptive gaussian mutation
  incrementing or decrementing the bounds of interval i;
  generatingtion operator .a brand new individual  using the initializa-
the crossover operator  starting from parent x  first selects the mate pattern y =  i1 w1 i1 r1  by tournament selection  y minimizing the sum of the euclidean distance between i and i1  and the distance between the center of i and i1 among k patterns uniformly selected in the population  where k is set to p/1 in all the experiments. the offspring is generated by:
  replacing i with the center i1 of the mate pattern y ;
  replacingand w1  respectivelyw  resp. r rusing an arithmetic crossover ofand r1 ;	w
  replacing i by the smallest interval containing i and i1.
an offspringis said admissible iff it satisfies the user-supplied thresholds mentioned in the initialization step.
1	selection scheme
the experiments .a pareto archive is constructed with size l  set to 1 〜p in
　a steady-state scheme is used; at each step  an admissible parent x is selected among k uniformly drawn individuals in the population  by retaining the one which is dominated by the fewest individualsin the archive  pareto tournament  deb  1  . a single offspringy is generatedfromx by applying a variation operator among the ones mentioned above.
　offspring y is evaluated by computing criteria a y   ` y   σ y  . y is rejected if it is mo-pareto dominated in the population; otherwise  it replaces a non-admissible individual in the population if any; if none it replaces an individual selected after anti-pareto tournament  the individual out of k randomly selected ones in the population  that is dominated by the most individuals in the archive .
　the archive is updated every p generations  replacing the mo-pareto dominated individuals in the archive with individuals selected from the population after pareto tournament.
1	experimental setting and goal
this section presents the goal of the experiments  describes the artificial and real-world datasets used  and finally gives the parameters of the algorithm and the performance measures used to evaluate the algorithm.
1 goals of experiments and datasets the initial goal is to provide the expert with a usable stp detection algorithm. the real datasets have been collected from people observing a moving ball. each dataset involves 1 measure points and the numberof time steps is 1. as can be noted from fig. 1  which shows a representative dataset  the amplitude of the activities widely vary along the time dimension. the other goal is to assess the scalability and the performances of 1d-miner  which is done using artificial datasets.
　the artificial datasets are generated as follows. n measure points are located in uniformly selected locations in the 1d domain  1 1. activities are initialized from random cumulative uniform noise    and
 is drawn according to u 1 τ . every target stp s =  i w i r δ  is defined from a center i  a weight vector w  a time interval i  a radius r  and a fading factor δ  used to bias the activities as detailed below. the activity cs of the stp s is the average activity in the spatio-temporal region
bthe i w rtarget  stps:〜 i. thereafter for each measureactivitiespointare biasedj  for accordingeach stp tos such that j is influenced by s  dw i j    r   the activity cj t  is smoothed as

and d t i  is the distance of t to interval i  1 if t belongs to i  otherwise the minimum distance of t to the bounds of i . the scalability of 1d-miner is assessed from its empirical

     figure 1: an artificial stp  t = 1  n = 1  complexity depending on the number n of measure points and the number t of time steps.
　the performances of 1d-miner are measured using the standard criteria in information retrieval  recall and precision. the recall is the fraction of target stps that are identified by 1d-miner  i.e. p-included in an individual in the archive; the precision is the fraction of relevant individuals in the archive  p-included in a target stp . for each experimental setting  see below   the recall and precision are averaged over 1 independent runs. the number of target stps is set to 1 in all experiments. each stp influences a number of measure points varying in  1   during intervals uniformly selected in  1 t  with length varying in  1  1   and δ uniformly selected in  1 .1 . each problem instance thus includes stps with various levels of difficulty; the detection is hindered as the spatio-temporal support  r and i  is comparatively low and the δ parameter increases  the regularity is not visible outside interval i  as in fig 1 .
1 experimental setting the experiments reported in the next section considers a population size p = 1  evolved along 1 generations  1 fitness evaluations per run . a few preliminary runs were used to adjust the operator rates; the mutation and crossover rates are respectively set to .1 and .1.
　the number n of measure points ranges in {1 1}. the number t of time steps ranges inthe thresholds{1used 1in the 1initialization}. are: mina = 1
 minimum number of curves supporting a pattern ; min` = 1  minimum temporal amplitude of a pattern ; minσ = .1  minimum spatio-temporal alignment of two curves in a pattern .
　for computational efficiency  the p-inclusion is computed as: x is p-included in y if the center i of x belongs to the spatial support of y   and there is an overlap between their time intervals.
　the maximal size of the datasets  t = 1  n = 1  is 1 mo. computational runtimes are given on pc-pentium iv  1 ghz. 1d-miner is written in c++.
1	experimental validation
this section reports on the experimentsdoneusing 1d-miner. 1 experiments on real datasets

figure 1: a stable spatio-temporal pattern  involving 1 measure points within interval  1   alignment .1
　typical stps foundin the real datasets are shown in figs. 1 and 1  showing all curves belonging to the stp plus the timewindow of the pattern. the runtime is less than 1 minute  pc pentium 1 ghz . as discussed in section 1  many relevant stps are pareto-dominated: typically the stp shown in fig 1 is dominated by the one in fig 1.
　these patterns are considered satisfactory by the expert. all experiments confirm the importance of the user-defined thresholds  controlling the quality of the initial population. due to the variability of the data  these threshold parameters are adjusted for each new experiment.
　the coarse tuning of the parameters can be achieved based on the desired proportion of admissible individuals in the initial population. however  the fine-tuning of the parameters could not be automatized up to now  and it still requires running 1d-miner a few times. for this reason  the control of the computational cost through the population size and number of generations is one of the key features of the algorithm.

figure 1: another stable spatio-temporal pattern involving 1 measure points within interval  1   alignment .1
1	multi-objective multi-modal optimization
the good scalability of 1d-miner is illustrated in fig. 1. the empirical complexity of the approach is insensitive to the number of time steps t and linear in the number n of measure points. this computational robustness confirms the analysis  section 1   the evaluationof each pattern has linear complexity in n. on-going work is concerned with exploiting additional data structures inspired from  wu et al.  1  in order to decrease the complexity in n. table 1 reports the

figure	1:	computational	cost	vs	n 	for	t	=
1 1.  in seconds  on pc 1 ghz 
recall achieved by 1d-miner over the range of experiments  averaged over 1 independent runs  together with the standard deviation. on-line performances are illustrated on fig
nt11111
1 1 ＼＼＼1＼＼＼1＼＼＼1 ＼＼＼ 1	＼	＼	＼	＼
table 1: recall achieved by 1d-miner vs n and t  average percentage and standard deviation over 1 runs 
1. these results confirm the robustness of the proposed approach: a graceful degradation of the recall is observed as t and n increase. it must be noted that stps occupy a negligible fraction of the spatio-temporal domain  circa 1 for t = 1  n = 1 . the average precision is low  ranging from 1 to 1%  results omitted due to space limitations . however  post-pruning can be used to sort the wheat from the chaff in the final archive  and increase the precision up to

figure 1: recall achieved by 1d-miner vs the number of fitness evaluations.  t = 1  n = 1  1  1  1  average over 1 runs .
1% without decreasing the recall; the post-pruning straightforwardly removes the stps with small spatial or temporal amplitudes.
quite differenteffects are obtainedwhenthe archiveis pruned along the search  e.g. by increasing the thresholds on the minimal spatial and temporal amplitudes   which decreases the overall performances by an order of magnitude; interestingly  similar effects are observed in constrained evolutionary optimization when the fraction of admissible solutions is very low.
　a final remark is that the performances heavily depend upon the user-supplied thresholds  section 1   controlling the diversity and effective size of the population. indeed  a parametric model of the dataset would enable automatic adjustment of these parameters. it might also be viewed as a advantage of 1d-miner that it does not require any prior model of the data  and that inexpensive preliminary runs can be used to adjust the needed parameters.
1	relevant work
this brief review does not claim exhaustiveness; the interested reader is referred to  shekhar et al.  1; roddick and spiliopoulou  1  for comprehensive surveys. spatiotemporal data mining applications  e.g.  remote sensing  environmental studies  medical imaging  are known to be computationally heavy; as most standard statistical methods do not scale up properly  new techniques have been developed  including randomized variants of statistical algorithms. many developmentsare targetedat efficient access primitives and/or complex data structures  see  e.g.   wu et al.  1  ; another line of research is based on visual and interactive data mining  see  e.g.   keim et al.  1    exploiting the unrivaled capacities of humaneyes for spotting regularities in 1ddata. spatio-temporal data-mining mostly focuses on clustering  outlier detection  denoising  and trend analysis. for instance   chudova et al.  1  used em algorithms for non-parametric characterization of functional data  e.g. cyclone trajectories   with special care regarding the invariance of the models with respect to temporal translations. the main limitation of such non-parametric models  including markov random fields  is their computational complexity  sidestepped by using randomized search for model estimates.
1	discussion and perspectives
this paper has proposed a stochastic approach for mining stable spatio-temporal patterns. indeed  a very simple alternative would be to discretize the spatio-temporal domain and compute the correlation of the signals in each cell of the discretization grid. however  it is believed that the proposed approach presents several advantages compared to the brute force  discretization-based  alternative. first of all  1d-miner is a fast and frugal algorithm; its good performances and scalability have been successfully demonstrated on medium sized artificial datasets. second  data mining applications specifically involve two key steps  exemplified in this paper: i  understanding the expert's goals and requirements; ii  tuning the parameters involved in the specifications. with regard to both steps  the ability of working under bounded resources is a very significant advantage; any-time algorithms allow the user to check whether the process can deliver useful results  at a low cost. further research is concerned with extending 1d-miner in a supervised learning perspective  finding the stps that are complete   active in several persons undergoing the same experiment   and correct   not active in the control experiment . the challenge is to directly handle the additional constraints of completeness and correction in the multi-objective multi-modal optimization framework presented here.
acknowledgments
the authors are partially supported by the pascal network of excellence  ist-1 ; this study was supported by a grant from the french ministry of research & technology  aci  new applications of mathematics . 