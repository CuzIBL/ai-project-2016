 
the main thrust of this research is the development of an artificial intelligence  ai  system to be used as an operators' aid in the diagnosis of faults in large-scale chemical process plants. the operator advisory system involves the integration of two fundamentally different ai techniques: expert systems and neural networks. a diagnostic strategy based on the hierarchical use of neural networks is used as a first level filter to diagnose faults commonly encountered in chemical process plants. once the faults are localized within the process by the neural networks  the deep knowledge expert system analyzes the results  and either confirms the diagnosis or offers alternative solutions. the model-based expert system contains information of the plant's structure and function within its object-oriented knowledge base. the diagnostic strategy can handle novel or previously unencountered faults  noisy process sensor measurements  and multiple faults. the operator advisory system is demonstrated using a multi-column distillation plant as a case study. 
1 introduction 
the diagnosis of process faults is a difficult  yet vital job for plant operators in modern chemical and nuclear process plants. many automatic control systems currently used in industry are inefficient in communicating the primary cause of a process upset to plant operators. as exemplified by the incident at three mile island  plant operators can quickly become inundated with alarms and process information immediately following an abnormal event in the process operation. even for experienced plant operators  timely and accurate fault diagnosis remains difficult  himmelblau  1j. 
   fault diagnosis can be viewed as the process of linking symptoms to causes  paralleling the field of medical diagnosis. thus  the goal of process fault diagnosis is to match patterns of sensor measurements and process alarms  the symptoms  to specific equipment malfunctions and operational faults  the causes . numerous methods and 
learning and knowledge acquisition 
technologies have been developed to aid the plant operator in the diagnosis of faults in chemical and nuclear process plants. each of these competing technologies have their own distinct advantages and disadvantages as reviewed by becraft et al. . within the past few years  expert systems and neural networks have emerged as the leading methods with which to aid operators in this arduous task. 
1 expert system fault diagnosis 
many expert systems have been developed for fault diagnosis in several different domains  with varying degrees of success. expert systems are intuitively attractive for process fault diagnosis  as rules can be explicitly listed linking symptoms  process measurements and alarms  to causes  specific equipment malfunctions and operational faults . these heuristic rules are a form of compiled  or shallow knowledge of an expert. that is  a distinct symptom-cause linkage is expressed without any deep knowledge of the system's structure  function  or principles of operation. 
   the limitations of rule-based expert systems are revealed when they are confronted with novel fault situations for which no specific rules exist. if the knowledge base does not contain the necessary information about a particular fault situation  the expert system will be unable to diagnose the fault. however  this diagnostic brittleness can be overcome through the inclusion of deep knowledge of the process in the knowledge base  usually in the form of models of the process structure and function  davis  1 . these models can be either qualitative or quantitative simulations of the process. the expert system can then reason from first principles  davis  1  to diagnose the novel faults. 
1 neural network fault diagnosis 
the use of neural networks is another diagnostic methodology which has shown promise as an aid to plant operators. as opposed to expert systems where the knowledge contained by the system is stored explicitly in the knowledge base as symbols such as words and phrases  the 

knowledge learned by a neural network is stored implicitly in a distributed manner throughout the network  as the numerical values computed for the different synaptic weights and neuron biases. 
   when using neural networks for fault diagnosis in chemical and nuclear process plants  the inputs to the network include the sensor values or alarm states of the process  and the outputs of the network represent the presence or absence of particular faults. in many fault diagnostic neural network systems  dietz et al.y 1; hoskins and himmelblau  1; venkatasubramanian and chen  1; venkatasubramanian et al.  1; watanabe et al.  1   each output node corresponds to one particular fault possibility. an output value of 1 indicates the presence of the fault and an output value of 1 indicates the absence of the fault. the use of output node values to determine fault magnitudes has been examined  venkatasubramanian et al.  1   but fault type must still be assigned to a particular output node. novel faults  for which the neural network has not been trained  or for which no output neuron has been assigned  are generalized and matched to the closest fault scenario for which the network has been trained. unfortunately  this generalization may or may not be valid  depending on the closeness of match between the novel fault and the faults contained within the network training set. 
1 diagnostic focus using neural networks 
becraft and lee  investigate a neural diagnostic strategy that solves the problem of diagnosis of novel fault types by using increasing resolution of diagnostic focus. the diagnostic strategy developed uses a hierarchical neural network structure  figure 1  to successively narrow the diagnostic focus of the system to isolate the fault cause. 

figure 1. 	hierarchical 	neural 	network 	diagnostic 
structure. 
the initial neural network examines the overall process and determines in which plant battery  or group of unit operations  the fault is occurring. each of the second layer neural networks is trained to localize faults within a particular plant battery and assign the cause to a unit operation within that battery. additional layers may be trained to diagnose the specific fault within the unit operation  and the magnitude of the fault as proposed in previous investigations  deitz et al.y 1; venkatasubramanian and chen  1; watanabe et al.   1   if it is deemed necessary. 
   one of the advantages of this diagnostic strategy is the system's ability to degrade gracefully in novel fault situations. rather than giving a diagnosis of  unknown   or else giving a false positive classification  the system narrows the diagnostic resolution to the particular plant battery  and then to the unit operation where the fault is occurring. thus  even though the system might be unable to diagnose the actual cause of the fault  useful information is still obtained concerning the fault's location. this information may then be passed on to an expert system for further analysis  or used by an operator to complete the diagnosis and take the appropriate corrective actions. 
1 neural network / expert system integration 
the dichotomy of ai approaches to fault diagnosis can be expressed as being either numeric / symbolic  algorithmic / heuristic  or neural network / expert system methodologies. each approach contains its own strengths and weaknesses: neural networks are extremely fast pattern associators  can handle sensor noise  learn from experience  and generalize in novel fault situations if sufficiently structured and trained  however they are black-box operators unable to explain their own reasoning methodology  incorrectly generalize novel faults if improperly trained  and forget past training if retrained on new data; expert systems have explicit representations of knowledge which eases the modification and validation of the systems  are able to generate explanations for their reasoning methodology  and can use deep knowledge to reason about novel events  but they are unable to learn from experience  are hard to maintain if the knowledge base becomes extremely large  and require extensive computational time if a deep model of the process must be consulted. to take advantage of the strengths of each technique  as well as avoiding the weaknesses of either individual technique  an integrated neural network / expert system diagnostic strategy is used. 
   the idea of an integrated approach is well supported by authorities in both fields of ai. on the neural network side  norman  mentions the need for an extra evaluative structure to interpret the results of a parallel distributed processing model. in the afterword of their compendium of neural network research  anderson and rosenfeld  
becraft  lee. and newell 

state that hybrid architectures could exploit the potentially powerful synergy obtainable through the use of  high level  traditional artificial intelligence methods and  low level  neural network methods. elaine rich  myers  1j describes the various structures that such hybrid architectures could take. although edward feigenbaum dismisses neural networks as  not of much current interest to those who are working on expert systems   he concedes that neural networks could perform a useful pre-symbolic processing function for sensory inputs  owen  1   thus indirectly supporting the integrated approach. 
1 interpretation of neural network diagnoses 
in most cases of fault diagnostic neural networks based on continuous activation functions  the values of the neurons in the output layer will not be either one or zero as desired  but fall somewhere in between these two values. when this occurs  the diagnosis presented by the neural network is not automatically generated  but must be interpreted by some external means. the usual method by which non-binary diagnostic neural network outputs are distinguished is through the use of a diagnostic threshold  or referent value  weiss et al  1 . this threshold is a cutoff point for neural outputs  values above which indicate the presence of the fault and values below which indicate the absence of the fault. depending upon the value of the diagnostic threshold  the number of incorrect diagnoses of the neural network can vary significantly. with a high diagnostic threshold  fewer cases will be diagnosed correctly as indicating the presence of a fault. thus  some cases in which a fault is actually present will be incorrectly diagnosed as being fault-free. with a low diagnostic threshold  more cases will be incorrectly diagnosed as indicating the presence of a fault when none is actually present. depending upon the diagnostic philosophy of the particular plant operation  a suitable diagnostic threshold must be selected in order to evaluate the neural network outputs. 
   an alternative to selecting a set diagnostic threshold is to evaluate the classification order of the output values. thus  a range of possible fault causes could be evaluated according to the magnitudes of their neural outputs. a large output value may not be high enough to warrant an absolute diagnosis according to a set diagnostic threshold  but may indicate the high possibility of the fault's presence when compared to the other alternatives. it is such an analysis of neural outputs which is extremely suitable for higher intelligence processes  such as an expert systems. 
1 embedding neural networks in expert systems 
the key to successful fault diagnosis using the combined methodology is the integration of the neural networks and expert systems. embedding a neural network within an expert system appears to be an effective architecture for a process fault diagnostic system  figure 1 . much of the 
learning and knowledge acquisition 
information required by the diagnostic system is numeric in nature  process sensor readings   which is easily handled by the neural networks. the hierarchical neural diagnostic structure developed by becraft et al.   provides useful fault detection and location information  even if it cannot determine the actual fault cause directly. the expert system activates the neural diagnosis to generate the potential fault candidate list. it then analyses the neural network outputs  and either confirms the diagnosis  or offers an alternative solution. the expert system takes into account symbolic information issues which are poorly handled by neural networks. 

figure 1. diagnostic architecture of innate/qualms. 
1 fault diagnosis case study 
in order to illustrate the integration of the neural networks and expert systems for process fault diagnosis  a case study is presented. the case study investigates the use of the hierarchical neural network diagnostic strategy as well as the interpretation of the results by the expert system. 1 case study process description 
the process chosen to demonstrate the operator advisory system's capabilities is the multi-column distillation plant  shown in figure 1. the objective of the distillation plant is to separate the feedstock mixture containing benzene  chlorobenzene  and meta-dichlorobenzene  obtained from a hydrocarbon chlorination plant  into the desired distillation products consisting of a 1% pure meta-dichlorobenzene stream  an 1 % pure benzene stream  and a dichlorobenzene stream of at least 1% purity. this objective is accomplished by using two distillation columns in series  with their associated condensers  reflux drums  reboilers  and pumps. a feed stream preparation battery  consisting 

of a pump  a flow controller  and a heat exchanger  precedes the first column in the flowsheet. the heat exchanger in the feed preparation battery uses the energy from the first column's bottoms product to preheat the feed stream to the desired level. the control system for the plant consists of the necessary sensors  control valves  and controllers required to maintain the desired flowrates  pressures  and levels of specific streams and units throughout the plant. the flowsheet contains 1 process streams connecting 1 major unit operations and 1 minor unit operations  with 1 control valves and associated controller loops. the case study process is simulated using 
hysim  a process flowsheet simulator developed by hyprotech  ltd . 

figure 1. distillation plant case study schematic. dotted lines indicate plant batteries for diagnostic focus of first level neural network. 
1 neural network development and training 
the neural networks used in the case study were built  trained  and tested using the /ntelligent neural network application testing environment  innate   a simulation package written in fortran by becraft . the neural network development effort was completed on an apollo dn1 workstation  with a modified version of 
innate embedded into the pc-based expert system  enabling easy portability of the trained neural networks used in the diagnostic strategy. 
   the basic neural network utilized in the operator advisory system's fault diagnostic strategy is the backwardspropagating multilayer perceptron network incorporating the generalized delta rule  as developed by rumelhart  hinton and williams . a learning rate  n  of 1 and a momentum term  a  of 1 were chosen as the training parameters for the networks. a convergence criteria  e  of 1  the allowable difference between the actual output of a neuron in the output layer and the desired or target output  is used to determine the extent of further network training required. the training methodology used is reported in  becraft  1 . the standard sigmoidal activation function  rumelhart et al.  1  is used to calculate each neuron's activation. 
   two levels of neural networks are required to implement the hierarchical neural network diagnostic strategy. the first level  or main plant neural network is trained to identify the particular plant battery where the fault originated. the main network contains 1 input nodes  corresponding to the process measurements from 1 streams in the plant. these streams include all of the streams entering and leaving the plant  as well as several internal streams which would normally be monitored if the distillation plant were an actual industrial installation. one hidden layer containing 1 nodes is used in the main network. the output layer consists of three output nodes  assigned to represent the three different plant batteries: the preheat battery  the column 1 battery  and the column 1 battery. 
   each of the second level networks  one for each plant battery in the distillation plant  are trained to further isolate the cause to a particular unit within the plant battery. the inputs used in each network are the process measurements of the streams crossing its battery limits  as well as measurements from internal streams which would normally be monitored. the second level network inputs include additional process measurements not presented to the main plant neural network  thus providing a greater degree of resolution of the plant battery state. one hidden layer is used in each network  with the number of hidden nodes being equal to the number of input nodes for that particular network. each node in the output layer corresponds to a unit contained within the plant battery limits. an additional output node is assigned to signify a process disturbance occurring upstream from the plant battery  thereby negating incorrect diagnoses due to fault propagation effects. consequently  the preheat neural network consists of 1 input nodes  1 hidden nodes  and 1 output nodes  and each of the column battery networks consists of 1 input nodes  1 hidden nodes  and 1 output nodes. 
1 	qualms expert system development 
the queensland university alarm management system 
 qualms  is a deep knowledge  model-based expert system for the diagnosis of faults in chemical process plants. qualms was developed using a pc-based expert system shell  intelligence/compiler  developed by intelligenceware  inc . intelligence/compiler supports backward chaining  forward chaining  exact reasoning  semi-exact reasoning  inexact reasoning  and the use relational database facilities within its inference engine structure. the objectoriented knowledge base of qualms consists of frames  rules  facts  and lists encoding the knowledge required by the expert system. the expert system utilizes simulationderived data about the operation of the process plant being diagnosed  which is generated by hysim. the qualms knowledge base contains generic process knowledge about 
becraft  lee  and newell 

chemical plants including frames for standard chemical plant unit operations  as well as process specific knowledge such as the plant topology and the functionality of specific units within the distillation plant case study process. thus  the expert system is designed for easy portability between industrial installations  with only the plant specific knowledge contained within the modular knowledge base requiring to be changed  as well as the development and training of neural networks specific to each plant. 
   the diagnostic metaknowledge contained within qualms includes the necessary information to collect the current sensor data from the process  run the modified version of innate to classify the present fault scenario using previously trained neural networks  and to analyze the results of the hierarchical neural diagnostic strategy. table 1 shows some of the rules contained in qualms which embed the the neural network program  innate  within the expert system. the results of the neural diagnosis are presented to the user in the form of both the numerical values of the output neurons and a relative classification ordering  and confirmation of the diagnosis by the deep knowledge expert system begins. 

1 innate/qualms diagnostic performance analysis 
in addition to the correctly functioning  fault-free scenario simulation of the case study process  1 single fault scenario simulations were developed for the process. these fault scenarios cover an extensive range of possible faults which could occur in the case study process. the data from these examples were used to train the neural networks used in the hierarchical neural diagnostic strategy. 
1 noise-free fault scenario diagnosis 
each individual neural network in the hierarchical diagnostic strategy was tested on the noise-free sensor data from all 1 scenarios. with the noise-free sensor measurements  each network performed flawlessly  with zero incorrect diagnoses throughout the entire test set. this result was to be expected  as these were the fault scenarios for which either the neural networks were trained  or which had no effect on the particular network's plant battery. the expert system analyzed the results and confirmed the diagnoses obtained 
from the neural diagnostic strategy. 
1 novel fault diagnosis 
to test the system's diagnostic abilities in novel fault situations  an additional fault scenario was conceived for which the neural networks were not trained. a simulation of the distillation plant was developed  containing a pipe burst or leak in the stream connecting the second distillation column and the pump immediately prior to it. using a pipe burst or leak as the novel fault scenario was deemed appropriate as it is a commonly encountered process fault in industrial situations. additionally  the location of the fault was not considered to be a unit operation  therefore the individual neural networks did not have a specific output node assigned to diagnose the fault. 
   when presented with the sensor data from the novel fault scenario  the first level main plant neural network correctly diagnosed the fault to be located in the column 1 plant battery  even though the fault was occurring downstream from the last unit operation in the plant battery. each of the second level neural networks also correctly diagnosed the fault. the preheat neural network correctly indicated that no faults were occurring in the preheat battery. the column 1 neural network correctly identified the fault as a process disturbance occurring upstream of the column 1 battery. the column 1 battery neural network indicated that none of the unit operations in its plant battery were the cause of the fault  which is the correct diagnosis for that battery. thus  while no individual second level neural network was able to give the correct diagnosis of the situation  the expert system was able to integrate the results from each of the individual neural networks to give the proper diagnosis for the novel fault situation: the first level network for the main plant narrows the diagnosis to the column 1 plant battery  and the individual second level networks indicate that the fault is occurring in the stream connecting the column 1 and column 1 plant batteries  thus providing the correct diagnosis. 
1 robustness to sensor noise 
the diagnostic system was also tested in the presence of sensor noise. random fluctuations of up to 1% and 1% 

noise levels were introduced into the process measurements 
learning and knowledge acquisition 

used by the system. the diagnostic performance of the hierarchical neural networks decreased slightly at the 1% noise level  with a greater degradation of performance occurring at the 1% levels  as seen in table 1. for the majority of cases  the expert system was able to confirm the faults diagnosed. 

1 conclusions 
an artificially intelligent operators' advisory system  innate/qualms  was designed to aid in the diagnosis of faults in large-scale chemical process plants. the integration of two fundamentally different diagnostic techniques  neural networks and expert systems  was used successfully to diagnose faults in a example case study process. the integration of the two technologies was investigated. the diagnostic system which was developed exhibited good diagnostic performance under a variety of conditions including novel faults  and the presence of sensor noise. 
