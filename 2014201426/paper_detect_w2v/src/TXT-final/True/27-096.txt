 
choosing appropriate models is crucial in analyzing complex physical phenomena  especially when supercomputing resources and complex partial differential equations are involved. this paper presents an approach to formulating mathematical models guided by the structure of a domain theory and the gross behavior of a physical problem. the approach is motivated by the observation that many physical domains  though complex and computationally expensive to analyze  have strong domain theories based on a few fundamental conservation laws and well-defined physical processes. furthermore  modeling decisions have to be guided by the behavior specific to a physical problem that the system is trying to model. by exploiting a domain theory and using problem specific behavior  the approach offers an uniform and efficient way of formulating models of various complexity  ranging from algebraic  ordinary to partial differential equations. the approach has been implemented in a computer program  msg  and tested in the heat transfer domain. 
1 	introduction 
modeling is an important first step in scientific computation and engineering analysis. to understand a physical phenomenon requires a representation of the phenomenon in the form of a mathematical model  carrying out simulations of the model  and interpreting the data from the simulations. the form of the model has a dramatic impact on the cost and the accuracy 
    most of the work was done at rutgers univerbity and partially supported by nsf under grant number dmc1  by the rutgers center for computer aids to industrial productivity  and by arpa under grant n1-k1 and by arpa and nasa under arpa-funded nasa grant nag1. i would like to thank lou steinberg for his guidance and support  and saul amarel  andrew gelsey  yogesh jaluria  elaine kant  bob vichnevetsky and members of the cap project for their comments. also thanks to bob boehm  richard marciano and three anonymous reviewers for their feedback to the earlier versions of this paper. 
1 	qualitative reasoning and diagnosis 
in understanding the phenomenon. the impact is even more significant in analyzing complex physical phenomena that require high performance and supercomputing resources. a few crucial approximations can transform complex partial differential equations to ordinary differential equations or algebraic equations  with the differences in resource requirements between supercomputers and workstations. 
　this paper describes an approach to formulating models. the models include not only algebraic and ordinary differential equations for modeling lumped phenomena  but also partial differential equations for modeling distributed phenomena  i.e. values of physical phenomena vary with time and spatial dimensions. this approach is based on two principles: 
  the use of the structure of a domain theory 
- to focus the approximations on choosing the types and the number of basic physical processes  and 
- to sequence the modeling process around the structure of the conservation laws. 
  the use of the gross behavior of a physical phe-nomenon  obtained through simple approximate models  to guide its modeling decisions. 
　the approach is targeted to domains where strong domain theories exist and simple approximate models for estimating gross behavior are available. it is motivated by the observation that many physical domains have strong and well-defined domain theories from which models are derived. these domain theories are based on several fundamental conservation laws and well-defined physical processes that are governed by domain-specific laws. examples of these domains are heat transfer  fluid mechanics and structural analysis where the laws of conservation of mass  of energy  and of momentum are the fundamental laws and the domain-specific laws relate the basic processes of mass  energy and momentum to the properties of materials in their respective domains. by organizing the modeling process around the structure of a domain theory  we can provide an uniform approach to formulating models of various complexity. 
　the approach is also motivated by the need of incorporating problem specific behavior of physical phenomena into modeling decisions. a model reflects the behavior of a physical problem at hand and the decisions behind the models have to be made within the context of the behavior. but how do we obtain the problem specific behavior to guide the modeling decisions  simple and approximate models exist in a domain that can be used to obtain the gross behavior of a problem. these models only give the estimates of the gross behavior of a problem  e.g.  the maximum temperature drop instead of the temperature distribution in a solid. however  these models are simple to compute  and the gross behavior is often adequate for making the modeling decisions. using the gross behavior of a problem  obtained from these approximate models  allows a system to quickly focus on a likely candidate model for the problem at hand. 
　the approach has been implemented in a computer program  msg  model selection and generation   which formulates mathematical models in the heat transfer domain. the models in this domain involve algebraic  ordinary and partial differential equations  for modeling lumped and distributed heat transfer phenomena. 
　the paper is structured as follows. section 1 introduces the domain theory of heat transfer and its implications for organizing the modeling process. section 1 presents the gross behavior of heat transfer and the methods for obtaining them. section 1 describes the program msg implementing this approach and an example problem. section 1 describes several features of this approach. section 1 compares this approach with related work  followed by the summary in section 1. 
1 	modeling process structured by domain theory 
many complex physical domains have well-developed domain theories that are based on several fundamental conservation laws and a set of physical processes defined by domain specific laws. the basic physical processes are the underlying concepts and entities. they are related to other physical properties in the domain through the domain specific laws. the conservation laws govern the interactions of these basic processes  and dictate how these processes are composed into a model. heat transfer is one of these domains. in the domain of heat transfer  the fundamental law is the conservation of energy and the three basic processes are conduction  convection and radiation heat transfer  defined by the fourier's law of conduction  the newton's law of convection and the stefan-boltzmann law of radiation. when a temperature gradient is imposed on an object from its environment  instances of the basic heat transfer processes occur and their interaction is governed by the law of conservation of energy. this law says that the net change of energy stored within any bounded region of space  i.e.  a control region1  is equal to the net heat flow into the region plus any internal heat generation within the region. all mathematical models  regardless of their complexity  are based on this conservation law. 
one way to view this conservation law is in the form 
1
 also called a control volume 
of 
where q s represent instances of basic heat transfer processes acting on surfaces of the region or internal heat generation processes within the region  and e represents internal energy change or energy storage within that region. regardless of the complexity of heat transfer models and the various forms in which the models appear  all of them can be traced to this form. 
　this general and yet simple form has two implications for the modeling process. the first implication is for the approximation decisions. since a model is a representation of this conservation law and the physical processes instantiated for a region in space  the choice of these processes will affect the final form of the model. various types and number of processes can be chosen. a model representing a few physical processes is less complex. similarly  a model representing lumped processes  i.e. processes which are assumed constant with respect to time and space  is less complex than a model representing differential processes  i.e. processes varying with respect to time and space. in other words  the complexity of a model depends on the choices of processes  and all the approximations in this domain are focused on choosing the types and the number of processes. a corollary to the focus of choosing physical processes is that the modeling process is compositional at the level of physical processes. the conservation law provides a template to put an arbitrary number of processes together once they are chosen. processes are put in the right or left hand sides of the equation depending on their types. 
　the form of a model depends on the choices of physical processes. however  these processes depend on the type of a control region where the conservation law is instantiated and the type of query that a model is supposed to answer. this dependency constrains how modeling choices should be made. in other words  the modeling decisions and approximations are not totally independent of one another. some of the decisions are constrained by earlier decisions. this dependency suggests a way to organize the modeling process in the following sequence. 
1. first  decide on the control regions of an object. 
1. for each control region  identify the potential active heat transfer and energy storage processes  and make approximations on them. 
1. finally  turn the processes into symbols in equations  simplify the equations  and provide relevant initial and boundary equations to make the models well-formed. 
1 	modeling decisions guided by gross behavior 
the domain theory provides a set of modeling decisions  and a way of organizing those decisions. how are these modeling decisions made  in particular  how can a system choose the control regions and the physical processes 
	ling 	1 

such that the final model is a candidate representing a physical problem with certain accuracy  
   to choose a candidate model  the system must be guided by the behavior specific to the problem that the system is trying to model. for example  if the temperature distribution of a problem is relatively constant in the x dimension  the system will choose heat transfer processes lumped in the x dimension  resulting in a model with the temperature function independent of x. the question is: how does a system know the temperature is constant in x  to know the behavior requires a model  but a model is what the system is looking for in the first place. the situation becomes a vicious circle  where intelligent modeling requires knowing a lot about a physical problem at hand. to know the problem requires a model  which in turn begs the question of where the model comes from. 
   one way to avoid this vicious circle is to use simple models to estimate the behavior of a problem. these models are simple to compute. they are domain specific. they are mostly expressed in terms of ratios and dimensionless numbers. they are approximate in the sense that they only predict gross behavior of a problem. however  the gross behavior is often adequate for guiding modeling decisions. these simple and approximate models exist in the heat transfer domain and allow this approach to incorporate problem-specific behavior into its modeling decision. for example  a control region can be lumped in the x dimension in an object if the temperature distribution is constant in that dimension. instead of finding the temperature distribution t x   the approach estimates the maximum temperature drop  xt in the object in the x dimension.  xt is the gross behavior of t x  because it only predicts the maximum drop. it does not give the temperature value at every point in x  as t x  does. if that maximum temperature drop is smaller than a threshold  then the approach infers that the temperature function is constant in the x dimension1. 
　instead of using a complex model to estimate t x   the approach can use some simple models to estimate  xt. for example   xt in a single-component solid can be estimated from the biot number  incropera and dewitt  1   hl/k  where h k l are respectively the convection coefficient  the conductivity and the thickness of an object in x. this ratio is simple to calculate and the values of h  l  k can be obtained from the input description of a problem. the rule for choosing a lumped control region in the x direction for a single component object then becomes: 
if the biot number hl/k is less than the threshold of 1  choose a lumped control region in x. 
for a multi-components object  the maximum temperature drop in each component can be estimated by its thermal resistance over the total thermal resistance of the object  and the control region for each component can be chosen using similar rules. other simple models for estimating the relative magnitude of heat transfer 
1
　　subject to some assumptions about the temperature profile. 
1 	qualitative reasoning and diagnosis 
processes and the rules for choosing them are obtained from domain experts  and the textbooks  incropera and dewitt  1; jaluria and torrance  1 . 
   besides using simple and approximate models to estimate the gross behavior of a problem  the approach also relies on a set of thresholds to determine the conditions under which approximations can be made  e.g. the value of the biot number less than 1. these thresholds are established based on the empirical and experimental studies of previous heat transfer problems. these thresholds are calibrated against accuracy requirements  and they establish the conditions for making approximations such that the output result of the model would meet certain accuracy. for example  the heisler charts  heisler  1  present the relations between temperature distributions and the biot number for various regular shape objects. from these charts  the maximum error for assuming uniform temperature distributions when the biot number is less than 1 is less than 1%. other studies have also been done to calibrate other thresholds for choosing various types and number of heat transfer processes  ling  1 . 
1 	msg: the program 
this section presents msg  the computer system that has been implemented based on this approach for modeling heat transfer. msg is focused on choosing mathematical models for typical heat transfer engineering analysis where accurate results with a typical error of less than 1% would be expected. the mathematical models are for modeling lumped and distributed heat transfer behavior in regular shape objects of single and multiple components. 
the input to msg is 
  a description of an object in terms of its geome-try  components  connections  material properties  initial and boundary conditions. 
  a query that a model is required to answer  and its spatial and temporal attributes  e.g.  t x t  would ask the temperature varied in the x spatial dimension and time. 
the output is: 
  a mathematical model expressed in terms of a set of equations  and 
  a set of assumptions which the system makes for that model. 
　the top level description of msg follows the sequence of choosing control regions  then heat transfer processes  and finally transforming processes into mathematical forms  as shown in figure 1. the approximate methods for estimating gross behavior and the thresholds calibrated to the accuracy requirement of less than 1% error are encoded within msg. 
1 	an e x a m p l e : 1-d transient m o d e l 
　the example involves heat transfer analysis of a composite made of two plates of brick and gypsum  having the same width and height dimensions  1 m on all sides  and the same thickness  1 m  shown in figure 1. plate 


	ling 	1 

1 	qualitative reasoning and diagnosis 

where h represents the convection heat coefficient  a represents the area of a surface  t1 the temperature at surface and t1  the temperature at its environment. assuming that t1  t1  then the order of magnitude approximation can simplify the model to a simplified model hat1. however  that simplified model is not consistent with the heat transfer theory as the expression does not represent any valid heat transfer process. the original model represents a convection heat flux and eliminating t1 from the original model destroys its definition  i.e.  convection heat transfer depends on temperature difference instead of temperature only. 
   the two heat transfer examples illustrate the case where the syntactic use of the order of approximation can lead to approximate models inconsistent with a domain theory. to ensure models consistent with a domain theory  the order of magnitude approximation cannot be applied to any arbitrary mathematical expression. it can only be applied to a set of physical processes in a way that represents the action of eliminating one or more physical processes. by focusing the approximations on choosing the types and the number of physical processes in a domain  msg avoids generating models inconsistent with the heat transfer theory. the constraint of ensuring consistent models is already built in msg. 
1 	constraining m o d e l i n g process 
msg demonstrates that the process of modeling is compositional at the level of choosing physical processes. furthermore  it demonstrates that a domain theory can constrain how modeling decisions are made. some modeling decisions can only be made after other decisions have been made. for example  formulating boundary conditions has to be made after choosing physical processes  and choosing physical processes has to be made after choosing control regions. a consequence of constraining modeling decisions is that modeling choices are also constrained by the earlier decisions  leading to a reduced search space for msg. if a totally lumped control region is chosen  msg does not need to choose heat transfer processes since a totally lumped model will only involve an algebraic or ordinary differential equation  either of which can be efficiently solved with many processes. furthermore  msg does not need to choose boundary equations for the totally lumped model. the reduced search space from constraining modeling decisions  and the use of simple approximate model to guide modeling decisions contribute to the efficiency of msg. msg currently takes less than 1 seconds on a sparcstation 1 to formulate a model involving coupled partial differential equations. 
　msg demonstrates an uniform approach to formulating models of various complexity in a physical domain  from simple algebraic to complex partial differential equations models. while partial differential equations are complex to analyze and difficult to comprehend  they are formulated in the same way as other simple models. they do not need a different modeling approach. the complexity of a model lies not in the way it is formulated  but in the choices made to the physical processes. 
1 	limitations 
this approach works because of a strong domain theory  where conservation laws exist and the domain specific laws are well defined  and approximate numerical methods and thresholds calibrated against accuracy are available. these features are present in other domains as well  such as fluid mechanics  panton  1   based on textbook analysis and discussions with domain experts. however  the requirement of a strong domain theory and the availability of approximate methods and thresholds limit this approach to well-established physical domains. 
	ling 	1 

1 	related work 
yip  yip  1  uses the asymptotic order of magnitude approximation to simplify partial differential equation models in fluid mechanics. his system accepts a detailed mathematical model and the constraints and values of terms in the model as inputs  and then carries out the asymptotic order of magnitude approximation on the input model. msg differs from his system by using approximate models to infer the order of magnitude values of physical processes and by carrying out approximations on physical processes to ensure models consistent with a domain theory. 
   most of the other modeling work is based on the compositional approach pioneered by falkenhainer and forbus  falkenhainer and forbus  1 . the compositional approach has a library of model fragments representing various phenomena in a domain. given a query and a physical situation  the approach composes relevant model fragments into a complete model. other work  iwasaki and levy  1; nayak et al.  1  has proposed ways to improve the process of selecting model fragments. msg differs from the compositional approach by focusing its modeling decisions on physical processes and using a domain theory to structure its modeling process. by organizing its modeling decisions around a domain theory  msg can formulate models for lumped and distributed phenomena in an uniform and efficient way. the compositional approach is aimed at a very broad class of phenomena  without making any assumption of a domain theory. msg relies on a strong domain theory  which makes msg less broadly applicable than the compositional approach  especially for a domain with no well developed theory. the compositional approach can handle qualitative and quantitative ordinary differential equations. msg is focused on quantitative models involving algebraic  ordinary and partial differential equations. finally  the compositional approach has paid less attention to the issue of getting the right level of numerical approximation than to getting a consistent and coherent model. 
   both addanki et al  addanki et al.  1   ellman et al  ellman et a/.  1  and weld  weld  1  focus on model selection. the work of addanki et al uses graphs to represent a set of models of a physical domain  and domain specific rules to select models that can resolve the conflicts between predictions and observation. weld's work uses the domain independent technique of intermodel comparative analysis. ellman et al use gradient magnitudes to select models. in all cases  model equations are explicitly input to the system. msg differs from them by constructing a model from the description of a physical phenomenon. 
1 	summary 
this paper describes a modeling approach to formulating complex mathematical models involving partial differential equations. the approach is targeted to domains with strong domain theories. the approach organizes its modeling process based on the structure of a domain theory  and uses simple approximate models to obtain problem 1 qualitative reasoning and diagnosis specific behavior to guide its modeling decisions. by exploiting these ideas  the approach can offer an uniform and efficient way to formulate models consistent with a domain theory. the approach has been implemented in a computer program  msg  which formulates algebraic  ordinary and partial differential equation models in the domain of heat transfer. 
