 
this paper discusses some trends in modelbased diagnosis. we consider some recent applications and discuss why they were possible  the lessons we learned from them  the new impulse that they gave to research in the field and the new challenges that emerged from them. 
1 	introduction 
the aim of this paper is to discuss some recent stories concerning the application of model-based diagnosis to industrial domains and the lessons we  as individuals and as a community  learned from such stories. 
　model-based diagnosis  mbd in the following  is an approach to diagnosis that was proposed in the early 1's to overcome limitations of the traditional expert systems approach  see  hamscher et ai.  1  for a collection of papers and  davis and hamscher  1  for an introduction . the philosophy of the model-based approach can be sketched as follows. diagnosis should be based on an objective model of the device  system  to be diagnosed. more specifically  different types of models can be considered: structural  concerning the physical or logical structure of a device   functional  describing the functions of a device   behavioral  describing how a device works  i.e.  how its functions are achieved   teleological  describing the purposes of the use of a device   or a combination of them. models should be reusable  in two ways. on the one hand  the same model of a device should be used for different problem solving tasks  such as diagnosis  simulation  reconfiguration  ... . on the other hand  models should be compositional: the model of a device should be usable in all the cases where the device is used as a component of a larger system. 
since the 1's a lot of work has been carried on and 
  several approaches to modeling have been proposed and investigated; 
  definitions of diagnosis and formal accounts of the task have been presented; 
  algorithms for solving the problem and overcoming its complexity have been designed; 
  applications have been developed. 
　mbd attracted researchers from many different fields of ai  and engineering  and played both the role of testbed of several approaches to kr and reasoning and the role of generator of new problems and approaches. 
　from an industrial point of view  diagnosis  or  more generally  guaranteeing the availability of systems  is a primary need. indeed  several diagnostic systems have been implemented since the mid 1's and some of them were success stories for ai. more recently  however  some links became stronger and this led  at least in some areas  to important projects and applications. in particular  the two authors were involved in some of these projects. 
　in the paper we analyze the reasons for such important evolution pointing out why  in our view  mbd is ready for applications  sect. 1   the applications that have been built and the lessons we learned from them  sect. 
1   the new research issues that arose from applications  sect. 1   concluding with some considerations on the implications for future activity in the field  sect. 1 . 
1 	why m b d is ready for application 
in this section we discuss the reasons that in our view make mbd ready for real application. in order to do that  it is interesting to start by looking at some past seminal talks and papers that strongly influenced our approach to the field  davis  1; 1; 1; hart  1; chandrasekaran and milne  1   and recent ones  such as  hamscher  1; struss  1b  . those paper pointed out the potential advantages of the model-based approach  as well as opportunities and goals. 
　did we achieve all of those goals and see all the opportunities  certainly not. some of them have been widely studied and we now have a clear understanding and available solutions  e.g.  many of the problems concerning modeling  the definition of diagnosis and algorithms for computing diagnoses efficiently had major advances . on the other hand  there are many aspects  such as dealing with dynamics or integrating models  that are still open research problems. 
　however  what was achieved in these years is in some sense more than solving many specific problems. in our view we succeeded in establishing ourselves as a community  with its agreed language and basic definitions. the foundations of the field are well established and we 
	console and dressler 	1 

share a clear specification of what the problem is and what its basic ingredients are. a good deal of theoretical work provided semantic foundations for our definitions and almost all of us have this semantics in mind when discussing about research topics or applications. 
let us analyze these foundations in more detail. 
　first of all  the diagnostic process relies on models which are in most cases component-oriented. a device is described in terms of its minimal replaceable or repairable components. for each type of component the model includes: a list of its variables  interface  internal or state variables  parameters   as well as a definition of its modes of behavior  including correct and fault modes . then the behavior of the component is described via a set of relations  constraints . both the nominal  correct  behavior and a set of known faulty behaviors can be described  de kleer and williams  1; struss and dressier  1   exploiting different modeling assumptions. for example  a model may be quantitative or qualitative  using different types of qualitative abstractions ; dynamic or static  in many cases the dynamics of a system is abstracted for the sake of simplicity ; crisp or probabilistic  where incomplete and/or imprecise information is represented using numeric information  as e.g.  in probabilistic networks . 
　the models of the components constitute a library of basic units that can be used for building models of complex devices  which only need to specify the structure of the device in terms of its components . such compositionality assumption is a fundamental one  allowing the re-use of models  and thus the possibility of building the diagnostic system for a new device without major efforts . obviously  the assumption has some major consequences on modeling  e.g.  the well-known  no structure in function  principle which requires that the model of a component does not depend on the contexts in which the component may be used in a complex device . 
　although the component oriented approach is the most widely adopted  it is not the only one. there are cases  in fact  where it is not easy or interesting to isolate components or the behavior of a system is not easily obtained as the composition of the behavior of its components. this is the case  for example  when processes have to be modeled or when the structure of the system is complex  as  e.g.  in physiological systems. thus  there are approaches that are based on process-oriented models that describe the global behavior of a system  usually in terms of causal networks  see e.g.   patil  1; porcheron et al.  1; provan  1  . 
the second foundation is the definition of diagnosis. 
there is a diagnostic problem whenever the observed behavior of a device is not in accordance with the expected behavior  i.e.  the behavior that can be predicted from the model  assuming that all the components are in a normal mode  fault detection . diagnosis corresponds to removing such an inconsistency and to explaining the faulty behavior. this amounts to finding which components of the system may be faulty  fault isolation  or  more precisely  finding an assignment of 
1 	invited speakers 
a mode to each component in such a way that the observed behavior is explained  fault identification . different notions of explanation can be adopted  ranging from weaker ones based on consistency  reiter  1; de kleer et al.  1  to stronger ones based on abduction  poole  1 ; see also the analysis in  console and torasso  1 . besides the logical characterization  there are also set-theoretic  peng and reggia  1; lucas  1  and probabilistic ones  pearl  1 . 
　several other aspects of the diagnostic process have been analysed and formalized: e.g.  diagnosis as an iterative process  struss  1a  test/probe selection  de kleer and williams  1   repair  priedrich et al.  1   integration with monitoring  dvorak and kuipers  1; lackinger and nejdl  1 . 
　characterizing diagnoses is a necessary and interesting problem but it is not sufficient. several algorithms for computing diagnoses that are correct wrt the characterization have been designed. the efficiency issue has been tackled from different points of view. fvom the theoretical one there are analyses of the complexity of the problem and of the special cases in which it is tractable  e.g.  see  levesque  1; bylander et a/.  1; eiter and gottlob  1; fyiedrich and nejdl  1  . 
fvom the practical point of view  several strategies for computing diagnoses efficiently have been devised. on the one hand  some approaches defined notions of  preferred diagnoses   e.g.  based on cardinality - single faults diagnoses are the preferred ones - or on other orderings or on fault probabilities  and algorithms for generating only those diagnoses  de kleer  1; raiman and de kleer  1; dressier and struss  1 ; other introduced focusing techniques for avoiding useless computations  e.g.   console et a/.  1   or techniques for re-using inferences  dressier and fveitag  1 ; others discussed how to exploit hierarchical models for focusing diagnosis  genesereth  1; mozetic  1 ; yet others coupled mbd with other techniques such as casebased reasoning  for caching results  e.g.  portinale and torasso  1    or machine learning. as regards the latter  there are approaches that use simple techniques to induce diagnostic rules from simulated cases  e.g.   mozetic  1; cascio et at.  1    or approaches proposing a closer integration between mbd and learning  e.g.   baroglio et a/.  1  . 
　the research on mbd benefited from interactions with many other disciplines of ai and of computer science; to mention some: knowledge representation  nonmonotonic reasoning  qualitative reasoning  constraint problem solving  probabilistic reasoning  machine learning  temporal reasoning  control theory  ... in other words  model-based diagnosis has been in the late 1's and 1's what heuristic diagnosis was ten years before: an area that originated new ideas that spread to other fields of ai  the use of the atms  de kleer  1  and of abduction are two examples  and an area where new ideas have been tested in practice  e.g.  qualitative or non-monotonic reasoning . 
the fact that several aspects in the field are ma-

ture is demonstrated by the existence of papers that review the diagnostic  task systematically and at the knowledge level  mapping the techniques that can be used for solving diagnostic problems to the features of the application domains. papers such as  poole  1; console and torasso  1; ten teije and van harmelen  
1; de kleer et of.  1; cordier  1; lucas  1; brusoni et al.  1}  pointed out the different alternatives that can be considered for characterizing diagnoses  discussing their properties and comparing them. moreover  some recent projects defined frameworks for selecting the most appropriate approach to diagnosis  given a specific application  e.g.  the artist  leitch et ai.  1; 1  and pride  chantler et al.  1  projects . 
　finally  but not less important  mbd has been a meeting point for theoretical and application work. this is not to say that this is not true of other areas of ai  but what happened in mbd is that many people have been active on both sides. this led to interesting research projects and applications. this is a very important topic and we shall devote the next section to it. 
　in conclusion  let us return to the initial question  why is mbd ready for applications  . a tentative answer is:  because we have reasonable foundations for the field and understanding of how a diagnortic problem can be tackled . this means that  given a problem  we can envisage how it could be tackled  which techniques could be adopted and which aspects of the problem could be critical or beyond available techniques  and thus would need either to be abstracted or solved in some approximate way . and we have the instruments to actually build systems. thus  although there are many open problems for research  we can tackle applications without cheating and claiming that everything is solved  but also without having to consider each new application starting from scratch and as a sort of bet. 
1 	what we did learn from applications 
after the discussion in section 1  it is interesting to analyse some of the applications that have been built recently and the lessons we learned from them  focusing on a specific field  automotive systems  on which we gained experience over the last years. 
　model-based diagnosis has been applied to many different fields. historically  one can recognize two mainstreams. on the one hand  there is the approach that focused on the diagnosis of technical systems  mainly circuits in the early years   based on a structural decomposition of the device to be diagnosed and on a description of the  correct or faulty  behavior of each type of component. on the other hand  it is important to mention the important works on medical diagnosis. however  the latter had no strong impact on applications  for several reasons whose analysis is outside the scope of this paper   but had important impacts on the genesis of mbd  con-
sider experiences such as abel  patil  1  and casnet  weiss et al.  1    although the community recognizes itself mostly in the first mainstream. 
　as mentioned above  electronic devices were the main application used in the early work to experiment ideas and techniques  see most of the papers in  hamscher et a/.  1  . the diagnosis of copiers led the xerox pare group to interesting research on efficient algorithms and focusing strategies. as an example of industrial application  it is worth mentioning the system developed by hewlett packard  allred et al.  1 ; cdiag by dassault electronique  loiez and taillibert  1  is a commercial system for the diagnosis of different types of circuits  including analog one; this shows that it is interesting to have working applications also for domains in which there are still interesting open problems for research . 
　although electronic devices were one of the main field for experimenting ideas  most of the applications that are currently on the field come from other areas. for example  the experience in tiger  an eu founded project  originated a commercial system for the diagnosis of gas turbines that is used in several locations trave massuyes and milne  1 . interesting work was performed on power generation and distribution systems: two applications that are being moved to the field are the diapo system by electricite de rrance  for nuclear power plants  porcheron et al.  1   and a system by cise for power distribution lines  lamperti and pogliano  1 . 
　aerospace is another important area of application  on which many details are not disclosed . among different applications  it is interesting to mention the role that model-based reasoning and diagnosis are playing in the nasa remote agents project for autonomy in space  doyle  1 ; particularly interesting is the livingstone system  williams and nayak  1  for the diagnosis and reconfiguration of space autonomous agents. other interesting aerospace applications have been developed by rockwell  see  provan  1j for a recent example ; aerospatiale is experimenting the cdiag system mentioned above in an automatic test equipment for analog and hybrid boards; similarly boeing developed interesting applications. 
　let us now turn to discussing the automotive domain. there are several reasons why diagnosis  and mbd in particular  became more and more important in this field. first of all  the increasing complexity of the cars  especially from the electronic point of view  called for more sophisticated diagnostic techniques  both on-board the car and in the workshop . second  legislation required the presence of diagnostic systems in the electronic control unit  ecu  of the car. third  competition between manufactures led them to investigate new features for attracting customers and for augmenting their satisfaction. thus  the interest of car manufacturers is growing and they are looking at model-based reasoning as one way of managing the increasing complexity of cars and the high maintenance costs and unnecessary downtime deriving from such a complexity. 
　the application to the automotive field is very promising from a commercial point of view  but also challenging from the technical point of view  under several viewpoints. first of all  the systems to be diagnosed are-com-
	console and dressier 	1 

plex  but many of them can be managed with state-ofthe-art technologies. second  different physical domains are involved  ranging from mechanical  to hydraulic  electric and electronic systems. thus the field is an ideal one for applying and experimenting modeling and diagnostic techniques. third  most of the critical devices to be diagnosed  especially on-board  are dynamic feedback system with an active control  performed in most of the cases by the software running on the ecus ; diagnosing these system is a very challenging problem and stimulated a lot of work from the research perspective. the application on-board the car imposed several new problems and constraints  mainly due to the resources that are available on-board and to the real-time constraints. 
　in summary  the application to such a domain led mbd researcher to confront themselves with many interesting problems and  as we shall discuss later  this had a very positive feedback on research. this was due to the possibility of working on real systems  together with the end users. several results came out of this cooperation. first of all  there is a number of systems  of various nature  that are deployed and used in practice. among them  it is worth mentioning idea  developed by centro ricerche fiat and currently used in more than 1 workshops around italy to diagnose some 1 different types of subsystems within a car  cascio and sanseverino  1 . another interesting system is mds by daimler-chrysler  which is going to become a commercial product. autosteve is a system for the automatic generation of the fmea  failure modes effect analy-
sis  in case of electrical circuits  price  1  used by ford and jaguar. an approach to diagnose chevrolet engines is discussed in  mosterman et al.  1 . raz'r by occ'm is a modeling and diagnosis development and runtime environment; it is used by bosch and volvo within the vmbd project  see below . 
last but not least it is fundamental to mention the 
vmbd project  funded by the european union   which involved a number of partners including car manufactures  daimler-benz  fiat  volvo   suppliers  bosch  dassault electronique  genrad  magneti marelli and 
occ'm  and universities  aberystwyth  paris xiii and 
turin   and whose goal was to make a step forward in the use of model-based diagnosis both on-board the car and in the workshop. the project was successful from several points of view. as an immediate effect  it led to the development of three prototype applications  based on state of the art techniques  and demonstrated on real cars: the common rail fuel delivery system  on a lancia car   the dti fuel delivery system and the automatic transmission  on a volvo car . the models we adopted are mostly qualitative ones  some simple quantitative models had to be used for measurement interpretation and for fault detection . for the two fuel delivery systems we adopted models based on qualitative deviations  malik and struss  1 . the components are modeled in terms of qualitative differential equations that include appropriate parameters whose values allow for the representation of fault modes of the components. the equa-
1 	invited speakers 
tions for deviations  in which the variables represent deviations of quantities from expected values  are obtained via algebraic transformations. this form of modeling proved to be very useful since in most cases it is relevant to reason in terms of variables deviating from their expected values  rather than in term of absolute values. 
　for the off-board system we adopted standard mbd; for the on-board one we experimented the direct use of mbd  for the dti using raz'r  and a precompilation approach: in the common rail diagnostic trees are synthesized starting from the solutions to a set of simulated cases computed using the model-based approach. this allowed us to produce diagnostic systems that can be easily implemented on current ecus   see  cascio et al.  1  for details . 
　probably the most important  even if not immediate  effect of the project is that it contributed to pushing mbd; manufactures and suppliers had the opportunity of having a close look at the technology  using it on their systems and viewing the advantages  and problems  that it can lead to; as a result  some of them decided to invest on mbd. the project was a unique opportunity for us as researchers  not only to experience our ideas and techniques  but also to face new problems and generate a huge number of new research issues. finally  the project stimulated the interest of other manufactures and suppliers and will probably originate a number of new projects  in several different directions. 
　in summary  we have that although automotive applications are complex and there are still open research problems  the systems that have been implemented in the last years witness the fact that applications solving real problems can be built. the same story could repeat in other application areas  provided that similar conditions are met. this would require the involvement of end-users in application projects  in co-operation with research centers and suppliers of solutions. in order for this to happen  as naive as it may sound  it is important that researchers work actively in trying to involve companies in their local environment and start projects on real applications. in this sense  in the european context  the role of the funding from the european union has been fundamental in the automotive domain and could play the same role also in other domains. 
　from a technical point of view  it is important that the experiences gained in the past projects are re-used. in fact  they can tell a lot on which problems can be solved and which are currently beyond the state of the art and about which techniques are suitable for a given problem. in particular  it would be very important to have frameworks for analysing problems and tools for supporting the construction of model-based systems  without having to re-implement most of the software every time. some advances in this direction are currently being made but many efforts are still needed. in particular  it would be interesting and important to design open architectures for diagnostic systems and to make available software modules  e.g.  as com or corba components  that can be combined to create mbd applications. 

1 	applications stimulated new research 
in the previous sections we stressed the idea that it is important to work on applications even if not all the research problems are solved. in this section we want to stress another issue: building applications is not the end of research. actually  working on applications is a big advantage for research  rising new relevant research issues. this indeed has been the case for model-based diagnosis  in our experience. thus  it is fundamental that researchers work on both theory and applications; keeping the two aspects too distant is a big mistake  especially for researchers who risk to spend a lot of time and efforts on artificial problems  each one attracting the interest only of a closed community. 
　thus  let us analyse in more detail some of the research issues that arose from the recent applications of model-based diagnosis. as in previous sections  we shall base the discussion on our experience in the automotive domain  and obviously the discussion will be partial . 
　different modeling techniques have been used in the applications discussed in the previous section. each model relies on some assumptions  being an abstraction of the actual system. although the problem of choosing the appropriate models  given the requirements of the diagnostic task  has been pointed out already in  davis  1   there is still a lot to be done for clarifying the issue. in particular  it would be interesting to have a general characterization and criteria that could help in the choice of the model that is most suitable for a given problem. this does not mean  however  that new modeling techniques are not needed. several applications  for example  pointed out that although qualitative models are very useful  some form of quantitative reasoning would be important  especially in the early phases of the diagnostic process  fault deletion in particular  and for discrimination purposes. thus  research on the integration of qualitative and quantitative reasoning  or on semi-quantitative reasoning  is very important. 
　an ideal output of research on modeling should lead to a sort of  intelligent model library   i.e.  a repository of models of components that could be used in different applications. reusability is in fact an important issue which still needs a lot of research. in fact  although in principle models of components are reusable  in practice this is a difficult problem. in order to improve reusability one should have different models of the same component  at different levels of granularity and based on different modeling assumptions. the repository should be intelligent and should provide guidelines to select the most appropriate model for a given application. 
　one specific research issue on which a lot of attention concentrated since the early age is the problem of dealing with dynamics  hamscher and davis  1 . this is in fact a critical aspect to be taken into account in most applications. several approaches to deal with dynamic  and time-varying  behavior have been proposed  see the discussion in  brusoni et a/.  1   and there is a very active debate  in which the experiments on applications play a fundamental role . it is worth noting that some of the proposals introduced in the mbd community techniques that are used in other fields; two examples are the use of bond graphs in  mosterman and biswas  1  and of techniques coming from system engineering  as e.g.  in  chantler et al.  1 . closer connections with these  and other  fields is a topic for future research. 
　the work on automotive applications pointed out that the diagnostic process  especially when performed onboard the car  is quite complex. the need of integrating diagnosis  in its restricted sense of interpretation or explanation of observations  and planning for scheduling  and performing  tests or actions was recognized already several years ago  e.g.   friedrich et al.  1; struss  1a  . however  in many cases the problem is more articulated and difficult than anticipated and there are aspects and opportunities that have not been considered yet. for example  in several systems it is interesting and important to perform active tests when the operating conditions allow them  e.g.  when a car is running at a constant engine speed and the pedals are in specific positions . this requires the ability of scheduling such tests  to avoid performing them in critical situations   performing some action and interpreting its effects. there are many opportunities for research on this problem  linking work on planning and theories of action and change and on perception  e.g. vision or sensing  more closely to the diagnostic task. 
　the future of diagnosis in automotive domains is the application on-board the car. in vmbd we experimented the use of mbd for on board diagnosis but in order to sit on current technology ecus  which have a few kilobytes of memory   we also considered the use of mbd to generate decision trees to be used on-board. mbd proved to be very flexible for such a task. however  the possibility of actually using model-based diagnosis on-board has to be investigated further. this  in fact  would be more flexible  opening new opportunities  and a closer integration with the off-board system to which the on-board one could pass useful information . would it be conceivable to define a run-time model-based system  with reduced functionality but that could be implemented in next generation ecus  will the idea of having an onboard car-pc be pursued by car manufactures and suppliers  this would be an fundamental opportunity for the growth of our field. 
　still considering on-board applications  it would be interesting to investigate tele-diagnostics  having a satellite connection between a car and an assistance center  for performing diagnosis or actions on the car or suggesting the driver what to do or how to reach the closest workshop  which  at the same time could be alerted . such a centralized model would be important also for simplifying the maintenance of models which could be done only on the server. an important role could be played also by approaches to preventive diagnosis  which needs further studies. for example  one could recognize a non-optimal behavior of some component  possibly exploiting wear models   and tune the system to avoid such 
	console and dressler 	1 

behaviors or warn the user or just keep track of the problem until the next maintenance. 
　however  the most important research  and practical  issue risen by research on automotive domains does not concern a specific step within the diagnostic process  but rather the role of diagnosis along the design manufacturing and service chain. what emerged clearly is that the current situation in which diagnosis is not integrated along this chain is not working. building models for diagnosis a-poateriori  when devices are manufactured is not a good choice. it makes diagnosis more difficult  especially as regards modeling  and does not allow to exploit all the potential advantages of the model-based approach. indeed  model-based diagnosis should be integrated along the process; in such a way  the diagnosabiiity of the system being designed could be tested and design choices  e.g.  selecting which sensors to use and where  could be influenced by these tests. this requires the availability of a library of models of basic components   library that could be extended when new components are in turn designed  and the integration of modelbased diagnosis into design tools. in this way  the models for diagnosis could be an automatic result of the design process  as well as other aspects such as  e.g.  the fmea of the device to be used in documentation manuals. this integration would provide significant benefits also for design since it would avoid the redesign of systems which do not meet diagnosability requirements. some ideas in the direction of integrating diagnosis and design were presented in the past  e.g.  the work on design for testability  williams and parker  1  and on sensor placement  scarl  1  . however  this is a topic requiring many efforts  possibly involving people working on design and companies that produce design tools. 
　the list of new topics could be longer  but providing it is not the goal of this paper. our goal is to stress that many of these problems would have not been recognized without working on real with end users. this work provided a new important impulse to research  impulse that would have been impossible without the applications. 
1 	some implications for the future 
in the previous sections we discussed the important role that applications had in the recent advances in mbd. they allowed researchers to experiment and validate their techniques; this work pointed out a number of new important research issues. thus  applications allowed the field to grow with new impulses  opening new research opportunities and avoiding to be confined on sterile  purely academic issues. 
　working on real applications requires the meeting of people from the research part and users with application problems. the recent successes in the field of mbd point out that this requires efforts from both sides. first of all  there must be an effort to create the opportunity for the meeting; after that there must be an effort in understanding each other. a number of conditions facilitated these aspects in the case of mbd. first of all  we 
1 invited 	speakers 
stress once again the importance of presenting ourselves to companies as a community with a strong common background. this is not to say that we agree on everything  but this means that the probability of having completely different answers on basic questions and problems when discussing with different researchers is low. this avoid confusion into potential  customers . second  we are a community which already involves people from the application side  working in corporate research centers or in end-user companies. the participation to the annual  workshop on principles of diagnosis  is not only academic. this was the result of big efforts; we always tried to involve application people  maybe organizing special events. this interest is now a witness for attracting other people from the application side. 
　finally  on the european side an important role has been played by funding from the european union. a part from many specific protects  an important initiative is the monet  monet  j network of excellence on model-based systems and qualitative reasoning. monet involves some 1 nodes  including universities  research centers and companies and its role is the diffusion and promotion of model-based techniques. the network is very active in this task  especially towards companies  creating thus the background for facilitating the meeting between research and application and thus the conditions for new projects. obviously  for that to happen  it is important that all researchers in the field look around for finding potential applications and that companies invest on such applications. past experiences show that there is a chance that the investments do not get lost. 
　prom the research point of view  the analysis in the paper points out that there are many open issues and opportunities for co-operation with many other fields of ai  exactly as it was in the past. 
1 	acknowledgements 
the authors are indebted to the partners in the vmbd project  be 1 . special thanks to d. theseider dupre  p. struss  p. torasso  for their comments. 
