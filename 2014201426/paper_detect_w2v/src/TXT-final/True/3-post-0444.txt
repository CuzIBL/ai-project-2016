
one of the ground tools used to operate the mars exploration rovers is a mixed-initiative planning system called mapgen.  the role of the system is to assist operators building daily plans for each of the rovers  maximizing science return  while maintaining rover safety and abiding by science and engineering constraints.
in this paper  we describe the mapgen system  focusing on the mixed-initiative planning aspect. we note important challenges  both in terms of human interaction and in terms of automated reasoning requirements.   we then describe the approaches taken in mapgen  focusing on the novel methods developed by our team.
1 introduction
many complex systems are operated with operations plans that are generated offline at different intervals.  spacecraft  in particular planetary rovers  provide some of the most extreme examples of such operations.  in the case of the mars exploration rovers  a new plan was generated for each rover  every martian day  which is slightly longer than an earth day .  each plan had to satisfy complex safety rules  while achieving as much science as possible.
a mixed-initiative activity planning system called mapgen was one of the key tools used to generate the daily plans for the mars rovers.  the complete set of constraints and operations preferences  which varied significantly over time and between days  was impossible to formally specify.   this made a fully automatic plan generation approach inapplicable to the problem at hand.  however  the limited time available for plan generation and the complexity of the task at hand also made it infeasible to generate highly effective plans manually.  consequently  a mixedinitiative planning approach was adopted  where humans could control the construction of a plan  while automated planning and reasoning capabilities were used to assist the human user in making decisions  actively enforce constraints  and handle mundane task management issues.
while mixed-initiative planning   burstein and mcdermott  1  is a fairly established field  the mapgen application provided new challenges  both in terms of interactions with the user and in terms of how to apply automated reasoning. in this paper  we outline these challenges and describe the solutions developed.
1 challenges and requirements
the primary challenge in the deployment of mapgen for the mer mission was to overcome skepticism about the use of automated planning.  in particular  there were concerns that users would not understand what the automation was doing and that the automation would limit human input.  to address this  the tool had to allow the user a broad range of operations  sufficient to arrive at any desired legal plan.  at the same time  the automated reasoning behavior had to  feel natural  to the user.
other specific challenges arose from user requirements. these included adjustable control over planning and scheduling decisions  as well as easy placement of activities in time.  the key motivation was to allow users to choose ways to adapt plans to complex limitations such as onboard energy.  these decisions required human-level judgment.
1 mixed-initiative planning in mapgen
like most mixed-initiative planning systems  mapgen combines a user interface with a planning services framework.  in mapgen  the user interface is an established spacecraft operations tool called apgen  maldague et.al.  1   and the planning and automated reasoning services are provided by a constraint-based planning framework called europa   frank and j¨®nsson  1 .
through the interface  users can edit the plans  with oversight and active constraint enforcement supplied by the automated reasoning component.  the core notion is that users can modify a plan by adding  editing  moving  and deleting high-level activities.  the automated reasoning component handles management of low-level and support activities  such as ensuring resources like cpu are turned on when required.  the automated reasoning also enforces constraints stemming from flight rules and specific daily constraints that define the coordination of science activities.
1 interactive plan modification
one of the core issues in mixed-initiative planning is the introduction of external decision-making and plan editing into a carefully designed automated search engine.  the intrusion of user choices complicates commonly used approaches such as backtracking search and propagation-based forward checking of consistency.  the europa planning framework used in mapgen supports non-chronological backtracking  but it cannot propagate information in plans that have constraint violations.  to support arbitrary changes by users  mapgen included a plan modification strategy that would adjust plans to eliminate inconsistencies.
1 interactive temporal reasoning
the most common way for users to modify plans is to change the placement of activities in time.  the europa planning framework tracks a family of temporal instantiations  represented as a simple temporal network.  this made it possible for users to quickly modify the temporal placement of activities while staying within a solution family.  in mapgen  this idea was extended further to allow users to quickly move to a nearby family that differed only in the ordering of a small set of activities  using the previous solution as a heuristic to guide the search.
1 interactive planning and scheduling
as noted above  mapgen users wanted a range of automated planning services.  the system offers a fully automated  plan everything  operation  a selective  plan this and everything related to it  operation  and a fine-grained  plan this and try to put it here  operation.  users can also un-plan activities and store them in a  hopper   which holds requested activities that are not yet in the plan.
1 minimizing perturbation
the key to making the automated services feel natural and unobtrusive is for them to respect the existing plan as much as possible. this is accomplished by combining an effective form of temporal placement preference with a heuristic bias. for changes in the temporal placement of activities  the system exploits the underlying temporal flexibility of europa plans.  as each plan represents a family  the system chooses an instance to display that is as close as possible to what the user had prior to the changes being made. for more significant changes  such as those involving automated planning  the heuristic bias guides the search to options that restrict changes in temporal placement to those needed to satisfy constraints; thus the plan changes only in accordance with achieving the user's desires.
1 responsiveness issues
mixed-initiative planning systems must respond and return control quickly to the user.  for simple temporal placement  this is not a difficult issue  since the core operation is propagation in a simple temporal network  which can be done in low-order polynomial time.
for an automated planning operation  which involves a cascading decision process  mapgen relaxes completeness in favor of responsiveness.  this has to be done carefully to maximize chances of finding near-optimal solutions within limited time.  we developed a backtracking algorithm that noted the difficulty of planning activities  and when the effort to plan an activity exceeded an allowance determined by its priority  the activity was rejected from the plan.
1 open issues and future work
a number of issues that arose in the development and use of mapgen could not be resolved in time for the mars rover application; among those are the following.
explanations for user
when activities could not be moved or planned  due to a combination of prior decisions and applicable constraints  users had a hard time understanding why.  this made it difficult for them to resolve the problems.  to address this  an explanation facility is needed that can provide understandable reasons to the user and respond to questions.
improved reasoning and planning
while the planning approach used in mapgen was quite effective  it left certain aspects of decision-making to the user-in particular  the user was tasked with handling vague preferences and very complex resource availability limitations.  future work should move towards incorporating complex preferences and automatically planning against complex resource limits.
1 conclusions
the use of mapgen as a critical tool in the ground operations for the mars exploration rovers is a major milestone in the application of automated planning in space exploration and other complex domains. mission operations staff successfully used the tool in an intense  time-pressured environment  leading to an estimated 1 and 1 percent increase in science return  compared to operating without ai assistance.  the deployment of mapgen has also identified key challenges for the mixed-initiative planning community and for the automated planning community as a whole.
