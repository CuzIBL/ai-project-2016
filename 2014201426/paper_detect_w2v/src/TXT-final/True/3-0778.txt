
brain-computer interfaces  as any other interaction modality based on physiological signals and body channels  e.g.  muscular activity  speech and gestures   are prone to errors in the recognition of subject's intent. in this paper we exploit a unique feature of the  brain channel   namely that it carries information about cognitive states that are crucial for a purposeful interaction. one of these states is the awareness of erroneous responses. different physiological studies have shown the presence of error-related potentials  errp  in the eeg recorded right after people get aware they have made an error. however  for human-computer interaction  the central question is whether errp are also elicited when the error is made by the interface during the recognition of the subject's intent and no longer by errors of the subject himself. in this paper we report experimental results with three volunteer subjects during a simple human-robot interaction  i.e.  bringing the robot to either the left or right side of a room  that seem to reveal a new kind of errp  which is satisfactorily recognized in single trials. these recognition rates significantly improve the performance of the brain interface.
1 introduction
a brain-computer interface  bci  is a system that translates the intention of a subject  as represented by his brain waves  typically  electroencephalogram signals   into a control signal without using activity of any muscles or peripheral nerves  millan  1; wolpaw＞ et al.  1 . electroencephalogram  eeg  is recorded non-invasively by means of electrodes placed on the scalp. then some features are extracted from the eeg and sent to a classifier  whose response is translated into some action thus making possible mental control of different devices. for instance  recent studies have shown that after a few days of training  subjects are able to control a miniature robot in an indoor environment with several rooms  corridors and doorways only using the signals derived from an eeg-based bci  millan＞ et al.  1 . this same system could be used to drive a wheelchair so that a subject suffering from severe motor disabilities  but with intact cognitive capabilities  could greatly gain in autonomy. other applications  such a virtual keyboard  could more generally provide an alternative way of communication with the outside world  birbaumer et al.  1; wolpaw et al.  1; millan＞ et al.  1 .
　nevertheless  bcis-as any other interaction modality based on physiological signals and body channels  e.g.  muscular activity  speech and gestures -are prone to errors in the recognition of subject's intent  and those errors can be frequent. indeed  even well-trained subjects rarely reach 1% of success. a possible way to reduce errors consists in a verification procedure whereby each output consists of two opposite trials  and success is required on both to validate the outcome  wolpaw et al.  1 . even if this method greatly reduces the errors  it requires much more mental effort from the subject and reduces the communication rate.
　in contrast to other interaction modalities  a unique feature of the  brain channel  is that it conveys both information from which we can derive mental control commands to operate a brain-actuated device as well as information about cognitive states that are crucial for a purposeful interaction  all this on the millisecond range. one of these states is the awareness of erroneous responses  which a number of groups have recently started to explore as a way to improve the performance of bcis  schalk et al.  1; blankertz et al.  1; parra et al.  1 . since the late 1s  different physiological studies have shown the presence of error-related potentials  errp  in the eeg recorded right after people get aware they have made an error  carter et al.  1; falkenstein et al.  1; holroyd and coles  1 . nevertheless  most of these studies show the presence of errp in typical choice reaction tasks  carter et al.  1; falkenstein et al.  1; blankertz et al.  1; parra et al.  1 . in this kind of tasks  the subject is asked to respond as quickly as possible to a stimulus and errp  sometimes referred to as  response errp   arise following errors due to the subject's incorrect motor action  e.g.  the subject pressed a key with the left hand when he should have responded with the right hand . more recently  other studies have also shown the presence of errp in typical reinforcement learning tasks where the subject is asked to make a choice and errp  sometimes referred to as  feedback errp   arise following the presentation of a stimulus that indicate incorrect performance  holroyd and coles  1 . in

figure 1: exploiting error-related potentials  errp  in a brain-controlled mobile robot. the subject receives visual feedback indicating the output of the classifier before the actual execution of the associated command  e.g.   turn left  . if the feedback generates an errp  left   this command is simply ignored and the robot will stay executing the previous command. otherwise  the command is sent to the robot  right .both cases  response errp and feedback errp  it has been observed a negative potential in the eeg with a fronto-central scalp distribution  see figure 1  whenever subjects make errors. this negative potential is most probably generated in a brain area called anterior cingulate cortex  which is crucial for regulating emotional responses.
　an important aspect of the two described errp is that they always follow an error made by the subject himself. first the subject make a selection  and then errp arise either simply after the occurrence of an error  choice reaction task  or after a feedback indicating the error  reinforcement learning task . however  in the context of a bci  or human-computer interaction in general  the central question is:
　 are errp also elicited when the error is made by the interface during the recognition of the subject's intent  
　in order to consider the full implications of this question  let's imagine that the subject's intent is to make a robot reach a target to the left. what would happen if the interface fails to recognize the intended command and the robot starts turning in the wrong direction  are errp still present even though the subject did not make any error but only perceive that the interface is performing wrongly 
　the objective of this paper is to investigate how errp could be used to improve the performance of a bci. thus  we will first explore whether or not errp also follow a feedback indicating incorrect responses of the interface and no longer errors of the subject himself. if errp are also elicited in this case  then we could integrate them in a bci in the following way as shown in figure 1: after translating the subject's intention into a control command  the bci provides a feedback of that command  which will be actually executed only if no errp follows the feedback. this should greatly increase the reliability of the bci as we will see later. of course  this new interaction protocol depends on the ability to detect errp no longer in averages of a large number of trials  schalk et al.  1   but in each single trial using a short window following the feedback that shows the response of the classifier embedded in the bci.
　in this paper we report experimental results with three volunteer subjects during a simple human-robot interaction  i.e.  bringing the robot to either the left or right side of a room  that seem to reveal a new kind of errp  which is satisfactorily recognized in single trials. these recognition rates significantly improve the performance of the interface.
1 experimental setup
to test the presence of errp after a feedback indicating errors made by the interface in the recognition of the subject's intent  we have simulated a real interaction with a robot  where the subject wishes to bring the robot to one side of a room  left or right  by delivering repetitive commands until the robot reaches the target. this virtual interaction is implemented by means of two horizontal progress bars made of 1 steps each. one of the bars goes from the center of the screen to the left side  left bar   and the other bar progresses to the right side  right bar . figure 1 shows the left and right horizontal progress bars used as feedback.
　to isolate the issue of the recognition of errp out of the more difficult and general problem of a whole bci where erroneous feedback can be due to non-optimal performance of both the interface  i.e.  the classifier embedded into the interface  and the user himself  in the following experiments the subject delivers commands manually and not mentally. that is  he simply presses a left or right key with the left or right hand. in this way  any error feedback is only due to a wrong recognition of the interface of which is the subject's intention.

figure 1: left and right horizontal progress bars. the goal of an interaction experiment is to fill one of the bars  which simulates a real interaction with a robot that needs to reach one side of a room  left or right . the system fills the bars with an error rate of 1%; i.e.  at each step  there was a 1% probability that the robot made a movement in the wrong direction.　three volunteer healthy subjects participated in these experiments. the subject sends a command after a stimulus delivered by the system  the word  go  appears in the screen . the system filled the bars with an error rate of 1%; i.e.  at each step  there was a 1% probability that the robot made a movement in the wrong direction. subjects performed 1 series of 1 progress bars  the delay between 1 consecutive steps  1 consecutive  go  from the system  was of 1 seconds  random delay to prevent habituation . duration of each interaction experiment  i.e.  filling a progress bar  was about 1 seconds  with breaks of 1 minutes between two series but no break between interaction experiments of the same series. eeg potentials were acquired with a portable system  biosemi activetwo  by means of a cap with 1 integrated electrodes covering the whole scalp and located according to the standard 1 international system. the sampling rate was 1 hz and signals were measured at full dc. raw eeg potentials were first spatially filtered by subtracting from each electrode the average potential  over the 1 channels  at each time step. the aim of this re-referencing procedure is to suppress the average brain activity  which can be seen as underlying background activity  so as to keep the information coming from local sources below each electrodes. then  we applied a 1 hz bandpass filter as errp are known to be a relatively slow cortical potential. finally  eeg signals were subsampled from 1 hz to 1 hz  i.e.  we took one point out of 1  before classification  which was entirely based on temporal features. indeed the actual input vector for the statistical classifier described below is a 1-second window starting 1 ms after the feedback and ending 1 ms after the feedback for channels cz and fz. the choice of these channels follows the fact that errp are characterized by a fronto-central distribution along the midline  see figure 1 . thus the dimensionality of the input vector is 1; i.e.  concatenation of two windows of 1 points  eeg potentials  each.
　no artifact rejection algorithm  for removing or filtering out eye or muscular movements  was applied and all trials were kept for analysis. it is worth noting  however  that after a visual a-posteriori check of the trials we found no evidence of muscular artifacts that could have contaminated one condition differently from the other.
1 statistical classifier
the different classes are recognized by a gaussian classifier trained to classify single trials as  correct  or  error . the output of this statistical classifier is an estimation of the posterior class probability distribution for a single trial; i.e.  the probability that a given single trial belongs to class  correct  or class  error . the present classifier is quite similar to that proposed by millan＞ et al.  in the framework of eegbased bcis  the main difference being the update rules.
　in this statistical classifier  every gaussian unit represents a prototype of one of the classes to be recognized. we use several prototypes per mental task. we assume that the classconditional probability density function of class ck is a superposition of nk gaussians  or prototypes  and that classes have equal prior probabilities. in our case  all the classes have the same number of prototypes np. in addition  we assume that all prototypes have an equal weight of 1/np. then  dropping constant terms  the activityof the ith prototype of the class ck for the input vector  or sample  x derived from a trial as described above is aki  x =|Σk| 1exp  1 x μik tΣ k1 x μik ♂＞  1 
	1	 	♂
where μik is the center of the ith prototype of the class ck  Σk is the covariance matrix of the class ck  and |Σk| is the determinant of that matrix. usually  each prototype has its own covariance matrix . in order to reduce the number of parameters  we restrict our model to a diagonal covariance matrix Σk that is common to all the prototypes of the class ck. now  the posterior probability yk of the class ck is
		 1 
where ak is the activity of class ck and a is the total activity of the network. the response of the classifier for the input vector x is simply the class with the highest probability.
　to initialize the center of the prototypes   of the class ck we run a clustering algorithm-typically  self-organizing maps  kohonen  1 . we then initialize the diagonal covariance matrix Σk of the class ck by setting
		 1 
where sk is the set of the training samples belonging to the class ck  |sk| is the cardinality of this set  and i  is the nearest prototype of this class to the sample x.
　during learning we improve these initial estimations iteratively by stochastic gradient descent so as to minimize thep 1 mean square error e = 1 k  yk   tk    where tk is the kth component of the target vector in the form 1-of-c; e.g.  the target vector for class  error  is coded as  1 . taking the gradient of the error function yields

and

where tk x  αykand x   βpare the learning rates andjyj x  tj x  yj x  . after updatingek x  μ=ik and Σik for each training sample  the covariance matrices of all the prototypes of the same class are averaged to obtain the common class covariance matrix Σk. this simple operation leads to better performance than if separate covariance matrices are kept for each individual prototype. it is also worth

figure 1: left. average eeg for error  correct and difference error-minus-correct at channel cz for the three subjects plus the grand average of them. feedback is delivered at time 1 seconds. the negative  ne  and positive  pe  peaks show up about 1 ms and between 1 and 1 ms after the feedback  respectively. right. scalp potentials topographies  for the grand average eeg of the three subjects  at the occurrence of the ne and the pe. small filled circles indicate positions of the electrodes  frontal on top   cz being in the middle of the scalp.noting that  due to the small number of training samples for the  error  class  it is sometimes preferible to have a single covariance matrix common to all classes  which is obtained by averaging all the individual Σk.
1 experimental results
with this protocol  it is first necessary to investigate wether or not errp are present no more in reaction to an error made by the subject himself  but in reaction to an erroneous response made the interface as indicated by the feedback visualizing the recognized subject's intention. figure 1 shows the different curves  error  correct and difference error-minus-correct  for channel cz for the three subjects plus the grand average of the three subjects. a first sharp negative peak  ne  can be clearly seen 1 ms after the feedback  except for subject 1 . a later positive peak  pe  appears between 1 and 1 ms after the feedback. finally an additional negative peak occurs ゛1 ms after the feedback. figure 1 also shows the scalp potentials topographies  for the grand average eeg of the three subjects  at the occurrence of the maximum of the ne and the pe: a first central negativity appears after 1 ms  followed by a fronto-central positivity at 1 ms.
　these experiments seem to reveal a new kind of errorrelated potentials that  for convenience  we call  interaction errp . the general shape of this errp is quite similar to the shape of the response errp in a choice reaction task  whereas the timing is similar to the feedback errp of reinforcement learning tasks1. as in the case of response errp  the interaction errp exhibits a first sharp negative peak followed by a broader positive peak. this is quite different from the shape of feedback errp that are only characterized by a small negative deflection. on the other hand  the time course of the interaction errp bears some similarities to that of the feedback errp: in both cases the first distinctive feature  negative peak and negative deflection  respectively  appears ゛1 ms after feedback. the time course of response errp is definitely different as the peaks show up much faster.
1 single trial classification
to explore the feasibility of detecting single-trial erroneous responses  we have done a 1-fold cross-validation study where the testing set consists of one of the recorded sessions. in this way  testing is always done on a different recording session to those used for training the model. this yields a better estimation of the actual generalization capabilities because brain activity naturally changes over time  as figure 1 illustrates. top panels show the average eeg of two consecutive series  1 interaction experiments each  at channel cz for subject 1  while the bottom panels show samples of single trials of those series. their variability is rather evident.
table 1: percentages of correctly recognized error trials and correct trials for the 1 subjects and the average of them.
subjectserror  % correct  % #1.1＼11＼1#1.1＼11＼1#1.1＼11＼1average1＼11＼1
figure 1: top. average eeg  error  correct and difference error-minus-correct  of two consecutive experimental series at channel cz for subject 1. bottom. samples of single trials  error and correct  of those two series.　table 1 reports the recognition rates  mean and standard deviations  for the three subjects plus the average of them. the different hyper-parameters-i.e.  the learning rates of the centers and diagonal covariance matrices  number of prototypes  and common/single covariance matrices for each class-were chosen by model selection in the training sets. regarding the learning rates  usual values were 1 to 1 for the centers and 1 to 1 for the variances  while the usual number of prototypes was rather small  from 1 to 1 . these results show that single-trial recognition of erroneous responses is almost 1% on average  while the recognition rate of correct responses is slightly better  1% . quite importantly  even for the subject with the worse detection rates  they are around 1%. but the key point for the exploitation of the automatic recognition of interaction errors is that they translate into an actual improvement of the performance of the bci  which we can measure in terms of the bit rate.
1 bit rate improvement
a traditional measure of the performance of a system is the bit rate  the amount of information communicated per unit time. the bit rate is usually expressed in bits per trial  bits per selection . if a single trial has nc possible outcomes  if the probability p that this outcome is correct  accuracy of the bci   and if finally each of the other outcomes has the same probability of selection  i.e.   1   p / nc   1    then the information transfer rate in bits per trial  bpt  is

　let's consider now how the performance of the bci changes after introducing errp and that the system detects a proportion e of erroneous trials and a proportion c of correct trials. in the general case  after detecting an erroneous trial the outcome of the interface is simply stopped and not sent to the brain-actuated device. the new accuracy p1 of the bci becomes p1 = p ， c/pt  where pt = p ， c +  1   p  ，  1   e .
now the new information transfer rate in bits per trial is

　in the case of a 1-class bci  nc = 1   after detecting an erroneous trial  it could be possible to replace the  wrong  outcome by the opposite one  what yields an accuracy p1 = p ， c +  1   p  ， e. the information transfer rate in this case is calculated by replacing p by p1 in equation 1  because now there is no stopped outcome.
　table 1 reports the performances of a bci that integrates errp for the 1 subjects and the average of them  where we have assumed an accuracy of 1% in the recognition of the subject's intent. these figures are to be compared to the performance of a standard bci  i.e.  without integrating errp . we have also reported the performances in the case of nc = 1  as the mind-controlled robot described by millan＞ et al. . in the case of standard 1-class and 1-class bci  their performances are 1 and 1 bits per trial  respectively. results indicate that there is a significant improvement in performance in the case of stopping outcomes  which is above 1% on average and higher than 1% for one of the subjects. surprisingly  replacing leads to smaller improvements and  in the case of subject 1  even to a significant degradation.
table 1: performances of the bci integrating errp for the 1 subjects and the average of them.
nc = 1nc = 1nc = 1stopstopreplacesubjectsbpt	gainbpt	gainbpt	gain#1.1%1	1%1	1%#1.1%1	1%1	-1%#1.1%1	1%1	1%average1	1%1	1%1	1%1 discussion
in this paper we have reported first results on the detection of the neural correlate of error awareness for improving the performance and reliability of brain-computer interfaces. in particular  we have found what seems to be a new kind of errorrelated potential elicited in reaction to an erroneous recognition of the subject's intention. more importantly  we have shown the feasibility of detecting single-trial erroneous responses of the interface that leads to significant improvements of the information transfer rate of a bci.
　given the promising results obtained in a simulated human-robot interaction  we are currently working in the actual integration of errp detection into our bci system. in parallel  we are exploring how to increase the recognition rate of single-trial erroneous and correct responses. a basic issue here is to find what kind of feedback elicits the strongest  interaction errp . the feedback can be of very different nature-visual  auditory  somatosensory  or even a mix of these different types. more importantly  we will need to focus on alternative methods to exploit at best the current  interaction errp . in this respect  grave et al.  have recently developed a technique that estimates the so-called local field potentials  i.e.  the synchronous activity of a small neuronal population  in the whole human brain from scalp eeg. furthermore  recent results show significant improvements in the classification of bimanual motor tasks using estimated local field potentials  lfp  with respect to scalp eeg  grave et al.  1 . consequently  we plan to utilize the electra method to best discriminate erroneous and correct responses of the interface. as a matter of fact  a key issue for the success in the above-mentioned study was the selection of those relevant voxels inside the brain whose estimated lfp were more discriminant. it turns out that the sources of the errp seem to be very well localized into the anterior cingulate cortex and thus we may well expect a significant improvement in recognition rates by focusing on the lfp estimated in this specific brain area.
　more generally  the work described in this paper suggests that it could be possible to recognize in real time high-level cognitive and emotional states from eeg  as opposed  and in addition  to motor commands  such as fatigue  stress  frustration  confusion  or attention that are crucial for an effective and purposeful interaction. indeed  the rapid recognition of these states will lead to truly adaptive interfaces that customize dynamically in response to changes of the cognitive and emotional/affective states of the user.
acknowledgments
this work is supported by the swiss national science foundation nccr  im1  and by the european ist programme fet project fp1. this paper only reflects the authors' views and funding agencies are not liable for any use that may be made of the information contained herein.
