
in modern urban settings  automobile traffic and collisions lead to endless frustration as well as significant loss of life  property  and productivity. recent advances in artificial intelligence suggest that autonomous vehicle navigation may soon be a reality. in previous work  we have demonstrated that a reservation-based approach can efficiently and safely govern interactions of multiple autonomous vehicles at intersections. such an approach alleviates many traditional problems associated with intersections  in terms of both safety and efficiency. however  the system relies on all vehicles being equipped with the requisite technology - a restriction that would make implementing such a system in the real world extremely difficult. in this paper  we extend this system to allow for incremental deployability. the modified system is able to accommodate traditional human-operated vehicles using existing infrastructure. furthermore  we show that as the number of autonomousvehicles on the road increases  traffic delays decrease monotonically toward the levels exhibited in our previous work. finally  we develop a method for switching between various human-usable configurations while the system is running  in order to facilitate an even smoother transition. the work is fully implemented and tested in our custom simulator  and we present detailed experimental results attesting to its effectiveness.
1 introduction
in modern urban settings  automobile traffic and collisions lead to endless frustration as well as significant loss of life  property  and productivity. a recent study of 1 u.s. cities  texas transportation institute  1  put the annual time spent waiting in traffic at 1 hours per capita  up from 1 hours in 1. a recent report puts the annual societal cost of automobile collisions in the u.s. at $1 billion  national highway traffic safety administration  1 . meanwhile  advances in artificial intelligence suggest that autonomous vehicle navigation may soon be a reality. cars can now be equipped with features such as adaptive cruise control  gps-based route planning  rogers et al.  1; schonberg et al.  1   and autonomous steering  pomerleau  1 . as more and more cars become autonomous  the possibility of autonomous interactions among multiple vehicles becomes a more realistic possibility.
　multiagent systems  mas  is the subfield of ai that aims to provide both principles for construction of complex systems involving multiple agents and mechanisms for coordination of independent agents' behaviors  wooldridge  1 . in previous work  we demonstrated a novel mas-based approach to alleviating traffic congestion and collisions  specifically at intersections cite1aamas-dresner. however  the system relied on all vehicles being equipped with the requisite technology - a restriction that would make implementing such a system in the real world extremely difficult.
　this paper makes two main contributions. first  we show how to augment this intersection control mechanism to allow use by human drivers with minimal additional infrastructure. second  we show that this hybrid intersection control mechanism offers performance and safety benefits over traditional traffic light systems. thus  implementing our system over an extended time frame will not adversely affect overall traffic conditions at any stage. furthermore  we show that at each stage the mechanism offers an incentive for individuals to use autonomous-driver-agent-equipped vehicles. our work is fully implemented and tested in a custom simulator and detailed experimental results are presented.
1 reservation system
previously  we proposed a reservation-based multi-agent approach to alleviating traffic  specifically at intersections  dresner and stone  1 . this system consists of two types of agents: intersection managers and driver agents. for each intersection  there is a corresponding intersection manager  and for each vehicle  a driver agent. intersection managers are responsible for directing the vehicles through the intersection  while the driver agents are responsible for controlling the vehicles to which they are assigned.
　to improve the throughput and efficiency of the system  the driver agents  call ahead  to the intersection manager and request space-time in the intersection. the intersection manager then determines whether or not these requests can be met based on an intersection control policy. depending on the decision  and subsequent response  the intersection manager makes  the driver agent either records the parameters of the response message  the reservation  and attempts to meet them  or it receives a rejection message and makes another request at a later time. if a vehicle has a reservation  it can request that its reservation be changed or can cancel the reservation. it also sends a special message when it finishes crossing the intersection indicating to the intersection manager that it has done so.
　the interaction among these agents is governedby a shared protocol  dresner and stone  1a . in addition to message types  e.g. request  confirm  and cancel   this protocol includes some rules  the most important of which are  1  a vehicle may not enter the intersection unless it is within the parameters of a reservation made by that vehicle's driver agent   1  if a vehicle follows its reservation parameters  the intersection manager can guarantee a safe crossing for the vehicle  and  1  a driver agent may have only one reservation at a time. while some may argue that insisting a vehicle adhere to the parameters of such a reservation is too strict a requirement  it is useful to note that vehicles today are already governed by a similar  although much less precise  protocol; if a driver goes through a red light at a busy intersection  a collision may be unavoidable. aside from this protocol  no agent needs to know how the other agents work - each vehicle manufacturer  or third party  can program a separate driver agent  each city or state can create its own intersection control policies  which can even change on the fly   and as long as each agent adheres to the protocol  the vehicles will move safely through the intersection. this system is a true multiagent system  integrating heterogeneous  complete  autonomous agents.
1 first come  first served  fcfs  to determine if a request can be met  the intersection manager uses what we call the  first come  first served   fcfs  intersection control policy which works as follows:
  the intersection is divided into a grid of n〜n tiles  where n is called the granularity.
  upon receiving a request message  the policy uses the parameters in the message to simulate the journey of the vehicle across the intersection. at each time step of the simulation  it determines which tiles the vehicle occupies.
  if throughout this simulation  no required tile is already reserved  the policy reserves the tiles for the vehicle and confirms the reservation. otherwise  it rejects it.
　we name the policy based on the fact that it responds to vehicles immediately when they make a request  confirming or rejecting the request based on whether or not the space-time required by the vehicle is already claimed. if two vehicles require some tile at the same time  the vehicle which requests the reservation first is given the reservation  provided there are no conflicts in the rest of the required space-time . figure 1 shows a successful reservation  confirmed  followed by an unsuccessful reservation  rejected .
　our previous work demonstrated that an intersection manager using the fcfs policy enabled vehicles to cross the intersection while experiencing almost no delay  increase in travel time over optimal   dresner and stone  1b; 1 . when compared with a standard traffic light  the fcfs policy not only decreased delay  but also tremendously increased the throughput of the intersection. for any realistic

	 a  successful	 b  rejected
figure 1: a granularity-1 fcfs policy. in 1 a   vehicle a's request reserves tiles at time t. in 1 b   vehicle b's request is rejected because it requires a tile used by a at t.
intersection control policy  there exists an amount of traffic for which vehicles arrive at the intersection more frequently than they can leave the intersection. at this point  the average delay experienced by vehicles travelling through the intersection grows without bound - each subsequent vehicle will have to wait longer than all the previous cars. the point for which this occurs in the fcfs policy is several times higher than for the traffic light.
1 other intersection control policies while the reservation system as originally proposed  dresner and stone  1b  uses only the fcfs policy  it can accommodate any intersection control policy that can make a decision based on the parameters in a request message. this includes policies that represent familiar intersection control mechanisms like traffic lights and stop signs. because the reservation system can behave exactly like the most common modern-day control mechanisms  the reservation mechanism can perform as well as current systems  provided it uses a reasonable control policy.
　traffic lights are a ubiquituous mechanism used to control high-traffic intersections. in our previous work  we describe a policy that emulates real-life traffic lights by maintaining a model of how the lights would be changed  were they to exist. we name this policy traffic-light. upon receiving a request message  the policy determines whether the light corresponding to the requesting vehicle's lane would be green. if so  it sends a confirmation  otherwise  it sends a rejection. in this paper  we extend this work to include a new policy that covers the area between traffic-light and fcfs  thereby enabling interoperability with human drivers as well as providing a smooth transition as autonomous vehicles become more prevalent.
1 incorporating human users
while an intersection control mechanism for autonomous vehicles will someday be very useful  there will always be people who enjoy driving. additionally  there will be a fairly long transitional period between the current situation  all human drivers  and one in which human drivers are a rarity. even if switching to a system comprised solely of autonomous vehicles were possible  pedestrians and cyclists must also be able to traverse intersections in a controlled and safe manner. for this reason  it is necessary to create intersection control policies that are aware of and able to accommodate humans  whether they are on a bicycle  walking to the corner store  or driving a  classic  car for entertainment purposes. allowing both humans and autonomous vehicles in the same intersection at the same time presents an interesting technical challenge. in this section we explain how we have extended the fcfs policy and reservation framework to allow for human drivers.
1 using existing infrastructure
to add human drivers  we first need a reliable way to communicate information to them. fortunately  we can use a system that drivers already know and understand - traffic lights. the required infrastructure is already present at many intersections and the engineering and manufacturingof traffic light systems is well developed. for pedestrians and cyclists  standard  push-button  crossing signals can be used that will give enough time for a person to cross as well as alerting the intersection manager to their presence.
1 light models
if real traffic lights are going to be used to communicateto human drivers  they will need to be controlled and understood by the intersection manager. thus  we add a new component to each intersection control policy  called a light model. this model controls the actual physical lights as well as providing information to the policy with which it can make decisions. in more complicated scenarios  the light model can be modified by the control policy  for example  in order to adapt to changing traffic conditions. the lights are the same as modern-day lights: red  do not enter   yellow  if possible  do not enter; light will soon be red   and green  enter . each control policy needs to have a light model so that humanusers will knowwhat to do. for instance  the light model that would be used with ordinary fcfs would keep all the lights red at all times  informing humans that at no time is it safe to enter. the traffic-light policy  on the other hand  would have lights that corresponded exactly to the light system the policy is emulating. here  we describe a few light models used in our experiments.
all-lanes
in this model  which is very similar to some current traffic light systems  each direction is successively given green lights in all lanes. thus  all north traffic  turning and going straight  is given green lights while the east  west  and south traffic all have red lights. the green lights then cycle through the directions. figure 1 shows a graphical depiction of this light model.

figure 1: the all-lanes light model. each direction is given all green lights in a cycle: north  east  west  south. during each phase  the only available paths for autonomous vehicles are right turns.
single-lane
in the single-lane light model  the green lane rotates through the lanes one at a time instead of all at once. for example  the left turn lane of the north traffic would have a green light  while all other lanes would have a red light. next  the straight lane of the north traffic would have a green light  then the right turn. next  the green light would go through each lane of east traffic  and so forth. the first half of the model's cycle can be seen in figure 1. this light model does not work very well if most of the vehicles are human-driven. however  we will show that it is very useful for intersections which control mostly autonomous vehicles but also need to handle an occasional human driver.

figure 1: the first half-cycle of the single-lane light model. each lane is given a green light  and this process is repeated for each direction. a small part of the intersection is used by turning vehicles at any given time.
1 the fcfs-light policy
in order to obtain some of the benefits of the fcfs policy while still accommodating human drivers  a policy needs to do two things. first  if a light is green  it must ensure that it is safe for any vehicle  autonomous or human-driven  to drive through the intersection in the lane the light regulates. second  it should grant reservations to driver agents whenever possible. this would allow autonomous vehicles to move through an intersection where a human driver couldn't - similar to a  right on red   but extended much further to other safe situations.
　the policy we have created which does both of these is called fcfs-light. as with fcfs  the intersection is divided into a grid. when it receives a request  fcfs-light immediately grants a reservation if the corresponding light will be green at that time. otherwise  it simulates the vehicle's trajectory as in fcfs. if throughout the simulation  no required tile is reserved by another vehicle or in use by a lane with a green light the policy reserves the tiles and confirms the reservation. otherwise  the request is rejected.
off-limits tiles
unfortunately  simply deferring to fcfs does not guarantee the safety of the vehicle. if the vehicle were granted a reservation that conflicted with another vehicle following the physical lights  a collision could easily ensue. to determine which tiles are in use by the light system at any given time  we associate a set of off-limits tiles with each light. for example  if the light for the north left turn lane is green  or yellow   all tiles that could be used by a vehicle turning left from that lane are off-limits. while evaluating a reservation request  fcfs also checks to see if any tiles needed by the requesting vehicle are off limits at the time of the reservation. if so  the reservation is rejected. the length of the yellow light is adjusted so that a vehicle entering the intersection has enough time to clear the intersection before those tiles are no longer off limits.
fcfs-light subsumes fcfs
using a traffic light-like light model  for example all-
lanes   the fcfs-light can behaveexactly like traffic-
light on all-human driver populations. with a light model that keeps all lights constantly red  fcfs-light behaves exactly like fcfs. if any human drivers are present it will leave

figure 1: the decision mechanism during a switchover from policy p1 to policy p1.
them stuck at the intersection indefinitely. however  in the absence of human drivers  it will perform exceptionally well. fcfs is  in fact  just a special case of fcfs-light. we can thus alter fcfs-light's behavior from traffic-light at one extreme to fcfs at the other.
1 policy switching
policies based on certain light models may be more effective at governing particular driver populations. in order to further reduce delay  we have developed a way in which the intersection manager can smoothly switch between different policies - the intersection need not bring all the vehicles to a halt and clear out the intersection. the switching mechanism requires every policy to keep track of the last time for which it has authorized a vehicle to be in the intersection. this could be either the last moment of a reservation or the last moment that a vehicle passing through a green light can be in the intersection. once the intersection manager decides to make the switch  it freezes the current policy. when a policy is frozen  it rejects all requests that would cause it to increase the  last reserved  time. once the current policy is frozen  the intersection manager accesses the last reserved time and henceforth delegates all reservation requests that begin after that time to the new policy. all requests that begin before that time are still processed by the current policy. because all requests are handled entirely by one policy  if two policies p1 and p1 are safe  vehicles granted reservations by it are guaranteed not to collide   the same will be true for the period during which the intersection manager is making the switch. a diagram illustrating this compound decision mechanism is shown in figure 1.
1 experimental results
we test the efficacy of the new control policies with a custombuilt  time-based simulator. videos of the simulator in action can be viewed at http://www.cs.utexas.edu/ ゛kdresner/aim/. the simulator models one intersection and has a time step of .1 seconds. the traffic level is controlled by changing the spawn probability - the probability that on any given time step  the simulator will attempt to spawn a new vehicle. for each experiment  the simulator simulates 1 lanes in each of the 1 cardinal directions. the total area modelled is a square with sides of 1 meters. the speed limit in all lanes is 1 meters per second. for each intersection control policy with reservation tiles  the granularity is set at 1. we also configured the simulator to spawn all vehicles turning left in the left lane  all vehicles turning right in the right lane  and all vehicles travelling straight in the center lane  in order to make the comparison between all-lanes and single-lane more straightforward. during each simulated time step  the simulator spawns vehicles  with the given probability   provides each vehicle with sensor data  simulated laser range finder  velocity  position  etc.   moves all the vehicles  and then removes any vehicles that have completed their journey. unless otherwise specified  each data point represents 1 time steps  or one hour of simulated time.
　in previous work  we demonstrated that once all vehicles are autonomous  intersection-associated delays can be reduced dramatically. by using the light models presented earlier  we can obtain a stronger result: delays can be reduced at each stage of adoption. furthermore  at each stage there are additional incentives for drivers to switch to autonomous vehicles.
1 transition to full implementation
the point of having a hybrid light/autonomous intersection control policy is to confer the benefits of autonomy to passengers with driver-agent controlled vehicles while still allowing human users to participate in the system. figure 1 a   which encompasses our main result  shows a smooth and monotonically improvingtransition frommodern day traffic lights  represented by the traffic-light policy  to a completely or mostly autonomous vehicle mechanism  fcfs-light with the single-lane light model . in early stages  1% human   the all-lanes light model is used. later on  less than 1% human   the single-lane light model is introduced. at each change  both in driver populations and light models   delays are decreased. notice the rather drastic drop in delay from fcfs-light with the all-lanes light model to fcfs-light with the single-lane light model. although none of the results is quite as close to the minimum as pure fcfs  the single-lane light model allows for greater use of the intersection by the fcfs portion of the fcfs-light policy  which translates to more efficiency and lower delay.

 a  delays decrease with decreasing pro-  b  a closeup of the all-lanes reportions of human drivers. sults.
figure 1: average delays for all vehicles as a function of traffic level for fcfs-light. all-lanes is well-suited to high percentages of human drivers  1%-1%   while single-lane works well with few humans  1%-1% .
　for systems with a significant proportion of human drivers  the all-lanes light model works well - human drivers have the same experience they would with the trafficlight policy  but driver agents have extra opportunities to make it through the intersection. a small amount of this benefit is passed on to the human drivers  who may find themselves closer to the front of the lane while waiting for a red light to turn green. to explore the effect on the average vehicle  we run our simulator with the fcfs-light policy  the all-lanes light model  and a 1%  1%  and 1% rate of human drivers: when a vehicle is spawned  it receives a human driver  instead of a driver agent  with probability 1  .1  and .1 respectively. as seen in figure 1 b   as the proportion of human drivers decreases  the delay experienced by the average driver also decreases. while these decreases are not as large as those brought about by the single-lane light model  they are at least possible with significant numbers of human drivers.
1 incentives for individuals
clearly there are incentivesfor cities to implementthe fcfs-
light policy - the roads will be able to accommodate more traffic and vehicles will experience lower delays. however  we have also shown that these benefits only materialize when a significant portion of the vehicles are autonomous. here we demonstrate that the system creates incentives for individuals to adopt autonomous vehicles as well  in the form of lower delays for autonomous vehicles. shown in figure 1 a  are the average delays for human drivers as compared to autonomous driver agents for the fcfs-light policy using the alllanes light model. in this experiment  half of the drivers are human. humans experience slightly longer delays than autonomous vehicles  but not worse than with the trafficlight policy  compare with figure 1 b  . thus  by putting some autonomous vehicles on the road  all drivers experience equal or smaller delays as compared to the current situation. this is expected because the autonomous driver can do everything the human driver does and more.
　once the reservation system is in widespread use and autonomous vehicles make up a vast majority of those on the road  the door is opened to an even more efficient light model for the fcfs-light policy. with a very low concentration of human drivers  the single-lane light model can drastically reduce delays  even at levels of overall traffic that the traffic-light policy can not handle. using the this light model  autonomous drivers can pass through red lights even more frequently because fewer tiles are off-limits at any given time. in figure 1 b  we compare the delays experienced by autonomous drivers to those of human drivers when only 1% of drivers are human and thus the single-lane light model can be used. while the improvements using the all-lanes light model benefit all drivers to some extent  the singlelane light model's sharp decrease in average delays  figure 1 a   appears to come at a high price to human drivers.
　as shown in figure 1 b   human drivers experience much higher delays than average. for lower traffic levels  the delays are even higher than they would experience with the traffic-light policy. however  figure 1 a  shows that despite this  at high levels of traffic  the humans get a performance benefit. because these intersections will be able to handle far more traffic than traffic-light  the fact that the human delays are kept more or less constant  as opposed to

	 a 	 b 
figure 1: average delay for humans and autonomous vehicles as a function of traffic level for fcfs-light with 1% human  singlelane a  and 1% human  all-lanes b .
the skyrocketing delay of figure 1 a    means this is actually a win for the human drivers.
　the single-lane light model effectively gives the humans a high  but fairly constant delay. because the green light for any one lane only comes around after each other lane has had a green light  a human-driven vehicle may find itself sitting at a red light for some time before the light changes. because this light model would only be put in operation once human drivers are fairly scarce  the huge benefit to the other 1% or 1% of vehicles far outweighs this cost.
　these data suggest that there will be an incentive to both early adopters  persons purchasing vehicles capable of interacting with the reservation system  and to cities or towns. those with properly equipped vehicles will get where they are going faster  not to mention more safely . cities and towns that equip their intersections to utilize the reservation paradigm will also experience fewer traffic jams and more efficient use of the roadways  along with fewer collisions  less wasted gasoline  etc. . because there is no penalty to the human drivers  which would initially be a majority   there would be no reason for any party involved to oppose the introduction of such a system. later  when most drivershave made the transition to autonomousvehicles  and the single-lane light model is introduced  the incentive to move to the new technology is increased - both for cities and individuals. by this time  autonomous vehicle owners will far outnumber human drivers  who will still benefit as traffic volumes continue to increase.
1 related work
rasche and naumann have worked extensively on decentralized solutions to intersection collision avoidance problems  naumann and rasche  1; rasche et al.  1 . others focus on improving current technology  systems of traffic lights . for example  roozemond allows intersections to act autonomously  sharing the data they gather  roozemond  1 . the intersections then use this information to make both short- and long-term predictions about the traffic and adjust accordingly. this approach still assumes humancontrolled vehicles. bazzan has used an approach using both mas and evolutionary game theory which involves multiple intersection managers  agents  that must focus not only on local goals  but also on global goals  bazzan  1 .
　halle＞ and chaib-draa have taken a mas approach to collaborative driving by allowing vehicles to form platoons  groups of varying degrees of autonomy  that then coordinate using a hierarchical driving agent architecture  halle＞ and chaib-draa  1 . while not focusing on intersections  moriarty and langley have shown that reinforcement learning can train efficient driver agents for lane  speed  and route selection during freeway driving  moriarty and langley  1 . on real autonomous vehicles  kolodko and vlacic have created a small-scale system for intersection control which is very similar a reservation system with a granularity-1 fcfs policy  kolodko and vlacic  1 .
　actual systems in practice for traffic light optimization include transyt  robertson  1   which is an off-line system requiring extensive data gathering and analysis  and scoot  hunt et al.  1   which is an advancement over transyt  responding to changes in traffic loads on-line. however  all methods for controlling automobiles in practice or discussed above still rely on traditional signalling systems.
1 conclusion
we have extended an extremely efficient method for controlling autonomous vehicles at intersections such that at each phase of implementation  the system offers performance benefits to the average driver. autonomous drivers benefit above and beyond this average improvement  which creates additional incentives for individuals to adopt autonomous vehicle technology. we also showed how the system can move between different control policies smoothly and safely.
　this work opens up the possibility of creating light models that use less of the intersection than all-lanes  but don't restrict human drivers as much as single-lane. these intermediate models would provide the needed flexibility to let autonomous vehicles traverse the intersection using the fcfs portion of fcfs-light more frequently  decreasing delays relative to all-lanes. additionally  adaptive light models could ameliorate the delays for human drivers associated with the single-lane light model. if an intersection manager can receive a reward signal based on delays experienced by vehicles  the manager can learn light models and adapt on-line.
　a science-fiction future with self-driving cars is becoming more and more believable. as intelligent vehicle research moves forward  it is important that we prepare to take advantage of the high-precision abilities autonomous vehicles have to offer. efficient  fast  and safe automobile transporation is not a fantasy scenario light-years away  but rather a goal toward which we can make worthwhile step-by-step progress. 