. 
     a fundanental sub-problem of the task of interpreting the sonar data gathered by a mobile subnersible robot vehicle is that of constructing and maintaining a stationary global reference frame in which interpretation can take place. such a frane nay be established by tracking the movements of objects in the local environment of the robot and using the data so obtained to deduce the motion of the observer. in a marine context  where currents make it impossible to hold a vehicle stationary for any extended period  it is important to track the vehicle and object motion continuously in real time. in this paper the problem of establishing a stationary reference frame using noisy  specular  intermittent sonar data is discussed and a computational method for its solution is presented. the nethod has been tested by computer simulation in a two dimensional context and an evaluation of its performance is given. the solution presented is not restricted to marine vehicles but is especially effective for land-based vehicles  where operating conditions are less severe. i. introduction. 
often  and the vehicle proceeds by dead-reckoning. such a paradigm is both simple and effective provided that it is possible approximately to predict or estimate the effects of the deliberate movements and  more importantly  that it is possible to remain stationary while the position recalibration is done. 
     these assumptions are reasonable on land  but immediately break down in a marine environment. it is impossible to keep a vehicle stationary for any extended period since water currents will push it about  and without expensive navigational equipment it is impossible to keep track of the vehicle position accurately. if motion resolution is to be 
done in this context it must be performed continuously  in real time  rather than using a discrete paradigm like the land-based one. b. system input. 
     this constraint on a motion resolution scheme allows some of the potential difficulties of marine acoustic sensing to be turned to advantage. acoustic data  unlike optical data  is strongly specular and it is difficult to recover anything resembling 

a. 	background. 
     the problem of motion resolution affects all mobile robotic vehicles to some degree. in essence it is the problem of determining a robot's proper motion or position with respect to its 'world'. this task has been well defined and tackled for land-based robots where some simplifying assumptions may be made. the solution is exemplified in 
lioravec's work with the stanford cart robot  mor1  and takes the form of a 'move  stop  think' paradigm. the vehicle estimates its current position  moves a roughly known distance in an approximate direction  and then remains stationary while its position is recalibrated using sensory data  in lioravec's work  nine television images supply this data . when recalibration is complete  it is ready to execute another planned movement. this procedure is a generalised version of the static calibration that fixed robots undergo before beginning work. indeed  if the planned movements can be made or measured accurately the recalibration with its an optical image in bulk spatial resolution without extensive processing and using special techniques to overcome the specularity. sonar images natur-
ally contain relatively few data points  but it is easy to obtain accurate range and bearing  in two or three dimensions  directly from the data and most sonar equipment is capable of measuring doppler shift velocity for each data point. this highly concentrated geometric information is ideal for driving a motion resolution system. 
     with these facts in mind  therefore  the input to the motion resolution system is assumed to comprise time series of vectors of measurements describing the data points  targets  in a sequence of sonar images. each vector contains the polar coordinates of its target with respect to the sonar transducer  and may carry a doppler velocity if one is available and reliable. the vector also carries a flag that informs the system whether the target has a non-zero absolute velocity - this can be computed from doppler data even when the doppler velocity cannot be determined exactly. 

time-consuming processing need not be done very 
this work is supported by the states of jersey education committee. 

     the number of targets seen in a given sonar scan is variable and because of specularity and the relative movement of observer and target a given 
target will in general be seen only intermittently. the geometric measurements obtained for each target  in polar coordinates  are subject to errors of constant variance. however  when transformed into cartesian coordinates the errors are range dependent -- the volume of uncertainty in which the target lies is a sector with width dependent on the sonar beam-width and thickness dependent on the sonar range resolution  see figure 1 . the errors are independent in polar coordinates but are coupled  depending on the bearing  in cartesian coor-
dinates. 
figure 1: measurement uncertainty region 
i i . a method for motion resolution. 
     an alternative and more uniform definition of motion resolution may be formulated in terms of target tracking. if the proper motions of all tar-
gets  including the sonar transducer as a special case target that is never seen  are tracked a global frame may be established using the tracking data. implicitly it is the frame with respect to which the transducer is tracked; explicitly  it is that frame in which stationary targets are fixed. in fact  although it is known whether a target is absolutely stationary  only the relative motion of the target with respect to the observer may be 
measured; and further  a stationary target does not imply a fixed absolute position  consider the stationary line reflector in figure 1  which mirrors observer motion parallel to the line . this motivates the fundamental insight of the method: if the relative motion of targets is tracked the observer movement will appear as a common component of those relative motions  that may be extracted and tracked to derive the observer motion. 
	the basic block of the tracking system is 	the 
kalman filter. devised by r. e. kalman  ka  this filter is a general and powerful recursive data processor. it is able to deal with input data vectors with variable error covariance and variable inter-sample times. for data with a unimodal error distribution with zero mean the kalman filter is optimal in the sense that its estimates and predictions of tracked quantities have minimal error variance  and the filter computes error covariance matrices for its outputs in the course of its operation. the filter has been used extensively in radar tracking applications  for example  morley 
and wilsdon's multiradar tracking systen  mor1   though in these cases there is no observer motion to extract. it is computationally demanding in 
general  but can be simplified considerably in particular cases. 
figure 1: behaviour of a line reflector. 
     the motion resolution algorithm may be divided into two parts: a set of per-target channels  figure 1 ; and a kernel  figure a . the kernel tracks the observer  which has three degrees of freedom - two translational and one rotational. translational tracking maintains the global frame origin position while rotational tracking compensates for fluctuations in the vehicle's heading which shift the sonar transducer's polar origin. the kernel receives inputs from all active channels and may incorporate navigational data from the vehicle's control system if available. 
     each channel tracks a given target and is activated when that target is seen. targets  for the purpose of tracking  are considered to be points and so have two degrees of freedom. the channel contains both relative and absolute motion data for its target and mechanisms to pass certain data to the kernel. with this organisation new targets are accommodated by creating a new channel  while defunct targets are eliminated by destroying the associated channel. 
	tracking is 	done 	in 	cartesian 	coordinates. 
the kernel tracking is done with respect to the global reference frame; channels track their targets using coordinates in the observer relative frame. this latter frame is defined as the cartesian reference frame with origin at the current position of the sonar transducer and with x axis aligned with the azimuth axis of the transducer. 

1 j. hallam 
     the algorithm is cyclic in its operation; each cycle is initiated by target observation vectors  event vectors  arriving at their appropriate channels  the implied segmentation problem is discussed later . with reference to figure 1  an arriving event vector is transformed into cartesian coordinates in the observer relative frame  orf   an error covariance matrix is computed for i t   and it is used as input to update the target relative state  trs  vector using the kalman filter kr. this state is a four component vector of position and velocity in the orf. the trs is rotated so that the orf and global frame polar axes are aligned  and three quantities computed from this transformed trs  ttrs  provide kernel inputs. 
	i   . 	the target absolute position less the 	ttrs 
position is used as an observer position estimate; i i   . the ttks velocity  adjusted for the 
current orf angular velocity estimate  and for target absolute motion   is used as an observer linear velocity estimate. i i i   . the ttks velocity is corrected using the 
current observer absolute velocity  and for target absolute motion if necessary  and used to compute an estimate of the observer  or orf  angular velocity. these three estimates drive the kernel translational and rotational tracking. 
figure 1  below : per-target channel organisation. 
the dashed link is used only for moving targets. 

     the next phase of activity takes place in the kernel  figure 1 . inputs from all active channels are collated  and conbined using a non-recursive minimum variance averaging filter. this filter is designed to have unit common node gain while rejecting uncorrelated differential inputs as much as possible  and is defined by the equations below: 


the position and velocity data are tracked by the kalnan filter  ko  which maintains the four component observer absolute state  oas  vector. the angular velocity average is used directly as the new orf angular velocity and the polar axis alignment is computed by integrating the angular velocity estimate. 
     in the third phase of each cycle the kernel pauses the new estimate of the oas to each active channel which adds the oas to the ttrs to compute a new estimate of its absolute state vector. each estimated quantity passed through the system is accompanied by an appropriate variance or covariance. 
	i i i . 	input segmentation. 
     as noted above  there is an implicit segmentation problem in matching target observation events to the appropriate channels. this is dealt with by using the prediction ability of the kalnan filters in the channels. for each arriving  event the set of potentially hatching channels is enumerated and a predicted tks is computed for each channel in the set. the potential match set is then pruned as follows. first  estimates of the radial and angular distances between the event and tks are made and compared  allowing for an unknown observer rotation  with estimates of the corresponding variances. matches with distances that are too large are rejected at once. secondly  the filter innovation distance  the distance between the tks and event using  the filter covariance matrix as a metric  is computed for each match. the matches are classified into 'good' if the distance is less than 1 standard deviations  or 'poor' if less than nine. matches missing  the 'poor' threshold are discarded. thirdly  poor members of multiple match classes that contain a good match are eliminated. lastly  the remaining matches are imple-
mented: uniquely matched events are passed to their channels; unmatched events initialise new channels; multiple good matches of events are dealt with by a multiple target correlation scheme  developed by fortmann et al.  for1   and to be implemented shortly ; multiple poor matches are deferred pending further data. 
     a problem that particularly affects segmentation arises from allowing the orf to rotate. the rotation of the orf appears as common angular velocity in the channel relative tracking filters. however  because these filters have a linear prediction model  an error arises in the tks due solely to polar origin shift. this is illustrated in figure 1. if the filter state is not estimated for a time t  the state will be predicted at point p  r l wt  where w is the angular velocity. however  the actual position of the target is point t  r cos wt sin wt . the prediction error is roughly proportional to r wt 1   and must be corrected if this is large. this error also affects the angular velocity estimates conputed by the target channels  since the position estimate in each tks will be displaced radially outwards relative to the correct position. the error is proportional to the relative distance between observer and target  and correction 	is 	made for it in the angular velocity estimator. 

iv. results. 
     the method has been tested using simulated events generated by a modeller program. the modeller reads initial values for target and observer position and velocity  and predicts their positions at future times. each simulated sighting of a target causes an event vector to be generated. the modeller can move targets and observer deterministically  randomly  or in a combination of both modes of movement  and adds measurement error into the computed vectors if desired. the random move-
ment and polar measurement 	errors 	have 	gaussian distribution. 
     two sets of tests were run. in the first set the angular compensation part of the motion resolution system was turned off and the observer restricted to translational motion only. the test world contained four objects positioned at the corners of a 1m sided square  centred on the origin  and the sonar scan repetition rate was 1hz  corresponding to a range limit of 1m. simulations ran from one hundred to one thousand seconds of simulated time. extensive error data were logged during the runs and the results of four of the tests arc reproduced in tables one and two. in the second set  the angular compensation system was turned on  and tests run for about thirty seconds simulated time  using the same world model as the first set of tests. the sonar scan rate remained 1hz and the angular measurement standard deviation was 1 radians  about 1 degrees . in each test the radial measurement error standard deviation was 1 metres  corresponding to a sonar range resolution of about 1cm . 
     table 1 gives the error variance ranges for the four runs in series one. these figures were conputed by comparing the filter states with the modeller states after each cycle of the algorithm  accumulating the errors in the input measurements  the trs position  the target global state for each 

1 j. hallam 


target and the observer global 	state. 	the vari-
ances presented are the maximum and minimum in each category. note that they are not the data variances computed by the kalman filters - the filters were uniformly more pessimistic about the validity of their estimates. 
     table 1 shows the coordinate origin offset vectors for the tests. these values are difference between the target and observer absolute positions and the corresponding data in the modeller states. the sizes of these numbers depends upon the difference between the modeller's initial position for the observer and the motion resolution system's starting observer position of  1   and on the amount of drift of the global frame origin which occurs during the initialisation period of the filter system. the stability of the global frame of reference in each test is indicated by the similarity between corresponding displacements for different targets and observer. note that test id is a lengthier run of test le  so that comparison between these rows of table 1 shows the time stability of the global frame; comparison within the rows' shows the spatial stability of the frame. 
     table 1 shows the observer absolute state variances and the biases in the angular state components for each of the tests in series two. these figures are the means and variances of the differences between system computed quantities and modeller generated quantities  as in table 1. table 1 shows the coordinate origin offset vectors for tests 1a and 1b. results of this nature for tests 1c and 1d are not meaningful because of the large values of the polar axis bias in those tests. the values in tables 1 and 1 are inherently less reliable than those in tables 1 and 1 because of the smaller number of samples involved  some seventy as against two hundred and forty . 
v conclusions. 
     1 . the system performs well when presented with data containing only translational motion. it rejects object motion satisfactorily and maintains a stable frame of reference under extreme input error conditions - the standard deviation of 1 radians in test la corresponds to a sonar beam width of more than ten degrees. the reference frame is stable over long periods of time  its ori-
gin drifting about 1cm in 1 seconds  and the movement of the observer with respect to the reference frame is tracked correctly. thus under these conditions the system fulfils its goal of implicitly defining a stable stationary frame of reference. 
     1 . when presented with data containing rotational error the system performs poorly. the cause of failure is the consistent low estimate of the orf angular velocity  low by 1 milliradians per second in tests 1c d  which integrates over the test period to account for half of the bias in the polar axis offset  filter initialisation time accounts for the other half . this gradual drift in the polar axis offset causes the global frame to rotate and interferes severely with absolute position and velocity extraction  thus there are no offset results for these tests . the error appears to be independent of the observer linear motion since it is seen identically in the results of tests 1c and 1d. further testing will show whether the angular velocity deficit is due to a biassed estimator or is a further rotational non-linearity error of the type already described. 
     1 . it requires between five and ten activations of a given channel to initialise the relative tracking filter successfully. since the global reference frame can be established using only four targets the system will cope with intermittent sightings of targets easily. for a sonar scan rate of 1ilz it may take up to about thirty seconds to collect the necessary observations  assuming a very pessimistic rate of appearance for the targets ; with more sophisticated sonar systems it will take only a few seconds. 
     1 . while the system is currently inadequate for marine vehicles  where angular effects cannot be eliminated easily  it is suitable for use in land based vehicles. the structure of the system allows it to incorporate position or velocity data from other sources into the kernel averaging process. thus mechanically obtained estimates of the motion of a robot vehicle could be used to improve the settling time of the global frame and increase the stability of the observer tracking further. the long term and spatial stability of the reference frame make it useful for navigation. the modifications necessary to enable the system to cope with marine conditions will be done in further work when the cause of the low angular velocity estimate has been fully investigated. 
