 
fuzzy logic  a neural network and an expert system are combined to build a hybrid diagnosis system. with this system we introduce a new approach to the acquisition of knowledge bases. our system consists of a fuzzy expert system with a dual source knowledge base. two sets of rules are acquired  inductively from given examples and deductively formulated by a physician. a fuzzy neural network serves to learn from sample data and allows to extract fuzzy rules for the knowledge base. the diagnosis of electroencephalograms by interpretation of graphoelements serves as visualization for our approach. preliminary results demonstrate the promising possibilities offered by our method. 
1 	introduction 
repetitively applied cognitive tasks of recognizing and evaluating certain phenomena  called diagnostic tasks  are among the main applications for artificial intelligence  ai . as there exists a vast variety of such diagnostic tasks in medicine  it has always belonged to the spectrum of potential users of artificial intelligence. 
　most popular among ai methods in medicine are knowledge based systems  buchanan and shortliffe  1   modeling the diagnostic behaviour of experts. a variety of such expert systems is being used in everyday ractice of physicians since shortliffe introduced mycin shortliffe  1   an expert system designed to diagnose infections of the human blood. one of the greatest difficulties in designing a convenient expert system is acquiring the knowledge base. we introduce a new approach where a dual source knowledge base is generated by deductive and inductive learning. 
　neural networks have also made their way into diagnosis. they are able to learn relationships between data sets by simply having sample data represented to their input and output layers. in the field of pattern recognition in medical data  neural network based approaches have led to quite remarkable results  for exam-
　*also affiliated with mainz university clinic  department of neurology  reisingerweg  d-1 mainz  germany 
1 	connectionist models 
ple in processing mri pictures  hall et a/.  1  or eeg traces  mamelak et a/.  1; jando et a/.  1 . for the task of acquiring knowledge bases  which is a part of our hybrid approach  neural networks have been proposed recently  thrun and mitchell  1 . 
　fuzzy logic  zadeh  1  also makes its appearance in medicine  dealing with the uncertainty of verbal expressions  kuncheva  1; nishimura et a/.  1l . terms like many  few or probably are hard to model with conventional logic. the linguistic variables offered by fuzzy representations allow pseudo-verbal descriptions close to natural human expressions. 
　all of the above methods bear advantages as well as disadvantages as will be seen in section 1. combining these methods not only sums up the advantages but also avoids some of the disadvantages. up to now  only few approaches in medical diagnosis combine multiple methods of artificial intelligence  although good results have been made by these means  modeling a physician's decision process  kuncheva et a/.  1; orsier et a/.  1 . 
　here  we will describe a hybrid system consisting of a fuzzy expert system for rule-based reasoning with a fuzzy neural network for acquiring case-based knowledge in addition to the explanation-based knowledge from an expert  section 1 . the automatic acquisition of rules by the network is implemented in parallel to the classical formulation of expert rules. two modes of processing result for the hybrid system: a learning mode to feed the knowledge base and an execution mode diagnosing patient data. all components of the system are based on a fuzzy representation  serving as an interface notation between the components and making a fuzzification of input data necessary. 
　in subsection 1  a very effective mapping technique will be introduced  transforming fuzzy variables into a neural representation. 
　to visualize the processing of real medical data in such a system  we chose the diagnosis of electroencephalograms  eegs  for demonstration. this type of medical data  measured and stored electronically  is very well suited for automatic processing since it need not be converted to an electronic representation any more. other types of data will also be appropriate for diagnosis in our system. we will describe our sytem apart from the application as far as possible and propose related topics and mc clelland  1  . therefore  to represent multiple phenomena eight neurons would be required for each phenomenon. since the number of features contained in every time-slice varies through the eeg  not every sample is deranged by an artifact  a representation is needed which is capable of coding multiple phenomena in a constant number of neurons. 
　we have developed a mapping scheme that brings two fuzzy variables into a network suited representation by calculating the cross product  which is described in detail in  herrmann  1a . the two four-term fuzzy variables result in 1 neurons nfrequencyxamplitude  see figure 1 . each neuron represents the conjunction of two fuzzy terms of each variable  thus overcoming the binding problem. the activation value of a neuron is calculated via the algebraic product of the two represented membership functions: 

the sum of activation  resulting from one spectral phenomenon always sums up to 1 for sake of reinterpretability of the rules learned by the network. 
1 	fuzzy neural network 
the fuzzy features  presented to the neural network by the two-dimensional mapping method  are then trained to be detected by the net. in order to extract the acquired knowledge  a fuzzy-neural network  called fune  halgamuge and glesner  1; halgamuge et a/.  1   is used in our three layer network. the special multilayer perceptron architecture is trained with a gradient descent algorithm. there exist three types of neurons in the middle layer grouped together topographically. one group of neurons can perform only the or function of multiple inputs while another group only performs the and function. as there may as well be unary rules  composed of simple one-term-premises  there is a third group of neurons having single inputs and single outputs. the output neuron simply acts as an or function of all middle neurons. in the initial state the fully interconnected network represents all possible logical functions of or premises  and premises  and the 1 unary premises. during the learning process all connections below a certain threshold are eliminated. this pruning method has been proposed by le cun in 1  lecun et a/.  1  in order to increase learning speed-but  it is also useful for limiting the number of resulting rules. this is of special interest to us  because we will extract exactly these rules after the training and want to avoid rules with negligible rule strength. 
　a net trained to detect bulbus artifacts is shown in its final state in figure 1. as an example  the pattern at the input neurons represents a bulbus artifact  ba  in a simplified manner 1. the delta frequency component is high while all other frequency components are low. the artifact is detected in the output neuron  shown by its activation of 1. some of the inputs no longer contribute to the detection task at all  since their lowweight connections have been pruned. 
   1  for the sake of simplicity we used only values 1 and 1  although they will not occur in reality. 

1 	fuzzy expert system 
the heart of our hybrid system is a fuzzy expert system  called fuzzyclips  knowledge systems laboratory  1   derived from clips  artificial intelligence section  1 . this expert system consists mainly of three components  see figure 1  'fuzzy expert system'   the dual source knowledge base containing the combined rule sets from inductive and deductive learning  the user knowledge base where the actual phenomena of a patient 
are entered  and the inference mechanism concluding a diagnosis from the comparison of the knowledge base. 
　when acquiring rules for the knowledge base of an expert system two major learning paradigms apply: deductive learning and inductive learning. deductive learning mostly is carried out by explanation-based learning  minton et a/.  1   meaning that the system is tought which rules lead to the desired decision capability. inductive learning is applied when this knowledge is incomplete but examples may serve as a teacher for machine learning techniques  michalski  1 . our knowledge base consists of two seperately acquired sets of rules. the first one is acquired deductively from an 
	herrmann 	1 

expert by explanation-based learning. the second one is acquired inductively by machine learning in a neural network. the resulting dual source knowledge base integrates two autonomous rule sets. they might contain rules that are equal in premises and conclusion but different in the degree of certainty  which results in contradiction in the worst case. like holland proposed in 1  holland  1   we do allow these contradictory rules  postulating it as a natural feature of decision processes and thus being well suited to model those. the following example might shed some light upon this matter: 
wife rule: if evening then go home boss rule: if evening then stay in office 
if one equally obeys to wife and boss  equal rule strengths  one certainly needs a third rule to make a decision  like 
　ijcai rule: if deadline close then stay in office which contributes to one of the former conclusions. the same is supposed for our dual source knowledge base. there may very well be phenomena that exist in sample data but are described differently in the expert rules. in this case the resulting uncertainty has to be solved by different rule strengths or a further rule  manifesting one of the possible conclusions. 
　besides an explanation component it is also important for this medical application that a don't know conclusion exists  telling the user if abnormal phenomena were detected but could not be interpreted. 
1 	preliminary results 
when talking about results in medical diagnosis  we would first like to mention one major point in where to put the main focus. other than in common detection tasks it is not sufficient to simply watch the overall performance of the system in means of average error  like it would be appropriate for character recognition  for instance. the diagnosis performance must be split into the missing of phenomena  called false negatives  and the accidental finding of phenomena which are not actually present  called false positives. with these two measures it is possible to decide whether the two can be kept apart or will be overlapping. for certain diagnosis types  it is very important to have absolutely no false positives whereas a few false negatives were still acceptable  like in diagnosing cerebral death. vice versa  in other cases it is important to have no false negatives  like in diagnosing epileptic seizures for emergency purposes.  both examples were chosen from the class of 
eeg diagnosis tasks.  
　figure 1 shows a typical diagram illustrating false positives  dashed line  versus false negatives  solid line  as a function of the threshold e  fp/fn-diagram  for the detection of bulbus artifacts  bas . since we apply fuzzy logic  we get fuzzy results rather than discrete ones.  we do not use standard defuzzification.  the example shows the diagnosis of bulbus artifacts in eegs. the decision of the system  whether it is a bulbus artifact or not  is represented by an analog value in the range from 1 to 1. for a binary decision a threshold is needed  above which a ba is assumed. in figure 1 there is a wide gap between 
1 	c1nnecti1nist models 

figure 1: false positive bas  dashed  and false negative 
bas  solid  in a patient record with additional electrode artifacts 
　the example of figure 1 nicely demonstrates the degree of accuracy of the system. the diagram shows only a narrow gap for the threshold  proposing possible misses in future data. the system can correctly diagnose all existing bulbus artifacts in the patient record with ease  shown in the narrow band of false negatives  rightmost peak in figure 1 . nevertheless  the wide scope of false positives gives rise to the assumption that the diagnosis performance is of minor quality  since with a threshold of e - 1   1% diagnosed bas would not actually be such. retrospectively examined  it showed that those false positives were indeed bas  but of minimal amplitude and thus overlooked in the visual diagnosis. only the 1% false positives that remained up to a threshold of e = 1 were not bas but electrode artifacts  being graphoelements that are somewhat related to bas in terms of frequency and amplitude and can only be kept apart due to their shape. thus  without explicitely com-

paring the system and a human expert yet  we showed with these preliminary results that the system's precision is of competing accuracy. 
　the comparison of the two rule sets  serving as basis for the dual source knowledge base  brought up two interesting results. 
  the inductively generated rule set  extracted from the network  contained more rules than the one deductively acquired from the expert. these extra rules seem redundant at first glance  because the expert can easily distinguish between different phenomena on the basis of more obvious criteria. but for the electronic system  designed to diagnose a vast variety of phenomena  it may very well be of great importance to 'know' every extra description neglected by the expert. 
  the extracted rules were more precise in their de-gree of fuzzy membership  since they were actually calculated from examples. 
　for our example of the bulbus artifact  the physician formulated the rule: 
 1  if frequency=delta and amplitude=high then ba 
the automatically generated rule base contained a whole group of rules with different rule strengths. the premises  conclusions and rule strengths are shown in the following table  compare to the network connections in figure 1 . only the rules with rule strenghts  rs  above 1 are listed  while rules with lower rule strengths were pruned. 
premise conclusion rs delta mid or delta high ba 1 delta zero not ba 1 delta high ba 1 this detailed rule base is the reason  why the system was able to detect 1% low-amplitude artifacts  see figure 1 . this would not have been possible with the mere expert rule  1 . 
1 	discussion 
by combining three major methods of artificial intelligence into a single hybrid system we managed to combine most of their advantages  avoiding some of their disadvantages at the same time. 
　the hybrid system  described in this article  introduces the following new paradigms of modeling the cognitive task of diagnosis: 
  instead of either acquiring the whole knowledge base automatically from examples  being an inductive learning method  michalski  1   or refining a rough knowledge base  ourston and mooney  1   being an enhanced explanation-based learning method  minton et a/.  1   we are using a dual source knowledge base. this knowledge base consists of two sets of rules  coexisting with equal importance  one generated deductively from rules formulated by an expert and another one generated inductively by machine learning in a neural network. 
this offers the full range of benefits from neural network learning. additionally  the automatically acquired rules can be supervised and adapted in the expert system  eliminating the black box problem  see subsection 1 . 
  the coexistence of the two resulting rule bases  with the possibility of competing knowledge  is not only permitted but desired. the competition of rules and the mechanism of taking further rules into account is part of the cognitive decision task. 
　besides the integration of the existing fuzzy neural network and fuzzy expert system  some intelligent interfacing techniques are introduced  that might as well be used for different applications: 
  a two-dimensional mapping technique  used to as-sign the membership values of linguistic variable terms to input layer neurons of a network. by this means  it is possible to input existing fuzzy representations into neural networks in order to autonomously acquire case-based knowledge from sample data  see subsection 1 . 
  an application-specific fuzzification of spectral eeg data that will work for most other multidimensional data  especially other frequency domain data  like voice spectra in speech recognition  as well as all kinds of medical images  see subsection 1 . 
　our preliminary results  see section 1  point out some promising features: 
  we proved the possible precision of our system  be-ing more accurate than the human expert  when applied to the task of diagnosing bulbus artifacts in eegs. 
  comparing the two rule sets of our dual source knowledge base it showed that the inductively acquired set was more extensive and of higher precision than the one deductively acquired. 
　in future we plan to investigate the interference effects of a dual source knowledge base. they occur when the two bases contain contradictory or similar rules with different rule strengths. for the case of perfect contradiction of two rules  possibly resulting in no conclusion  a third rule could be generated by a supervising mechanism to indicate to the user that such a contradiction occurred. 
1 	acknowledgements 
the author wishes to thank andre de waal for his last polish of the english  as well as frank reine and michael thielscher for their valuable comments on an earlier version of the paper. 
