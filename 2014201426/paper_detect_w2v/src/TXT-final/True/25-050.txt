 
in multiagent planning  an agent sometimes needs to collaborate with others to construct complex plans  or to accomplish large organizational tasks which it cannot do alone. since each agent in a group may have incorrect beliefs about the world and incomplete knowledge  and because agent's abilities differ  constructing a coordinated collaborative plan among agents is a difficult proposition. in previous work  osawa and tokoro 1   we developed a scheme for constructing collaborative plans from the. possibly incomplete  individual plans of agents. this scheme was designed to provide availability-based assignment of goals to agents  and opportunistic collaboration to distributed planning in open multiagent environments based on the contract net. in this paper  we formalize incomplete individual plans and collaborative planning among rational agents using the multi-world model  and provide a utility-based model for rational choice of actions. agents can effectively balance workloads based on the utility theory. a condition for incomplete collaborative plans is also presented. 
1 	introduction 
in multiagent planning  agents try to achieve goals  which can be independent  shared  or competitive. researchers have attempted to address the problem of coordinating interacting plans so as to increase efficiency. the subject of coordination has been of continuing interest in multiagent planning  corkill 1  georgeff 1  zlotkin and rosenschein 1  martial 1. osawa and tokoro 1  ephrati and rosenschein 1  kinny et al. 
1 . martial has investigated how planning agents can positively cooperate in distributed environments  martial 1 . many previous papers on distributed coordinated planning mainly focused on how to resolve conflicts  corkill 1  georgeff 1 . martial  however  studies situations where a positive effect can be reached  as modeled by his favor relation. we also focus on the positive effect of cooperation in terms of collaborative plan construction  and have developed a scheme for constructing collaborative plans among agents based upon their  possibly incorrect  beliefs and partial  incomplete  knowledge of the world  osawa and tokoro 1 . the partiality of agents1 skills and inconsistencies among agents1 beliefs in open multiagent environments are not well treated in most of the previous work involving multiagent planning. 
　in martial's method  agents broadcast their plans at any time and at different levels of abstraction  so that they may refine their plans in a coordinated way. his method is based on the assumption that there is a collection of autonomous intelligent agents which communicate about  planned actions ahead of time. in our scheme  the investigation of possible positive cooperation  collaboration  is taken into account when the need for help actually arises. the scheme is designed to provide flexible decomposition of goals  availability-based assignment of goals to agents  and opportunistic collaboration to distributed planning based on the contract net proposed by davis and smith  davis and smith 1 . these features of the scheme are designed to cope with the uncertainty and dynamic nature of open multiagent environments. 
　in the collaborative planning  agents are presumed to rationally take three factors  obstacle elimination  workload balancing  and cost effectiveness  into account to decide which actions will be performed by each agent in a collaborative plan. the rationality makes it possible for every agent to make a good choice among alternative plans in individual plan construction. additionally  it enables agents to expect certain decisions and behavior from other agents in collaborative activities. the role of rationality in collaborative planning is illustrated in previous work  osawa and tokoro 1   however  the formal treatment  of collaboration and the rational decisions among agents still needs to be addressed. 
　in this paper  we formalize collaborative planning among rational agents using the multi world model  nagao 1   and provide a utility-based model for rational choice of actions with which agents can effectively balance the above mentioned factors. a condition for incomplete collaborative plans is also presented. 
　the organization of this paper is as follows. in section 1  we will present the outline of the collaborative plan scheme proposed in  osawa and tokoro 1 . section 1 gives a formal model of individual planning of rational agents based on the multi-world model  nagao 1 . in section 1  we formalize the process of investigating the possibility of collaboration among individual plans. section 1 gives a formal model for a rational choice of actions from the initial individual plan. section g contains our conclusions. relation to other work has already been discussed in this section. 
1 	collaborative plan scheme outline 
large  multiagent systems can be viewed as open distributed environments. thus  agents have inconsistent and partial world views. in multiagent cooperative plan construction  several agents mutually generate collaborative plans by inference based on their own beliefs and partial knowledge about the world. therefore  mutual planning is confounded by disparities in agents' world knowledge. 
   in a multiagent system  an agent may have a goal or task which it cannot do alone. contract-net protocol  davis and smith 1  provides a way for an agent who needs help  the requestor  to dynamically decompose the task into subtasks  and to allocate the subtasks to other agents  requestees  through negotiation. the contract-net protocol also provides dynamic and opportunistic control. 
   in open distributed environments  services  processing capacity  and the connection topology of computing elements are continuously changing. at the same time  the granularity of agents and plans are changing dynamically. also agents are heterogeneous. although contractnet type organization schemes are usually preferable in open distributed environments because of their dynamic nature  a multiagent system embodies additional com plexity which makes application of the contract-net difficult. 
   two such problems in the contract-net occur in decomposition and task allocation. when the requestor first decomposes the task  its fixed decomposition of the task may not suit the open distributed environment . not only may it not know what agents are currently available  but it also may not know the changing skills of potential requestees. the requestor then selects one agent per subtask through negotiation  and allocates the subtask to that agent. no single agent may have a plan to achieve the subtask alone. even though subcontracting is possible  this fixed task allocation strategy  which assigns a subtask to only one agent  may result in an ineffective hierarchy of subcontracts. 
   if we apply the contract-net protocol to hierarchical multiagent planning  the problems become more serious. the requestor wants some agent to accomplish a goal  but if it does not have sufficient knowledge to decompose a complex goal properly in an open distributed environment  it cannot ask any single agent to achieve the goal. its task allocation strategy fails. therefore  we need a more flexible strategy for selecting requestees. 
   suppose that the requestor can somehow select sev eral agents as collaborative requestees. this raises some questions. what information should the requestor provide to those requestees  in other words  what information is necessary for the requestees to mutually construct collaborative plans  also  how should the mutual plan construction be coordinated and organized  
   the scheme proposed in  osawa and tokoro 1  is designed to provide flexible decomposition of goals  availability-based assignment of goals to agents  and opportunistic collaboration to distributed planning partially based on the contract net proposed by davis and smith  davis and smith 1 . these features of the scheme are designed to cope with uncertainty and the dynamic nature of open multiagent environments. 
　in the collaborative plan scheme  an agent who needs help dynamically organizes a group. the agent first announces a request for proposals  rfp  by sending a message to a bulletin board agent. agents who read the rfp and can construct an individual plan for the request  even if incomplete  send their individual plans to the originating agent  hereafter referred to as the requestor. the requestor then investigates possible collaboration among potential requestees. if collaboration seems possible  the requestor gives collaborative awards  along with suggestions for collaboration  to the requestees. a suggestion for collaboration given to a requestee agent contains:  1  explicit obstacles of the other collaborating agents which the agent may possibly resolve;  1  actions which collaborating agents may perform. the suggestions set up a partial model for predicting the other agent's actions. using these suggestions  along with its initial individual plan and beliefs  each collaborating agent constructs a collaborative plan through inference. in collaborative plan construction  each agent decides on the actions it should perforin  the actions the other agents would perform  and the actions both agents will achieve jointly. in the process  each agent takes three factors into account: the elimination of obstacles of other agents  balancing of the workload among agents  and cost effectiveness. this whole process can be summarized as follows. 
1. requestor sends a request for proposal  rfp  to the bulletin board agent 
1. free agents1 request the bulletin board to provide a stored rfp 
1. bulletin board sends rfp to requesting free agents 
1. free agents generate individual plans 
1. free agents send individual plans  if any. to the requestor 
g. requestor investigates the possibility of collaboration  computes suggestions for collaboration  
1. requestor sends collaborative awards to requestees 
 out. of free agents  
1. requestees construct collaborative plans 
1 	individual planning of rational agent 
in this section  we present a. model for individual plan generation by rational agents. in the model  the beliefs of an agent at time t arc modeled by a first-order axiomatic system  which is called a world. operators are represented by a transition from one world to another. therefore  a plan can be viewed as a chain of operators which connect several worlds. this model is based on the multi-world model  nagao 1 . 
1 	belief model of agent 

	osawa 	1 
　 is used for entailment from a single world. later  we introduce entailment based on consistent inheritance of propositions from previous worlds  which is called entailment with consistent inheritance. 
1 	operator 
each agent maintains a library of operators that it may execute. operators in the library are generic functions that are represented in the following form: 
where 	are propositions 
that hold before  after  the operator is executed. preconditions and effects are sometimes written as preconds and effects. also  each operator is associated with a temporal variable t  and an execution time cost r which is the expected cost of the operator. the cost of the operator is predicted from an agent's working environment. 
the arguments of an operator in the library  agent  
parameters  t  preconds  and effects  are instantiated when the operator is invoked. 
　the functions agt  pars  time  cost  pre  and eff  which are used in the following definitions  are functions that take an instantiated operator and return its respective argument  agent  parameters  t  t  preconds  and effects. 
cost  since the hypothesis will be achieved by executing some operator. the semantics of the cost will be discussed in subsection 1 of this section. 
1 	operator sequence 
a transition from one world to another by way of a chain of operators and abductions is called an operatar sequence. 

　now  we define entailment with consistent inheritance and extend the definition of the operator. in the previous definition of the operator  the preconds of the operator are restricted to be solely entailed from the world in which the operator will be applied. however  if there is a chain of several worlds which are connected through a sequence of operators  not only the world in which the operator will be applied  but also some previous world in the chain  will entail a proposition in preconds. therefore  we need to extend the definition of operators. for that purpose*  we first define entailment with consistent inheritance. this inference rule is analogous to the default rules in nonmonotonic reasoning  r.eiter 1   . 


	osawa 	1 




	osawa 	1 
teria;  1  the maximum completeness  obstacle detection and elimination   and  1  the utility equalization principle. if the resulting collaborative plan still contains an unsupported hypothesis  the plan is incomplete. the plan can be made complete by forming another collaborative group with agents who have the skills necessary to achieve the hypotheses  using the hypotheses as goals. 
we are currently working on the following extensions: 
 1  implementing the proposed scheme;  1  theoretical analysis on computational complexity of the collaboration scheme;  1  incorporating a learning capability into agents  so that successful collaboration can be reutilized again without the overhead of organizing a group. 
