 
we solve the problem of obtaining answers to queries posed to a mediated integration system under the local-as-view paradigm that are consistent wrt to certain global integrity constraints. for this  the query program is combined with logic programming specifications under the stable model semantics of the class of minimal global instances  and of the class of their repairs. 
1 	introduction 
for several reasons a database may become inconsistent wrt certain integrity constraints  ics . in such a situation  possibly most of the data is still consistent. in  arenas et al.  1  consistent data in a single relational database is characterized as the data that is invariant under all minimal restorations of consistency  i.e. true in all repaired versions of the original instance  the repairs . in that paper and others  arenas et al  1; greco etal  1   some mechanisms have been developed for retrieving consistent answer when queries are posed to such an inconsistent database. 
　when independent data sources are integrated  inconsistencies wrt to global ics are likely to occur  specially when the sources are virtually integrated by means of a mediator  because the data sources are kept completely independent. the mediator provides a global schema as an interface  and is responsible for generating query plans to answer global queries by retrieving data sets from the sources and combining them into a final answer set for the user. 
　 local-as-view   lav  is a common paradigm for data integration that describes each data source as a set of views over the global schema. another one   global-as-view   gav   defines every global relation as a view of the set of relations in the sources   lenzerini  1  is a good survey . query answering is harder in lav  abiteboul et al.  1 . on the other side  the lav approach allows more flexibility when new sources are integrated into an existing system. however  the flexibility to add new sources  without having to consider the other sources in the system  makes inconsistencies wrt global ics more likely. 
example 1 consider the lav based global integration system g1 with a global relation r x  y  and two source relations v1 = {vi a 1   v1 c d } and v1 = {v1{a c  v1{d e } that are described by the view definitions v   x  y   - r x  y ; v1{x y  - r{x y . the global functional dependency  fd  r: x -  y is violated through the pair of tuples 
{ a b   a c }. 	＆ 
in a virtual integration system  the mediator should solve potential inconsistencies when the query plan is generated. in  bertossi et a/.  1   under the lav approach  a methodology for generating query plans to compute answers to limited forms of queries that are consistent wrt an also restricted class of universal ics was presented. the limitation comes from a first step where a query transformation for consistent query answering  cqa  is performed  arenas et al  1 . next  query plans are generated for the transformed query. however   bertossi et al  1  provides the right semantics for cqa in mediated integrated systems  see section 1 . 
example 1  example i continued  if we pose to the global system the query q : ans x y   - r x y   we obtain the answers {ans a b  ans c d  ans a  c  ans d c }. however  only the tuples ans c  d   ans d  e  should be returned as consistent answers wrt the fd r: x -  y. d 
　in this paper  under the lav approach and assuming that sources arc open  or incomplete   abiteboul et al  1   we solve the problem of retrieving consistent answers to global queries. we consider arbitrary universal ics and referential ics  in consequence all the ics that are used in database praxis  abiteboul et al  1 . view definitions are conjunctive queries  and global queries are expressed in datalog and its extensions with negation. the methodology can be summarized as follows. first  in section 1  the minimal legal global instances of a mediated system are specified by means of logic programs with a stable model  or answer sets  semantics. next  in section 1  the repairs of the minimal global instances are specified as the stable models of disjunctive logic programs. those programs contain annotation constants  like those used to specify repairs of single relational databases for cqa  barcelo et ai  1 . finally  in section 1  consistent answers to queries are obtained by running a query program in combination with the previous two specification programs. 
1 preliminaries 
1 	global schemas and view definitions 
a global schema r is modeled by a finite set of relations 
{r1 r1  	... rn} over a fixed domain u. with these relation 
ai and data integration 


al and data integration 	1 

al and data integration 

al and data integration 	1 

rules 1. repair referential ics by deletion of tuples or insertion of null values that are not propagated through other ics 
 .barcelo et al  1 . for this purpose  we consider that the definition 1 the instance associated to a choice model m. 
1 	consistent answers 
ements of the global schema r. each positive occurrence of those predicates  say p t   is replaced by p t  t** ; and each negative occurrence  say not p t   by p i  f** . this program has a query predicate ans that collects the answers to q. in particular  first order queries can be expressed as stratithen to the certain answers if q is monotone. if we are interested in just the minimal answers to q  without considering consistency issues  then they can be computed as above  but 
1 	conclusions 
we have presented the most general approach so far to specifying  by means of disjunctive logic programs with a stable model semantics  the database repairs of a mediated integration system with open sources under the lav approach. then  consistent answers to queries posed to such a system are computed by running a query program together with the specification of database repairs under the skeptical or cautious stable model semantics. the specification of the repairs is achieved by first specifying the class of minimal global legal instances of the integration system. to the best of our knowledge  this is also the first specification  under the lav paradigm  of such global instances in a logic programming formalism. this specification is inspired by the inverse rules algorithms  where auxiliary functions are replaced by auxiliary predicates that are forced to be functional by means of the non deterministic choice operator. 
　the methodology works for conjunctive view definitions  but can be extended to disjunctive views using the corresponding extension of the inverse rules algorithm  duschka  1 . wrt the ics and queries it can handle  the approach works for arbitrary universal and referential integrity constrains and queries expressed as datalognot programs. in consequence  the current approach to consistent query answering  cqa  subsumes and extends the methodologies presented in  bertossi et al  1  for integration systems  and the one in  barcelo et al.  1  for stand alone relational databases. 
　for reasons of space  we just mention a few optimizations of the specification programs and their execution. the materialization of the cwa present in can be avoided by program transformation. classes of common 
ics can be identified for which  becomes head-cycle-free  and in consequence  can be transformed into a non disjunctive program  ben-eliyahu et al.  1; barcelo et al.  1 . the program for cqa can be split  lifschitz et al.  1  into the program that specifies minimal legal instances  the program that specifies their repairs and the query program. the first is non stratified  but its models can be computed bottom-up as fixpoints of an iterative operator  giannotti et al.  1 ; and the second one is locally stratified  przymusinski  1 . finally  if the query program is stratified  e.g. if the original query is first-order  then the consistent answers can be eventually computed by a bottomup evaluation mechanism. 
　for cqa we have successfully experimented with dlv  eiter et al.  1 . the current implementations of the disjunctive stable models semantics would be much more effective in database applications if it were possible to evaluate open queries in a form that is guided by the query rather than based on  first  massive grounding of the whole program and  second  considering what can be found in every  completely constructed  stable model of the program. 
al and data integration 

　wrt related papers  query answering in mediated integration systems under the assumption that certain global ics hold has been treated in  gryz  1; duschka et al  1; grant et al  1; cali et al  1 . however  in cqa  we do not assume that global ics hold. logic programming specifications of repairs of single relational databases have been presented in  arenas et al  1; greco et al  1; barcelo et al  1 . 
　 lembo et al  1  considers integration systems under the gav approach that do not satisfy global key dependencies. there  legal instances are allowed to be more flexible  allowing their computed views to accommodate the satisfaction of the ics. in this sense  the notion of repair is implicit; and the legal instances are the repairs we have considered here. view definitions are expressed as datalog queries; and the queries to the global system are conjunctive. the  repairs  of the global system are specified by normal programs under stable model semantics. 
　in  bertossi et al  1   cqa in possibly inconsistent integration systems under the lav approach is considered. there  the notion of repair of a minimal legal instance is introduced. the algorithm for cqa is based on a query transformation mechanism i arenas et al  1  applied to firstorder queries. the resulting query may contain negation  and is run on top of an extension of the inverse algorithm to the case of stratified datalognot queries. this approach is limited by the restrictions of the query transformation methodology. 
acknowledgments 
work funded by dipuc  mecesup  conicyt  carleton university start-up grant 1  nserc grant 1-
1. l. bertossi is faculty fellow of the ibm center for advanced studies  toronto lab. we are grateful to pablo barcelo  alvaro cortes  ariel fuxman  nicola leone  and alberto mendelzon for useful conversations. 
