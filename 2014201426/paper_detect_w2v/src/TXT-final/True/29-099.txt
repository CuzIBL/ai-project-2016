 
based on a resulting medial axis configuration of planar shapes  a new shape descriptor called the chain of circles  cocs  is defined herein. the cocs representation is directly extracted along the boundary contour of silhouette images  and can be controlled in a hierarchical manner which appeals to intuition. the coarseto-fine hierarchy makes matching of shapes possible with less computational complexity and greater robustness to noise  spatial quantization and local deformation of shapes. the dissimilarity vector calculated in the matching  which is executed via the dynamic programming technique  may be used to facilitate the searching process in the digital library. the capability of the proposed method is shown by matching several complex shapes such as map images. 
	1 	introduction 
compared to the curvature-based shape descriptions  mokhtarian and mack worth  1; he and kundu  1; sederberg et a/.  1; siddiqi and kimia  1   the axis-based methods  blum  1; blum and nagel  1; brady and asada  1; rosenfeld  1; leyton  
1; saint-marc ei al.  1; rom and medioni  1; zhu and yuille  1; ogniewicz and kubler  1  are known to be capable of describing shapes in terms of the region surrounded by the boundary  as well as the boundary itself  simultaneously. although this is not dealt with in this paper  we intuitively know that shapes with holes  as shown in figure 1 a   also can be represented directly by the axis-based description without using any other intermediate representation. 
several axis-based descriptions  blum and nagel  
1  zhu and yuille  1  require the analysis of axis connections to find branch points where shapes are partitioned into their parts. however  it is difficult to find stable branch points  as discussed in  zhu and yuille  1   in which they used a top-down approach using shape models to solve the problem  which can deal with only the formal shapes  as shown in figure 1 b . blum's medial axis transformation  mat   blum  1  and its effective calculation  lee  1  has conventionally been 
   *he is also with dept. of information eng.  school of eng.. nagoya univ.  japan 
1 	vision 

figure 1:  a  a planar shape with a hole   b  an example of formal shapes   c  the rectangle can be described using the axis obtained by applying medial axis transformation to its boundary contour  left   but the description is greatly affected by even a slight deformation of the contour  right    d  examples of nonformal shapes. these are difficult to describe using verbal representation and to decompose into parts. 
used to calculate the axis. however  the use of mat has been criticized because the axis obtained is very sensitive even to a slight deformation of shapes  as shown in figure 1 c . although several ideas  blum and nagel  
1  ogniewicz and kiibler  1  have been proposed to solve this problem  a more systematic approach is required. 
   in this paper  we present a new planar shape description called the chain of circles  cocs . as an axis  or region -based representation  the cocs is rich and invariant to rotation and translation of shapes. the cocs also has hierarchical description capability  i.e  the capability to represent shapes at various levels of detail on demand. using this capability  it is shown how we can get robust representation against noise and local deformation of shapes. examples of shape matching and recognition using the cocs are presented for fairly complex shapes such as those shown in figure 1 d . 
1 chain of circles 
1 	medial axis transformation 
figure 1: a collection of the maximal disks  mds  obtained for the inner part of a map of australia. a maximal disk has its center at a point on the medial axis of the boundary curve. 
the idea of mat was developed by blum  blum  
1  to extract the medial  or symmetric  axis of planar shapes. from the physics of grass fire1 it can be said that the medial axis is uniquely determined for a planar 
shape. 
　the medial axis generated by applying mat to a boundary curve can also be considered as the locus of the center of the maximal disk  md   as shown in figure 1. md is a circle which does not cross the boundary curve and touches at least two points on the curve. several algorithms have been proposed for effective computation of mat of a curve approximated by a polygon  lee  1 . the vertexes of the polygon are sampling points on the curve. 
1 	c h a i n of circles  cocs  
　as shown in figure 1 a   in shapes represented by a 
　collection of mds  a md generally has two points x  and x1 which contact the boundary contour of the shapes. the two points are mutually corresponding. the correspondence arises from the fact that the two contact points share a common md. the cocs is defined by r x  and along the arc length x of a boundary contour curve.  see appendices a and b for proof of the validity of the cocs as a shape representation . 
　at each point  for example xl the md is described by r xi  the radius of the md and  the angle from x1 to the corresponding point x1 around the center of the md in the clockwise direction. the point x1 is described in the same manner. the range of  is between 1 and 

　although the cocs can be extracted for both the internal area and the exterior of the boundary contour of shapes  we here use only the internal area  as shown in figures 1 b  and  c . depending on the local geometry of shapes  there is a md that has more than two contact points. for the uniqueness of description in this case  we use a value closest to 
l
　　in the case that we fire the boundary line of a shape written on grass simultaneously  the line of extinction is uniquely determined depending on the shape. 

figure 1: definition of chain of circles  represented by  a  r x  and  along contour arc length x.  b  a rectangle and its axis   c  extracted cocs representation for one rotation of  b  starting from the upper left corner and moving in a clockwise direction. the dotted and solid lines correspond to r x  and  respectively. 
1 	control of cocs: robust description 
prior to describing the control of cocs  we redefine v x  and rn x  as 

	chung & ohnishi 	1 

figure 1: control of cocs. each numeral on solid lines indicate t values when both rc and vc are 1. the dotted line is for  r=1  r r =1  v c =-1   the dashed line  1 1  and the dot-dash line  1 -1 . 


figure 1:  a  a noisy image of the rectangle.  b  d  uncontrolled and  c  e  controlled cocs representations. 


figure 1: controlled cocs representations with r=1  
  a  the thick points on the boundary contour line display contour points used in each representation  and thin points show unused points   b  the lines show interpolated results for unused contour points using the neighboring used contour points. 

figure 1:  a  a notched image of the rectangle.  b  d  uncontrolled and  c  e  controlled cocs representations. 
   figures 1 and 1 show the robustness of shape description obtained from the control of the cocs representation. the parameter values used are the same as those used in figure 1. note that figures 1 e  and 1 e  become similar to figure 1 b  due to the control  even though their uncontrolled original was corrupted. 
1 hierarchical approximation of nonformal shapes 
figure 1 shows how nonformal shapes are hierarchically approximated based on cocs representation. the values of parameters and in equation  1  are selected to be 1 and -1  respectively. the hierarchy of the description is obtained by controlling the value of t. figure 1 shows the corresponding cocs representation. 
1 matching and recognition 
1 	matching using dp 
the dynamic programming  dp  technique is used to match a pair of cocs representations. we can expect computational efficiency because matching is possible based on the ordering constraint  as used in  sakoe and chiba  1; geiger et al  1 . 
　if there are / points in one and j points in the other of a pair of cocs which must be matched  and / is greater than /  a match sequence of length a  is a set of point matches p  as 
		 1  
where twice the number of j points must be made for a match which does not depend on starting points of the two cocs representations in the matching process. the score 1 for the match sequence p is defined as the sum of the individual similarity scores s as 

 1  
1 	vision 

figure 1: the hierarchical approximation of the map of 
australia  each of which is displayed as the collection of mds used. the values of t and the numbers of contour points are  a  1  1 points  b  1  1  c  1  1  d  1  1  e  1  1 and  f  1  1  respectively. 
　the problem in matching is to find the match sequence with the highest score  and the computational complexity corresponds to the number of steps  o i1j 1   ota and kanade  1 . here the individual similarity score is defined as 

figure 1 shows the robustness of the controlled cocs to digitization of shapes. with much computational efficiency  matching using the approximated cocs was successful not only for variously disturbed shapes  but for 
	chung & ohnishi 	1 


figure 1: shapes used in experiments   a  a noisy image of the map of australia and its display of collection of mds.  b  collections of mds to the maps of rotated australia  england and africa  for t = 1. rotated australia is used to investigate the effect of spatial quantization arising from the shift of sampling points on the contour curve. 
different shapes  as shown in figure 1  in which the correctness may be improved  by some means  in the programming of the method. the matching of different shapes is necessary for searching shapes from a digital database. 
　table 1 shows that the dissimilarity vector calculated via matching has different values depending on the resemblance between shapes. the values of self-

figure 1: the results of matching of the map of australia to  a  its noisy and  b  oriented images  and  c  the maps of africa and  d  england. in each of the matches  squares show the contour points determined in matching among the points used in each cocs representation  t = 1 . the lines connecting the squares show matched points between two contour lines. 
1 	vision 
table 1: the dissimilarity vectors between the map of 
australia  shown in figure 1  and the shapes shown in 
figure 1 when case of the values of t are 1 and 
1. the columns of aus  n a   r a   afr and eng are for self-matching of australia  matching of australia to noisy australia  rotated australia  africa and england  respectively. 

matching  aus  and matching with disturbed shapes  n a  and r a   are zero and relatively small  respectively. as expected  the australia-england match  eng  has much higher dissimilarity than the australia-africa match  afr . 
　fundamentally  open curve matching is also possible based on the cocs if the greatest md in each curve is determined. although the determination seems to be possible via iteration  we expect to obtain a more concrete approach by a theoretical analysis on the cocs. 
a 	local geometric analysis 
　as shown in figure 1  the local geometry of the shape represented by a collection of mds is analyzed as follows. if y s  denotes a vector from the origin of a coordinate system to the center of a md  i.e.  a vector on an arc length s of the axis  x a vector from the origin to a point on the edge of the md  and r s  the radius of the md  the shape can be formulated as 

because the envelope of the collection of these mds arises from the intersection of two adjacent mds  it can be calculated from 
		 1  
from equation  1   we can deduce 


figure 1: local geometry of mds. 

where y s  and r s  denote the derivatives of y s  and r s  with respect to s  respectively  and y s  is in the tangential direction of the axis on s. 
　let be the unit tangent vector to the axis curve and formed with the unit normal vector  an orthonormal frame is a moving frame and a function of arc length s along the axis curve  as shown in figure 1. at every intersection point between mds  a vector x-y s  makes an angle with an unit tangent vector from equation 
 1   the value of the angle 
b 	global geometric property 
compared to figure 1 b   figure 1 d  shows that the bending of the axis is reflected in the cocs representation. there is an apparent difference in the lengths of the upper and lower edges between the two figures. 
