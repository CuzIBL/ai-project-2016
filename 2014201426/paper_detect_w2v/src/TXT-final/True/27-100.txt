 
models of complex physical systems often cannot be defined precisely  either because of lack of knowledge or because the system parameters change over time according to unknown phenomena. such systems can be represented by semi-quantitative models that combine both qualitative and quantitative knowledge. this paper presents numerical interval simulation  a method that can produce tight predictions of systems involving nonmonotonic functions. we present a 
successful application of nis to predict the behavior of a complex process at a brazilian-japanese steel company. we claim that such capability of simulating nonmonotonic functions is fundamental in order to handle real-world complex industrial processes. 
1 introduction 
mathematical models of complex physical systems cannot be precisely defined in many cases  either due to lack of knowledge or because parameters and functions change over time according to unknown phenomena. nevertheless  it is often possible to provide reasonable bounds for the parameters and functions. bounds on parameters are interval ranges. bounds on incompletely known functions take the form of a pair of functions  one to provide an upper bound and another to provide a lower bound. such models that can integrate qualitative and quantitative knowledge are called semi-quantitative models. they can represent important classes of complex systems such as chemical  electromechanical  nuclear  thermal  steel and other industrial processes  vescovi et ah  1 . 
   many qualitative simulation methods are based on constraint propagation. they generate all possible states and use filtering techniques to eliminate impossible ones. semi-quantitative methods such as q1  kuipers and 
berleant  1  and fu-sim  shen and leitch  1  add numerical information and take advantage of it in the filtering process. the basic algorithm remains the same. 
¡¡this research is in part supported by the advanced research projects agency  arpa order 1  monitored by nasa ames 
research center under grant nag 1  and by nasa ames research center under grant ncc 1. 
1 	qualitative reasoning and diagnosis 
such semi-quantitative methods do not fully exploit the quantitative knowledge and produce only weak predictions across time intervals. this is primarily due to the limitations of interval propagation across derivative constraints. the mean value theorem is used to constrain the ranges of a variable at two adjacent time points tn and tn+1  where tn and tn+1 are the temporal boundaries of a qualitative state. those methods do not reason about the behavior of the system within a qualitative state. 
   this paper presents numerical interval simulation  nis   
   a complete method that produces more precise simulations of semi-quantitative models. nis is complete in the sense that its solutions bound all the solutions of the semiquantitative model. nis performs numerical simulations using maximal and minimal values for the derivatives of the state variables. in order to calculate such maximal and minimal values  nis uses interval arithmetic to calculate intervals containing the possible values of the derivatives and takes their maximum or minimum respectively. the method replaces the use of the mean value theorem with explicit integration. nis also produces tighter predictions than interval simulators as defined in  moore  1 . 
   nis was presented at the 1 qualitative reasoning workshop  vescovi and trave-massuyes  1 . at that same workshop  kay and kuipers also presented their work on dynamic envelopes. both techniques share the same fundamental insights. subsequent development has lead in different directions  although it should be possible to unify the two lines of work. nis has been extended to handle non-monotonic functions and forcing functions  whereas the dynamic envelope method is more closely integrated with the qsim  kuipers  1  formalism. the dynamic envelope method of kay and kuipers  derives and numerically simulates  extremal systems  composed of  extremal equations  that are bounds on the derivatives of the state variables. such  extremal systems  have been automatically generated only for systems of monotonic functions. 
   nis is an extension of the fuzzy simulation methods for linear systems proposed in  vescovi  1  and  vescovi and trave-massuyes  1 . we claim that the extension presented in this paper to handle nonmonotonic functions and forcing functions is fundamental to simulate real-world nonlinear complex systems. we demonstrate the usefulness of nis by presenting its successful application to simulate a complex sintering process at cst tubarao  a brazilianjapanese steel company located in brazil. 
this paper is organized as follows: we first describe the 
numerical interval simulation method. second  we show two examples of numerical interval simulation of systems of ordinary differential equations composed of nonmonotonic functions. the first system represents an electrical system with power supplied by an ac generator  and the second represents an inverted pendulum attached to an electric motor. we then discuss the mathematical properties of the method. we finally present the application of nis to a complex industrial process. we close with a discussion of related work and conclusions. 
1 numerical interval simulation 
the numerical interval simulation method takes as input a 
semi-quantitative model and generates upper and lower bounds on the trajectories of each of the state variables in the model. 
   the semi-quantitative model is composed of a set of equations  interval bounds on the constant parameters used in the equations  and interval bounds on the initial values of the state variables. the equations are  non-  linear first-order ordinary differential equations  odes  of the form : 

the functions fk can contain the standard arithmetic operators such as addition  subtraction  multiplication  division  exponential  logarithm  sines  cosines  and constant parameters. in addition  fk can also contain intervals in place of constant parameters and interval functions that bound the values of the actual parameters and functions. interval functions are functions that take intervals as arguments and return an interval. in other words  fk can contain  instead of a real-valued function g t  xj  ... xn   an interval function h t  ij  ... in  such that g t  x}  ... xn  e h t  ij  ... in  where ij's are intervals and xj e ij forj = i to n. 
   nis performs numerical simulation  using extremal values for the derivatives of the state variables. such extremal values for the derivatives are calculated in the following manner: 
  first  nis uses interval arithmetic to calculate the interval of possible values for the derivatives of the state variables  moore  1 . since the functions fk can contain intervals  as parameters  and interval functions  the arithmetic operators in fk are actually their corresponding interval arithmetic operators  and fk are interval functions as well. nis uses fk to calculate the intervals for the values of the derivatives. 
  second  nis takes the maximum or minimum of the resulting interval  depending on whether the maximal or minimal derivative is required. 
later in the paper  we show that nis is complete in the sense that its result is guaranteed to bound all the possible solutions of the semi-quantitative model. the only restriction for the functions fk is that they must be continuous over the intervals considered in the simulation. it means that functions fk can be composed not only of monotonic functions but also of nonmonotonic ones. nis allows nonmonotonic functions over the reals such as multiplication  sine  cosine  exponential and logarithm  and the arbitrary interval functions can also bound a set of nonmonotonic arbitrary real functions. 
   the nis method calculates maximal and minimal values for the derivatives at a given instant tn. such extremal values are used by a numerical simulator to determine the value of the state variables at the next instant tn+1. several different methods could be used to perform the numerical simulation. we present below nis using both the euler's method and the runge-kutta method. 

	vescovi  farquhar  and iwasaki 	1 



soundness is the property of predicting behaviors that are solution of at least one instance on the semi-quantitative model. although nis is not sound in general  the method is very precise in most cases. in this section we first discuss why nis is usually precise by comparing the method to our first approach for interval simulation  vescovi  1 . we then discuss and show a particular case in which the method 
diverges after a couple of interactions. 
   in order to point out why spurious behaviors are produced  we will recall our first approach for interval simulation  vescovi  1 . the idea with the former 
1 properties of nis 
we have analyzed some computational properties of nis  namely completeness and soundness. nis can be shown to 
be complete  but not sound. 
about 	completeness method was to extend a numerical method by substituting its operators by the interval arithmetic correspondents. the 
extended method is complete but produces too much spurious values. the main reason is that the arithmetic interval operations are applied without taking into account the interaction among variables. consider the first order system x = -kx  there is a strong relation between x and x  and both variables are operands in the extended euler's method: 
	vescovi  farquhar  and iwasaki 	1 

1. the complex sintering process 
in this section  we present the successful application of nis to predict behavior of a complex sintering process at cst companhia siderurgica de tubarao  a steel company located in brazil. the sintering process continuously produces sinter ore with various kinds of fine iron ore as the raw material and lime stone as the binder. the process has two major goals: one is the stabilization of operation to 
   actual productivity  safety and reliability requirements demand optimum operation. in the case of the sintering process  btp is to be kept as close as possible to 1%. small deviations can have significant effects on the process. 
a btp increase of around 1% when its value is at 1% correspond to a very dangerous operation region that can cause fire and damage to the coolers. predictions that are too wide  either due to lack of knowledge  or weaknesses in the 

	simulation method  are simply useless. 	many hours of 
1 	qualitative reasoning and diagnosis 

operation during different periods of the year were simulated  and the results obtained by nis were very successful. with rare exceptions  the actual behavior of the process was always bounded by nis simulations  the rare exceptions ocurred because of modeling errors as opposed to nis errors . furthermore  the predictions were considered tight enough to be useful. 

figure 1 shows an example of a nis predicted behavior  the two outer thin lines  and the observed behavior  the thick line  of the btp. the nis simulation failed in the interval  1  1  minutes  indicating that the boundaries were not well chosen in this operating region. this is not of great concern since the system is not supposed to operate in this region {btp smaller than 1% . this undesirable behavior occurred in reality because of an operator mistake. notice that the nis simulation predicted that the btp would penetrate the region below 1% at time 1 minutes. an on-line monitoring system would have thus advised the operator about such possibility  and it could have been avoided. 

1. related work 
research in different areas such as qualitative physics  sensitivity analysis  tolerance banding and interval analysis address the problem of combining qualitative and quantitative knowledge. we will first discuss the methods outside qualitative physics. 
   sensitivity analysis  deif  1  is used to predict the effect of small-scale perturbations to a system. tolerance banding  lunze  1  is used to predict large-scale uncertainties. both methods are normally restricted to linear models and allow uncertainties of parameters and initial values only. 
   interval analysis simulators  moore  1; markov and angelov  1  are close related to nis  in which they also simulate semi-quantitative differential equations by recasting numerical simulators to work with interval arithmetic. however  both nis and the dynamic envelope method produce tighter simulations than the mentioned interval simulators  see  kay  1  for more details . basically  the method described in  moore  1  consists in iteratively calculating the intervals ai - x tk +  1  h  * f ai-1   given x to  and a1 which is a bound on x over the interval  tk  tk + h . inclusion monotonicity garantees that the ai intervals always shrink. the intervals ai  which are bounds for the variables x  are the arguments for the derivative interval function f. the function f calculates intervals much larger than those calculated by nis  which passes only  ximax  or lximinl as arguments for the derivative functions instead of the entire interval  ximin  x m a x     as discussed in section 1. such interval simulators do not take into account the interactivity among the variables. by analysing the method of calculating ai  we can see that the prediction uncertainty will always increase with increasing time. it would thus be impossible with such a method to obtain precise results as those showed in figure 1 where the interval shrinks towards the end of the prediction of an oscillatory behavior. 
   inside the scope of qualitative physics  the first semiquantitative methods such as q1  kuipers and berleant  1  and fu-sim  shen and leitch  1  do not fully exploit the quantitative knowledge available in the semiquantitative model and produce only weak predictions across time intervals. as model precision increases  nis produces more precise simulations than q1 or fu-sim. the method replaces the use of the mean value theorem with explicit integration over time. 
   to establish the temporal correspondence between the observed values and the predictions  the sintering application uses synchronized sampling as most industrial process monitoring systems do. tracking the process is thus significantly facilitated. the imprecision of the semiquantitative model only affects variable values estimates. that provides a firmer ground for comparing the results of the simulation with real observations  which is crucial in real time monitoring systems. in semi-quantitative methods like q1 or fu-sim  temporal durations are calculated with the first order taylor-lagrange formulae using quantity space values in the form of numeric or fuzzy intervals. it was shown in  missier  1  that the first order taylorlagrange formulae is scarcely sufficient to provide significant information. this is true  independent of the weakness directly related to a weak quantity space  at the neighborhood of critical points for which the derivative reaches zero. indeed  zero derivative leads to one infinite boundary for the duration estimate. as a result  time durations calculated for adjacent states are often widely overlapped. it may happen that a given time instant belongs to several consecutive states  implying that variable values at this instant are very weakly constrained. 
¡¡¡¡most closely related to nis is the dynamic envelope method  kay and kuipers  1 . both methods numerically simulate extremal systems. nis uses interval 
	vescovi  farquhar  and iwasaki 	1 

arithemetic to calculate the extremal values for derivatives at each simulation step  whereas the dynamic envelope method generates the extremal systems a priori. the dynamic envelope method inherits certain limitations from the qsim formalism upon which it is built. first  it does not allow forcing functions such as a sin we in the example in section 1. forcing functions cannot be reasonably specified in a purely qualitative framework  because the events generated by the forcing function must be exhaustively interleaved with the normal qualitative events. this results in a combinatoric explosion. second  the qsim formalism does not allow for non-monotonic function in equations other than multiplication. the dynamic envelope method also benefits from the qualitative representation. qsim is able to split divergent behaviors  which allows the dynamic envelope method to provide separate  tighter  bounds on each qualitative behavior  rather than a single  broad  bound that covers all of the behaviors. 
   nis can simulate systems involving nonmonotonic functions and allows use of forcing functions. since a large class of complex industrial processes are modeled by nonmonotonic functions and include force functions  the capability of handling such functions constitutes an important contribution to the field of qualitative physics. 
   nis simulations of certain oscillatory systems can be unstable. the same limitation occurs with the dynamic envelope method. an alternative  which consists in intersecting the results of the dynamic envelope method and of q1  was proposed in  kay and kuipers  1  in order to improve the results of the simulation in such cases. we are considering the integration of nis with the methods under development at the university of texas. 
1. summary 
the numerical interval simulation method produces high precision simulations of semi-quantitative models. the method is complete in the sense that its solutions bound all the solutions of the semi-quantitative model. as the precision of the semi-quantitative model increases  the method produces more precise simulations than former semiquantitative methods like q1 or fu-sim. although nis produces the same results as the dynamic envelope method when simulating systems involving only monotonic functions  the method also simulates systems containing arbitrary continuous  nonmonotonic functions. nis also allows use of forcing functions. we claim that such level of generality is fundamental to simulate real-world nonlinear complex systems. 
   we demonstrated the usefulness of nis by presenting its successful application to simulate a complex sintering process at companhia siderurgica de tubarao  a brazilianjapanese steel company located in brazil. the result shows that nis is adequate to represent the available information and produces simulations with the required level of precision. the prototype has been tested and we are working to run nis on-line as an adviser to the sintering process operators. 
1 	qualitative reasoning and diagnosis 
acknowledgments 
we would like to thank marcelo lamego and cristiano dalvi for their work in modeling the cst sintering process. 
