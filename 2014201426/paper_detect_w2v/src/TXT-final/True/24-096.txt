 
this paper presents a region-based stereo matching algorithm  in which the regions are computed from the gaussian  k  and mean  h  curvature information of the image intensity surface. a region is defined as a connected area of constant k/h sign combination  and thus constitutes the footprint of a local section of the intensity surface  whose shape is a peak  a pit  a positive or a negative saddle. region adjacency information is explicited by means of a voronoi graph representation of the region map. matching between nodes of identical shape types in the two region maps is established by comparing the topological configuration of their immediate neighborhoods. the disparity map is established through a coarseto-fine strategy. 
1 	introduction 
computing 1-d structure from two stereoscopic or consecutive images requires the establishing of one-to-one correspondences between images primitives originating from the same elements of the scene. it is therefore essential to select  as primitives to be matched  image characteristics which strongly correlate with significant scene descriptors. experiments with random stereograms  first introduced by julesz  jule1   have demonstrated that binocular matching does not necessitate a preliminary stage of high-level monocular recognition and can be based on local image primitives only. they have also shown that human stereopsis can tolerate substantial differences in intensity values and micropatterns between the two images. it is thus widely accepted that the correspondence problem cannot be efficiently solved by directly matching intensity values. 
　techniques for solving the correspondence problem fall into two broad categories  namely the point-based and the region-based approaches. in the point-based category  marr &: poggio  mapo1  proposed a theory of stereoscopic matching  using as primitives the zerocrossings of the image convolved with a laplacian of gaussian operator at different spatial resolutions. false niatchings are minimized by means of a coarse-to-fine 
1 	vision 
matching strategy  in which the disparity range is progressively reduced while the resolution is progressively increased. mayhew & frishy  mafrsl  later showed that zero-crossings alone cannot explain the perception of stereograms corresponding to saw-tooth intensity gratings and suggested using peaks of the intensity profile as additional matching primitives. many other point-based matching algorithms were proposed. some of them use correlation  glre1   some use edges  babi1; grim1; ohka1   others use segments  ayfa1   combinations of features  weng1  or phase  jeje1 . 
　region-based approaches involve extracting from the two images  areas which are uniform with respect to some image characteristics. regions have been defined as areas of consistent grey-level intensity bounded by edges  libi1; cvsg1   of constant sign of the bandpass operator  of morphologically detected local peaks and valleys  fuma1   or of black and white intensity produced by the projection of a filtered random dot pattern onto the scene  xukt1 . 
   regional features possess certains advantages over points and lines. first  regions are more robust than edges because noise tends to perturb less a measurement taken over a region than one taken over its boundaries. this advantage was first noted by nishihara  nish1  who proposed a matching algorithm based on the regions delimited by the zero-crossings contours of v1g*1. second  the matching ambiguity problem should be less severe with regions because they give rise to a richer variety of features than points and segments. third  occlusions have a more radical effect on points and lines than on two-dimensional primitives and should thus be less detrimental to the matching performance of a regionbased matching algorithm. finally  image descriptions in terms of regions implicitly contain region-adjacency information  which can be captured in a graph representation and constitute a powerful means of matching and disambiguation. 
　this paper presents a region-based matching algorithm  in which the regions are computed from the gaussian  k  and mean  h  curvature information of the image intensity surface. a region is defined as a connected area of constant k/h sign combination  and thus constitutes the footprint of a local section of the intensity surface  whose shape is a peak  a pit  a positive or a negative saddle  depending on the particular k/h sign combination  beja1 . region adjacency information is explicited by means of a voronoi neighborhood graph representation of the region map  or equivalently  the delaunay triangulation   prsh1 . each node is labelled with a feature vector which contains the shape type  the size and the mean intensity of the corresponding region   while the arc joining two adjacent nodes is labelled with the relative position of the corresponding regions. matching  between nodes of identical shape types and similar average intensity  is established by comparing the topological configurations of their immediate neighborhoods. the disparity map is established through a coarse-to-fine strategy: regions are first extracted and matched at a coarser resolution in order to compute a 
　rough estimate of the disparity map  which is then used to drive the matching procedure and the disparity computation at a finer level. 
　the use of gaussian and mean curvature information to define the region primitives can be justified in several ways. first  since regions are areas of constant k/h sign combinations  their boundaries partially consist of the zero-crossings that would be used by an edge-based matching algorithm. however region boundaries are not limited to zero-crossings  and thus constitute a denser set of image elements. second  the fact that k/h regions implicitly contain information about peaks of the intensity surfaces fits well with the argument that peaks of the intensity signal are useful primitives for stereopsis  mafr1l . third  since gaussian and mean curvatures constitute surface characteristics which remain invariant under a change of viewpoint  they should provide a stable description of the image intensity surface  in areas of quasi-lambertian behavior. 
　section 1 of this paper gives a brief outline of the complete matching algorithm  while sections 1 and a describe in more details the computation of the region map and the matching strategy respectively. section 1 presents and discusses results obtained with real image pairs. 
1 	algorithm outline 
the matching algorithm uses a coarse-to-fine strategy  which progressively increases the resolution and refines the disparity map estimation  using the local disparity obtained at a coarser level to drive the correspondence search at the next finer level. each of the resolution stages consists of three different steps:  1  a region map extraction step   1  a region matching step  and  1  a disparity map computation step. 
　the region map extraction step consists of all the processing operations required to select the proper level of resolution  gaussian filtering   to compute the signs of the gaussian and mean curvature of the intensity surface at each pixel location  to establish the modified voronoi diagram of the curvature regions  and to label the nodes and the arcs of the diagram with the necessary intraregional  shape type  size  mean intensity  and interregional  relative position  parameters respectively. the modified voronoi diagram  together with the node and arc labels  constitute the region map. 
　the region matching procedure is applied to regions of the two images which are of the same shape type and of similar average intensities. it starts with an initial  possibly ambiguous  matching of regions based on a similarity measure of their neighborhood topology. in accordance with other multi-resolution strategies  the search for a match is conducted in a window  whose size is proportional to the current gaussian parameter  centered at the local disparity value inherited from the coarser resolution level  a zero disparity value is assumed at the coarsest level . this first attempt may produce three types of results: a one-to-one match  an ambiguous  one-to-several  match  or a no-match result. for a one-to-one match  a disparity vector  is computed. ambiguous  oneto-several  matches are further treated by a recursive disambiguation procedure  which consists of choosing  among all the matching alternatives for a node  the one whose disparity best agrees with those of the currently validated  i.e. one-to-one  matches within the voronoi neighborhood. an attempt is then made to reduce the amount of unmatched nodes  using a relaxed procedure  i.e. reduced search window and more tolerant dissimilarity test  which tries to find  for each such node  a one-to-one match around a disparity value in agreement with those of its voronoi neighbors. 
　the disparity computation step consists of establishing  through interpolation  a dense disparity map at the current resolution stage. in order to prevent undesirable blurring across discontinuities  the interpolation procedure uses both the node disparity map established at the preceding step and an edge map obtained by means of a recursive edge detection operator  shca1 . 
　the next two sections give details concerning the map extraction and the region matching steps. 
1 	region map extraction 
1 	computation of gaussian and mean curvatures 
scale selection is accomplished by gaussian filtering of the intensity values  i.e. by convolving the image intensity with the gaussian kernel: 
		 1  
　the gaussian  a  and the mean  h  curvatures are computed from the values of the first and second derivatives of the filtered intensity surface  according to the expressions: 

　computation of the derivatives requires a continuously differentiable intensity function. this can be accomplished by least-squares fitting a quadratic surface over a 1 x 1 neighborhood centered at each location. the derivatives needed to calculate k and h are then given by the coefficients of the basis functions obtained in per-
forming the fit  boco1 . 
	audette  cohen  and weng 	1 

 a  image 1 	image 1 

 b  image 1 	image 1 
figure 1: region map extraction:  a  original monocular pair;  b  regions obtained at coarse resolution level 
 the four shape types are represented by four different grey-levels. 
1 	definition of curvature regions 
regions of constant k/ h signs are then extracted by thresholding. each region is the footprint of one among four possible shape primitives: a peak   a pit a negative saddle  
and a positive saddle 	in fact  h and 
k values must be thresholded in order to confer to the region map some immunity to insignificant changes in curvature sign  caused by viewpoint changes in nearly flat areas of the intensity surface. in general  regions corresponding to positive or negative saddle shapes tend to be more elongated than those corresponding to peaks or pits. since the later step of region matching will result in the association of a disparity value to a central location of each region  its centroid or maximum curvature location   it is desirable to keep all regions reasonably compact. consequently  the thresholds on k/h must be selected so as to generate saddle regions whose compactness remains comparable to that of peaks and pits. once properly detected  all the curvature regions rn of each image are indexed by means of a component labelling routine. figure 1  a    b  shows a temporal pair of images and the corresponding regions extracted at the coarsest level of resolution. 
1 	definition of regional features 
four intra-regional features are associated with each region rn: its shape type  its average intensity  
1 	vision 
its area sn and the position  xn yn  of its extremum of gaussian curvature  called region principal point in the rest of the text . this last feature is not used during the matching procedure  but serves as anchor point of the region  in the computation of the local disparity. the location of curvature extremum is a better anchor point than the region centroid  because it tends to be less affected by changes of the region shape  induced by variations of the curvature threshold. a fifth regional feature  called the neighborhood matrix nmn is defined in order to summarize information about the region immediate neighborhood. its computation requires the transformation of the set of regions into a graph in which region adjacency is explicited. a natural choice for this graph is the modified voronoi diagram  toy1; prsh1  of the curvature regions. each node of the graph corresponds to a particular curvature region rn and coincides with the location  of its principal point. it is labelled with the set of the four regional features 

　the aspects of the neighborhood information which are conveyed by the neighborhood matrix nmn are the locations of voronoi neighbors  as well as their own intraregional characteristics  namely their shape type  area and average intensity. this choice of characteristics is justified by the consistency of the relative position and orientation of each neighbor under changing viewpoint  as noticeable in the example of figure 1. the area around the region under consideration is divided into 1 sectors and the neighbors are sorted according to the sector in which they fall. the matrix nmn consists of 1 rows: the kth row enumerates the four characteristics of the closest neighbor whose principal point falls in the kth sector  namely 
: an integer  between 1 and 1  indicating the shape type of the neighbor  
: its area  
: its distance from the central region 
: its average intensity. 
　if no voronoi neighbor falls into a sector  its corresponding row is empty. 
1 	region matching and disparity computation 
1 	matching criterion 
the matching strategy consists of associating regions rn and rn' of the two images  i.e. nodes of the two region maps  which are of the same shape type and have highly similar neighborhoods: 

 1  
where enn* is a measure of the dissimilarity between the 
two neighborhood matrices nmn and nmn'  and ynn' represents the absolute difference in average intensity between the two regions. comparing the two neighborhood 

 1  
c is a normalizing constant and designates modulo-1 addition operator. the min operator in expression  1  is used to allow a relative rotation of one sector in either direction  when comparing neighbors in the two region maps.  k  is a penalty measure which takes into account differences in shape type  size  relative distance and mean intensity between the two neighbors under comparison. it uses threshold-type compatibility functions defined as follows: 
	 1  
type compatibility is thus assumed if and only if the shape types of the two neighbors under consideration are identical. 
	 1  
where tarea is a relative area threshold  typically 1 %  which limits the acceptable size discrepancy between compatible neighbors. 
distance compatibility function  
 1  
where tdist is an absolute threshold  typically 1 pixels  which limits the tolerable discrepancy of distance to the two central regions. 
  intensity compatibility function  
 1  
where tint is an absolute threshold  typically 1 grey levels  out of 1  which limits the tolerable discrepancy between average intensity of compatible neighbors. 
figure 1: statistical distributions of the dissimilarity measure under match and no-match assumptions 
　the ability of the dissimilarity measure  to correctly match regions of the two images is illustrated in figure 1  which represents the statistical distributions of  for matching and unmatching regions. a discriminating threshold can be easily defined to minimize the probability of misclassification. the inclusion in the matching criterion  1  of a test on the average intensities of the central regions rn and rn  aims at increasing the robustness to occlusion errors  which would otherwise occur if type and neighborhood alone were used. 
1 	matching procedure 
as mentioned in section 1  a first step of the matching procedure consists of selecting  for each region  node  of the first image  all potential matching nodes in the second image within a search window whose size decreases with increasing resolution. potential matches are selected on the basis of the dissimilarity measure enn'  using a decision threshold established by analysis of the distributions of figure 1  typically set to 1 . at coarse resolution  a large search window  1-pixel wide for a 1 image  is used  since no a priori disparity information is available at this level. a square window is used in the case of temporal image pairs  while in the stereo case the epipolar constraint allows a reduction of the window height. since matching is done between regions and not point features  the window cannot be reduced to one line segment but necessitates a height of a few pixels  typically 1   in order to allow for fluctuations in the position of the region principal points. 
　an efficient search strategy is an important consideration when matching discrete primitives. a bucketing technique is used to sort each region node according to the location of its principal point. the image plane is first divided into tiles  each of 1 x 1 pixels. a region whose principal point falls within a tile has its label stored in a memory location corresponding to this tile. the search window is centered at the tile which coincides with either the position of the region to be matched  at coarse resolution   or with this position offset by the cur-
	audette  cohen  and weng 	1 

table 1: matching score sensitivity to parameters variations  upper left: number of good matchings; lower right: number of false matchings; total number of regions: 1  


 a  	 b  

rent disparity estimate  at higher resolutions . 
　in order to disambiguate between multiple potential matches  a disparity continuity constraint is applied  using neighboring information within an iterative procedure. for each region  a disparity estimate is established using the median of the disparity values of the currently validated neighboring matches. taking the median of x- and y-components of the disparity values rather than their mean provides some immunity to outliers. comparing then the disparity estimate with all corresponding potential matches allows us to select the match whose actual disparity is the closest to the estimate. this disambiguation step is allowed to iterate until there is no change in the number of validated matches. 
　the disparity continuity constraint is also used to force additional matches at the same resolution. for each unmatched region  a disparity estimate is established by taking a weighted average of the disparity values of the validated neighbors. each weight is inversely proportional the distance  and is normalized so that all weights sum to 1. the search window is centered on the tile corresponding to the principal point position offset by this new estimate  the window size radius is reduced  and the dissimilarity threshold is increased. 
1 	results and discussion 
table 1 illustrates the performance of the matching procedure  in the case of the temporal image pair of figure 1  under variations of the dissimilarity measure parameters  and shows that the choice of such parameters does not critically affect the performance of the algorithm. 
　figure 1 illustrates the kind of results obtained with a stereo pair and with the temporal pair of figure 1  at a finer resolution level . the left original stereo image is featured in  a   and its corresponding disparity 
1 	vision 
	 c  	 d  
figure 1: disparity map:  a  original left image  stereo pair    b  finer level dense disparity map  stereo pair ;  c  finer level sparse disparity map  with edge map used to inhibit interpolation  temporal pair ;  d  finer level dense disparity map  temporal pair  
map is plotted in  b . to demonstrate the density of the results extracted at this scale  a sparse density map for the temporal pair is shown in figure 1  c   where intensity is inversely proportional to the disparity value and thus proportional to range. the edge map used to inhibit interpolation is also shown in figure 1  c . finally  figure 1  d  features a plot of the dense disparity map  for the temporal pair. the disparity values extracted for every region at the coarsest resolution are used to drive the matching at the finer one. 
　the interpolation scheme used here is based on sinha & schunck's method  sisc1; sisc1   which uses a least-median-squares approximation stage followed by a weighted bicubic spline interpolation stage. the approximation performs a fit at each point defined on a regular grid  using nearby  irregularly spaced  sparse disparity data. this fitting provides regularly spaced disparity values  which are necessary for a spline-based surface interpolation. 
　we modify the approximation stage as follows: we discount any disparity value defined at a point which lies across a discontinuity from the point where we are performing the fit. the motivation for this modification to the approximation scheme is that least-median-squares fitting provides noise immunity by ignoring outliers in the disparity data  but near discontinuities the number of outliers approaches the number of disparity values over 

which it is desirable to perform the fit. the fitting step yields a value consistent with the majority of neighboring points  and this would produce an incorrect disparity estimate if this value were dictated by undesirable points  e.g.: points lying outside of the boundary of an object over which we are fitting   if they were not eliminated. 
1 	conclusion 
 this paper has described a region-based stereo matching algorithm  in which the regions are defined as areas of the intensity surface having constant-sign gaussian  k  and mean  h  curvatures. region adjacency information is explicited by means of a voronoi graph representation of the region map. matching between nodes of identical shape type in the two region maps is established by comparing the topological configuration of their immediate neighborhoods. the disparity map is established through a coarse-to-fine strategy. all operations concerning region map extraction and regional feature calculation involve simple local computations  and make the algorithm suitable for efficient parallel implementation. results presented indicate that the algorithm is reliable and produces dense disparity maps. further experiments are under way in order to assess the performance in a wide range of situations. 
1 	acknowledgement 
this work has been supported by the institute for robotics and intelligent systems  iris  under the canadian program of networks of centres of excellence. the help of nguyen hong hai  computer analyst in our group  concerning various aspects of the algorithm implementation is gratefully acknowledged. 
