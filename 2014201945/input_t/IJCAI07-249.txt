     Generating Bayes-Nash Equilibria to Design Autonomous Trading Agents

     Ioannis A. Vetsikas   and  Nicholas R. Jennings                Bart Selman
         ECS School, University of Southampton,             CS Dept., Cornell University,
               Southampton SO17 1BJ, UK                        Ithaca, NY 14853, USA
                 {iv,nrj}@ecs.soton.ac.uk                      selman@cs.cornell.edu


                    Abstract                          then use them to generate new trading strategies. Even though
                                                      our general methodology is motivated from the fact that com-
    This paper presents a methodology for designing   plex games cannot be analyzed using the current game theo-
    trading agents for complex games. We compute,     retic tools, by concentrating on one sub-problem, we can now
    for the ﬁrst time, Bayes-Nash equilibria for ﬁrst- analyze it. In particular, we examine auctions that have a set
                               th
    price single-unit auctions and m -price multi-unit of possible closing times, one of which is chosen randomly
    auctions, when the auction has a set of possible  for the auction to end at, and compute several novel equilib-
    closing times, one of which is chosen randomly for ria. To evaluate our work we applied it to a sub-problem of
    the auction to end at. To evaluate this approach  TAC, the purchase of a hotel room of a particular type. In
    we used our analysis to generate strategies for the more detail, in TAC Classic, m =16rooms are available
    International Trading Agent Competition. One of   in each category (meaning hotel and day) and they are sold
    these was evaluated as the best overall and was   in separate, ascending, multi-unit, mth-price auctions (one
    subsequently used very successfully by our agent  per category). These auctions close at randomly determined
    WhiteBear in the 2005 competition.                times and, more speciﬁcally, a random auction will close ev-
                                                      ery minute throughout the game. The agents want to buy up
                                                      to 8 rooms, but for ease of analysis we assume that each such
1  Introduction                                       agent is represented by 8 sub-agents, each of which is inter-
Auctions are becoming an increasingly popular method for ested in a single room. In this way, we have N =8× 8=64
transacting business, both between individuals over the Inter- agents each wishing to buy 1 unit (room) in the auction. Be-
net and between businesses and their suppliers. In this con- tween closing times, the agents may place bids, but these are
text, auction theory provides us with some simple equilibria, not opened until the next possible closing time; hence each
mostly for the case when a single item is being bought or round that takes place between consecutive closing times is
sold. However, in practice, agents (or humans) are rarely in- effectively a sealed bid auction. The agents’ bids are binding,
terested in a single item. Rather, they often wish to bid in as they cannot subsequently be retracted.1
several auctions in parallel for multiple goods. Moreover, the This paper makes a number of contributions to the state of
fact that the value of each good to an agent often depends the art. In section 2, we analyze the Bayes-Nash equilibria
on other goods makes this problem particularly hard. Given that exist in mth-price auctions with multiple possible clos-
this background, the International Trading Agent Competi- ing times and compute several equilibria that have not been
tion (TAC) [Wellman et al., 2001] deﬁned a benchmark game seen in the literature before. In particular, the equilibrium
that incorporates several elements found in real marketplaces, that we look for in each case is the unique symmetric equilib-
and different researchers adopted a variety of approaches to rium. Now, some of the initial stages of this work appeared
tackle the problem (see e.g. [Stone et al., 2002] or [Green- in [Vetsikas and Selman, 2006] where we presented equilib-
wald and Boyan, 2001]). Now, most of these approaches op- ria for the 2-round case, without any implementation details.
erate based on some form of heuristics, because it is widely The current paper extends this very preliminary work by pre-
claimed that a principled theoretic approach is not practical.
However, in [Vetsikas and Selman, 2003] we outline a gen- 1As well as being a benchmark for the international competition,
eral, principled methodology for systematically exploring the there are also a number of real world auction settings that exhibit
space of bidding strategies for complex games with multiple these characteristics. The Yahoo! auctions have a “random” closing
interdependent goods, which are traded in several different time, since they are extended every time a new bid is placed. In ad-
auctions, like TAC, where it is not possible to ﬁnd an equi- dition governments sometimes conduct rounds of binding and non-
librium solution. Speciﬁcally, to handle this complexity, we binding bids when privatizing resources (normally the ﬁrst rounds
                                                      consist of non-binding bids, and the latter rounds of binding ones).
decompose the problem into sub-parts, which are then an- As in TAC, after each round of binding bids, there is a chance that
alyzed separately, before the various resulting strategies are the government will decide, for political or economic reasons, to
recombined to generate the strategy the agent should use. end the auction (well before the last possible closing time). Further-
  Against this background, in this paper we actually compute more, in many countries, the spectrum auctions for third generation
Bayes-Nash equilibria for some of these sub-problems and cellular phones involved multiple rounds of bidding.
                                                IJCAI-07
                                                  1543senting equilibria (with proofs in most cases) for the general 2.1 Equilibria For A Single Unit Auction
multi-round case, as well as for the special case of a ﬁrst price In this section, m =1and the single unit is sold to the
auction. In section 3, we describe the implementation of this agent which submitted the highest bid at a price equal to its
work to various cases, including the TAC game. Finally, in bid. In theorem 3, we assume that in the second round the
section 4, we generate two new TAC strategies inspired by utilities are drawn from the same distribution as in the ﬁrst
this analysis, and we determine, via experiments, that one           2 
                                                      round, and that ui ui. Each agent i submits a bid vi in
of them is superior. We then used this strategy in the actual the ﬁrst round. We compute a Bayes-Nash equilibrium g(u)
competition (where the corresponding agent was highly suc-
                                                      that maps utilities ui to bids vi. In the case of p1 =1(only
cessful). We conclude this paper, in section 5, by detailing one round) and Q1 =0, we know from standard auction the-
interesting directions for future extensions of this work.
                                                      ory that each risk-neutral agent i with valuation ui should bid:
                                                                                          
                                                                          1      ui        N−1
                                                           g(ui)=ui −        N−1 · 0   F1(ω)     · dω
2  Computing the Equilibria                                            F1(ui)
We assume that N risk-neutral agents wish to buy 1 unit of a Theorem 2 If the starting price is Q1 ≥ 0 and the bidding
                                                      lasts for exactly 1 round (p1 =1) the equilibrium strategy is
certain good each. An independent seller sells m units of the                       
                  th                                                          ui       N−1
desired good in an m price auction. The agents have val-                         F1(ω)     · dω
                r                                                            Q1
uations (utilities) u at round r which are i.i.d. drawn from    g(ui)=ui  −                         (1)
                i                                                                  (  ) N−1
distribution Fr(u). Each agent knows accurately its own val-                     F1 ui
uation ur at the current round and all the distributions F (u).
       i                                      r       Proof. Since Q1 > 0, (i) some agents might have stopped par-
The probability that round r is the last round is known to be
                                                      ticipating in the auction, since the current price Q1 exceeds
pr. If more rounds exist, an agent can submit new bids as long their private valuation u , and (ii) the probability distribution
as they are greater or equal to the bid price from the end of the         i
                                                      of the valuations F1(u) has changed, since now we know that
previous round; this is the minimum bid allowed at round r
                                                      the valuation of agents that still participate is ui ≥ Q1.The
which is denoted as Qr. We make two different assumptions
                                                     new probability distribution is:
about the information each agent i knows about its utility ur
                                                i             F1(u)−F1(Q1)
(r ≥ r) at the start of the round r:                      ( )=                    ≥   1 &    ( )=0
                                                      FQ1 u      1−   (  )  ,ifu    Q    FQ1 u     ,o.w.
                                                                   F  Q1                             (2)
  • ur can be assumed to be relatively similar to the current
     i                
           r         r    r                            We also know the probability πk of the event that exactly
    utility ui , and thus ui ui ; this is reasonable for TAC
    because usually there is a correlation between the valua- k agents participate in the auction at price Q1; it is the proba-
                                                                     (  − 1)                          2
    tion of the same room over the course of the game. This bility that exactly k of the other agents’ valuations ui
                                                      are ui ≥ Q1, which is (see e.g. [Rice, 1995]):
    assumption is used in theorems 3 and 5.                                                   
                                                                                  N−k             k−1
  • The more general case is when the agent only knows π  = C(N  −1,k−1)·  F1(Q1)     · 1−F1(Q1)      (3)
                                                       k
         r                                 ( )
    that ui is drawn from some distribution Gr u .This Let us assume that it is a Bayes-Nash equilibrium for each
    distribution could even be Gr (u)=Fr (u),whenno
                                                      agent i to bid vi = g(ui).Ifk agents participate then the
    information whatsoever exists. We use this assumption utility of agent i is 0, if it does not have the highest bid, and
    in theorem 6.
                                                      (ui − vi), if it does. The expected utility of agent i when it
  In addition, agents may not subtract bids.IntheTAC  places a bid of vi (in the case of k agents) is:  
                                                          ( |#       =   )=(   −   ) ·            ≥    =
game, when the valuation of a room drops below the bid price EUi vi agents k ui vi  Prob   j=i vi vj
Q , it is an optimal behavior for the agent to place a bid equal ( − ) · [  ≥   ]
 r                                                     ui  vi    j=i Prob vi vj .
to Qr as late as possible, since in this way it might be lucky = (  )          [  ≥   ]=    ( −1(  ))
                                                      Since vj  g uj ,itisProb vi vj    FQ g   vi  .Let
enough to get rid of the room. If only k<magents have               N−1
        r ≥                                (  −   )   Φ(x)=   F1(x)     . The expected utility regardless of the
utilities ui Qr, the rest of the rooms are sold to m k
winners of the round (r − 1), that no longer wish to buy; all number of agents  participating is:
                                                          ( )=    N     ·    (  |#       =  ) ⇒
their bids are equal to Qr and the TAC rules state that the EUi vi k=1 πk EUi vi  agents   k
(m − k) earliest placed such bids will get the rooms, there-                           −1
                                                                     ( )=(    −   ) · Φ(  ( ))        (4)
fore this means that a random selection of those winners will    EUi  vi    ui  vi    g    vi
get the rooms, as the order of their bid placements is random. The bid vi that maximizes EUi(vi) can be found by setting
                                                                                −1
  It should be noted that all the equilibria when p1 =1are dEUi(vi)          Φ (g (vi))     −1
                                                              =0⇔   (   −  ) ·  −1    =Φ(     (  )).
                                                         dvi         ui   vi  g (g (vi))    g   vi
the solutions of differential equations of the form described                                 =   ( )
by theorem 1, which is taken from [Atkinson and Han, 2004]. Since we assumed that the optimal solution is vi g ui ,the
                          (  )                        previous equation becomes:
Theorem 1 Let f(x, z) and ∂f x,z be continuous functions                           1
                          ∂z                                      −  (  ) · Φ( ) ·      =Φ(   )
of x and z at all points (x, z) in some neighborhood of the     ui  g ui      ui            ui
                                                                                   g (ui)
initial point (x0,Y0). Then there is a unique function Y (x)
deﬁned on some interval [x0 − α, x0 + β], satisfying: The solution of this equation, for boundary condition
                                                      (   )=                                          
  Y  (x)=f(x, Y (x)), ∀x : x0 − α ≤ x ≤ x0 + β and    g Q1     Q1, is equation 1; this can be easily veriﬁed.
  Y (x0)=Y0
This theorem guarantees the existence and uniqueness of the 2Because from the point of view of a participating agent it does
equilibria we compute in the next sections.           not know whether the other (N − 1) agents participate.
                                                IJCAI-07
                                                  1544   It should be noted that this theorem is reminiscent of the lasts for exactly 1 round (p1 =1) the equilibrium strategy is
                                                                  R       
 work in [McAfee and McMillan, 1987] concerning the equi-          u    −Y1 (ω)
                                                                               ·dω 

                                                                   Q1 Φ1(ω)−Y1(ω)    u  Φ  ( ) −  ( )
 librium solution in the case that the distribution F1(u) has a  e                        1 z   Y1 z
                                                       g(u)=u−                    ·    R              ·dz
                                                                                        z    −Y (ω)
 minimum value vl, presented by equation 5 in that paper. In       Φ1(u) − Y1(u)               1    ·dω
                                                                                    Q1 e Q1 Φ1(ω)−Y1 (ω)
 fact the two equilibria are given by similar equations, where                                         (7)
 the minimum valuation v is substituted by the minimum al-
                      l                                In the next proofs, we will use the following derivation from
 lowable bid Q1. However there are also some important dif-
 ferences between theorem 2 and that work. In particular, in the proof of theorem 4, without proving it here; that the ex-
                                                       pected utility, if the auction closes at this round r,is:
 the case examined by theorem 2, the number of agents partic-                           
  r
                                                                                          vi
 ipating is not known a priori, because some of them may have (r)( r)=( r − r) · Φ ( −1( )) + ( −1( )) ·
                                                       Ui   vi    ui   vi   r gr  vi        Yr gr  ω   dω
 a private valuation ui which is smaller than the minimum al-                            Qr
 lowable bid Q1; this creates a fundamental difference com-                                            (8)
 pared to the case examined by McAfee and McMillan where
 there is a minimum valuation vl. Indeed, dealing with this un- Theorem 5 If the starting price of the current round r is
 certainty concerning the number of bidders, which participate Qr ≥ 0, the next round of bidding (r +1)exists with prob-
 in the auction, constitutes the core of the proof of theorem 2. ability (1 − pr) (pr =0, 1) and the utility of the agents in
                                                                                         ( )
                                  =0                   round r is drawn from the distribution Fr u (and each agent
   Theorem 3 If the starting price is Q1 , a second round               r
                                                       i in fact has utility u of a similar value to the utility ui of the
 of bidding exists with probability (1 − p1) (p1 =0, 1) and            i
                                                       ﬁrst round) then the equilibrium strategy is the solution of the
 the utility of the agents in the second round is drawn from
                      ( )=     ( )                     differential equation:
 the same distribution F2 u F1 u  as in the ﬁrst round            Φ ( )                
 (and each agent i in fact has utility of a similar value to the − ( ) · r ui = Φ ( )−  (  ) ·Ψ (    (  ))
                                                        ui  gr ui     ( )     r ui   Yr ui    r ui,gr ui
 utility ui of the ﬁrst round) then the equilibrium strategy is     gr ui
                                                                                                       (9)
 the solution of the differential equation:                                1−    U   (  )
                                                       where Ψ (u, x)=1−     pr · ∂ r+1 u,x ,
                   Φ(  )                                   r             pr      ∂x
            −  ( )  ·   ui =Φ(    ) · Ψ( ( ))              U   (       )                           ( +1)
         ui   g ui             ui    g ui       (5)   and  r+1 ui,Qr+1  is the expected utility at round r ,
                     g (ui)
                                                       when the agent’s utility is ui and the starting price is Qr+1.
where the boundary condition is g(0) = 0,              The boundary condition is g(Qr)=Qr.
              −1                            −1
               N                  1−p1        N
 Φ( )=    1( )         Ψ( )=1+        ·  1( )          In addition, the expected utility at round r given this strategy
   x     F  x      and   x         p1   F  x      .
                                                       gr(ui) is then:
 Proof. Due to space considerations we omit this proof. How- U ( )=
                                                         r ui,Qr                                    (10)
 ever it has similarities with the proof of theorem 5.                              ui       
                                                         p  · (u − g (u )) · Φ (u )+   Y (ω) · g (ω) · dω
                                                          r     i  r i    r  i    Qr  r     r
                                                                      ui                 
   As a special case, we can examine this equation when only +(1 − p ) · U +1(u ,g (ω)) · Y (ω) · dω
   =2                                      ∼   [0 1]            r     Qr  r    i  r     r          
 N      agents participate and their valuations ui U , ,            +U   (     (  )) · Φ ( ) −   ( )
                   ( )=    ∀  ∈  [0 1]                                r+1 ui,gr ui      r ui   Yr ui
 which means that F1 u   u, u     ,  . Equation 5 be-                  −1                            
                                                                       gr (ui)                
 comes:                                                             +        U +1(     ( )) · Φ ( ) ·
                                                                       ui     r   ui,gr ω     r ω  dω
                           −   ( )
                         ui  gp ui    
            g (ui)=          1−                  (6)
             p       u · 1+    p · g (u )              Proof. If the auction closes at the ﬁrst round, then the ex-
                      i       p   p  i                 pected utility is given by equation 8. To compute the expected
 In ﬁgure 1 (left), we graph the solution for various values utility from the other rounds, we need to examine the value of
   1−p
 of    . We provide this ﬁgure in order to contrast with the Qr+1, which depends on the bids placed in the current round.
    p                                                                                     th      th
 Bayes-Nash equilibrium for the case that p =1,whichis The probability distribution of the (m−1) and m highest
         ui
 g1(ui)=  2 (see e.g. [Krishna, 2002]).Onemaynoticethat bids among all other agents at this round, named respectively
                                                         (m−1)      (m)           (m−1)             −1
 as the probability (1 − p) of a second round increases, the B and B   ,areProb[B         v]=Yr(g    (v))
                                                                 (m)            −1
 equilibrium strategy suggests that the agent should bid less. and Prob[B  v]=Φr(g (v)).
 In section 3, we compare these results with those produced (m)  r           =   (m)    (m−1)    r ≥  (m)
                                                       If B   >vi ,thenQr+1    B   .IfB       >vi    B   ,
 by our algorithm for solving the R-round case.                                   th              =   r
                                                       then the agent submitted the m price, so Qr+1 vi .If
                                                        r ≥   (m−1)          =   (m−1)
                                                       vi   B      ,thenQr+1   B      .
 2.2  Equilibria For Multiple Round Auctions                        [     =  r]=
                                                       Note that Prob Qr+1  vi
 In this section we present the system of equations for com- [ (m−1)  r ≥  (m)]=Φ  ( −1( r)) −   ( −1( r))
                                                       Prob B      >vi   B         r gr vi     Yr gr  vi .
 puting the equilibria for the R-round auction (R ≥ 2).
            Φ ( )      ( )                             As a result, we can now compute the expected utility from the
 Let us deﬁne r x and Yr x as follows:                                  ∗
                                 −1−           
 Φ ( )=    m−1   (  − 1 ) ·   ( ) N   i · 1 −  ( ) i   rest of the rounds Ui as follows:
  r x      i=0 C N     ,i  Fr x              Fr x        ∗    ui
            −2                   −1−               U  =     U +1(u ,ω) · Prob[Q +1 = ω] · dω ⇒
   ( )=    m    (  − 1  ) ·   ( ) N   i · 1 −  ( ) i     i   Qr  r    i           r
 Yr x      i=0 C N     ,i  Fr x              Fr x                
  r
                                                                   vi
 In the short paper [Vetsikas and Selman, 2006],3 we give the ∗                   d     −1
                                                            U  =     U +1(u ,ω) ·   Y (g  (ω)) · dω   (11)
 following theorem for the 1-round case:                     i         r    i        r  r
                                                                  Qr            dω                    
                                  ≥ 0                                     r        −1  r        −1  r
 Theorem 4 If the starting price is Q1 and the bidding         +U  +1(u ,v ) · Φ (g  (v )) − Y (g (v ))
                                                                  
r   i  i     r  r   i     r  r   i
                                                                    ui
   3This proof and other details that have been omitted from this +   U   (    ) · d Φ ( −1( )) ·
                                                                       r+1 ui,ω       r gr  ω    dω
 paper may also be found at Dr. Vetsikas’ thesis.[Vetsikas, 2005]   r
                                                                   vi             dω
                                                 IJCAI-07
                                                   1545         0.45

         0.4      (1−p)/p = 1
                  (1−p)/p = 2                             1000
         0.35     (1−p)/p = 5
                  (1−p)/p = 10                             800
         0.3
                  (1−p)/p = 20
                                                           600
         0.25
                                                           400
        bid:  g(u)
         0.2                                              bid:  g1(u,Q)
                                                           200
         0.15
                                                            0
         0.1                                              1000
                                                                                                1000
         0.05                                                                               800
                                                                  500                   600
                                                                                    400
          0                                                                      200
           0     0.2    0.4    0.6   0.8     1                             0 0
                                                             starting price: Q       utility: u
                          utility: u
Figure 1: Equilibrium strategies for case N =2, m =1and utility drawn from uniform distribution U[0, 1],(left)using
equation 6 for the case when R =2rounds exist, and Q1 =0, and (right) using the algorithm of ﬁgure 2 for the 1st round of 8
and probabilities pr equal to those of TAC.

                                                                r
The expected utility for both rounds is:              utility is ui and the starting price is Qr and given that
                         ( )                            ( r   )
             r( r)=   ·   r +(1−    ) · ∗             gr ui ,Qr has been computed it is:
         EUi  vi    pr Ui         pr  Ui       (12)                         
  r
                                                                             ui
                          r( r)                       U ( r    )=(1−    )·       r+1(  (    )) · ( )·
The bid vi that maximizes EUi vi can be found by setting r ui ,Qr     pr        U     gr ω,Qr   Yr ω  dω
   r( r )
dEUi vi =0               r =   (  )                                          Qr
    r       .Thenwesetvi     gr ui and eventually we                                           
  dvi                                                         +  r+1( ( r   )) · Φ ( r) −  ( r)
derive the differential equation 9.                            U     gr ui ,Qr     r ui   Yr ui      (15)
     =                           r  =                         
 −1( r  )
If ui   Qr then the agent must bid vi Qr, hence the             gr ui ,Qr                         
                                                                          r+1            
boundary condition.                                         +            U   (gr(ω,Qr)) · Φ (ω) · dω
                                                                r                         r
                                     r =   (  )                ui
From equations 11 and 12, by substituting vi gr ui ,we                            
  r
                                                                                  ui                  
derive equation 10.                                   +   · ( r−  ( r   ))·Φ ( r)+       ( )·  (   )·
                                                        pr  ui  gr ui ,Qr   r ui       Yr ω gr ω,Qr  dω
                                                                                   Qr
  In the following theorem the utility in the later rounds is
assumed not to be precisely known and to be drawn from dis- Proof. Due to space limitations and because the proof of this
          ( )
tribution Gr u .                                      theorem shares a number of common steps with the proof of
Theorem  6 If the starting price of the current round r is theorem 5, we will give a sketch of the proof. One should
Qr ≥ 0, the next round of bidding (r+1) exists with probabil- notice that equation 15 is derived in almost the same way
  (1−   )    =0 1                                                                          r
ity   pr (pr    , ), and the utility of the agents in round r as equation 10. However since the utility ui in round r is
                                                                                                     ( )
is drawn from the distribution Fr(u) (and each agent i knows not precisely known, and is drawn from distribution Gr u ,
                                  r
more accurately that, in fact, its utility ui is drawn from dis- we must use equation 14 in order to compute the expected
          ( )                            ( r    )
tribution Gr u ), then the equilibrium strategy gr ui ,Qr is utility at a round r, based on all posible utility values. The
the solution of the differential equation:            other important difference between the two proofs, is that we
                                                   must also compute the expected gain of utility (actually it’s
                1 − p                    Φ (u )                             r+1
  r      r           r   r     r          r  i                                 (   +1)
 u − gr(u ,Qr)+        · U (gr(u ,Qr)) ·    r    =    negative, so it’s a loss) UL Qr if the agent is a win-
  i      i               L     i       ∂gr(ui ,Qr)
                  pr                        r         ner in the round and in the next round ( +1)its utility
                                          ∂u                         r                     r
                                          i            r+1
                                                      is u   <Q+1. Initially we compute the utility difference
          Φ  ( r) −  ( r) · Ψ (  ( r   ))      (13)      i       r
            r ui   Yr ui     r gr ui ,Qr                r+1( r+1     )
                                                      UL    ui  ,Qr+1 , and then it is
                 1−pr  d   r+1       r+1               r+1
where Ψ (x)=1−        ·  (U    (x)+U     (x)) and     U    (Q +1)=
       r          pr   dx            L                  L    r  
                                                                  Qr+1  r+1  r+1              r+1
                 m−1                                                U    (u   ,Q +1)·Prob[u    = ω]·dω
       +1             N · (m − k)                                0      L    i    r           i
    U r  (x)=−                   · C(N − 1,k)·
      L                 · (  −  )                                          +1
                  =0  m   N    k 
                                        r  (     )
               k               x                 The ﬁnal equation for UL Qr+1 is:
          N−1−k               k
    +1( )       · 1 −   +1( )   ·      +1( ) ·          r+1
  Fr   x              Fr   x        Gr    ω  dω            (   +1)=
                                  0                    UL   Qr
                                     r                  m−1                                   
and the expected utility at round r when ui is drawn from     N · (m − k)                         N−1−k
  ( )                                                 −                  · C(N − 1,k) · F +1(Q +1)      ·
Gr u  is:                                                       · ( −  )                r    r
                                                         =0   m   N   k
              
 +∞                                      k                             

                                                                                      Qr+1           
      r( )=        U (    ) · d   ( ) ·                                            k
     U  Qr           r ω,Qr      Gr ω   dω     (14)                   1−Fr+1(Qr+1)   ·      Gr+1(ω)·dω
               Qr             dω                                                       0
                       ( r    )=           r =
The boundary condition is g ui ,Qr Qr,whenui   Qr.    The rest of the proof proceeds along the same lines as the
U ( r   )                                                              
 r ui ,Qr is the expected utility at round r, when the agent’s proof of theorem 5.
                                                IJCAI-07
                                                  1546   Set UR+1(u, Q)=0, ∀u, Q                                    1

   forr=Rto1do                                               0.9
                            1−pr  ∂
     ∀       Ψ  (   )=1−        ·   U +1(    )
      u, Q set r u, Q        pr  ∂Q  r   u, Q                0.8
     ∀Q compute gr(u, Q) by solving Differential Eq. 9
                                                             0.7
     ∀u, Q compute Ur(u, Qr) using equation 10
   end for                                                   0.6
                                                                                            r=1

                                                             cdf:  F(u) 0.5                 r=2
 Figure 2: Algorithm for solving the system of Theorem 5.                                   r=3
                                                             0.4                            r=4
                                                                                            r=5
                                                             0.3                            r=6
3  Implementation                                                                           r=7
                                                             0.2                            r=8

Figure 2 provides the algorithm that we used in order to com- 0.1
                                                               0     200    400    600   800    1000
pute the equilibrium described by theorem 5 using Matlab.                     utility: u
At each round r, starting from the last round (R), the equi-
                                                                                       ( )
librium strategy and expected utility from round (r +1)are Figure 3: Experimental distribution Fr u , which is used to
used to compute the equilibrium strategy for round r,using generate the strategies for our TAC agent.
the equations of theorem 5. To solve equation 9, we used the
differential equation solver ode45. R is set to R =8rounds
                                                      these functions and their derivatives are continuous, so that
in all cases, since TAC hotel auctions can have up to 8 rounds.
                                                      we can apply ode45 and guarantee uniqueness. To do this, we
  Initially we computed the equilibria for a uniform distribu- group all the samples in buckets of size 2, and then to make
tion. The simplest case is when N =2agents are buying
  =1                                                  it continuous, we expand each bucket to a normal distribution
m     items; this case was used in order to compare the re- with σ =2and center μ equal to the center of the bucket;
sults of the algorithm with the known solution as shown in this is the most common way, which is used in statistics, for
ﬁgure 1. We only present the equilibrium strategy for the ﬁrst
        8                                             turning sampled discrete distributions into continuous ones.
round of  rounds here in ﬁgure 1 (right); the solutions of In ﬁgure 4, we present the equilibrium strategy for rounds 1,
all the other rounds have similar graphs with different curva-
                                                      5 and 8. The fact that the utility distribution Fr(u) is different
tures. One notices that in earlier rounds the agent bids less in every round causes the bid function to vary signiﬁcantly
than in the later rounds as was expected. By comparing ﬁg- between different rounds. In the later rounds, it is advisable
ure 1 (left) to the solution for the 7th round, we verify that
                                              =0      to bid close to the marginal utility ui that the agent gets if it
they are identical for the case that the current price Q . buys a unit of the commodity sold in the auction, whereas in
However we observed that the solution at each round is very the early rounds, it is preferable to bid closer to the current
similar to the solution that we would get if, instead of sev-
                              (1 − )                  price Q of the auction.
eral later rounds (with probability p that the auction  We also computed the equilibrium strategies described by
will close later), we only have one possible later round (again theorem 6. We set the distribution of the later rounds G (u)
with probability (1 − p) that the auction does not close at this                                     r
                                                      to be equal to Gr(u)=Fr(u|u ≥ ur−1), which means that
round, but at the next one). This indicates that, from the point- we disregard any value of u that is smaller than the utility
of view of the agent, the number of possible rounds does not
                                                      ur−1 in the previous round; this is reasonable for TAC, since
matter, as long as the probability of having more rounds is utilities rarely decrease between rounds. We only need to add
the same. For example, the equilibrium strategies for all the one step to the algorithm of ﬁgure 2 in order to implement
rounds are almost identical to the one presented in ﬁgure 1
            =0                                        this: before ﬁnishing each iteration, we add a step (see equa-
(left) when Q   . This would mean that we only need to tion 14) in order to compute the utility of this round when the
solve one differential equation instead of a system when the r                                       ( )
                                                      utility ui is only known to be drawn from distribution Gr u .
utility distribution is the same in every round.      Even though, due to space limitations, we can’t show any ﬁg-
  Still using a uniform distribution, we computed the equi- ures of the equilibrium strategies, they all have the same gen-
             =64                    =16
libria when N     agents are buying m     items;this  eral form as the strategies generated by theorem 5. However,
uses the correct number of agents and items for a real TAC for any values of the valuation u and starting price Q and at
scenario. In every round the equilibrium strategy is to bid every round these strategies bid less than the correspond-
                               94%                               r
closer to each agent’s utility; that is or more in round ing strategies given by theorem 5; this is something that we
1andalmost100%   in the last round. This happens because
                                                      expected, because of the form of distribution Gr(u),which
of the fact that many more agents participate, compared to the only allows for higher than the current utility ur.
number of items offered. In this case, the agent makes a proﬁt                               i
by the fact that its bid is likely not to be the mth price, and
thus, usually pays less than its actual bid, if it wins. 4 Strategy Generation and Experiments
  Finally, we computed the equilibria using an experiment Each candidate strategy for the hotel auctions determines the
derived distribution. Since our stated goal was to apply these prices offered in each round; they are differentiated by how
equilibria to a TAC agent in order to generate more candidate aggressively the agent bids. In [Vetsikas and Selman, 2003],
strategies, we collected the utilities of the hotel rooms from we present three strategies. Two of them are the boundary
a large number of actual games and used these to create the strategies, that is the lowest and highest possible prices re-
distributions Fr(u) and Gr(u). The cdf of the distribution spectively, that a rational agent would ever consider bidding
Fr(u) that we used is presented in ﬁgure 3. We make sure that at:
                                                IJCAI-07
                                                  1547