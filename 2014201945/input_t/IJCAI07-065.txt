                     Counting Complexity of Propositional Abduction

                      Miki Hermann                                Reinhard Pichler
                 LIX (CNRS, UMR 7161)                      Institut f¨ur Informationssysteme
                   Ecole´ Polytechnique                     Technische Universit¨at Wien
                  91128 Palaiseau, France                Favoritenstrasse 9-11, A-1040 Wien


                    Abstract                          Finally, let the set of hypotheses be given as
    Abduction is an important method of non-mo-          H =  { weak defense, weak attack, star injured }
    notonic reasoning with many applications in AI    This PAP has six abductive explanations (= “solutions”).
    and related topics. In this paper, we concentrate
                                                          S  = {            }
    on propositional abduction, where the background       1    weak defense
                                                          S  = {           }
    knowledge is given by a propositional formula. De-     2    weak attack
                                                          S  = {                       }
    cision problems of great interest are the existence    3    weak defense, weak attack
                                                          S  = {                     }
    and the relevance problems. The complexity of          4    weak attack, star injured
                                                          S  = {                       }
    these decision problems has been systematically        5    weak defense, star injured
                                                          S  = {                                  }
    studied while the counting complexity of proposi-      6    weak defense, weak attack, star injured
    tional abduction has remained obscure. The goal of
    this work is to provide a comprehensive analysis of Obviously, in the above example, not all solutions are
                                                      equally intuitive. Indeed, for many applications, one is not
    the counting complexity of propositional abduction                                  P
    in various classes of theories.                   interested in all solutions of a given PAP but only in all ac-
                                                      ceptable solutions of P. Acceptable in this context means
                                                      minimal w.r.t. some preorder  on the powerset 2H .The
1  Introduction                                       most natural preorder is subset-minimality ⊆. This criterion
                                                      can be further reﬁned by a hierarchical organization of our
Abduction is a method of non-monotonic reasoning which hypotheses according to some priorities (cf. [7]). In this con-
has taken a fundamental importance in artiﬁcial intelligence text, priorities can be considered as a qualitative version of
and related topics. It is widely used to produce explanations
                                                      probability. The resulting preorder is denoted by ⊆P .On
for observed symptoms and manifestations, therefore it has the other hand, if indeed all solutions are acceptable, then the
an important application ﬁeld in diagnosis – notably in the corresponding preorder is the syntactic equality =.
medical domain (see [12]). Other important applications of
                                                        In Example 1, only the solutions S1 and S2 are subset-
abduction can be found in planning, database updates, data-
                                                      minimal. Moreover, suppose that for some reason we know
mining and many more areas (see e.g. [9; 10; 11]).
                                                      that (for a speciﬁc team) weak defense is much less likely
  Logic-based abduction can be formally described as fol- to occur than weak attack. This judgment can be formalized
lows. Given a logical theory T formalizing an application,
                                                      by assigning lower priority to the former. Thus, only S2 is
aset M  of manifestations, and a set H of hypotheses, ﬁnd
                                                      considered as ⊆P -minimal w.r.t. these priorities.
an explanation S for M, i.e., a suitable set S ⊆ H such that
                                                        The usually observed algorithmic problem in logic-based
T ∪ S is consistent and logically entails M. In this paper, we
                                                      abduction is the existence problem, i.e. deciding whether at
consider propositional abduction problems (PAPs, for short),
                                                      least one solution S exists for a given abduction problem P.
where the theory T is represented by a propositional formula
                                                      Another well-studied decision problem is the so-called rele-
over a Boolean algebra ({0, 1}; ∨, ∧, ¬, →, ≡) or a Boolean
                                                      vance problem, i.e. Given a PAP P and a hypothesis h ∈ H,
ﬁeld Z2 =({0, 1};+, ∧), and the sets of hypotheses H to-
                                                      is h part of at least one acceptable solution? However, this
gether with the manifestations M consist of variables.
                                                      approach is not always satisfactory. Especially in database
                                                      applications, in diagnosis, and in data-mining there exist situ-
Example 1 Consider the following football knowledge base. ations where we need to know all acceptable solutions of the
   T = { weak defense ∨ weak attack → match lost,     abduction problem or at least an important part of them. Con-
        match lost → manager sad ∧ press angry        sequently, the enumeration problem (i.e., the computation of
        star injured → manager sad ∧ press sad }      all acceptable solutions) has received much interest (see e.g.
                                                      [5; 6]). Another natural question is concerned with the to-
Moreover, let the set of observed manifestations be   tal number of solutions to the considered problem. The lat-
   M =  { manager sad, press angry }                  ter problem refers to the counting complexity of abduction.

                                                IJCAI-07
                                                   417     #-Abduction       =         ⊆⊆P                  dual Horn and bijunctive theories (Section 4) and ﬁnally for
     General case   #·coNP    #·coNP    #·Π2P         afﬁne theories (Section 5). We conclude with Section 6.
      T is Horn       #P        #P      #·coNP
   T is deﬁnite Horn  #P        #P        #P          2   Preliminaries
    T is dual Horn    #P        #P        #P          2.1  Propositional Abduction
    T is bijunctive   #P        #P      #·coNP        A propositional abduction problem (PAP) P consists of a tu-
                                                         
                                          ⊆
      T is afﬁne       FP       #P        #P          ple V,H,M,T   ,whereV  is a ﬁnite set of variables, H V
                                                      is the set of hypotheses, M ⊆ V is the set of manifestations,
                                                      and T is a consistent theory in the form of a propositional
 Table 1: Counting complexity of propositional abduction formula. A set S ⊆ H is a solution (also called explana-
                                                      tion)toP  if T ∪ S is consistent and T ∪ S |= M holds.
                                                      Priorities =  
 1      K  are a stratiﬁcation of the hy-
Clearly, the counting complexity provides a lower bound        P    H  ,...,H
                                                      potheses H = H1 ∪···∪HK   into a ﬁxed number of disjoint
for the complexity of the enumeration problem. Moreover,                                           ⊆
counting the number of abductive explanations can be useful sets. The subset-minimality with priorities relation A P B
                                                      holds if A = B or there exists an i ∈{1,...,K} such that
for probabilistic abduction problems (see e.g. [13]). Indeed, ∩ = ∩                    ∩       ∩
in order to compute the probability of failure of a given com- A Hj B Hj for all j<iand A Hi  B   Hi.
ponent in a diagnosis problem (under the assumption that all In this paper, we follow the formalism of Eiter and Gott-
                                                         [ ]
preferred explanations are equiprobable), we need to count lob 4 , allowing only positive literals in the solutions, except
                                                                                                      [ ]
the number of preferred explanations as well as the number for the afﬁne case. In contrast, Creignou and Zanuttini 1
of preferred explanations that contain a given hypothesis. also allow negative literals in the solutions S. We apply the
                                                      latter to afﬁne PAPs, where we need the possibility in the al-
  The counting complexity has been started by Valiant [15;
                                                      gebraic setting to assign a variable to 0.
16] and is now a well-established part of the complexity the-
                                                        Together with the general case where T can be an arbi-
ory, where the most known class is #P. Many counting vari-
                                                      trary propositional formula, we consider the special cases
ants of decision problems have been proved #P-complete.
                                                      where T is Horn, deﬁnite Horn, dual Horn, bijunctive, and
Higher counting complexity classes do exist, but they are not
                                                      afﬁne. Due to Schaefer’s famous dichotomy result (see [14]),
commonly known. A counting equivalent of the polynomial
                                                      these are the most frequently studied sub-cases of proposi-
hierarchy was deﬁned by Hemaspaandra and Vollmer [8],
                                                      tional formulas. A propositional clause C is said to be Horn,
whereas generic complete problems for these counting hier-
                                                      deﬁnite Horn, dual Horn,orbijunctive if it has at most one
archy classes were presented in [3].
                                                      positive literal, exactly one positive literal, at most one neg-
                                                      ative literal, or at most two literals, respectively. A clause C
                                                      is afﬁne if it can be written in the form of a linear equation
Results. The goal of this work is to provide a comprehen- + ···+   =                       Z
sive analysis of the counting complexity of propositional ab- x1 xk   b over the Boolean ﬁeld 2.AtheoryT
duction in various settings. An overview of our results is is Horn, deﬁnite Horn, dual Horn, bijunctive, or afﬁne if it is
given in Table 1. The columns of this table correspond to a conjunction (or, equivalently, a set) of Horn, deﬁnite Horn,
the three preorders on 2H considered here for deﬁning the dual Horn, bijunctive, or afﬁne clauses, respectively.
                                         =
notion of acceptable solutions, namely equality , subset- 2.2 Counting Complexity
minimality ⊆, and subset-minimality with priorities ⊆P .
  Apart from the general case where the theory T is an arbi- The #-abduction problem is the problem of counting the num-
                                                                             P        ⊆
trary propositional formula, we also consider the subclasses ber of solutions of a PAP .The#- -abduction problem
                                                                                         P           ⊆
of Horn, deﬁnite Horn, dual Horn, bijunctive, and afﬁne the- counts the subset-minimal solutions of , whereas #- P -
ories T . The aforementioned classes enjoy several favorable abduction counts the minimal solutions w.r.t. priorities P .
properties. For instance, they are closed under conjunction Formally, a counting problem is presented using a witness
and existential quantiﬁcation, i.e., a conjunction of two for- function which for every input x returns a set of witnesses
                                                                                         :Σ∗ →P<ω(Γ∗)
mulas from C belongs to the class C and a formula from C for x.Awitness function is a function w        ,
                                                            Σ    Γ                    P<ω(Γ∗)
with an existentially quantiﬁed variable is logically equiva- where and are two alphabets, and is the collec-
                                                                             Γ∗
lent to another formula from C. Moreover, they represent the tion of all ﬁnite subsets of . Every such witness function
most studied formulas in logic, complexity, constraint satis- gives rise to the following counting problem: given a string
                                                        ∈ Σ∗                  |  ( )|                ( )
faction problems, and artiﬁcial intelligence. This is mainly x , ﬁnd the cardinality w x of the witness set w x .
                                                                       C
due to Schaefer’s famous result that the satisﬁability problem According to [8],if is a complexity class of decision prob-
                                                                    #·C
for them is polynomial as opposed to the NP-completeness lems, we deﬁne to be the class of all counting problems
of the general case (see [14]).                       whose witness function w satisﬁes the following conditions.
                                                        1. There is a polynomial p(n) such that for every x ∈ Σ∗
                                                          and every y ∈ w(x) we have |y|≤p(|x|);
Structure of the Paper. The paper is organized as follows.                            ∈   ( )      C
After recalling some basic deﬁnitions and results in Section 2, 2. The problem “given x and y,isy w x ?” is in .
we analyze the counting complexity of propositional abduc- It is easy to verify that #P = #·P. The counting hierarchy
tion for general theories (Section 3), for Horn, deﬁnite Horn, is ordered by linear inclusion [8]. In particular, we have that

                                                IJCAI-07
                                                   418                                                                                          
#P ⊆  #·coNP ⊆  #·Π2P ⊆  #·Π3P, etc. Note that one can, we have to select at least one of xi and xi. The additional
                                                                      
of course, also consider the classes #·NP, #·Σ2P, #·Σ3P, formula ¬xi ∨¬xi enforces that we have to select at most
                                                                                                     
etc. However, they play no role in this work.         one of xi and xi. By these two conditions, the value of xi is
                                                                                  
  The prototypical #·ΠkP-complete problem for k ∈ N is fully determined by xi, namely xi is the dual of xi.
#ΠkSAT   [3], deﬁned as follows. Given a formula        Moreover, it is easy to check that there is a one-to-one rela-
                                                                                 ⊆      P
       (  )=∀    ∃   ···      (            )          tionship between the solutions S X of and the models of
      ψ X      Y1 Y2   QkYk  ϕ X, Y1,...,Yk ,         ∀Yϕ(X, Y  ). Hence, this reduction is indeed parsimonious.
                                                                                   
where ϕ is a Boolean formula and X, Y1,...,Yk are sets The complementarity of X and X enforces each solution to
of propositional variables, count the number of truth assign- be incomparable with the others and, therefore, to be subset-
ments to the variables in X that satisfy ψ.           minimal.                                         2
  Completeness of counting problems in #P is usually    According to the above theorem, #-abduction and #-⊆-
proved by means of Turing reductions. However, these reduc- abduction have the same counting complexity. Intuitively,
tions do not preserve the counting classes #·ΠkP.Itisthere- this is due to the following equivalence (cf. [4]): S is a ⊆-
fore better to use subtractive reductions [3] which preserve minimal solution of the PAP P, if and only if S is a solution
the aforementioned counting classes. We write #·R to de- of P and for every h ∈ S, S  {h} is not a solution. Hence,
note the following counting problem: given a string x ∈ Σ∗, taking the ⊆-minimality into account makes things only poly-
ﬁnd the cardinality |R(x)| of the witness set R(x) associated nomially harder. In contrast, as soon as there are at least 2 pri-
with x. The counting problem #·A reduces to #·B via a ority levels, the following effect may occur. Suppose that S
strong subtractive reduction if there exist two polynomial- is a solution of the PAP and that S  {h} is not a solution for
time computable functions f and g such that for each x ∈ Σ∗: every h ∈ S. Then it might well happen that, for some h ∈ S,
                                                                          =(  {  })∪
  ( ( )) ⊆  ( ( ))    | ( )| = | ( ( ))|−| ( ( ))|    some set of the form S S    h   X  is a solution, where
B  f x     B g x  and  A x     B g x      B f x       all hypotheses in X have higher priority than h. Checking if
                                                                
A strong subtractive reduction with B(f(x)) = ∅ is called such a set S (and, in particular, if such a set X) exists comes
parsimonious.Asubtractive reduction is a transitive closure down to yet another non-deterministic guess. Formally, we
of strong subtractive reductions.                     thus get the following complexity result.
                                                                       ⊆                      #·Π  P
3  General Propositional Theories                     Theorem 3  The #- P -abduction problem is   2 -com-
                                                      plete via subtractive reductions.
The decidability problem of propositional abduction was
                                                                 ⊆
shown to be Σ2P-complete in [4]. The hardness part was Proof: The P -minimal solutions of a PAP can obviously
proved via a reduction from QSAT2. A modiﬁcation of this be computed by a non-deterministic polynomial-time Turing
                                                                                       ⊆
reduction yields the following counting complexity result. machine that generates all subsets S H and (i) checks
                                                      whether S is a solution of the PAP and (ii) if so, checks
                                                                 ⊆
Theorem 2 The #-abduction problem and the #-⊆-abduction whether S is P -minimal. The latter test – which is the most
                                                                                    Π P
problem are #·coNP-complete.                          expensive part – can be done by a 2 -oracle. Indeed, the
                                                      problem of testing that S is not ⊆P -minimal can be done by
                                                                                                       
Proof: The #·coNP-membership is clear by the fact that it is the following Σ2P-algorithm: guess a subset S ⊆ H s.t. S
                                                                                       
in Δ2P to test whether a subset S ⊆ H is a solution (resp. a is ⊆P -smaller than S and check that S is a solution of the
subset-minimal solution) of a given PAP (see [4], Proposition PAP. Hence, the #-⊆P -abduction problem is in #·Π2P.
2.1.5). The #·coNP-hardness is shown via the following par- The #·Π2P-hardness is shown by the following (strong)
simonious reduction from #Π1SAT. Let an instance of the subtractive reduction from #Π2SAT. Let an instance of the
#Π1SAT   problem be given by a formula                #Π2SAT   problem be given by a formula
                                                                   (  )=∀       ∃    (      )
              ψ(X)=∀Yϕ(X, Y        )                              ψ X         Y  ZϕX, Y, Z
                                                      with the variables X = {x1,...,xk}, Y = {y1,...,yl},and
      =  {         }      = {        }                                                       
with X    x1,...,xk and Y    y1,...,yl . Moreover, let Z =  {z1, ...,zm}. Moreover, let x1,...,xk,p1,...,pk,
                                                           
x1,...,xk,r1,...,rk,t denote fresh, pairwise distinct vari- y1,...,yl, q1,...,ql,r,t be fresh, pairwise distinct vari-
              = {       }      = {        }                                                    
ables and let X  x1,...,xk  and R    r1,...,rk .We    ables and X  =  {x1,...,xk}, P =  {p1,...,pk}, Y =
             P = 
                                           
deﬁne the PAP     V,H,M,T    as follows.              {y1,...,yl},andQ  =  {q1,..., ql}. Then we deﬁne two
       =     ∪   ∪  ∪   ∪{  }                        PAPs P1 and P2 as follows.
   V      X    X   Y   R    t                                                
                                                       V   =   X ∪ X  ∪ Y ∪ Y  ∪ Z ∪ P ∪ Q ∪{r, t}
   H   =  X  ∪ X
                                                            =     ∪    ∪  ∪   ∪{ }
       =    ∪{  }                                       H       X   X    Y   Y    r
  M       R    t                                                                                     
                                                              with priorities H1 = H  Y and H2  = Y
   T   =  {¬xi ∨¬x  ,xi →  ri,x →  ri | 1 ≤ i ≤ k}
                   i           i                            =     ∪   ∪{  }
           ∪{  (    ) →  }                              M       P   Q    t
              ϕ X, Y    t                                                           
                                                        T1  =   {¬xi ∨¬xi,xi  → pi,xi →  pi | 1 ≤ i ≤ k}
Obviously, this reduction is feasible in polynomial time. We                         
                                                                ∪{¬yi  ∨¬yi,yi →  qi,yi → qi | 1 ≤ i ≤ l}
now show that the reduction is indeed parsimonious.
                                                                ∪{¬   (      ) →  }
  The manifestations R together with the formulas xi → ri,           ϕ X, Y, Z   t
 
xi →  ri in T enforce that in every solution S of the PAP, T2 = T1 ∪{r ∧ y1 ∧···∧yl →  t}

                                                IJCAI-07
                                                   419Finally we set P1 = 
V,H,M,T1 and P2 = 
V,H,M,T2.     For the #P-hardness, we modify the reduction from the
  Obviously, this reduction is feasible in polynomial time. #POSITIVE-2SAT problem in Theorem 4. Let ψ, X,andG
                                                                                                 
Now let A(ψ) denote the set of all satisfying assignments of be deﬁned as before. Moreover, let X = {x1,...,xk} and
a #Π2SAT-formula  ψ and let B(P) denote the set of ⊆P - R = {r1,...,rk} be fresh, pairwise distinct variables. Then
minimal solutions of a PAP P. We claim that the above deﬁ- we deﬁne P = 
V,H,M,T as follows.
nition of the PAPs P1 and P2 is indeed a (strong) subtractive         
                                                         V  =   X ∪ X  ∪ G ∪ R
reduction, i.e. that                                                  
                                                        H   =   X ∪ X
  B(P1) ⊆ B(P2)   and   |A(ψ)| = |B(P2)|−|B(P1)|
                                                        M   =   R ∪ G
                                                 2
Due to lack of space, the proof of this claim is omitted. T =   {pi → gi,qi → gi | 1 ≤ i ≤ n}
                                                                                     
                                                                 ∪{¬xi ∨¬x  ,xi → ri,x →  ri | 1 ≤ i ≤ k}
4  Horn, Dual Horn, and Bijunctive Theories                                 i         i
                                                      TheideaofthevariablesX   and the additional manifesta-
In this section, we consider the special case where the the-
                                                      tions G is exactly the same as in the proof of Theorem 2.
ory T is a set of (arbitrary or deﬁnite) Horn, dual Horn, or                      
                                                        Actually, the formula ¬xi ∨¬xi can even be omitted. This
bijunctive clauses. If no minimality criterion is applied to the                                      
                                                      is due to the fact that, whenever a subset S ⊆ H with xi,xi ∈
solutions then we get the following result.                                                            
                                                      S is a solution of P,thenS  {xi} is also a solution since xi
                                                      is useless as soon as xi is present (note that the only use of
Theorem 4 The #-abduction problem of Horn, deﬁnite Horn, 
                                                      x  is to derive ri in the absence of xi). Therefore in a subset-
dual Horn, or bijunctive clauses is #P-complete.       i
                                                      minimal solution of the PAP P, we will never select both xi
                                                                                 ¬   ∨¬  
Proof: The #P-membership is easily seen by the fact that and xi even without the formula xi xi. The remaining
                                                                                                       2
it can be checked in polynomial time whether some subset formulas are indeed deﬁnite Horn and dual Horn.
S ⊆ H  is a solution, since the satisﬁability and also the un- Below we consider PAPs with ⊆P -minimality. It turns out
satisﬁability of a set of (dual) Horn or bijunctive clauses can that for deﬁnite Horn and dual Horn clauses, the priorities
be checked in polynomial time.                        leave the counting complexity unchanged. In all other cases,
  For the #P-hardness, we reduce the #POSITIVE-2SAT   the counting complexity increases.
problem (which is known to be #P-complete by [16])toit
and show that this reduction is parsimonious. Let an arbitrary Theorem 6 The #-⊆P -abduction problem of deﬁnite Horn
instance of #POSITIVE-2SAT be given as a 2CNF-formula and of dual Horn clauses is #P-complete.
           =(    ∨  ) ∧···∧(    ∨  )
         ψ    p1  q1         pn  qn ,                 Proof: The #P-hardness is clear, since it holds even without
                                                                   #P
where the i’s and i’s are propositional variables from the set priorities. The -membership for deﬁnite Horn clauses is
        p      q                                                          P =  
         
X  = {x1,...,xk}. Moreover, let g1,...,gn denote fresh, proved as follows. Let V,H,M,T    where T consists
                                                                                     [ ]
pairwise distinct variables and let = { 1 n}.Then     only of Horn clauses. According to 4 , Theorem 5.3.3, for
                             G     g ,...,g                 ⊆
we deﬁne the PAP P = 
V,H,M,T as follows.            any S    H, we can check in polynomial time whether S
                                                      is a ⊆P -minimal solution. The #P-membership for deﬁnite
  V  =   X ∪ G                                        Horn clauses is thus proved.
 H   =   X                                              Now suppose that T is dual Horn, i.e. the clauses in T are
                                                      either of the form ¬p or ¬p ∨ q1 ∨···∨qm,orq1 ∨···∨qm
 M   =   G
                                                      (for p, q1,...,qm ∈ V and m ≥ 1). Moreover, let N denote
  T  =   {pi → gi | 1 ≤ i ≤ n}∪{qi → gi | 1 ≤ i ≤ n}  the propositional variables occurring in negative unit clauses
                                                                 =  {  |¬   ∈   }
Obviously, this reduction is feasible in polynomial time. in T ,i.e.N p   p   T  . Then for every solution S
                                                      of P we have S ⊆ H  N, since otherwise T ∪ S would be
Moreover, it is easy to check that there is a one-to-one re-                             ⊆    ⊆   
lationship between the solutions S ⊆ X of P and the models inconsistent. Moreover, for any S with S S H N,
                                                      the set S is also a solution of P, since (by the special form of
of ψ. Note that the clauses in T are at the same time deﬁnite     ∪
Horn, bijunctive, and dual Horn.                 2    dual Horn) S  T is also consistent and (by the monotonicity
                                                      of |=) S ∪ T also implies M.
  Analogously to the case of general theories, the counting Let H1,...,HK denote the priorities of H.NowS is a
complexity remains unchanged when we restrict our attention ⊆P -minimal solution of P if and only if S is a solution of P
to subset-minimal solutions.                          and for all i ∈{1,...,k} and for all x ∈ (S ∩ Hi) the set
                                                            =(     { }) ∪ (    ∩   ) ∪···∪(     ∩  )
Theorem 5 The #-⊆-abduction problem of Horn, deﬁnite     S       S    x     Hi+1   N          HK   N
                                  #P
Horn, dual Horn, or bijunctive clauses is -complete.  is not a solution of P. The latter test is clearly feasible in
                                                                                                       2
Proof: The #P-membership holds analogously to the case of polynomial time in the dual Horn case.
abduction without subset-minimality. This is due to following Recall from our remark preceding Theorem 3 that the ef-
property (see [4], Proposition 2.1.5). S⊆H is a subset- fect of at least 2 priority levels is as follows. In order to check
minimal solution of P, if and only if S is a solution and for that some solution S is not ⊆P -minimal, we have to test that
all h ∈S,thesetS  {h} is not a solution of P.        there exists some solution of the form S =(S  {h}) ∪ X,

                                                IJCAI-07
                                                   420where all hypotheses in X have higher priority than h.In Due to lack of space, the proof of this claim is omitted. 2
general, the difﬁculty of determining if such a set X exists is
the following one. If we choose X too small, then S might 5 Afﬁne Theories
not entail the manifestations M. If we choose X too big,
                                                     In this section, we consider the special case where the the-
then S ∪ T might be inconsistent. The intuition underly-
                                                      ory T is a set of afﬁne clauses. Recall that such a set can be
ing Theorem 6 is that the problem of choosing X too big
                                                      written as a linear system AX = b over the Boolean ﬁeld Z2.
disappears for deﬁnite Horn and dual Horn clauses. For def-
                                                      We change to the Creignou and Zanuttini approach [1] in this
inite Horn, the only candidate X that has to be checked is
                                                      case, since we need the possibility to set a variable to 0. If
X = Hi+1 ∪···∪HK   . For dual Horn, the only candidate X
                                                      no minimality criterion is applied to the solutions then we get
is X =(Hi+1 ∪···∪HK   ) ∩ N,whereN   takes care that if
                                                      the following result.
the theory T contains a negative unit clause ¬p,thenp must
not be included in any solution.
                                                      Theorem 8  The #-abduction of afﬁne clauses is in FP.
                ⊆
Theorem 7 The #- P -abduction problem of Horn or bijunc- Proof: Given an afﬁne PAP P = 
     where  is an
            #·coNP                                                                 V,H,M,T         T
tive clauses is    -complete.                         afﬁne system AX = b, we reduce it to the problem of count-
                                                                                                  Z
Proof: The #·coNP-membership is established as follows: ing the satisfying assignments of linear systems over 2.Re-
                                                               ∪   |=               =1            ∈
Given a set of variables , we have to (i) check whether is call that T S M means that x for each x  S and
                    S                          S        =0            ∈     (  ∪   )         =1
a solution of the PAP and (ii) if so, check whether is ⊆P - x for each x H    S   M   entails y   for each
                                           S            ∈                                       ∪   |=
minimal. The latter test, which dominates the overall com- y M in the system T . First we check whether T S M
                                                                  (  ∪   )               P
plexity, can be done by a coNP-oracle. Indeed, the problem can hold. If V H M is nonempty then has no solution,
                                                                             ∈        =1
of testing that S is not ⊆P -minimal can be done by the fol- since we cannot force all y M to y . Otherwise trans-
                                                                      =         =   +             ⊆
lowing NP-algorithm: guess a subset ⊆  s.t.  is ⊆P -  form the system AX   b to EY  b   FZ,whereY      M
                                S    H    S                 ∩    =  ∅             +     =
smaller than S and check (in polynomial time for a Horn or and Z M   , such that EY FZ     AX. Transform
                                                     EY  by Gaussian elimination to Smith normal form giving
bijunctive theory), that S is a solution of the PAP. Hence, in    
this case, #-⊆P -abduction in #·coNP.                 E Y  .IfE  Y  has a row with more than one variable, say
                                                         + ···+         ≥  2           P
  The #·coNP-hardness is shown by a (strong) subtractive yi1     yil for l  , then either has no solution, or
                                                                                     = ··· =    =1
reduction from #Π1SAT. Let an instance of the #Π1SAT  each solution S compatible with yi1    yil   is also
                                                                        =0            ∈{1       }      
problem be given by a formula ( )=∀     (    ) with   compatible with yij   for some j    ,...,l .IfE Y
                           ψ X      YϕX, Y                                                        =
   = {  1     k} and    =  { 1     l}. W.l.o.g. (see  has only rows with one variable, then add to AX b the
X      x ,...,x      Y      y ,...,y                            =1           ∈
[17]), we may assume that (  ) is in 3DNF, i.e., it is of equations y for each y M, resulting in the new system
                       ϕ X, Y                             =  
the form C1 ∨···∨Cn  where each Ci is of the form Ci = A X   b . Check whether the last system is satisﬁable and
  ∧   ∧                                        ∪      transform it by Gaussian elimination into the Smith normal
li1 li2 li3 and the lij ’s are propositional literals over X Y .     
                                                       (   )  =
  Let         ,  1     k,         , 1     l, 1        form IBX      b . Each truth assignment I of the variables
     x1,...,xk p ,...,p  y1,...,yl q ,...,q g ,...,      
gn, r, t denote fresh, pairwise distinct variables and let H M satisfying the linear system determines a solution S
                                                  P        = {  ∈   |  ( )=1}∪{¬     | ( )=0}
   = {         },    = {        },   = { 1      k},   of  , i.e., S y   H   I y          y  I y      .Let
X     x1,...,xk   Y     y1,...,yl P     p ,...,p                     (   )  =   
Q =  {q1,...,ql} and G = {g1,...,gn}. Then we deﬁne   the linear system IBX    b have k rows. Then there are
                                                      2|HM|−k                   P                     2
two PAPs P1 and P2 as follows.                                  different solutions of .
      =     ∪    ∪  ∪    ∪  ∪  ∪   ∪{  }
   V      X   X    Y   Y   P   Q   G    r                             ⊆
                                                    Theorem 9  The #- -abduction problem of afﬁne clauses is
  H   =   X ∪ X  ∪ Y ∪ Y  ∪{r}                        #P-complete.
                         =              =  
          with priorities H1 H  Y  and H2   Y                    #P
      =     ∪   ∪                                     Proof: The    -membership is clear from the fact that it
  M       P   Q   G                                   can be checked in polynomial time whether a set S ⊆ H
                             
  T1  =   {¬xi ∨¬xi,xi  → pi,xi → pi | 1 ≤ i ≤ k}     is a subset-minimal solution of an afﬁne system according
                               
          ∪{¬yi  ∨¬yi,yi →  qi,yi → qi | 1 ≤ i ≤ l}   to Proposition 1 in [2]. The problem of minimal afﬁne ex-
                                                      tension, namely that given an afﬁne system AX = b and a
          ∪{zij →  gi | 1 ≤ i ≤ n and 1 ≤ j ≤ 3}
                                                      partial assignment to the variables , count the number
                                                                    s               X
where zij is either of the form xk, xk, yl,oryl depending on of extensions s which are minimal solutions of AX = b,is
whether the literal lij in Ci is of the form ¬xk, xk, ¬yl,oryl, proved to be #P-complete in [2] even if the partial assign-
respectively. In other words, zij encodes the dual of lij . ment contains no 0. There is a parsimonious reduction to an
                                                                P = 
                         =    =
 T2 = T1 ∪{r →  gi | 1 ≤ i ≤ n}∪{r → yj | 1 ≤ j ≤ l}  afﬁne PAP      V,H,M,T    as follows. Let V H   X,
                                                         =  {   ∈    | (  )=1}          = {     =  }
            P  = 
              P  = 
              M      xi   X   s xi      ,andT      AX     b .Let
Finally, we set 1 V,H,M,T1    and 2    V,H,M,T2   .   Y  ⊆ X  be the variables not assigned by s and let s¯ be an
  Obviously, this reduction is feasible in polynomial time. extension of s satisfying the afﬁne system. Then the set of
Now let A(ψ) denote the set of all satisfying assignments of     = {   ∈    | ¯( )=1}
 #Π   SAT                   ( )                ⊆      variables S   xi   Y   s xi       is a subset-minimal
a    1    -formula ψ and let B P denote the set of P - solution of P if and only if the extension s¯ is minimal. 2
minimal solutions of a PAP P . We claim that P1 and P2 have
the following property.
                                                      Theorem 10  The #-⊆P -abduction problem of afﬁne clauses
  B(P1) ⊆ B(P2)   and   |A(ψ)| = |B(P2)|−|B(P1)|      is #P-complete.

                                                IJCAI-07
                                                   421