                 dynamic approach mpe weighted maxsat                               tian sangpaulbeame henry kautz                             department science engineering                               university washington seattle wa                                      sangbeamecswashingtonedu                                      department science                               university rochester rochester ny                                           kautzcsrochesteredu                        abstract                            success modern complete sat solvers inspired                                                        number researchers develop improved complete max      problem probable explanation mpe    sat algorithms recent developments include using unit      arises scenario probabilistic inference propagation strong bound computation li et al       ﬁnding assignment variables  adapting local consistency methods developed      maximum  likelihood given evidence       csp maxsat   givry et al  using fast      consider general cnfbased mpe prob     pseudoboolean solvers check optimality maxsat      lem each literal cnfformula asso bounds aloul et al       ciated weight reductions      tween mpe weighted maxsat show            probabilistic reasoning problem probable      solved variant weighted  explanation mpe ﬁnd assignment variables      model counting mpesat algorithm quite    maximum likelihood given evidence exact      competitive stateoftheart maxsat    methods mpe probability distributions represented      wcsp mpe solvers variety problems   bayesian networks include wellknown methods                                                        join tree algorithm jensen et al  recent                                                        branchandbound algorithm andor tree search mari    introduction                                       nescu dechter  solving mpe exactly np  constraint satisfaction problems csp subject hard local search algorithms introduced ap  intensive study realworld domains formal proximation park  paper consider mpe  ized csp models solved complete incom cnf formulas weighted literals goal  plete reasoning methods classic csp solu ﬁnd solution maximum product sum literal  tion satisfy hard constraints csp models weights cnfbased mpe problem strictly gen  capable handling hard soft constraints def eral mpe discrete bayesian networks  inition constraints measurement quality discrete bayesian network converted cnf  solution vary model model goal usually weighted literals size linear size conditional  ﬁnd best solution constraints simply probability tables cpts network sang et al  solution example constraints associated mpe cnf viewed special case weighted  probability cost utility weight goal model counting wmc sang et al likely  minimize costs violated constraints maximize easier wmc apply branchandbound  likelihood variable assignment ﬁt based pruning techniques reduce search space  general framework soft constraints semiring choose cachet sang et al  stateoftheart model  based csps bistarelli et al  paper focus counting platform build  speciﬁc models mpe weighted maxsat      mpe solver extend pruning techniques sub    maxsat extends sat problem ﬁnding problems components result present mpe  signment maximizes number satisﬁed clauses sat decompositionbased branchandbound algorithm  case formula unsatisﬁable weighted maxsat ex works wmc prunes search space ef  tends maxsat adding weight each clause fectively furthermore able use dtree algorithm  goal ﬁnding assignment maximizes sum huang darwiche  darwiche  boost  weights satisﬁed clauses maxsat weighted  performance problems good decomposability  maxsat problems solved incomplete local  general mpe weighted maxsat illustrate  search methods complete branchandbound based exhaus complementary ways representing soft constraints  tive search maxsat problems local search  having weight variables having weight constraints  methods exhibit better speed scaling complete meth clauses apparently different represen  ods local search methods unfortunately provide tations weight goals converted each  proof returned solution optimal          adding auxiliary variables clauses possibly                                                    ijcai                                                     loss efﬁciency addition describing clause surprisingly representations equiv  ductions show formulate cnfbased mpe alent directly converted each  iterative pseudoboolean satisﬁability pbsat process                                                        mpe weighted maxsat    experiments compare mpe solver mpesat  stateoftheart complete mpemaxsat solvers simple conversion mpe cnf weighted  pseudoboolean solver variety mpe maxsat different encoding park  maxsat problems approach quite competitive  translates mpe bayesian networks weighted  problems signiﬁcantly faster each maxsat assuming combination operator   solvers classes benchmarks • each literal mpe unit clause added                                                            weight equal weight literal    mpe weighted maxsat                             • original clauses mpe assigned “inﬁnite”                                                            weight number chosen large  mpe problem originated research bayesian net   sum weights added previous step  works popular graphical models bayesian  network dag each source node prior proba original clauses inﬁnite weight op  bility distribution values each nonsource node timal solution weighted maxsat satisfy  conditional probability table cpt specifying proba maximize sum weights satisﬁed unit clauses  bility distribution values given values parents obviously maximizes sum literal weights mpe  probable explanation mpe problem ﬁnding optimal solution mpe vice  complete assignment values nodes max versa converted formula mixture hard soft  imum likelihood given node values evidence constraints challenge exact weighted max  likelihood complete assignment product cor sat solvers efﬁcient advantage  responding entries conditional probability tables hard constraints  prior probabilities solve mpe exactly ei weighted maxsat mpe  ther compile bayesian network junction tree  propagate evidence jensen et al orper givry et al  described pseudoboolean encoding  form branchandbound search andor tree search maxsat does explicitly refer mpe  marinescu dechter  alternatively modiﬁed mpe adding proper weights  vert mpe weighted maxsat solve local conversion follows  search algorithm park                           • variable weighted  maxsat let    begin deﬁnitions                          weightxweight¬x  deﬁnition  cnf formula weighted literals cnf • clause ci weighted maxsat auxiliary  formula plus function weight maps literals real literal ¬yi added ci weight¬yiand  valued nonnegative weights                              weightyiweightci  deﬁnition  given combination operator ⊕ deﬁned                                                          original formula maxsat unsat  reals problem mpe cnf formulas weighted                                                        isﬁable converted formula guaranteed satisﬁable  literals ﬁnd complete satisfying assignment                                                        obtain trivial solution setting  maximum ⊕iweightviwherevi positive                                                        auxiliary variables false combination operator  negative form ith variable convenient                                                        ﬁxed sum solving mpe converted formula ﬁnds  deﬁne inverse operator  mpe unsatisﬁable                                                        solution maximum sum weight variables  cnf formula deﬁned                                                         equivalent maximizing sum weights satisﬁed    cnfbased mpe represent bayesiannetwork  clauses weighted maxsat encoding does add  based mpe linear reductions bayesian clause needs auxiliary variables num                                            networks cnf formulas weighted literals sang et al ber clauses inﬂated number variables makes solv                                                  ⊕  chavira darwiche   practically setting ing mpe difﬁcult especially auxiliary variables  arithmetic  ×  −  sufﬁces                       ×                                make clause trivially satisﬁable unit propaga  purposes  example used likelihoodoriginated tion conﬂictdriven learning unavailable  mpe  used weighted maxsatoriginated mpe  rest paper use short term mpe mpe pseudoboolean sat  “mpe cnf formulas weighted literals” encoding givry et al  converts max  confusion                                      sat pseudoboolean sat weighted maxsat    problem weighted maxsat cnf formula mpe equivalent observe close relation  ﬁnd assignment maximum sum weights ship mpe pseudoboolean sat  clauses satisﬁed assignment weight deﬁnition  given cnf formula φ set linear   weighted maxsat reduces maxsat            constraints variables φ pseudoboolean sat pb    mpe weighted maxsat optimize metric  sat ﬁnd total assignment satisﬁes φ  weight difference mpe weight linear constraints  linear constraint form                                                        n                 each literal weighted maxsat weight each  aivi ≥ vi variable takes value                                                     ijcai                                                      ai realvalued constants number algorithm  mpesat  variables                                            mpesatφ lb  returns mpe cnf formula φ    show convert likelihoodbased mpe  φ return optimal value unassigned vars  iterative pbsat process context likelihood φ clause nogood learning return   combination operator ⊕ × variable vi dynamic component detection solve each separately  weightvipi  weight¬vi−    pi loss  cache lookup reuse previously computed values  generality assume  pi   pi  dynamic boundingifeφ ≤ lb return   pruning  solve simpliﬁed formula vi instantiated   select unassigned literal ∈ φ branching heuristics  mpe goal ﬁnd complete satisfying assignment lresult  mpesatφvlb weight¬v  maximizes                                              update lb according lresult                                                                                                              pi  xi                  rresult  mpesatφ vlb weightv        pi     − pi                  − pi      result  maxlresult ⊕ weight¬v rresult ⊕ weightv                                − pi    xi  xi                                       caching addtocacheφ result                                                                return result    − pi constant log increasing  function equivalent maximizing                                             pi               pi                  branchandbound decomposition         log     −         log  −   xi                  pi              pi              branchandbound underlying mechanism ex  linear expression used left side haustive search algorithms ﬁnd optimal solution  linear constraint pbsat need ﬁgure branchandbound algorithm maintains global best solution  bound right side deﬁni  far lower bound estimated upper bound  tion mpe know optimal value node better lower bound node     n    maxpi  − pi  iteratively search pruned search continues branches  bound using binary search each step previous research shown decomposition  set solve pbsat single linear constraint   caching techniques critical exhaustive search                                          pi                            efﬁcient darwiche  bacchus et al  sang et                    log     xi ≥                   al  marinescu dechter  dy                         − pi                                                      namic decomposition simple form branchandbound  way arbitrarily close optimal value modiﬁed during search problem decom  bounded number steps                         pose independent subproblems components                                                        efﬁciency like analyze separately    algorithms implementation                  branchandboundalgorithm include way allocating                                                        portions global bounds individual components  section ﬁrst examine simple mpe algorithm  show enhance advanced techniques  mpesat    dpll mpe                                     address issues develop mpesat  na¨ıve algorithm  simple modiﬁcation classic new decompositionbased branchandbound algorithm  dpll search formula satisﬁed dynamic decomposition caching mpesat extends  dpllmpe returns optimal value sum product dpllmpe following function blocks  weights unassigned variables number similarities related andor tree  current value formula unsat dpllmpe returns search algorithm marinescu dechter webrieﬂy   deﬁnition selects variable branch compare methods algorithm  cursively solves each branch returns best value dynamic component detection connected component  better branches    detection performed dynamically nontrivial φ    unlike dpll sat search halts sat search components φ independent sub  leaf dpllmpe performs exhaustive search problems disjoint variables solved separately  possible sat leaves optimal value results combined result φ  slow proper pruning branchand algorithm  does show details obvi  bound algorithms widely used similar optimiza ous steps space limitation andor tree search  tion tasks including maxsat weighted csp        components determined statically using pseudo tree                                                        constructed search                                                          caching cache lookup  value com  algorithm  dpllmpe                                  ponent known component value stored  dpllmpeφ   returns mpe cnf formula φ          hash table caching later reuse cache lookup   φ return optimal value unassigned variables avoids repeated computation component store   φ clause return                    corresponding clauses short signature clauses                             ∈   select unassigned variable φ branch          save space exact value component   return maxdpllmpeφv ⊕ weight¬v                              ⊕                         known pruning subtree proper bound             dpllmpeφ    weightv              cached reuse purpose bound caching                                                    ijcai                                                     save partial work component component processing components processed  pruned cached bound used estimated depthﬁrst order search stays component  upper bound component pruning updated til ﬁnished component processing strategy  tighter bound exact value com suited dynamic bounding sibling components  ponent andor tree search caches context different model counting cachet  instead component                     component sat during search work    dynamic bounding parameter lb initially ∞ given rest component temporarily suspended  local search lower bound φ φ created unexploited component available processed  eφ upper bound estimation true value φ strategy works ﬁnding unsat components  simply ⊕v∈φmaxweightvweight¬va   soon possible good model counting  cached bound result special computation described mpesat want continue working sat component  section  eφ lb current branch fully known value ﬁnished  pruned yield better result note component yields better lower bounds siblings  subproblem lb right branch better lb checked pruning  left branch solving left branch improve optimal solution retrieval order optimal  previous lb subproblem component solution optimal value need maintain  solved local information needed pruning partial solutions associated active components  bound parent bounds sibling compo current search path compose  nents updated dynamically parent’s lb imme optimal solution backtracking optimal partial solution  diately broken passed subproblems pruning component cached exact value  topdown example subproblem splits branching heuristics dynamic branching heuristics    lbs  lbs  esandlbs    lbs  es   sat model counting vsids vsads    solved lbs dynam eupc moskewicz et al  sang et al work  ically updated exact value replacing es mpe heuristics aim maximizing effect  andor tree search uses dynamic bounding col unit propagation avoiding infeasible search space  lects bounds subproblems bottomup          learning conﬂicts maxsat problems    branching heuristics dynamic heuristic good dtreebased semidynamic branch  dpll search work turns decomposition ing heuristic huang darwiche  darwiche   based heuristics useful discussed section  better problems unit propaga   andor tree search uses staticallyconstructed tions conﬂicts guide dynamic heuristics longer  pseudotree heuristic aims decomposition available structural decomposition based heuristics    nogood learning wellknown conﬂictdriven clause affected dtree program huang dar  learning technique satisﬁability testing zhang et al wiche  computes static variable group ordering based   directly used cnfbased mpe learned dtree decomposition darwiche whichisfed  clauses implicitly prune infeasible search space mpesat semidynamic branching heuristic makes    comparison  topdown scheme passes best choices dynamic heuristic variables group  known lower bound subproblem available prefers variables group higher priority  mpesat examine fewer nodes andor tree      group priorities determined statically dtree time  does pruning occurs mpesat beneﬁts nogood running dtree usually insigniﬁcant compared time  learning dynamically changes variable ordering solving problem nice property dtree  vsids vsads heuristic nogood learning likely each group variables instantiated high low pri  useful static pseudotree variable ordering ority problem guaranteed decompose  dynamic component detection mpesat powerful problem large treewidth sizes high priority  static detection andor tree search groups dtree large search space blows  miss decomposition dynamic effects problem decomposes  overhead higher finally upper bound computation able extend  expensive component caching mpesat heuristic li et al  weighted maxsat  powerful context caching andor tree search solver computing upper bound weight satis  cause different contexts lead component ﬁed clauses formula φ equivalent computing lower                                                        bound weight violated clauses φ weight    implementation                               violated clauses φ estimated follows  problem model counting counting number solu costlb   tions cnf formula shares features mpe each unit clause φ  requiring exhaustive search dpllmpe replace simplify φ setting current unit clause true  max operation sum optimal value sat leaf clause conﬂict  na¨ıve model counting algorithm using increment costlb minimum weight  weighted model counting cachet sang et al    clause clauses deriving  platform implemented mpesat algorithm    remove clauses deriving clause φ  following better support                 costlb  lower bound violated clauses end                                                    ijcai                                                       adopt trick previous maxsat solvers    problems vars clauses toolbar pb mpesat                                                                  ra               value known solution current estimated    rb                                                                                rc                 value differ unit clauses safely propagated bitcomp                                                                            bitmax                                                                              rand                    experimental results                                                            figure  mpe circuit cnf runtime seconds  tested cnfbased mpe   maxsat  cnfbased mpe problems  random            problems node induced width aotree mpesat  cnf structured cnf formulas random literal                                                                                                                 weights equivalent weighted maxsat trans                                lated bayesian networks special                                                                                                                  adhoc bayesiannetworktocnf encoding max  sat problems structured ones used previous liter figure  mpe grid bayesian networks runtime seconds  ature fault diagnosis problems generated stan  dard circuit benchmarks challenging  solvers details problems ﬁrst domain mpe satisﬁable random cnf  wwwcswashingtoneduhomessangbenchmarkshtm       mulas random weights   each pos    used following stateoftheart solvers     itive literal  weight each negative literal prob    toolbar givry et al    exact weighted lems converted weighted maxsat encoding  csp solver integrates efﬁcient algorithms maintaining section  introducing positive unit clauses                                                                                      ⊕  various levels local consistency generic solver use  combination operator mpe direct  weighted csp weighted maxsat used version  translation pbsat adding linear constraint    li et al   exact branchandbound max weighted sum positive literals given bound  sat solver using unit propagation distinguishing inde principle run pb iteratively optimize  pendent conﬂicts powerful lower bound computation bound just set bound opt proving sat                                                        opt proving unsat pb efﬁ    maxsatz li et al   exact branchandbound                                                        cient domain value opt  maxsat solver extending  sophisticated lower                                                        solvers mpesat used weightbased  bound computation techniques highly optimized max                                                        dynamic heuristic variable selections good unit  sat winner  maxsat evaluation                                                        propagated weights preferred solution                           pb  aloul et al   pseudo boolean sat solver good bound early bad unitpropagated weights  takes linear constraints prove optimality preferred afterwords prunings early  encoded maxsat problems basically auxiliary vari figure  each point represents median runtime  able added each clause linear constraint  instances pb curve data point ratio   limiting sum added variables given bound actually timeout median   seconds compared    aotree marinescu dechter  andor tree pb inefﬁcient low ratios frequently  implementation works mpe bayesian networks timed problem gets  weighted csp                                     constrained ratio increasing  pb improves    mpesat solver implements mpesat al signiﬁcantly mpesat similar trend  gorithm cnfbased mpe weighted maxsat times slower toolbar low ratios gains dramatic    experiments linux machine  speedup high ratios apparently high ratios mpesat  ghz pentium  cpu  gb memory ran pb beneﬁt lot clause learning underlying  aotree windows machine  ghz pentium  cpu sat engine prunes infeasible search space   gb memory runtime cutoff  seconds curve toolbar ﬂat ratio  low ratio  solvers apply domains each underconstrained problems toolbar prunes search space  main show results solvers apply effectively using advanced bounding techniques                                                        nogood learning effective pruning                random mpe  variables              using constraints does poorly wellconstrained                                                 mpesat                                      toolbar           high ratio problems effect ampliﬁed  vari                                       pb                                                     ables ratio  toolbar solve instance                                                        hour mpesat solve seconds                                                        figure  shows results mpe structured circuit                                                         cnf formulas random variable weights clearly          time  sec                                   problems easy mpesat hard nonsolvable                                                     toolbar ran pb na¨ıve binary search                                                        optimal value pb works ﬁne problems                                                               clausevar ratio                appears cnfbased mpe suits mpesat pb better                                                        toolbar optimized weighted csp      figure  mpe random cnf median runtime      figure  compared andor tree search                                                    ijcai                                                     
