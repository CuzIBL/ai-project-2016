                performance analysis online anticipatory algorithms                       large multistage stochastic integer programs                                   luc mercier pascal van hentenryck                                             brown university                                       mercierpvhcsbrownedu                          abstract                          pertinent group group members                                                        allocated hotel customers immediately      despite signiﬁcant algorithmic advances recent notiﬁed acceptance rejection requests ac      years ﬁnding optimal policies largescale mul cepted requests satisﬁed accepted requests      tistage stochastic combinatorial optimization prob assigned speciﬁc resource reservation time      lems remains far reach existing meth choice reconsidered goal maximize      ods paper studies complementary approach proﬁt served requests come different      online anticipatory algorithms make decisions types different characteristics arrival frequencies      each step solving anticipatory relaxation online multiple vehicle routing time windows bent      polynomial number scenarios online  van hentenryck  captures important class ap      ticipatory algorithms exhibited surprisingly plications arising transportation distribution systems      good results variety applications problems ﬂeet vehicles serve clients      paper aims understanding success par located different locations place request ser      ticular paper derives sufﬁcient conditions vice realtime speciﬁc time windows clients      online anticipatory algorithms achieve good immediately notiﬁed acceptance rejection      expected utility studies various types er quests accepted requests satisﬁed routing      rors arising algorithms including antic decisions delayed necessary goal      ipativity sampling errors sampling error maximize number satisﬁed requests      shown negligible logarithmic num                                                          problems share characteristics      ber scenarios anticipativity error harder                                                        modeled multistage integer stochastic programs      bound shown low theoretically                                                        second number stages large packet schedul      experimentally existing applications                                                        ing time discrete nature experiments                                                         stages applications time    introduction                                       continuous reasonable discretization time  online stochastic algorithms solving large multistage require  stages set feasible decisions  stochastic integer programs attracted increasing each stage ﬁnite finally applications require fast  recent years motivated applications decisionmaking characteristics prohibit use  different types requests arrive dynamically priori methods partially observable markov decision  role algorithm decide requests serve processes stochastic programs chang et al  unlike traditional online algorithms applications  benoist et al  shown pomdps  assume uncertainty stochastic distributions scale applications successful algo  requests given                            rithms stage stochastic optimization sample    consider packet scheduling problem chang et average approximation method shown require num  al  router receives set packets each time step ber samples exponential number stages shapiro  choose packet serve packets served  precluding use applications  limited time characterized value interestingly highquality solutions applications  goal maximize values served packets obtained online algorithms relax non  packet distributions speciﬁed markov models anticipativity constraints stochastic programs  states specify arrival frequencies packet type online anticipatory algorithms make decisions online    online reservation systems benoist et al  time three steps  application customers place requests real time  sample distribution obtain scenarios future  service ﬁxed date resources modeled  multiknapsack constraint think tour operators request  optimize each scenario each possible decision  ing rooms hotels group choice speciﬁc hotel  select best decision scenarios                                                    ijcai                                                    clear strategy necessarily suboptimal                                                         function makedecisionst   γt  scenarios experimental results                                                                                              use γt compute scenarios ξ ξ ξt  ξt  surprisingly good especially regret algorithm     ∈x  bent van hentenryck  hentenryck et al  foreach   st                                                                  ←             efﬁcient way implementing step  goal  gx       stxξ                                                              ←  paper demystify results providing xt argmaxx∈x st gx  oretical analysis algorithms section  describes  model algorithm section  analyses performance  online anticipatory algorithm isolates funda  analysis anticipatory algorithm  mental sources error sampling error quantity called compare performance anticipatory algorithm  global anticipatory gap inherent problem ofﬂine posteriori solution expected sense  section  shows bound anticipatory gap theoreti typically online algorithms borodin elyaniv  cally experimentally section  analyzes effect ap  words decision process produced  proximating optimization problem section  compares anticipatory algorithm bound evc − xξ  anticipatory gap expected value perfect informa expected global loss egl  tion section  presents directions future research                                                          local global losses    model algorithm                                ﬁrst show egl sum expected losses  consider ﬁnite stochastic integer programs form stages                                                                                                    deﬁnition  let st state expected local loss     maxe         max     max   fx ξ        decision ∈xst deﬁned         x∈x  x∈x   xt ∈x st                                                                 Δstxe   ostξ −ostxξ st    ξ stochastic process ξt observation                                                        note conditioning state st does provide  time ξ deterministic st xt−ξt                                                      information γt reading expression  state time maps states nonempty subsets     ﬁnite set decisions max’s welldeﬁned form  st mind uncertainty                                                        ξtξt γtγt   utility function bounded fmax denote  respectively ξ vectors xt ξt     lemma  global loss  sum local losses    decision process stochastic process ∀t  decision process  xt ∈xst assume computation each xt                          t  requires exactly random variable γt variables   evc  − xξ   Δst  xt   independent independent ξ                                                    practice decisions based future ob                                                        proof let ct random variable ostxtξ   servations decision process nonanticipative xt                                                        ct − fx ξthenat tt  deterministic function γt ξt                                                                         −         −  adapted ﬁltration ft  σγtξt rewrite     ct  ct    ct     fx ξ  stochastic program                                          ct − ctat     maxe    fx ξ  nonanticip dec proc             Δstxt   scenario realization process ξtheofﬂine prob equality comes decomposing reassembling                                                                                                   evc   −  lem problem decision maker face given possible values xt finally                                                               −                           state st future observations revealed deﬁne   ξ       ξ                                                    stxtξmax    fyξ  dec procyt  xt   decomposition local loss                                                      stξmax    fyξ dec procyt−  xt− show local loss state st consists            maxostxξ                              sampling error anticipatory gap              x∈x st                                                        deﬁnition  anticipatory gap state st deﬁned  note problems deterministic                                                                      Δgst   min  Δstx    finally expected value clairvoyant evc isde                 x∈x st  ﬁned expected utility clairvoyant decision maker choice error wrt deﬁned  evc  os ξ problems discussed                                                                                                       −  introduction ﬁt model particular utility  ΔcstxΔstx    Δgst  bounded thanks capacity constraints model anticipatory gap inherent problem indepen  generalized case fx ξ ﬁnite ﬁrst dent decision process  equivalent deﬁnition                                                                                                     second moments                                                                                                                                                                               anticipatory algorithm studied algorithm   max   ostxξst − max  ostxξst   makedecision parametrized number scenarios   x∈x st                   x∈x st  successive decisions form nonanticipative pro expression shows gap interpreted  cess                                                 cost commuting max bound Δcstx                                                    ijcai                                                                                                            important consequence theorem sam  lemma  sampling error let xt computed                                                        pling error smaller constant  ticipatory algorithm using samples decision let st                                                                    choosing ≥  log   shapiro  ar  state argmax ostxξ st  break ties arbi                       max  trarily                                        gues saa method does scale multistage prob                                                                                                       lems number samples achieve given accu                                     −mΔ    Δ   ≤   Δ xexp                racy grows exponentially  anticipatory algorithm                                           requires grow logarithmically xwhich                   ∈x                σstx                     st                               makes highly scalable course produces high  σstx standard deviation ostxξ − quality decisions anticipatory gap small          ostx ξ given st  proof probabilities expectations implicitly  bounding global anticipatory gap  conditional st lefthand side decomposed section provides theoretical experimental results                                                       anticipatory gap explaining anticipatory algorithms                                            Δcstxt     Δcstx xt           effective applications mentioned introduction                       x∈x st                                                          theoretical proof packet scheduling  argmax makedecisiontheeventxt                                                                                                   gag  implies ∀x ∈xstgx  ≤ gx xt  ≤ ﬁrst show compute upper bound                gx ≥ gx sincef    bounded ostxξ −    simpliﬁed version packet scheduling problem suppose                                                                                                   ostx ξ ﬁnite expectation variance types packets values                                                          respectively each step  −  packet                     m                                                                                        type arrives probability  random variables     gx − gx       os  xξi −os xξi                                                                                     independent each packet lifetime  meaning                                                                          packet received time scheduled time  central limit theorem difference normally time  utility sum scheduled packets                                       −  distributed large mean Δcstx stages packets single time step serve                             ∼n         variance σstx  finally    μ σ  μ convenience introduce packet type  value                                                    μ                              probability  clear problem  ≥  ≤ exp −    chernoff bound                             σ                              satisﬁes assumptions particular utility                                                                  ≤   ≤    performance algorithm                     bounded     tvk                                                          gag  small problem show  assemble previous results                                                        Δg rarely high inducing small gagforst state  deﬁnition  global anticipatory gap problem ∈xs  say dominates os xξ ≥                      ⎡                 ⎤                                                                                                              os yξ surely given  studying Δ                               t                                                                                 ⎣                 ⎦               quires focus nondominated decisions            gag      max       Δg st                           xt                          nondominated decisions given state consists                                                      xi∈x si                     scheduling  quantity inherent problem   • valuable packet type received time t−  theorem  expected global loss anticipatory al scheduled  gorithm satisﬁes                                        •                                                          valuable packet type received time                                  −               egl  ≤ gag     km                   ≥ choosing dominated                                                        valuable lost chosen  number samples decision                                                        ijbut second valuable packet received                                                                  Δcstx                   type ≥ choosing dominated                min                                conditions holds decision dominates ones                    stx∈x st σstx                    Δcstx                          Δgst  proof                                          suppose st does satisfy                                                        dominance property scenarios partitioned                                                            t               t                             scheduling resp unique ofﬂine optimal  egl       Δ    ≤     Δ      Δ                              cision tie introduce random                                                variable  taking values ⊥ three respective          gag                                                    term     comes                           cases  t                t                   t                                                         Δs  os ξ −os iξ      Δgst     Δgst  ≤  max     Δgst                                                                   xt                                                     ostξ −ostiξ styt   yt   global sampling error satisﬁes                symmetrically                                                                  Δstje  ostξ −ostjξ st                                        −km             Δcstxt ≤ fmaxe                                                                   ostξ −ostjξ styt  yt                                                               ijcai                                                    scheduled optimal ofﬂine solution ostxtξostξ st  consensus ratethis  schedule loss exceed vj − vi quantity estimated easily during computation  rest optimal ofﬂine schedule feasible anticipatory algorithm sufﬁces count sce  ostξ −ostiξ styt   ≤ vj − vi narios make decision  optimal ofﬂine schedule choose time titis                                                                                                     ∈          o                  necessary packet value greater vi arriving   stxξ    stxtξ                       ≤   −                    −           yt       ki qk qk   pk  finally ﬁnd                                       hentenryck et al  kindly gave statis                                                      tics online reservation systems depict consensus                                                                                           rate minmaxavg function number scenarios            Δsti ≤ vj − vi  −   qk                                                                                            max                                   ki                                                                                                                      average  case harder study trivial upper bound                                                                                ≤                                                                                min    Δs    remains bound expectation              agreement                                                                    Δgst  minΔsti Δstj enumerating possi  ble values weighting each case proba                                                                                       scenarios  decision  bility occurrence weight fact bounded                     product probabilities  following events                                                        class instances  possible decisions    • packet type arrived time −          each state expect average consen    • valuable packet arrived type sus rate  actually higher                                                         maximal ofﬂine loss bad decision eas    • packet type ≤ kjarrived time                                                        ily bounded problem markov inequality  numerical example suppose  types gag low similar observations packet  packets following values emission probabilities scheduling problem measured average consensus              type                                  vehicle routing problem             value                                 rate varies stages exhibiting increasing trend             prob                           argument useless                                                        fmax high problems high penalty states  upper bound Δg depending jis           generally following theorem gives way mea                                                       sure anticipatory gap state                                                                                                                                      theorem   let st state deﬁne Δgst                                                                                                                                             m                           m                                                                                                                                                            max  ostxξ  −  max     ostxξ                                                                  x∈x st           x∈x st                                                                                       ﬁnd Δgst ≤  hand simple  lower bound evc expectation value strongly consistent estimator Δgst                                                                                              valuable packet arriving each stage multiplied                              number stages case leads evc ≥                                                                                                lim  ΔgstΔgst      st   result ratio gag evc problem       m→∞   analysis tight – espe proof apply strong law large numbers os xξ  cially lower bound evc – anticipatory algo                                                                                               conclude ﬁniteness st   rithm likely better expected global loss   analysis hints online anticipatory algorithms Δg computed online anticipatory algorithm  effective packet scheduling outper additional cost  form competitive algorithms instances                                                           approximating ofﬂine problem    discussion practical problems                 theorem  explains anticipatory algorithm provides  previous section shows bound gag par good results gag small practical im  ticular problem study dominance properties plementations use variant algorithm   cisions bound loss making nonoptimal ofﬂine placed fast approximation o case  sense decision bound probability event three applications mentioned earlier use approxi  currently applying method complex prob mating technique called regret bent van hentenryck  lems proofs quickly cumbersome  hentenryck et al theregret algorithm  alternative discuss empirical way argue seen discrete version sensitivity analysis instead  gag problem small                                                        computing ostxξ each each ∈xsttheidea    emphasized theoretical discussion             ∗                                                                         compute argmaxx   stxξ   ﬁrst   importance bounding probability cho                                                                                                  compute vector approximations ostxξ   sen decision  posteriori optimal                                                x∈x st                                                    ijcai                                                    using x∗ each entry vector derived approx  imating loss selecting speciﬁc st instead  optimal decision x∗ result regret algo                                              rithm ensures o≤oand   iimaxxostxξ                    maxxostxξ seebent et al  discussion  complexity computing approximated vector    easy provide tight theoretical bounds  expected global loss regret approximation    figure  low evpi high global anticipatory gap  measured empirical distribution o−o  line stochastic reservation systems hentenryck et al                                                                proof    let    decision process maximizing   difference o−o zero  cases                                                                                             fx ξst ξ ostξ ≥ fx ξ  mean small  typical values                                                                                          nondecreasing ostξst ≥ fx ξst   range  occasionally            ξ                                                        φst inversely let decision process maximizing  large intuitively justiﬁes quality regret      ξ                                                        fx ξ        −deﬁnex    aggrega  expected global loss signiﬁcatively different      t−                                                                                        ξ  anticipatory algorithm sample size      tion does thing scenario ξthen                                                             ≥                                      finally recall online reservation systems φst fx ξ st  stξ st                                                                                               evpi  consensus rate high average let x        twostage stochastic programming low makes                                                    problem easier optimal decision  argmax      ostxξ  let consensus rate                                                    good each speciﬁc scenario birge louveaux  α properties ii regret approximated                                                       ch  longer true multistage  “score”     os xξi decision x exhibit                                                  case consider threestage problem depicted figure   errors  − αm scenarios close    αm                                               black dots represent decisions variables stochas      ostx ξ  decisions ap                                                      tic variables ξ ξ inﬂuence repre  proximated score terms sum                                                        sented white dot represents ξ values   negative error approximated decision bi                                                         equal probability leaves tagged utilities  ased consensual decisions high consensus rate                                                         large positive number value evpi                                  o−o                       tends hide approximation errors regret     anticipatory gap Δ each state following    summary high consensus rate makes ag                 small allows regret produce decisions close         state root state                                                                                         quality exact anticipatory algorithm does         Δg              ε   mean brutal regret approximation assigning zero       ηεε               each nonoptimal decision effective bent problem evpi ε optimal solution  van hentenryck                                 score ε scenario expected value     gag           evpi                                 optimal policy zero online anticipatory algo          versus                                       rithm chooses expected utility  section studies relationships anticipatory ε − anticipatory algorithms behave  gap expected value perfect information evpi  poorly low evpi  case  concepts seemingly close useful ex inequality theorem  tight converges ∞  plain differ chose introduce gag equals ε   tion anticipatory gap                               phenomenon comes fact evpi    consider following maps assigning values problem low evpi node                                                             −    −         states ofﬂine value online value state stre ε  ε  ε  larger                                                                                                      spectively denoted φst πst deﬁned   does contradict supermartingale property demp                                                        ster  dempster considers optimal decision pro                                     φstmax     fx ξ st dec proc              cesses case anticipatory algorithms   πstmaxe   fx ξst  nonanticip dec proc  result expected global loss anticipatory algo                                                                                        evpi               ≥                                        rithm bounded root    example  note φst πst state st difference suggest maximum evpis each node                                                                                      egl                 ηstφst  − πst                  tree gives upper bound  true                                                        figure  presents stochastic program ‘sub’                                              evpi  local expected value perfect information   clones problem figure  variables indices  expected value perfect information problem shifted problem optimal solutions scenar  ηs advantage expected sense clair ios expected expected utility ε  voyant nonclairvoyant inﬁnite computa anticipatory algorithm  ∞ expected utility  tional resources lemma relates ofﬂine problem   − theegl equals    theorem                                                          aε                     aε  φ shows operators max commute gag smaller egl  ∞ sampling  clairvoyant decision processes                       error result gag greater maximum                                                                                              lemma   state st φste ostξst      evpi nodes equal ε                                                     ijcai                                                    
