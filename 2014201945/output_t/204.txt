            automatic gait optimization gaussian process regression                      daniel lizotte tao wang michael bowling dale schuurmans                                     department computing science                                            university alberta                      dlizottetrysibowlingdalecsualbertaca                          abstract                          friction softness height variation compare                                                        crete linoleum carpet grass robot platforms      gait optimization basic challenging prob selves vary manufacturing imperfections gen      lem quadrupedal bipedal robots al  eral joint motor wear lastly criterion      techniques automating process ex  termining effective gait likely situation speciﬁc      ist involve local function optimization pro velocity like obvious choice relative      cedures suffer three key drawbacks lo stability robot’s sensor hardware important      cal optimization techniques naturally plagued tailoring robot’s gait environmental robot      local optima make use expensive gait task speciﬁc circumstances ideal constant man      evaluations local step taken ual retuning impractical automatic gait optimization      explicitly model noise gait evaluation  attractive alternative laborious manual process      drawbacks increase need large number      walk learning new idea existing tech      gait evaluations making optimization slow data niques based common approach local func      inefﬁcient manually intensive present    tion optimization existing algorithms share key      bayesian approach based gaussian process     drawbacks including local minima inefﬁcient use gait      regression addresses three drawbacks evaluations drawbacks combine increase num      uses global search strategy based poste   ber gait evaluations required ﬁnd effective parameters      rior model inferred individual noisy work propose different approach based gaus      evaluations demonstrate technique    sian process regression does approach suf      quadruped robot using optimize different fer drawbacks inherent local methods ad      criteria speed smoothness show   ditional advantages providing conﬁdence estimates      cases technique requires dramatically fewer   gait’s performance useful exploration al      gait evaluations stateoftheart local gradient lows natural inclusion prior knowledge demon      approaches                                       strate effectiveness approach sony aibo                                                        quadruped robot show separate criteria                                                        gaussian process regression ﬁnds effective gait    introduction                                       parameters does order magnitude fewer  legged robot platforms offer advantages tradi evaluations local gradient competitor  tional wheeled robots addition ability traverse begin section  examining recent  wide variety terrain walking robots basically approaches gait optimization note common draw  quirement performing useful tasks humancentric backs approaches motivation proposed  world despite advantages walking technique section  present relevant background ma  fundamental challenges legged robots             terial gaussian process regression section     optimizing robot’s gait simple control problem apply gaussian processes problem  open loop gait consists sequence joint values gait optimization section  show results  high degree freedom leg joints sim technique applied different gait optimization scenar  pliﬁed parametric representations leg trajectories ios demonstrating dramatically efﬁcient learning  sult manageable number parameters simple stateoftheart gait optimization techniques  parameters likely complicated interactions making finally discuss future extensions approach  manual tuning gait parameters timeconsuming simple  robots nearly impossible increasing complexity  motivation  humanoid platforms                                   sony aibo commercially available quadruped robot    worse single gait effective circum spurred recent gait optimization use  stances walking surface critical vary terms robot soccer robocup legged league gives                                                    ijcai                                                     immediate application gait velocity uncertain com competitive walks using  evaluations total  petition conditions reward tuned walks aibo running time approximately ﬁve hours distributed  evaluation platform examine number robots total robothours  recent approaches pioneered robot           evaluations noisy approaches deal    common foundation approaches includ possibility inaccurate evaluation cause poor  ing notion “walk engine” param gait parameters incorrectly remain population  eterized gait generation number degrees used targeted reevaluation reduce possibility reevalu  freedom legged robots large optimizing angle ating parameters remained multiple gener  each joint ﬁnely discretized time scale involve ations ones performed disproportionately  searching thousand parameters walk engine  duces number parameters focusing leg trajecto  function optimization  ries physically possible intuitively plausible second family approaches explored  parameters usually deﬁne properties each leg’s tra involves adapting techniques multidimensional function  jectory “distance foot lifted ground” optimization gait optimization problem kim  “the period walk” space parameterized uther  used powell’s method press et al   walks obviously large impact ﬁnal quality performs line search chosen search direction  automatic gait optimization optimization problem based effectiveness previously chosen search direc  self regardless walk engine optimization tions kohl stone  used hill climbing approach  cases requires ﬁnding point parameter space rang gradient known set random pertur  ing ﬁfty parameters results effective bations evaluated empirically evaluations  gait cited work based different walk used approximate gradient parameters  engines variation walk engine sur adjusted ﬁxed step size direction estimated  faces robots reported walk speeds largely gradient kohl stone reported fastest learning                incomparable                                         sult literature requiring three hours distributed    second common feature approaches exper three robots total robothours im  imental setup approaches involve evaluating spe portant note reported experiments tech  ciﬁc parameter settings having aibo walk struc niques involved initializing optimization known set  tured arena using parameters evaluated local sen reasonable parameters differs evolutionary ap  sor readings aibo–either camera images visual proaches begin random initial population  landmarks ir sensor readings walls–are used  compute noisy estimate gait’s average speed  drawbacks  procedure replicated each estimate averaged previous approaches share three key drawbacks  compute accurate evaluation                   stuck local optima kim uther                                                        ported actual experiences local optima kohl stone    evolutionary approaches                          noted importance starting good initial parame  evolutionary approach ﬁrst proposed method ters having considerably poorer performance  gait optimization aibo hornby et al  different starting conditions techniques deal   used fairly standard evolutionary search early local optima random restarts local func  prototype aibo population parameters main tion optimization approaches radiation evolutionary  tained each evolutionary generation new population approaches involve considerable increase  formed through mutation crossover individuals required number gait evaluations furthermore  previous generation replacing parameters popula approaches forget previously evaluated gaits  tion evaluated poorly procedure showed slow gait die population gradient step taken  improvement  generations requiring approximately inefﬁcient use expensive gait evalu  twentyﬁve robothours learning                   ations certain parameter settings unnecessarily    evolutionary approach revisited chernova reevaluated finally approaches explicitly model  veloso chernova veloso  used similar mu noise evaluation process involve  tation crossover operations generate candidate gaits long evaluations repeated evaluations aver  unlike work hornby parametric space walks aged compute noisy estimate summary  included measurement possibility aibo goal reduce total number robothours draw  physically perform gait allowed throw backs severely hurt usefulness approaches  poor gait parameters requiring empirical eval approach addresses disadvantages consequently  uation addition used “radiation” procedure dis quires considerably fewer gait evaluations  perse clusters similar parameters population forcing  search demonstrated technique learned  background    despite lack basis comparison three recent core proposed method gaussian process  techniques discussed achieve similar walk speed gression model describes knowledge func  range – ms                               tion optimizing discussing use gait opti                                                    ijcai                                                     mization brief overview gaussian processes  observation selection  gaussian process regression                          given gaussian process model set observations                                                        shown incorporate observations create    gaussian processes                               function posterior ﬁnd expected optimum  gaussian process gp  williams  rasmussen  remaining challenge decide points xi   rasmussen williams  collection receive observations fact sequential decision    random variables fx fx   ﬁnite subset making task each observation gives additional information  variables joint multivariate gaussian distribution used selecting future points  variables indexed elements set foranyﬁ                                           nite length vector indices xx  xn wehavea optimal selection assume ﬁxed horizon                             corresponding vector      xn  variables limited number remaining observations optimal ac  multivariate gaussian normal distribution tion given model theoretically computed                 ∼nμ                     quires considering possible points domain possi                                               ble realvalued outcomes function evaluation  elements μx given prior mean func taking expectations maximizations possible future  tion μxiandk kernel function kernel takes observation sequences horizon make  indices xi xj  gives covariance cor observation point maximizes                                                        tual posterior maximum assuming future optimal decisions  responding variables fxi fxj  given vectors indices  xi xj returns matrix covariances enumeration exploration discussed previ                                                      ous work wang et al  domains signiﬁcant  pairs variables ﬁrst pair comes xi                                                    size impractical instead focus myopic search  second xj  note each xi marginally  gaussian mean μxi variance kxixi      strategies      gaussian process regression                      probable improvement   consider proposal  suppose function fx like op return domain point largest observed value  timize suppose observe directly want maximize largest observed value approach                                                        search points likely better  observe random variable fx indexed                                                                                       domain expected value current best observation let maximum ob                                                        served value choose xmpi maximize posterior proba  ∀x ∈xefxfx particular assume                                                              mpi  prior belief function conforms gaussian pro bility   probable im  cess prior mean μ kernel described sup provement mpi criterion                                                          computing posterior probability improvement  pose fx observation fx corrupted                                                        point xˆ domain simple computation pos  zeromean iid gaussian noise fx  fx        ∼n    σ                                  terior distribution fxˆ gaussian given equations              hidden variable                  xmpi  posterior distribution infer observing samples  finding point requires search through                                                        domain maximize probability improvement  fx various locations domain resulting inference  called gaussian process regression                equivalent maximizing    let set observations points fx result φˆxσˆxxfx    − μˆxx       ing realvalued observations want compute poste                                                        criterion deciding evaluate sug  rior distribution new point ∈x distribution                                ˆ                       gested mockus  fortunately posterior mean  gaussian mean variance                                                        standard deviation ratio continuous dif     μ xx       μ   −  − μ        ferentiable functions apply function optimization      ˆ        ˆ   ˆ                                            mpi                                     −                techniques model ﬁnd     σ ˆxxkˆx   xˆ − kˆx xkx kx xˆ   note inverse applies kernel matrix observed  gait optimization  domain points computed used eval proposed approach gait optimization basically  uate posterior points domain      application described gaussian process opti    problem ﬁnd optimum unknown mization procedure like previous approaches assume  function ﬁnal step compute optimum parameterized walk engine                        sulting posterior mean argmaxxˆ∈x μˆxxthisin  parameters addition empirically noisy evalu  general computed closed form requires ations gait’s velocity feature gait unlike  application technique function optimization al previous approaches model stochastic velocity func  optimal technique simply return tion  rk → maps walk parameters velocity    xi largest observed value fxi thishasthe gaussian process exact mean kernel function  practical sideeffect technique return point gaussian process chosen based prior domain  evaluated adding protection knowledge use probable improvement selec  incorrect prior                                   tion rule decide parameters empirically evaluate                                                    ijcai                                                     based previous observations number observed velocity  meters second  gait evaluations parameters generated fastest ob  meters second  time” observa  served walk returned                             tion noise domain expert familiar par    place choosing mutation crossover rates initial ticular experimental setup instead computed sample  parameters step sizes approach requires speciﬁ variance small number observations particu  cation mean kernel gaussian process lar setting walk parameters gave value                                                           provides natural way encode domain knowledge σ  work practice  exists just use “generic” priors ﬁrst interesting test stability method  walk engine exactly priors cho respect model parameters ran velocity op                                                                                                 sen aibo experiments                         timization prior variance parameter σf                                                         times larger    walk engine  discussed earlier complete joint trajectory gait  thousands parameters gait optimization prior smoothness smoothness  techniques parameterize walk space using walk engine evaluated domain expert consult  work used carnegie mellon university’s stead took small number samples  used  tekkotsu software control aibo includes sample means variances estimate parameters                                                             μ     −   σ         σ      walk parameterization release  originating prior       show  carnegie mellon cmpack  robot soccer team section simple uninformed method  early version cmwalk engine used work specifying gaussian process model effective  chernova et al  consultation domain  expert identiﬁed  walk parameters reason  implementation details  able bounds each parameter deﬁne domain order compute probable improvement point  ⊂                                                       described section  used generic constrained hill    priors                                           climber matlab fmincon supplied function                                                        gradient φˆx equation  used default  deﬁning prior gaussian process means deﬁning starting points best parameters far               μ   →                   × →  mean function        kernel function            drawn uniformly random bounded domain                                 σ    need specify variance  noise total  starting points addition forced ﬁrst                                   believed added observation priors gait evaluation selection choosing center point  use simple form mean use constant domain gaussian process model starts uni         μ    μ  function     means priori belief form belief domain function points equally  speciﬁc parameters’ velocities covariance good expected probable rule  function hypothesized general parameter vec  tors close terms euclidean distance likely  similar walk velocities large posi  results  tive covariance furthermore expect parame applied gaussian process approach gait  ters widereaching consequences parame optimization tasks sony aibo ers ﬁrst look  ters far apart small positive correlation standard problem maximizing walk velocity  chose use radial basis function kernel examine problem optimizing gait’s smoothness                                                         − xi−xj  sxi−xj           goal gait optimization technique ﬁnd near           kxixj σf ·                                                                             optimal gait evaluations possible  scaling matrix diagonal we’ll want compare techniques using criterion  verse range each dimension distance previous gait learning involved walk  end dimension’s range scaled                                                       engine experimental setup robots comparing directly  equal need simply choose constants σ                                                        previously reported results somewhat problem  μf andσf  setting appropriate values depends atic direct comparison implemented  feature gait optimized section  hill climbing method kohl stone  described  present results optimizing gait’s velocity section  applied identical circumstances  smoothness examine each cases turn approach kohl stone algorithm data efﬁ                                                        cient technique aibo literature demonstrat  prior velocity gait velocity studied relatively ing effective walks robothours training  extensively aibo particular walk replicated experimental setup using  random evalua  engine consulting domain expert easily tions approximate gradient each “iteration” using  solicited useful prior information particular chose step size  empirical epsilon used estimating                   μf   σf   correspond gradient  parameters’ range  tuition “for random gait parameters expect adequate change performance gaussian                                                        process model started hill climber point    httpwwwtekkotsuorg                            center space                                                    ijcai                                                       physical setup                                     results hill climbing approach                                                        poor somewhat surprised performance  evaluate each parameter choice robot walk                                                        better method tended poor steps  tween visual landmarks focusing head                                                        reached value  ms natu  center landmark robot determined distance                                                        ral explanations simply local optima  landmark walked based land                                                        line kohl stone’s noted importance initial  mark’s apparent width camera’s ﬁeld view                                                        parameter vector alternatively based frequency  change used estimate velocity determine gait’s                                                        taking poor gradient steps step size  smoothness measured timeaveraged distance                                                        large certain dimensions random restarts vari  center landmark center robot’s ﬁeld                                                        able step size each dimension mitigate unim  view negated unstable walks result                                                        pressive results  large head movement yield negative smoothness  values difﬁcult robot head  gait smoothness  camera aimed target ﬂuid walks allow  robot aim camera directly target resulting similar graph gait smoothness shown figure  smoothness nearer zero                  gaussian process optimization smoothest walk    each observed measurement result three “traver three methods did ﬁrst  observa  sals” landmark average time tions minutes robot time later improve  three traversals including time turn approx ment incremental postmortem analysis  imately minute chosen consistent gait smoothness task apparently simpler impact  kohl stone’s hill climbing experiments parameters measure smoothness ended  easily used single traversal compensated ing quite simple wide range walks short period  creasing observation variance used model   ms moderate requested walk speed                                                          ms resulted smooth gait mea    gait velocity                                    surement scores walks typically greater                                                         independence pair parameters  graph showing result  observations shown rest unlikely random search ﬁnd  figure chose number observations priori smooth gait choosing parameters range occur  allow hill climber  “steps” iterations  test average  gait evaluations random search  points each gaussian process technique trial did happen ﬁnd point giving moderate  kohl stone hill climbing technique shown win hill climbing technique suspect  simple baseline choosing gaits uniformly random unimpressive hill climbing result initial condi  solid lines represent maximum achieved walk speed tions local maxima  accumulating observations corresponding  isolated markers show maximum velocity achieved  recent  observations                      conclusion    gaussian process hill climbing proposed new approach gait learning based gaus  methods performed appreciably better random evalua sian process optimization approach overcomes  tions best walk velocity  ms drawbacks previous techniques effectively avoiding local  gaussian process overestimated optima efﬁciently using gait evaluations explicitly                  prior variance σf  walk modelling noisy observations caveats  gaussian process “sensibly” initialized variance associated comparing gait velocities training time  nearly fast despite having warned difﬁcul demonstrated approach effec  ties comparing walk speeds note speed com tive high dimensional noisy nonconvex optimization  parable learned gaits impressively problem requires drastically fewer evaluations  fact speed attained  observations accomplished minimum parameter tun  took approximately robothours nearly ing demonstrating effective performance using prior  ﬁvefold improvement required number robothours settings domain expert incorrect settings    interesting best walks gaus data derived settings  sian process models widely separated parts space three main directions feel ex                                         walk sensible setting σf  plored point model quite simple  low period shorter stride parameter vector far comparison gaussian process models recent ma  center space hand experiment chine learning literature interesting innovations     σf  similarly fast walk near center volving kernel optimization hyperparameter models di  space longer slower strides cover similar distance mensionality reduction suited problem                                                        worth investigating compelling build    work kohl stone used multiple aibos models incorporate knowledge previous gait op  parallel reduce total time three hours approach timization runs similar robots surfaces second  easily beneﬁt evaluating multiple sample points simultane interesting explore knowledge imposed  ously                                                budget number samples compute time                                                    ijcai                                                     
