      solving pomdps continuous large discrete observation spaces                            jesse hoey                                 pascal poupart                   department science                 school science                        university toronto                       university waterloo                       toronto ms                         waterloo nl                     jhoeycstorontoedu                      ppoupartcsuwaterlooca                        abstract                          imate scalable algorithms modelbased pomdps                                                        large state spaces   complex policy spaces        methods solve partially observable  modelbased algorithms tackle problems      markov decision processes pomdps      continuous large discrete observation spaces      tinuous large discrete observation spaces real paper study propose new algorithms      istic problems rich observation spaces modelbased pomdps continuous large discrete ob      posing signiﬁcant problems standard pomdp     servation spaces ﬁrst demonstrate complexity      algorithms require explicit enumeration observation spaces signiﬁcantly reduced      observations problem usually approached  affecting decision quality intuitively observations pro      imposing priori discretisation obser vide information decision maker choosing future      vation space suboptimal course action course action chosen      cision making task ob different observations observations indis      servations change policy need tinguishable decision making point view      distinguished decision problem induces aggregated policy composed      lossless partitioning observation space small set conditional plans conditional obser      paper demonstrates ﬁnd partition vations possible partition observation space      computing policy resulting discreti small number regions corresponding relevant fea      sation observation space reveals relevant tures observation space decision making      features application domain algorithms systems tackle feature detection problem separately      demonstrated toy example realis decision making problem ﬁrst building set features      tic assisted living task                         computing policy based observation features                                                        paper demonstrate decision problem    introduction                                       used automatically deﬁne set relevant features  partially observable  markov    decision  processes   sufﬁcient ﬁnd optimal policy  pomdps   provide rich framework planning paper ﬁrst provides background pomdps  uncertainty particular pomdps used robustly sect  followed discussion partitioning  optimize course action complex systems despite observation space sect  sects   discuss methods  complete state information poor noisy sensors onedimensional multidimensional cases respec  instance mobile robotics  spokendialog systems  tively sect  reports experiments assisted living task   visionbased systems  pomdps used  optimize controllers rely partial noisy  partially observable mdps  information provided various sensors sonars formally  pomdp     speciﬁed      tuple  laserrange ﬁnders video cameras microphones hs ztzrγhi  consists set   fortunately date use pomdps realworld states capturing relevant features world set  systems limited lack scalable algo actions corresponding possible control decisions  rithms capable processing rich continuous sensor set observations corresponding sensor readings  observations                                         transition function  prss encoding    modelfree approaches neurodynamic pro stochastic dynamics world observation function  gramming  monte carlo sampling  stochastic za sz  prza indicating sensor readings  gradient descent    tackle pomdps arbi late physical states world reward function rs  trary observation spaces tend require large encoding objectives discount factor γ  simulation priori knowledge restrict space   planning horizon assumed  policies reduces need simulation signif inﬁnite paper assume states actions  icant progress developing approx discrete observations continuous discrete                                                       stages conditional plan  common observations continuous               cp                                                                                            value function                                                                   listen  sensors provide continuous readings states      observe observe  abstract unobservable quantities case      left  right                                                                  cp      cp                                                                     user modeling problems event recognition problems  k−                         α                                                                  listen listen        cp                                                             observe                    sates discrete continuous observations                    observe value                                                               left          right                                                                                           α   α                                                                                        α     cp  cp  α                                                                                        cp     za zpdfz  probability density function                                          cp                                                                cp            cp  states directly observable decision maker’s k− open right open left                                                                                     left               right  belief current state represented probability                           belief  tiger location   distribution bs  prs called belief state executing                           observing beliefp state revised according figure  tree representation threestep conditional                                           bayes’ theorem bz  ∝ bst za plan simple tiger problem starting uniform    illustrate concepts present use clas lief tiger location corresponding value function  sic tiger problem  decision maker faced composed  αvectors  doors small reward lies door  large cost tiger lies decision maker fig shows value function policy tiger  open door listen tiger listening gives problem composed  conditional plans each  decision maker information infer highest belief space goal                                                        ﬁnd optimal policy π∗ highest value  location tiger original discrete version π∗ π                               ∗  problem possible observations result listening left ≥ ∀π optimal value function                                                        inﬁnite planning horizon computed value  right observations correspond true lo                                      cation tiger probability  continuous eration computes successive approximations  version discuss decision maker access dynamic programming                                                                                     original microphone array measurement noisily                                                                                               max bγ     przb av bz   locates tiger continuous horizontal dimension                                                                                             far left far right                                                                                                               each time step decision maker picks action wherep     bsrs przb                                                                                          execute based information gathered past actions ss bsprs aprza  bz revised  observations represent decision maker’s possi belief state executing observing  ble strategies set cp conditional plans cp cor                                                                                          formed set αcp new set αcp  respond decision trees fig shows decision tree constructed pointbased dynamic programming backups  kstep conditional plan tiger pomdp dis pointbased backup computes best conditional plan  crete observations nodes labeled actions edges cp∗  ha∗os∗i corresponding αvector set  labeled observations execution conditional conditional plans cp given belief state  plan starts root performing actions nodes tra              versed following edges labeled observations          a∗                 ∗         a∗                                                         αha∗os∗ibr   bγ    przb αos∗zbz    received environment example conditional                     plan fig lead opening door successive  observations conﬁrm tiger location deﬁne             ∗                    a∗                                                        st          os zargmaxcp   αcpb             recursively kstep conditional plan cpk  ha osk−i                                                                                           ∗                                       tuple consisting action observation strategy  argmaxa bγ    przb aαos∗zbz   osk−  z→cpk−   maps observations − step                                                          practice perform pointbased  conditional plans pomdps continuous observa                                                        ups belief state belief space contin  tions conditional plans cp decision trees inﬁnitely                                                        uous noted smallwood sondik   branches observation strategies os continuous                                                        ﬁnitehorizon optimal value functions composed ﬁ  functions value function αcpb conditional plan cp                                                        nite number αvectors means need  expected sum discounted rewards earned                                                        compute ﬁnite number pointbased backups  starting belief state value function                                                        αvector constructed exact algorithms linear  called αvector linear respect                                                        support  witness  perform ﬁnite set point  lief space parameterized vector αcps                                                      based backups carefully chosen belief points alterna  component state αcpb bsαcps                                                      tively approximate algorithms pointbased value  fig shows  αvectors corresponding condi                                                        eration    heuristically sample set belief points  tional plans shown fig αvectors corresponding                                                        perform pointbased backups  conditional plans starting open door action α  α high value extreme belief space  certainty tiger location high  policydirected observation aggregation  low value extreme                       decision process observations provide information    collection conditional plans forms policy π decision maker deciding future course action  value function π policy π best value achieved observation space rich continuous observations                               π  conditional plans  maxcp∈π αcpb discrete observations decision maker deviserich policies different course action each pos observations aggregated segments line corre  sible observation pomdps sponding range observations  exists good policies quite simple policies tend ditional plan optimal segment boundaries observations  select course action different obser conditional plans yielding                                                                       vations share similar features pomdps contin highest αcpbz  make clear variable                                                                    ba  uous observations allow implicitly discretise deﬁne βcp function corresponds  observation space introducing error                           ba                                                                αcpbz  ﬁxed βcp ≡ αcpbz   point view application domain gives                                                        ﬁnd boundaries solving βbaz − βba  insights regarding relevant features observation                         cpi     cpj                                                                                                space section discuss simple policies allow pair cpi cpj conditional plans analytically  aggregate observations effectively reducing solving equation difﬁcult general  complexity observation space                  possible observation functions exponential family    recall conditional plan cp  ha osi tuple gaussians efﬁcient numerical solutions  sisting action observation strategy os used wellbehaved functions used math  observation strategy oszcp indicates each observa ematica function intervalroots ﬁnds roots  tion conditional plan cp encoding future course arbitrary onedimensional function given interval  action intuitively observations select interval bisection combined gradientbased methods  conditional plan indistinguishable aggregated potential regions identiﬁed aggregate proba  view observation strategies partitioning bilities zcpb computed exact integration  observation space regions mapped condi monte carlo approximation each conditional plan cp  tional plan continuous observation tiger problem consider continuous tiger problem introduced  example long sound heard coming “from left” sect  illustrate ﬁnd observation regions  best choice action open right door al induced set conditional plans use  precise location sound important pointbased backup suppose doors located  decision boundary far right sound  − decision maker   heard decision maker listen  lack accuracy binary microphone array reports    each pointbased backup compute observation tiger’s location corrupted zeromean normally  strategy os partitions observation space distributed noise standard deviation σ  listening  gions zcp select conditional plan cp let’s ex costs  meeting tiger costs  opening  amine regions arise recall eq  correct door rewarded  discount γ   each observation conditional plan selected suppose  conditional plans correspond                                               ∗  maximizes αcpbz  deﬁne zcp∗  zcp  ing αvectors shown fig like                argmaxcpαcpbz  set observations form pointbased backup considering belief state    ∗                                    cp best conditional plan execute bz     btiger location  left  action  listen    each region zcp compute aggregate prob fig shows β functions each conditional plan                    ability przcpa  observation ∈zcp observation function gaussian βfunction  action taken state reached inte linear combination gaussian distributions ﬁnding                                                             ba   −  ba       ba   −  ba  rgrating pdfz  region zcp pr cp  roots βcp βcp βcp βcp ob        pdfza sdz aggregate probabilities tain boundaries   delimiting   z∈zcp                                                                                                                                 observation regions cp  cp cp   used perform pointbased dynamicx programming backups                 a∗                    ∗     a∗             form  discrete observation function      ∗  ∗                      zcp      cp   αha os ibr  bγ     pr    α bzcp   przcps integrating original gaussian observa                        cp                            tion distributions each region analytically integrate             ∗                   ∗      ∗    pr cp ap  ss bsprs pr cp each gaussian each region using complementary er      a∗                     ∗         ∗             ror function erfc fig shows gaussian observa  bz  ∝   bsprs przcpa       cp                                               tion distributions aggregate observation probabilities  equivalent eq  replaced sum                                                        each region using eq  compute value  observations sum regions zcp each                                                        conditional plan cp  ha σi  listen  particular conditional plan dominant                         ∈z                                                        σzcpi    cpi     onedimensional observation space                    contrast original discrete version tiger prob                                                        lem partitions observation space halves   discuss ﬁnd implicit discretization  resulting discrete binary observation function  observation space induced set conditional plans α                          erfc √−                                                         observe  right tiger location right       σ  vectors observation space onedimensional dynamic partition induced current set conditional  tinuous special case regions zcp                                                               note observations mapped condi method ﬁnd boundaries necessary  tional plan form contiguous region  βcpk higher value βcpi βcpj         zcp contiguous region integrals intersection points                                                                       ∞                                                              erfc  √    −t  computed each contiguous subregion                    π    dtplans advantage information lost fig world case possible factor obser  compares value policies obtained dynamic vation function product small observation func                                                                                                         discretization scheme naive binary discretization tions each random variable przza                                                                            vary variance σ  dynamic discretization outper prza prza  example consider mobile  forms ﬁxed binary discretization variances robot sonars pointing forwards side read  solutions perfectly observable cases ings each sonar conditionally independent given  σ ≤  approach unobservable location robot map robot’s environment  cases σ →∞                                           factorization exploited process observa                                                        tions sequentially conditionally independent observa                                      open right  open left                     tion variables divide each time step substeps        cp       cp                   cp                            β       listen          cp                           α              observation variable observed substep            β                            cp             cp                                                                    listen        easily accomplished constructing pomdp                                             −                                               additional state variable sub step keeps track                              vb     cp    β −                      − α                     current substep observation function encodes                                  cp            α                                                cp     −    β                                                 cp                                           probabilities single different observation variable                             −  open left     −                                      open right each substep transition function    −                       −     − − − − −                              observation         btiger location  right original pomdp sub step identity                                                function rewards gathered dis                                                      count factor applied sub step                                                                            lossless dynamic observation variables conditionally indepen           left    right                                     naive binary   dent effectively reduces dimensionality continu                                     pz   sa      cp                                             ous observations allowing approach sect         sleft                                    average  reward           used discrete observation variables exponential      sright        pdfzas                                                       reduction achieved domain single vari                                   −                        able exponentially smaller crossdomain                             −     − − − − −                  variables note complexity equivalent                 observation            standard deviation pomdp remains reduction achieved                                                                                        multiplying horizon number states  figure  tiger example βcpbz  btiger location   left   listen showing regions  sampling  each conditional plan selected αvectors   ditional plans observation function aggregate proba arbitrary multidimensional observations effective ap  bilities each observation region each state average proximation technique computing aggregate proba  discounted reward achieved  trials  simulated bilities consists sampling recall sect   runs  steps each different observation variances each conditional plan cp aggregate region                                                         continuous tiger problem                        cp observations cp yields highest                                                                  ba       ba                                                              value ieβcp ≥ βcp ∀cp ∈cp each                                                        ha sipair sample observations pdfza    multidimensional observation space                                                                                     set przcpa  fraction observations                                                         ba  applications observations composed βcp maximal breaking ties favoring conditional  sensor readings example mobile robot plan lowest index  number sonar laser tactile sensors sampling technique allows build approxi                                                                                                  rise multidimensional observations observation mate discrete observation function przcpa   space multidimensional analytically ﬁnding regions used perform pointbased backup set cp  computing aggregate probability difﬁcult conditional plans belief state number ob  observation functions                           servations sampled ksa each pointbased backup    examine approaches  ﬁrst discussed  quality approximation improves par  sect  considers special case pomdps obser ticular using hoeffding’s bound  guarantee                                                                    vations composed conditionally independent variables przcpa  error  probability  − δ  special case possible deﬁne equivalent pomdp  lncpδ interestingly doesn’t  observation variables processed sequentially pend dimensionality complexity mea  isolation essentially reducing observation space sure observation space depends num  dimension arbitrary multidimensional observations ber regions number conditional  present general samplingbased technique sect  plans true single dp backup num                                                        ber conditional plans increase exponentially    conditionally independent observations           worst case number observations each dp  applications random variables corresponding backup  hand algorithms    individual sensor measurements conditionally   mitigate policy complexity searching good  independent given action executed state small policies represented bounded number conditional plans αvectors perseus  randomized point t−                                                                    hands         hands                                                            state          state             tap  based value iteration algorithm algorithm                               α                                             hands         hands  number vectors bounded number belief wet            wet  points initially sampled depends policy com                                            towel                                                            water          water  plexity generally depends observation complexity                        soap                                                            hand           hand  independent restricting policies location  location  bounded representation                                      impeller prompt impeller       water                                                            xy         xy      away    sampling technique used pomdps    hand position hand position  discrete observations particular                                 observations factored random variables  number observations exponential number vari figure  pomdp model handwashing example im  ables long number conditional plans remains age showing regions induced observation function  small number samples relatively small maxi yhand location     note weaken dependency  tween number samples size action  given hands dry clean water  state spaces instead sampling observations each smaller rewards given progressions through  densities pdfza sample obser task hands clean  soapy  wet   vations proposal distribution pz sample variables ﬁnal goal state discount                                                       γ   observations used approximate each przcpa   follows assign weight pdfza spz model equipped impeller  each sampled observation obtain unbiased sample water pipe returns  water  pdfza each conditional plan cp ﬁnd ﬂowing  water sensor’s noise                                         ba            zeromean gaussian standard deviation σ   subset sampled observations βcp max                                                       gives  accuracy likely state  imal set przcpa  normalized sum                                                        water considered position hands hori  weights observations subset number                                                        zontal plane measured using camera mounted ceil  sampled observations necessary guarantee error                                                        ing sink connected vision   probability  − δ depends similar                                                       returns estimate position patient’s  proposal distribution pz each density pdfza                                                         dominant hand image using skin color  fig  proposal relatively similar each densi                                                        shows example image camera observation  ties tends close signiﬁcantly reducing                                                        function relates measured hand positions ac  dependencies differences                                                        tual hand location learned set data taken  tween proposal each densities increase                                                        vision actor simulated repeated  increases arbitrarily large sect                                                         handwashing trials  minutes vision  use pdfzb proposal distribution                                                        tracked reported position right domi                                                        nant hand researcher annotated data ac    experiments                                        tual hand location functions yhand location                                                         learned ﬁtting mixture gaussians  section presents experiments pomdp                                                        data annotated value hand location   sists people cognitive difﬁculties complete activities                                                        mixture models ﬁt using kmeans initialization  daily living focusing task handwashing                                                        followed expectationmaximization algorithm fig  present simpliﬁed pomdp guiding patients verbal                                                        ure shows likely hand locations each  prompts wash hands goal                                                        position induced learned mixtures gaussians  minimize human caregiver burden                                                        water ﬂow observation function learned data  ongoing research initiative applying intelligent reasoning  assistive living  paper present results sim water ﬂow hand position readings yield ob                                                        servation space water ﬂow hand positions  ulations methods simpliﬁed pomdp model                               handwashing task fig shows graphical model conditionally independent coordinates mea  handwashing pomdp pomdp’s actions sured hand positions dependent pro  verbal prompts corresponding canonical steps hand cess observations sequentially suggested sect   washing turn water wet hands use soap dry hands resort sampling technique sect                                                                            turn water null action waits extended perseus  sampling technique described    states deﬁned variables hands state   dirty soapy clean hand location away vision reports hand position  sec                                                        onds hand location changes located consistently  tap water soap towel hands wet wet dry                                                       frames  second  water  assume hands start model orders selected minimizing mini  dirty dry goal clean dry mum description length mdl −logp zhand location                                                           happen soapy wet inter  mlogn number parameters num  mediate time water starts task ber data points yielded  mixture components  completion cost prompt  large reward each state away state ﬁxed  mixture component
