                  detecting stochastically scheduled activities video               ∗  massimiliano albanese        vincenzo moscato          antonio picariello       vs subrahmanian                                                octavian udrea                      university maryland institute advanced studies                                    albanesevsudreaumiacsumdedu                                universita di napoli federico ii napoli italy                                         vmoscatopicusuninait                         abstract                            paper provide fast algorithms answer                                                         kinds queries ﬁrst type query tries ﬁnd min       ability automatically detect activities imal shortest possible clips video contain       video increasing importance applications given event probability exceeding speciﬁed threshold       bank security airport tarmac security bag — threshold activity queries second type       gage area security building site surveillance query takes portion video seen far       present stochastic activity model composed   set activities tries ﬁnd activity set       atomic actions directly observable   likely occurred video activity       through image understanding primitives focus  recognition queries       answering types questions   key contributions paper following       minimal subvideos given action ﬁrst introduce section  simple stochastic automata       identiﬁed probability certain thresh representation complex activities based atomic actions       old ii given video decide recognizable image understanding primitive       activity given set likely occurred elgammal et al  bevilacqua        provide mps algorithm ﬁrst problem    cavallaro et al   makarov ex       different algorithms naivempa amples actions implemented       mpa solve second experimental    ing vision algorithms include person object       sults dataset consisting staged bank robbery identiﬁcation identiﬁcation people entering exiting       videos described vu et al  show rooms motion tracking ﬁrst major contribution       algorithms fast provide high qual section  mps algorithm answer threshold       ity results compared human reviewers     queries second major contribution section                                                          naivemp  mpa   algorithms solve activity recog                                                         nition queries evaluate algorithms theoretically     introduction                                       experimentally section  party dataset                                                         consisting staged bank robbery videos vu et al    tremendous work lowlevel provide evidence algorithms efﬁcient   vision video processing algorithms detection yield highquality results   various types elementary events actions person   entering leaving room unloading package   work low level detection algo  stochastic activities   rithms utilized highlevel recognition activities section provide simple framework represent   video high level activities include transactions bank high level activities low level image processing   automatic teller machine atm robberies atm primitives framework simple version hmms    loading aircraft moving bags secure baggage zone don’t claim new novel paper starts   airport truck transports plane section onwards     paper focus high level activities assume existence ﬁnite set “action” sym   provide simple atm example motivate work high bols assume each atomic action detected   level activities consist set simple actions image understanding method purposes   tectable using video image processing algorithms paper assume action symbols propositional   temporal requirements                      loss generality assumption       ∗authors listed alphabetical order work partly sup image understanding methods cited   ported afosr grants fa fa paper return numeric value   readily   aro grant daad joint institute knowl transformed method returns “yes” “no” based   edge discovery                                       ﬁxed threshold                                                     ijcai                                                     deﬁnition  stochastic activity stochastic activity given video segment satisﬁes activity speci  labeled graph veρ                          ﬁcation    ﬁnite set action symbols               deﬁnition  probabilistic satisfaction let    subset ×                         video segment let veρ stochastic activity let    ρ function associates each outdegree   →                                                                                        labeling video segment wesay       probability distribution  ∈ veρ                                                                      satisﬁes       probability iff exists      ∈   ρv            sequence framesf ≤  ≤ fn ∈ sequence                         vv∈e                                                        activity symbols uun    ∈   ∃ v ∈ vstv v ∈  ∅ states                                                         ∀i ∈ nui ∈ fi      exists end symbol activity   ∈ n−                     deﬁnition                                         ii          follows wrt      ∈   ∃ v ∈ vstvv ∈  ∅                veρ                                         states      ∈  ∈  ∅     ∈ ∈      exists start symbol activity iii                                                                                     ∅      deﬁnition                                              n−                                                        iv Πi ρuiui ≥  ∈  denote pbv maximum product prob  abilities paths end node     problem deﬁnition activity                                                        sisting action symbols cases yield    figure shows small example stochastic activ higher probability activity times  ity associated transactions automatic teller ma actions cases want decide activity  chine atm ﬁgure assumed edges given set likely occurs video need  label probability  example consider malize probability wrt activity deﬁnition say  node withdrawcash edges starting video satisﬁes activity veρ wrt label  node  withdrawcard labeled probabil ing  relative probability p∗ iff satisﬁes veρ  ity  insertchecks probability              ∗     p−pmin                                                        probability         wherepminpmax  means  probability transitioning                  pmax−pmin                                                        lowest respectively highest probabilities labeling  withdrawcard state executing withdrawcash                                                        path start node end node veρ   probability transitioning insertchecks exe  cuting withdrawcash purposes paper example  consider labeling example   example somewhat simpliﬁed avoided talking stochastic activity figure  video satisﬁes  receipts generated atms each actions action probability  example pmin   stochastic activity easily detected arbitrarily large sequence activities  image processing algorithm detectperson check repeating action symbols withdraw − cash insert −  person present image sensor detect checks pmax  video labeling  insertcard holds important note given example  satisﬁes activity figure   framework possible execute withdrawcash ex relative probability approximately   ecute insertchecks execute withdrawcash                                                        proposition  let video segment let   — informally speaking probability sequence oc                                                        labeling let veρ stochastic activity  curring  ×  similarly figure                                                        satisﬁes veρ probability videos  describes attempted robbery atm             v                    ⊆  v    ∀f ∈ f                                                       labeling         labeling video mapping takes video f v satisﬁes veρ probability  frame input returns set action symbols output                                                        deﬁnition  stochastic activity query saq fourtuple  example  following labeling frame   veρp video  labeling  video wrt stochastic activity presented fig video veρ stochastic activity threshold  ure    detect − person  present −  card  insert −  card  withdraw  −    probability                                                          sequence answer saq iff  cash  insert − checks  withdraw −          veρ                card  ¬detect − person                     satisﬁes       probability strict sub                                                       set se ⊂ satisﬁes veρ probability                       a                   say action follows action segment  intuitively looking smallest subvideos  ⊆                             veρ          wrt labeling activity deﬁnition  iff  satisfy activity deﬁnition probability given     ∈ s a ∈ e    a ∈   ∀a ∈b  ∈                             ii             threshold deﬁne probable subvideo  ∈ e−a   ∀fsts≤  ≤ a ∈ f                                                  probable activity problems formally  example  consider labeling example   probable subvideo mps problem   subvideo   action withdraw − cash follows action probable subvideo problem deﬁned follows  insert − card action insert − checks does given stochastic activity query  veρpﬁndthe  follow action insert − card                          set answers query  intuitively labeling video speciﬁes actions node indegree   detected given video deﬁne probability node outdegree                                                     ijcai                                                          detect  present           withdraw  withdraw                          insertcard           person    card               cash       card                                                         detect present        detect withdraw cash                                                                        insertcard                                                                  person   card          assailant cash    transfer                                                                                                                                                                                                                                                                           detect                                                person                                     insert                                             detect detect                                                                                                                         checks                                               person  assailant                  atm regular operation                         atm attempted robbery                                      figure  atm stochastic activity examples    probable activity mpa problem       mps algorithm maintains set triples fpa  practical cases – airport security atm monitoring correspond partially detected activities represents  users interested monitoring list speciﬁc frame start symbol veρ detected  activities goal identify activity activities later used determine subvideos  likely occur given portion surveillance answer represents product probabilities path  video likely activity problem deﬁned start symbol action symbol – sym  follows given video labeling  set activity def bol detected current frame algorithm works  initions  veρvnenρnﬁndtheset    changing state represented – intuitively consist     ⊆  following hold let pm  maxp ∈ ing paths through activity deﬁnition   ∃ai vieiρi ∈ astvsatisﬁes ai relative reach end node probability threshold                                     probability pthen∀vieiρi ∈  vieiρi satisfy triples removed evident current                                                     relative probability pm ii  ∃vjej ρj ∈ −  path result probability lower pt lines –  st satisﬁes vj ejρj relative probability pm frames video analyzed mini                                                        mality condition deﬁnition  enforced lines –    threshold queries                                  removing redundant subvideos                                                          consider labeling example  activity deﬁni                           mps  probable subvideo    algorithm tries ﬁnd tion figure assume pt  frame   answers stochastic activity query  veρp mps algorithm add triple   detect − person  shown figure                              line  frame  triple replaced                                                         present − card immediately frame  algorithm mps                                                 withdraw− cash  input query  ρptwherev                                    process  output set subvideos representing answer input query probabilities tinues frame  condition line   activity satisﬁed  notation set triples awheref frame ∈   ∈ true   ¬detect − person causes  activity symbol                                      subvideo   added answer line    ←∅                                              theorem  mps correctness algorithm mps     termi   ←∅                        vs ←a ∈   ∃a ∈ st ∈            nates input query  veρpt returns                          ve ←a ∈   ∃a ∈ st  ∈           set answers query –   fi    ∈                           •∀s ∈ answer  veρpt    ← fi ∩b ∈ ∈     ∅                                        deﬁnition      ← −f                                                         •  ∃s st answer  veρpt   ∈                  · ρa  ≥ pt                            ∈                               ←f ∈ cf  ∧      ← − ∪                                     theorem  mps complexity algorithm mps   input         maxmax      pp· ρa aa                                                               fpa∈t                        query  veρpt runs time ov ·v     endif   endfor                                              note mps makes pass through video   endfor   ∈ vs ∩ fi                       allows process video comes frame   ← ∪fi                               frame mps suited scenarios   ∈ st ∈ ve   ← ∪f fip                             surveillance video analyzed playing   ← −f   endfor  endfor                                                activity recognition queries  ffp ∈              ffp  ∈ −ffp            section present methods answer activity        f  ⊂                                          recognition queries    ← −ffp          f  ∧ p                                      • video labeling     ← −ffp                              •    ρ ρ    endfor                                                                        ﬁnite set  endfor                                                 activities  return                                                          way ﬁnd set activities vieiρi satisﬁed                                                        maximum relative probability activities        figure  algorithm mps problem      use mps algorithm presented earlier follows                                                    ijcai                                                                                                          algorithm mpa    start pt                                  input video labeling  set activities    pt changed previous iteration return output vieiρi ∈ satisﬁed highest probability                                                        ∀j ∈ nj  vj ej ρj  satisﬁes satisﬁed probability                                                               set activities obtained step        run mps  record activities satisﬁed relative notes vector sets each ci structure mps algorithm                                                                     p−pi                                                                        min                              pt                                notation fip    wherep   maximum respectively      probability                                        pi  −pi       max  min                                                                    max  min    activity previous set minimum probabilities path vieiρi      set pt average current previous                                                              value step  activity  mi ←       obtained step  return                     ci ←∅                                                         endfor    activity previously computed set set  frame fj                                                                      pt half previous value step                                                              ∈ ci                                                           ← fj  ∩b ∈ ∈ ei    reasons space omit detailed algorithmic   ∅            naivemp                                       ci ← ci −f  scription          algorithm’s main issue                                                                ∈                                                                          binary search run iterations each taking  ← · ρia                                                                        ·v ·v                                            fip · pba  maxmmn                steps experiments show algo                                                                                     ←f ∈ cf  ∧                                                                                                      rithm particularly slow activity  ci ← ci − ∪f maxmaxfpb∈t pp   returned                                           endif                                                          endfor  example  consider  set activities depicted  endfor                                                         ∈x ∈ vi  ∃ ∈ vi st ∈ ei∩fj   figure   following labeling  detect −     ci ← ci ∪fj   person  present −   card  insert −     ∈ ci st                                                               ∈x ∈ vi  ∃y ∈ vi st ∈ ei  card  withdraw −   cash  insert −     ci ← ci −f  checks  detect − assailant  withdraw −  mi ← maxmifip                                                         endfor  card  withdraw −  cash  ¬detect −    endfor  person  ¬detect − person                   endfor                                                       return aimimimaxmmn    naivemp  determine  ∅ pt   point subvideo   satisﬁes activity depicted  figure relative probability  pt figure  algorithm activity recognition problem  subvideo   satisﬁes activity figure  relative probability  pt  returned                                                        portion image person implementing mo    activity recognition problem problem ef tion tracking primitives – turn leads ability  ﬁciently solved maintaining state similar fashion detect atomic actions person entering room  mps   each activities set algorithm library implements algorithms described elgammal et al  shown figure                                      bevilacqua   cavallaro et al      mpa   maintains array cn sets makarov  labeling data obtained video process  ci holds current state activity vieiρi sim ing stored mysql dbms experiments  ilar way set used mps mi holds maxi run pentium centrino  mhz gb ram  mum relative probability ai satisﬁed running windows xp professional  far pruning occurs triple fpa ci  notes path completed relative probabil experiments performed dataset  video  ity greater mi line  mps mpa makes sequences approximately  seconds depicting  pass through video permitting incremental com regular bank operations staged attempted robberies  putation                                             dataset superset described vu et al                                                         developed ﬁve activity deﬁnitions following                                       mpa  theorem  mpa correctness algorithm     terminates  tation depicts regular customeremployee interaction  returns correct answer – set activities describes nonemployee enters vault room                      satisﬁed highest relative probability “safe” describes bank robbery attempt describes                      activities                              successful bank robbery – assailants enter  theorem  mpa complexity algorithm mpa runs time bank enter safe holding employee hostage        ov · maxi∈nvi ·                        escape describes employee accessing safe                                                        behalf customer    experiments implementation                       ﬁrst set experiments measured running  prototype implementation mps naivemp time mps activity deﬁnitions aa imple  mpa   consists approximately  lines java code mented version algorithm ca refers orig  addition implemented image processing library ap inal algorithm figure  scenarios  proximately  lines java code library operates activities atm improve efﬁciency  video frames identifying blobs corresponding objects assuming activities interleaved – lead  video information objects version denoted cna running times labeling                                                    ijcai                                                                                                                            frame recall precision                           mps running time                                                                                 ca             cna                                                                                                                                  frame precision  ca             ca                                                                             frame recall  ca             cna                                                                            frame precision  cna                                                                                           frame recall cna             ca                                                     cna         ca             cna                                                                                                                       time  ms                                                                                                                                                                                                                                                                                                                                       threshold                         labeling size actions                    mps running time                         mps frame precision recall                                         figure  mps experimental results    size   actions shown figure athe set experiments analyzed perfor  activity deﬁnitions aa satisﬁed labeling mance answer quality naivemp mpathe  size reaches  leading visible increase running time following sets activities used    expected cna efﬁcient original ca ver aa  aaa  aaaathe  sion observed running times dependent running times shown figure  naivemp espe  complexity activity deﬁnition           cially inefﬁcient labeling satisﬁes activi                                                        ties – large number iterations taken                                                        threshold close  running times                    mpa naivempa running times                                                        algorithms comparable labeling sizes greater                                             naivempa     naivemp efﬁcient mpa                                        naivempa                                     naivempa    graph shows running time generally proportional                                        naivempa                                         mpa         number actions labeling                                    mpa                                         mpa                                         mpa                                                        related work conclusions         time ms time                                 modelbased anomaly recognition techniques provide                                                        priori deﬁnition anomalous activity detect new                                                             anomalous activities hongeng nevatia  zhong et                                                    al  stauffer grimson  deﬁne models reg                                                         ular activities bags event ngrams detect abnormal                                                                                                            labeling size actions       ities contextfree grammars studied ivanov                                                        bobick  vu et al  nevatia et al                                                         narayanan  oliver et al oliver et al                figure  mpa running time                                                        scribed approach based coupled hmms learning                                                        recognizing human interactions dynamic bayesian net    second set experiments measure precision works – viewed generalization hmms  recall mpswrt set  human annotators av – used tracking recognizing multiagent ac  erage annotations subjects tivities hamid et al  databased methods detect ac  sidered ground truth measuring precision tivities based extracted features cuntoor chellappa  recall results shown figure notice cuntoor chellappa  proposed characterization  precision high generally constant events based antieigenvalues sensitive  recall surprising variation pattern – recall changes parameswaran chellappa parameswaran  monotonic threshold explanation ap chellappa  computed view invariant representations  parently anomalous behavior comes fact low human actions  thresholds number candidate subvideos relatively ontologies recently used different contexts  high minimality condition causes fewer frames video surveillance chen et al chen et al  use ontolo  appear answer monotonic behavior pattern stops gies analyzing social interaction nursing homes ha  threshold high  case keem et al use ontologies classiﬁcation meeting videos                                                        hakeem shah georisetalgeoris et al     does include running time library methods use ontologies recognize activities bank monitoring  generate labeling                                setting result video event challenge workshops                                                    ijcai                                                    
