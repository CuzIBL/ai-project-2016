people tracking anonymous idsensors using raoblackwellised particle                                                    filters                               dirk schulz dieter fox jeffrey hightower                                     dcpt science  engineering                                           university washington                                                  seattle wa                          abstract                          relatively coarse location information want et al                                                           priyantha et al  various techniques pro•      estimating location people using network                                                          posed tracking multiple anonymous sensors multi•      sensors placed environment                                                          ple idsensors problem integrating anonymous       fundamental challenge smart environments                                                          id sensor information addressed far       ubiquitous computing idsensors infrared                                                          paper present approach combines accuracy ben•      badges provide explicit object identity information                                                          efits anonymous sensors identification certainty       coarse location information anonymous                                                          idsensors       sensors laser rangefinders provide accurate                                                            approach uses raoblackwellised particle filters ef•      location information tracking using sen•                                                         ficiently estimate locations identities multiple ob•      sor types simultaneously open research chal•                                                         jects each particle represents history associations be•      lenge present novel approach tracking mul•                                                         tween object tracks observations each particle       tiple objects combines accuracy benefits                                                          individual objects tracked using kalman filters       anonymous sensors identification certainty                                                          initial id uncertainty makes samplebased representation       idsensors raoblackwellised particle filters                                                          id assignments extremely inefficient approach starts       used estimate object locations each particle rep•                                                         tracking objects using anonymous sensors ef•      resents association history kalman fil•                                                         ficiently representing estimates object ids keeping       tered object tracks observations using                                                          track sufficient statistics id estimates cer•      anonymous sensors id estimates cer•                                                         tain approach switches sampling id assignments       tain id assignments sampled re•                                                         resulting fully raoblackwellised particle filter       sulting fully raoblackwellised particle filter                                                          object tracks id assignments applied       object tracks id assignments ap•                                                         anonymous sensors method results new rao      proach implemented tested successfully us•                                                         blackwellised approach multihypothesis tracking       ing data collected indoor environment                                                          gained substantial attention target tracking commu•                                                         nity barshalom li     introduction                                           paper organized follows section  clarifies                                                          problem section  presents raoblackwellised par•  accurate reliable tracking people using sensors placed                                                          ticle filter approach tracking multiple objects using   environment fundamental problem relevant                                                          anonymous sensor information section  extends ap•  research communities knowing locations                                                          proach incorporate idsensors implementation ex•  people critical importance research investigating high                                                         perimental results presented section  followed   level state estimation plan recognition learning human                                                          discussion   activity patterns applications work flow enhance•  ment health monitoring     years location estimation approaches  problem description   introduced using sensors cameras laser range figure  illustrates problem tracking multiple people   finders infrared ultrasound sensors wireless net• anonymous idsensors solid dotted lines   working infrastructure hightower bordello  trajectories person respectively   crucial aspect sensors provide ex• beginning identity people known   plicit information identity person anony• walk anonymous sensor observes locations fre•  mous sensors radar reflective ultrasound transducers quently people far apart positions   scanning laser rangefinders provide accurate location tracked reliably using anonymous sensor how•  appearance information provide explicit identity reach idsensor areas   trajectories   information idsensors like infrared ultrasound badge probability belonging person   systems provide explicit object identity information different hypotheses ids       perception                                                                                            figure  example scenario shaded circles indicate areas cov•  ered idsensors infrared receivers person wearing   badge enters area corresponding sensor issues read•  ing indicating id person sensors provide figure  graphical model multiobject tracking anony•  information persons location area people mous idsensors state vector describing locations   area distinguished shown additional individual objects time objects generate anonymous ob•  anonymous sensor laser rangefinder sensor provides servations id observations  assignments individual   accurate information high rate locations people observations objects given hidden nodes rao  information ids                               blackwellised particle filters sample assignments solve                                                                  state updates analytically using kalman filters conditioned   trajectories passing through coverage idsensors samples     ambiguity resolved trajectories ids   determined paths cross confusion    complete sequence observations time   continuation tracks people      given use hat tilde distinguish anonymous   leave light gray area anonymous sensor deter•  id observations associations object tracks   observations associate trajectory       observations given assignment matrices   problem known data association problem       instance assigns anonymous ob•  multitarget tracking community barshalom li                                                                   servation object zero observa•  idsensors impossible resolve                                                                  tions depend current object positions assign•  ambiguity scenario ambiguity resolved                                                                  ments   soon people reach areas covered idsensors                                                                     goal tracking estimate posterior    necessary maintain hy•                                                                 state based sensor information available time   potheses possible track continuations going   going going going                  factored representation tracking problem allows                                                                  use raoblackwellised particle filters rbpf sample     use combination anonymous idsensors re•     assignments track objects using bank kalman   quires solve types data association problems     filters each sample doucet et ai    problem classic multitarget tracking problem  large number anonymous assignments fiat   assigning anonymous observations object tracks     distributions id assignments straightforward implemen•  data association problem solved each point     tation rbpfs require prohibitive number sam•  time resulting possible associations tracks length  ples section efficiently sample     involving people fortunately probability distribu•     anonymous assignments time resulting algorithm   tions anonymous assignments typically highly    mhtrbpf multihypothesis tracking rbpf track mul•  peaked allowing efficient samplebased represen•  tiple objects using anonymous sensor information   tation assignments second problem es•    section section  extend mhtrbpf   timating id individual objectstracks anony•   incorporate idsensors   mous assignments possible assignments ids   tracks fortunately number id assignments does in•  mhtrbpf raoblackwellised particle   crease time identity objects does change   low spatial resolution idsensors      filters multihypothesis tracking   posterior id assignments uniform during early   assignments observations ob•  stages estimation process figure  flat jectstracks given need estimate posterior   distributions samplebased representation requires or•                                                                object states assignments joint   der samples certainly feasible online                                                                 posterior factorized conditioning state   tracking                                                                                                                                                                        assignments     figure  shows graphical model tracking prob•  lem time indexed subscripts current time                                                            denoted current po•  sitions people tracked following standard no•      key idea raoblackwellised particle filters com•  tation tracking community observations denoted pute  sampling assignments                                                                                                             perception computing state xk conditioned each sample desired   specifically each sample represents history data associ• rightmost term target distribution  morales  ations annotated bank ofkalman fil•     menendez et al  second source inefficiency   ters each tracked person kalman filters arc sampling predictive distribution sec•  conditioned data associations provided sample ond sampling step inefficient observation   updated efficiently using standard kalman likelihood highly peaked compared   filter update rules known data association barshalom predictive distribution pitt shephard    li  kalman filter estimates tracks second problem extremely severe context                 represented mean covariance predictive distribution assignments virtually uniform   persons locations                            posterior typically concentrated small set     rbpf generate assignments incrementally maintaining assignments barshalom li    sample sets containing assignment histories distributed ac•  cording posterior given rightmost term  mcmc sampling optimal distribution                                                         let discuss address second problem   specifically time sample set                                                         problem drawing samples posterior distribu•             contains tv weighted samples each sam•                                                        tion  given previous sample set conditioned spe•  ple consists history assignments                                                         cific assignmentthe optimal sampling distribution fol•  current position estimates objects generic                                                         lows    rbpf algorithm generates set previous sample   set observation generating new assign•  ments distributed according posterior   each assignment specifies observations be• possible efficiently generate samples dis•  long object track final step consists updating tribution using markov chain monte carlo mcmc tech•  kalman filter tracks each sample using observations niques gilks et al  apply version   assigned sample doucet et al   metropolishastings algorithm adapted specif•                                                        ically data association problem dellaert et al     importance sampling lookahead                idea metropolishastings sample states                                                         ergodic markov chain posterior stationary distri•  efficiency rbpfs strongly depends number bution markov chain constructed choosing   samples needed represent posterior candidate state given current state accord•  section devise efficient algorithm generat• ing proposal distribution state transition   ing assignmentssamples sequential nature accepted probability   estimation process samples generated   assignments previous time step posterior time                                            given                                                         intended stationary distribution                                                         case states possible assignments                                                         optimal sampling distribution  efficiency                                                         metropolishastings method strongly depends choice                                                         proposal distribution use efficient approach                                                         called smart chain flipping smart chain flipping permutes                                                         assignments subset objects each transi•                                                        tion actual choice takes individual as•   follows bayes rule  follows  signment likelihoods account approach   position tracks objects sufficient shown result improved mixing rates assignment prob•  statistics previous observations assignments lems dellaert et al                                                          assignment lookahead     unfortunately cases impossible sample di• mentioned source inefficiency   rectly  approach commonly used particle fact previous sample set does consider   filters evaluate  right left three stage pro• recent observation problem greatly reduced   cess doucet et al  draw samples using recent observation reweight sam•  previous sample set using importance weights draw ples previous sample set pitt shephard    each sample new sample predictive dis• moralesmenendez et al  weight sample   tribution finally weight samples pro•            given dividing target distribution   portional observation likelihood sampling distribution   step importance sampling adjusts tor tact sam• shown result   ples drawn actual target distribution   approach main sources inefficiency   samples previous sample set distributed according       perception                                                                                                                                  table  mhtrbpf algorithm                                                          tracking anonymous idsensors   importance weight sample given abil•                                                        principle mhtrbpfs readily extended include   ity tracks associated sample predict                                                         idsensors instead sampling anonymous assignments   observation accurate computation right term  possible sample anonymous id assignments   requires summation possible assignments straightforward extension results infea  moralesmenendez et al  case sible increase number samples needed during early   number assignments prohibitively large esti• stages estimation process reasons   mate  using samples generated mcmc step un• each hypothesis sample mhtrbpf possible as•  fortunately computing equivalent comput•       signments ids object tracks second low spa•  ing normalization factor markov chain tial resolution idsensors posterior id assignments   possible general gilks et al  case initially uncertain samplebased representations   need absolute value normalization con• flat distributions inherently inefficient overcome   stant each chain value relative normal• difficulties instead use twostage estimation pro•  izes markov chains distributions  cess during initial stage anonymous sensors   similar shapes chains highly peaked used object tracking idsensors simply used                                                         estimate identity different objects esti•  estimate relative normalization constants aver•                                                        mates certain process moves rao  age probabilities samples different markov chains                                                         blackwellisation phase during anonymous id     specifically let samples drawn each assignments sampled phases discussed   markov chain let denote th sample drawn   markov chain associated sample up•  identity estimation phase   dated weight sample given               during phase anonymous sensors used track                                                         objects idsensors used estimate identity                                                         different objects specifically each hypothesis                                                      mhtrbpf possible assignments                                                         identities tracks order avoid estimating distributions   proportionality weights sum potentially large number assignments                                                         track sufficient statistics allow recover distri•  mhtrbpf algorithm                                    butions assignments sufficient statistics given   algorithm summarized table  step  new sam• individual assignments ids tracks   ples generated previous sample set aver• probabilities individual assignments   age probability samples used estimate looka updated recursively using recent id observation   headpredictive weights each sample previous set   step  step involves normalization                                              weights sum step  sample drawn   previous sample set each sample drawn  id observation corresponding person        draw assignment posterior reusing determine assignment probabilities normalize   samples generated markov chains step  step  values considering possible assignments   updates actual position estimates individual objects                                                                                                             using corresponding assignment ifassigns id object track   zero computational complex computa•  tion  avoided sampling id assignments using   metropolishastings based individual values   approach works identical method used sample   anonymous assignments mhtrbpf algorithm     summarize identity estimation phase each sam•  ple consists kalman filters matrix   representing sufficient statistics  id assign•  ments needed posterior id assignments   computed using mcmc sampling id estimation   stage ended soon posterior id assignments   sufficiently peaked allow accurate representation   reasonable number samples currently estimate   condition determining average number hypotheses figure  outline intel research lab seattle environ•  markov chains run id assignments             ment equipped ceiling mounted ultrasound infrared re•                                                        ceivers cubical partitions halfheight  meters high   raoblackwcllisation phase                       laser rangefinders scan chest height just parti•  ids estimated accurately begin es• tions shown paths people estimated   timating joint posterior anonymous id assign•   ments posterior given                                                         sample set contained hypothesis correct loca•                                                        tions identities each method tested  trial runs   note id assignments sampled during using real data set identity estimation phase   complete estimation process id assignment algorithm able successfully complete data   sampled identities attached object tracks arc fixed set tested approach switching   id observations serve purposes raoblack isation phase algorithm remained   provide information object positions second identity estimation phase lookahead update   provide information weighting anonymous hypotheses times approach prohibitively large    improving object estimates considerably  times real time lookahead resulted significant speedup                                                         results shown row table    experiments                                         finally tested twophase approach                                                         lookahead algorithms able successfully track   validate approach captured trace logs peo• complete data cases seen col•  ple simultaneously walking cubical areas umn three columns average time standard de•  office environment outlined figure  each person viation maximum time update seconds results   wearing small idsensor trackpack consisting in• demonstrate lookahead twostage process   frared badges ultrasound badge infrared ultra• improve performance tracking algorithm   sound receivers installed ceiling   entire scene continually observed wallmounted method               succ   avg   std  max   laser rangefinders scanning chest height just cu• id estimation look       bical partitions duration log  minutes dur• twophase rbpf                ing individual people moved  meter twophase rbpf look            meter challenging data log paths people fre•  quently crossed each situations set experiments compared mcmc    people occluded validate track• based assignment generation deterministic sampling   ing algorithm quantitatively carried series exper• scheme used traditional mht algorithms as•  iments based data log additional simulation signments enumerated decreasing order wrt like•  runs wwwcswashingtoneduroboticspeople      lihood cox hingorani  note generating as•  tracking visualizations                        signments decreasing likelihood results estimates   tracking ability                                      strongly biased likely assignments per•                                                        formed extensive tests using real data data simulating    path people estimated shown people approach slightly efficient   figure  result obtained mhtrbpf us• achieving robustness results de•  ing  samples markov chains length  pend implementational details did consider   setting algorithm able reliably track people significant fact smart chain flipping   lookahead used determining parame• works good ranked assignments practice   ters carried trial runs different variants al• encouraging mcmc approach results   gorithm run considered successful end biased estimates       perception                                                                                           
