                    •  learning utilizing motion patterns                                     persons mobile robots                      grzegorz cielniak maren bennewitz wolfram burgard             department science university freiburg  freiburg germany                     department technology orebro university  orebro sweden                            abstract                          recorded laserrange finders furthermore demon•                                                         strate learned models used predict positions        people through environments   persons        randomly instead usually    recently variety service robots developed        follow specific trajectories motion patterns cor• designed operate populated environ•       responding intentions knowledge   ments robots example deployed hos•       patterns enable mobile robot robustly pitals  museums  office buildings  department        track persons environment im• stores  perform various services deliver       prove obstacle avoidance behavior paper  educate entertain  assist people    variety        proposes technique learning collections tra• techniques developed allows robot track       jectories characterize typical motion patterns people vicinity   additionally authors       persons data recorded laserrange finders used models peopics motions adapt behavior        clustered using expectation maximization al• mobile platform according predicted movements        gorithm based result clustering pro•   approaches assume motion       cess derive hidden markov model hmm        model given provide means learn parame•      hmm able estimate current fu•   ters motion behavior persons bui et al proposed       ture positions multiple persons given knowledge abstract hidden markov model ahmm predict peoples        intentions experimental results ob•  motion assume goals subgoals per•      tained mobile robot using laser vision  son locations person aims approach       data collected typical office building sev• given approach contrast able learn in•      eral persons illustrate reliability robustness tentions automatically derive parameters un•      approach demonstrate      derlying hmm technique described paper       model provides better estimates hmm di•    extension approach recently proposed bennewitz et       rectly learned data                      al  learn intentions persons                                                          derive hmm corresponding motion pat•                                                         terns hidden markov model allows robot main•   introduction                                         tain belief current location person                                                            paper organized follows section intro•  mobile robots designed operate populated                                                          duces approach learn motion patterns observed   environments need able perceive people                                                          trajectories describes generate hidden markov   neighborhood adapt behavior according                                                          models predict motions persons section    activities people knowledge typical motion                                                          present experiments illustrating robustness   behaviors persons used ways improve                                                          approach estimating positions single multiple   behavior robot provide better estimates                                                          persons using laser vision data mobile robot   current positions persons allow better pre•                                                         results indicating models provide better es•  diction future locations                                                          timates hidden markov models directly learned     paper present approach learning prob• observations   abilistic motion patterns persons use em  algorithm  simultaneously cluster trajectories belong•  learning motion patterns   ing motion behavior learn characteris•  tic motions behavior apply technique data people perform everyday activities envi•                                                         ronment permanently usually stop      work partly supported german science locations stay certain period time   foundation dfg contract number sfbtr depending activity currently carrying   ec contract numbers st hpmtct accordingly assume input algorithm       perception                                                                                              collection trajectories resting            patterns highest data likelihood em al•  places output number different types motion gorithm iteratively maximizes expected data likelihood   patterns person exhibit nat•           optimizing sequence lower bounds particular   ural environment each trajectory consists sequence generates sequence models denoted                            positions accordingly increasing data likelihood standard method use       position person starts leaving socalled function depends models   resting area destination task algo• accordance  function factored follows   rithm described section cluster trajectories   different motion behaviors finally derive hmm   resulting clusters     paper assume trajectories   length chosen maximum length   trajectories trajectory length ex•  tended linear interpolation learning algorithm de•  scribed operates solely information there•  fore does account velocities persons   during learning phase experiments   evidence walking speed person depends   intention way incorporate veloci•  ties introduce dimensions state variables   necessary changes clustering algorithm starting initial model   straightforward                                      function continuous case em algorithm con•                                                        verges local maximum    motion patterns                                                           particular optimization involves steps calculat•  begin description model motion pat• ing expectations given current model   terns subsequently estimated data using em  finding new model maximum   paper assume person engages dif• expected data log likelihood expectations   ferent types motion patterns motion pattern denoted steps typically referred estep      represented probability dis•                                                        short expectation step mstep   tributions each probability distri•                                                        short maximization step   bution computed based subse•  quent positions trajectories accordingly       calculate expectations apply   specifies probability person location alter bayes rule obeying independence assumptions dif•                    steps given engaged motion ferent data trajectories   pattern calculate likelihood trajectory   motion patternas                                                                                                              normalization constants ensure    expectation maximization                          expectations sum  combine    essence approach seeks identify model max•  utilizing fact distributions represented   imizes likelihood data define likelihood gaussians obtain   data model useful introduce   set correspondence variables denoted   index trajectory index motion                                                   pattern each correspondence binary variable    th trajectory corresponds th   motion pattern think motion pattern specific finally mstep calculates new model max•  motion activity person engaged  imizing expected likelihood technically   person engaged motion activity trajectory   computing motion pattern each probabil•    sequel denote set correspon• ity distribution new mean   dence variables data item         consider expectations computed                data item fact exactly step   correspondence variable  leads     paper assume each motion pat•                                                                                                            tern represented gaussian distributions fixed   standard deviation goal set motion                                                                                                    perception   estimating number model components         sequence positions covered person during mo•   general correct number motion patterns tion computing trajectories ignore positions    known advance need determine quantity during lie closer cm each   learning phase number motion patterns wrong    distinguish different situations  deriving hidden markov models    motion patterns trajectories learned intentions    explained current motion patterns intentions persons learned    hand motion patterns easily derive hidden markov models estimate posi•  trajectories explained different tions achieve distinguish types nodes    model components em algorithm class initial final nodes correspond   converged check overall data likelihood resting places connect nodes introduce socalled   improved increasing decreasing number model intermediate nodes lie learned motion patterns   components limit model complexity during eval• current use sequence intermediate   uation use penalty term depends number nodes each intention  intermediate   model components avoids algorithm nodes distributed distance    learns model overfits data worst case consecutive nodes cm  given equidis•  model motion pattern single trajectory tant distribution subnodes assuming constant   maximum number iterations reached overall speed standard deviation person transi•  evaluation improved increasing decreas• tion probabilities hmm depend length    ing model complexity algorithms stops returns time interval consecutive updates hmm   model best value far current value set   experiments carried different data sets approach secs accordingly compute probability   correctly clustered trajectories corresponding cat• person node given currently   egories                                               given time elapsed      laserbased data acquisition   embased learning procedure implemented   data acquired laserrange finders acquire data   used laserrange scanners installed value gaussian   environment relevant parts environment mean standard deviation posi•  covered identify persons laser data tion transition probabilities resting places   extracts features local minima range computed based statistics average time period   scans come legs persons additionally elapses person starts particular motion   considers changes consecutive scans reliably iden• behavior staying corresponding resting area   tify moving people track person use note resulting model regarded   kalman filter state person time step repre• twolevel abstract hidden markov model    sented vector  represent          higherlevel goals ahmm correspond resting   position person terms represent places person lowerlevel goals nodes   velocity person direction accordingly paths highlevel goals   prediction carried equation                                                          application example                                                         embased learning procedure works prac•                                                        tice consider figure  example model                                                         trajectories three different intentions                                                         learned leftmost image shows initial model   time elapsed measurement     means three model components indicated cir•  usually sensors position object cles images evolution   laser range sensor does provide velocities model components fourth image shows model      state space mea• components convergence em algorithm   surement matrix projects components seen trajectories approximated quite   state space accordingly predicted measurement step corresponding motion patterns finally rightmost picture                                                     shows hmm derived motion patterns dif•                                                        ferent resting places indicated rectangles numbers                                                          experimental results   second step identify resting places perform technique described implemented   segmentation data different slices evaluated using data acquired unmodified office envi•  person moves finally compute trajectories ronment experiments described section      perception                                                                                             figure  hidden markov model derived learned inten• figure  evolution probability person   tions                                                 different resting areas time     signed illustrate approach learn complex mo• recursive bayesian update scheme   tion behaviors typical office environment further•  demonstrate resulting models used   robustly estimate positions persons additionally likelihood observation given   compare performance models learned al• state computed using gaussian distribution   gorithm standard hmm finally present depends variance current estimate   extension allows deal multiple per• tracking variance used during learning   sons                                                  intentions                                                            figure  plots different resting areas probability    learning intentions office environment       person stays particular place xaxis   evaluate approach applied data recorded represents individual time steps yaxis indicates   hours office environment during acquisition probability graph includes ground truth   phase average speed person cmsec  indicated corresponding horizontal linepattern   standard deviation cmsec resulting data    level seen figure   extracted  trajectories successfully reliably determine current position person during   clustered  different intentions resulting hidden experiment predicted correct place person   markov model shown figure                       time                                                          comparison standard hmms    tracking single person                                                         second experiment designed demonstrate   analyze applicability learned hmm pre• hmm takes account peoples intentions allows   diction locations person used mobile robot better prediction standard hmm directly gen•  albert br platform equipped laser range erated observed trajectories persons   scanner robot moving corridor does account clustered trajectories   department speed cmsec task evaluate performance different approaches   maintain belief position person   chose motion patterns depicted figure      incorporate observations hmm apply pattern leading resting place                                                                                                  perception  office containing resting place  staying area    second motion pattern places      defined standard hmm possible states   person space   discretized cm patches encode  possible in•  cremental moves cell transition probabilities    learned trajectories corresponding motion    patterns counting randomly chose position    trajectories patterns observed position    person states hmm initialized according figure  typical scene persons walking    observation model section  convergence corridor left image corresponding estimate laser  hmm measured likelihood final destina• based people tracking right image   tion compared value obtained hmm   generated algorithm trajectories correspond•   ing intentions repeated experiment rate calibration camera laser use   different locations trajectories patterns perspective projection map position per•  determined average probability true goal location son world coordinates image coordinates   obtained average  model color histograms arc robust respect translation ro•  corresponding value standard hmm  il• tation scale kind geometric distortions    lustrates model leads better results sensitive varying lighting conditions handle    standard independence assumption hmms generally problem consider hsv huesaturationvalue color   justified application domain note similar space color model intensity factor sepa•  observations reported murphy  contrast rated influence reduced current   standard hmm model automatically chooses tran• simply ignore factor experiments   sitions correspond actual intention person evidence factor negatively af•                                                         fected performance image database    estimating locations multiple persons       created each person contains his•  final experiment described section designed togram built  images    illustrate models used maintain beliefs compare given query histogram  prototype   multiple persons major difference situation database use normalized intersection norm   single person able represent hi  quantity computed   beliefs individual persons detect multiple   persons observations current learn                                              individual hmm person     track multiple persons range scans apply in•  dependent kalman filters each feature solve  color histograms having bins   data association problem apply nearest neighbor ap• advantage norm allows compare partial    proach update filter using observation views person close camera    closest new filters introduced observations visible   predictions arc far away furthermore fil•  ters removed corresponding feature   second     need able identify person order ap•  propriately update belief location person   achieve additionally employ vision   robot identify person proceed follows ev•  ery time laserbased people tracker detects person   field view camera image collected follow•  ing three steps applied                                                          figure  segmentation persons image      segmentation size rectangular area im• grabbed camera robot left image sim•       age containing person determined          ilarity segments data base prototypes right      feature extraction compute color histogram image        area selected previous step      database matching determine likelihood incorporate similarity measure provided vi•       particular person compare histogram computed sion hmm person simply multi•       step  prototypes existing database ply likelihoods provided laser tracking   determine area image corresponding feature similarity measure query histogram   detected laser tracking rely accu segment data base prototype person       perception 
