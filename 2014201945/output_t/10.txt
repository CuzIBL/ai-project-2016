                   depth estimation using monocular stereo cues                             ashutosh saxena jamie schulte      andrew ng                                       science department                                  stanford university stanford ca                                   asaxenaschulteangcsstanfordedu                        abstract      depth estimation vision robotics      commonly stereo vision stereop      sis images cameras used      triangulate estimate distances      numerous monocular visual cues—      texture variations gradients defocus      colorhaze etc—that heretofore little figure  images taken stereo pair cameras      exploited systems cues ap depthmap calculated stereo colors      ply regions texture stereo depthmap indicate estimated distances camera      work poorly paper apply      markov random field mrf learning algorithm                                                        defocus colorhaze etc—that contain useful important      capture monocular cues                                                        depth information humans perceive depth      corporate stereo show                                                        seamlessly combining stereo monocular      adding monocular cues stereo triangulation                                                        cues work depth estimation focused stereo      ones obtain signiﬁcantly accurate depth                                                        vision algorithms require multiple images      estimates possible using monocular                                                        structure motion forsyth ponce       stereo cues holds true large vari                                                        depth defocus klarquist et al       ety environments including indoor environ      ments unstructured outdoor environments    paper look monocular cues sin      taining treesforests buildings approach gle image incorporated stereo estimat      general applies incorporating monocular ing depth single image using monocular cues requires      cues offtheshelf stereo signiﬁcant prior knowledge                                                        intrinsic ambiguity local image features depth                                                        variations addition believe monocular cues                                                        purely geometric stereo cues largely orthogonal    introduction                                       complementary types information depth  consider problem estimating depth images stereo cues based difference images  taken pair stereo cameras fig  com depend content image images  mon approach doing stereopsis stereo vision entirely random generate pattern dis  depths estimated triangulation using im parities random dot stereograms blthoff et al   ages past decades researchers developed hand depth estimates monocular cues  good stereo vision systems scharstein szeliski entirely based prior knowledge environment   review systems work global structure image examples  environments stereo vision fundamentally limited beautifully engineered stereo systems literature  baseline distance cameras speciﬁ goal work directly improve compare  cally depth estimates tend inaccurate dis systems instead goal investigate  tances considered large small triangu monocular cues integrated reasonable stereo  lationangle estimation errors translate large errors hopefully obtain better depth estimates  distances stereo vision tends fail texture stereo  regions images correspondences reli depth estimation monocular cues difﬁcult task  ably                                           requires account global structure    stereotriangulation cues numerous image saxena et al applied supervised learn  monocular cues—such texture variations gradients ing problem estimating depth single monocular                                                    ijcai                                                    images unconstrained outdoor indoor environments  michels et al  used supervised learning estimate  distances obstacles application driving figure  ﬁlters used computing texture variations  mote controlled car autonomously methods shape gradients ﬁrst  laws’ masks   shading zhang et al  rely purely photometric oriented edge ﬁlters  properties assuming uniform color texture  applicable unconstrainedtextured images distribution direction edges help indicate  consider delage et al  generated models depth  image indoor scenes containing walls ﬂoor monocular cues based prior knowl  hoiem et al  considered monocular recon edge example humans remember structure  struction focused generating visually pleasing graphi particular shape building sky blue grass green trees  cal images classifying scene sky ground vertical grow ground leaves  planes accurate metric depthmaps        cues help predict depth environments similar    building saxena et al approach based seen cues rely  incorporating monocular stereo cues modeling “contextual information” sense global  depths relationships depths different points properties image inferred small im  image using hierarchical multiscale markov ran age patches example occlusion determined  dom field mrf mrfs variants workhorse look just small portion occluded object al  machine learning successfully applied local information texture colors  numerous applications local features insufﬁ patch information depth usu                                               cient contextual information used taking ally insufﬁcient accurately determine absolute depth  supervised learning approach problem depth esti need look overall organization  mation designed custom scanner collect training image estimate depths  data comprising large set stereo pairs corre  sponding groundtruth depthmaps using training set  stereo cues  model posterior distribution depths given each eye receives slightly different view world  monocular image features stereo disparities stereo vision combines views perceive depth  learning mrf model approximate map posterior object projected different locations reti  inference tractable linear programming        nae cameras case stereo depending    depthmaps estimated single monoc distance object retinal stereo disparity varies  ular images demonstrate combining monocu object distance inversely proportional dis  lar stereo cues model obtain signiﬁcantly tance object disparity effective cue  accurate depthmaps possible small depth differences large distances  demonstrate large variety environments includ  ing indoor environments unstructured outdoor envi  features  ronments containing treesforests buildings                                                          monocular features    visual cues depth perception                   approach divide image small rectangu                                                        lar patches estimate single depth value each patch  humans use numerous visual cues depth perception similar saxena et al use types fea  grouped categories monocular tures absolute features—used estimate absolute depth  stereo loomis                                 particular patch—and relative features use    monocular cues                                   estimate relative depths magnitude difference                                                        depth patches chose features cap  humans amazing ability judge depth sin ture three types local cues texture variations texture gra  gle image using monocular cues tex dients color convolving image  ﬁlters  ture variations gradients occlusion known object sizes  laws’ masks  oriented edge ﬁlters  color ﬁlters  haze defocus loomis  blthoff et al  fig  saxena et al  saxena et al cues haze generate absolute features computing sum  sulting atmospheric light scattering defocus blur squared energy each  ﬁlter outputs each  ring objects focus local cues esti patch local image features centered patch  mate depth dependent local image proper sufﬁcient attempt capture global information  ties objects’ textures appear different depending  distance texture gradients capture textured environments welldeﬁned                                                        edges texture gradient generalization edge directions    examples include text segmentation lafferty et al im example grass ﬁeld viewed different distances  age labeling et al  kumar hebert  smooth different distribution edges  ing disparity compute depthmaps stereo vision tappen neighbor patches image display similar features  freeman  mrf learning intractable general humans perceive parts object  model trained using pseudolikelihood similar depth values                                                    ijcai                                                    figure  absolute depth feature vector patch includes immediate neighbors distant neighbors  larger scales relative depth features each patch compute histograms ﬁlter outputs    using image features extracted multiple spatial scales  patch  neighboring patches fig   results absolute feature vector    ∗  ∗     dimensions relative features use bin histogram  each ﬁlter output pixels patch giving   ∗    values yi each patch  features edge patch difference  yij  yi − yj    disparity stereo correspondence  depth estimation using stereo vision images taken  cameras separated baseline distance involves  three steps establish correspondences  images calculate relative displacements called  “disparity” features each image finally  termine depth feature relative cameras figure  multiscale mrf model modeling relation  using knowledge camera geometry               features depths relation depths    stereo correspondences reliable estimates dispar scale relation depths different scales  ity large portions image featureless   scales subset edges shown  correspondences accu  racy depends baseline distance cameras  general given baseline distance cameras cameras algorithm allow subpixel interpolation accu  accuracy decreases depth values increase racy  pixels disparity use fairly  cause small errors disparity translate huge errors basic implementation stereopsis ideas paper  depth estimates limit distant objects just readily applied better  observable disparity depth estimation generally fails stereo systems  empirically depth estimates stereo tend  reliable depth exceeds certain distance      probabilistic model    stereo ﬁnds good feature correspondences  tween images rejecting pixels little texture learning algorithm based markov random field  correspondence ambiguous mrf model incorporates monocular stereo fea  use sumofabsolutedifferences correlation metric tures models depth multiple spatial scales fig   score ﬁnd correspondences forsyth ponce  mrf model discriminative models depths                                                        function image features dx depth    patches each spatial scale arranged grid particular patch depends monocular features  equally sized nonoverlapping regions cover entire image patch stereo disparity related depths  use  scales experiments                   parts image example depths    formally reject feature best match adjacent patches lying building highly cor  signiﬁcantly better matches search window related model relation depth                                                    ijcai                                                                                         ⎛        ⎛                                                            ⎞⎞                                                                                                                                  m         −                 −                     −                                            ⎝       ⎝di  distereo  di  xi θr            dis  dj ⎠⎠                 pgdx θ σ    exp   −                                                                                                     zg                   σ  stereo           σr                       σrs                                                                              j∈nsi                                           ⎛      ⎛                                                         ⎞⎞                                                                                                                                     m       −               −                  −                                                ⎝      ⎝  di  distereo di  xi θr             dis  djs ⎠⎠                     pldx θ λ    exp   −                                                                                                        zl                  λistereo         λr                      λrs                                                                                 j∈nsi                                                                                                                        patch neighbors multiple spatial scales σg  pixels used                                                                    estimate σdstereo note σdstereo func                gaussian model                                   tion estimated depth speciﬁcally captures              ﬁrst propose jointly gaussian mrf eq  parame fact variance depth estimates larger distant ob                                                                    jects closer ones              terized θ σwedeﬁnedis  depth                            ∈                    patch iat scale     constraint dis  given new test image map inference depths                                    depth higher scale                j∈insi dj                             derived closed form              constrained average depths lower scales              nsi  neighbors including patch  laplacian model              scale total number patches image second model eq  replace terms              lowest scale xi absolute feature vector patch                                                                     terms results model parameterized θ              distereo depth estimate obtained disparity zg λthelaplacian spread parameters instead gaussian              normalization constant                           variance parameters ml parameter estimation                ﬁrst term exponent eq  models rela laplacian model intractable learn parameters              tion depth estimate stereo disparity following analogy gaussian case saxena et al              second term models relation depth motivation using terms threefold              multiscale features single patch term                                                                    histogram relative depths di − dj close lapla              places soft “constraint” depths smooth ﬁrst cian distribution empirically suggests better              estimate θr parameters eq  maximizing modeled second laplacian distribution heav                                               ditional likelihood pd θr training data keeping ier tails robust outliers image              σ constant saxena et al achieve selective                                                                   features errors trainingset depthmaps collected              smoothing modeling “variance” term σrs laser scanner section  gaussian              nominator term linear function patches                                                                   model generally unable depthmaps sharp              j’s relative depth features yijstheσr term gives edges contrast laplacians tend model sharp transi              measure uncertainty second term learn tionsoutliers better section  given new test im              linear function features xi motivated age map posterior inference depths tractable              observation cases depth reliably es easily solved using linear programming lp              timated local monocular features case              rely neighboring patches’ depths stereo              cues infer patch’s depth                           experiments                                                                      laser scanner              modeling uncertainty stereo                                                                    designed scanner collect stereo image pairs              errors disparity modeled gaussian das                                                                    corresponding depthmaps fig  scanner uses              ahuja  heaviertailed distribu                                                                    sick laser device gives depth readings vertical              tion szelinski  speciﬁcally errors dispar    ◦                                                                    column  resolution collect readings              ity main causes assuming uniqueperfect corre                                                                    axis left right mounted sick laser              spondence disparity small error image noise                                                                    panning motor motor rotates each vertical scan              including aliasingpixelization modeled                                                                    collect laser readings vertical column              gaussian occasional errors correspondence causes ◦                                                                     horizontal angular resolution depthmap later              larger errors results heavytailed distribution                                                                    constructed using vertical laser scans motor readings              disparity szelinski                                                                     known position pose laser device cam                estimate depths log scale                                                      logcg          eras laser range ﬁnding equipment mounted              disparity camera parameters determining cifthe                                                                    lagr learning applied ground robotics robot              standard deviation σg computing disparity stereo              images image noise standard devi xvarx derived second order taylor series approx                                           ation depths σdstereo ≈ σgg stereo imation fx                                                                                                                                              envisage obtaining better estimate σg                                 work directly use distereo stereo cue sax function match metric used during stereo correspon              ena et al  use library features created stereo dence scharstein szeliski  normalized sum              depths cues identifying grasp point objects squared differences learning σg function disparitytexture                using delta rule statistics varfx ≈  based features                                                                ijcai                                                                figure  results varied set environments showing image stereo pairs column  ground truth depthmap  collected laser scanner column  depths calculated stereo column  depths predicted using monocular cues  column  depths predicted using monocular stereo cues column  row shows color scale  representation depths closest points  farthest best viewed color                                                      ijcai                                                    
