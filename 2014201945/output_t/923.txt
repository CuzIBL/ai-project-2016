        common sense based joint training human activity recognizers               shiaokai wang      william pentney                   tanzeem choudhury                     anamaria popescu                             matthai philipose                   university washington                           intel research                          abstract                          used daytoday activities common deployment                                                        conditions people use kettles cups teabags      given sensors detect object use commonsense   making tea possible specify broadly applicable prior      priors object usage activities reduce models activities simply lists objects used      need labeled data learning activity models forming priors speciﬁed hand      useful understand ob mined automatically web perkowitz et al       ject used action performed given simple models priors unlabeled traces      show add personal sensor data ac objects used enduser activities technique learning      celerometers obtain little label sparse labels em used produce cus      ing feature selection overhead synchroniz tomized models peractivity labeling wyatt et al      ing personal sensor data objectuse data       possible use easily speciﬁed commonsense      models minimize labeling overhead      object use promising ingredient general low      combining generative common sense model      overhead indoor activity recognition approach      activity discriminative model actions limitations instance important discern      automate feature selection observed activity  aspects activities door opened      data automatically trained action classiﬁers closed indistinguishable object identity       precisionrecall  actions adding ac practical tag objects microwaveable objects      tions pure objectuse improves precisionrecall sensors multiple activities use similar objects         activities         clearing table eating dinner way overcome                                                        limitations augment objectuse complemen                                                        tary sensors    introduction                                         wearable personal sensors especially accelerometers  systems capable recognizing range human activity audio provide data body motion surround  useful variety applications key problems ings particularly interesting complement sensors  building systems include identifying small set unobtrusive relatively insensitive environmental condi  sensors capture sufﬁcient data reasoning tions especially accelerometers previous work lester  activities identifying features sensor data relevant et al  bao intille  ravi et al   classiﬁcation task minimizing human overhead shown detect accurately variety simple ac  building models relating feature values activities tivities walking running climbing stairs  traditional approach using vision generic sensor focus use sensors detect ﬁnegrained arm  moore et al  duong et al  proved chal actions using objects “scoop spoon” “chop  lenging difﬁculty identifying robust infor knife” “shave razor” “drink glass”  mative video features sufﬁcient activity recognition note physical motion depends kind action  diverse realworld conditions considerable overhead object used combine actions  providing labeled footage learn models  objectuse data dense sensors accurate    promising recent alternative philipose et al  activity recognition  tapia et al  use dense sensing indi present joint probabilistic model objectuse phys  vidual objects used activities tagged tiny wireless ical actions activities improves activity detection rel  sensors report each object use activities ative models reason separately quantities  represented probabilistic distributions sequences learns action models labeling overhead  object use hidden markov models simple conventional approaches show use joint  models perform surprisingly variety activ prior model speciﬁed declaratively little  ities contexts primarily systems able “common sense” knowledge activity prin  detect consistently objects use objects ciple mined web automatically infer distri                                                    ijcai                                                                                                                                          prata                                                                                  prota    prbto ta tb                                                                                                                                                                                      prmto bt                                                                                          figure  sensors ibracelet msp left rfid tagged       timeslicet            timeslicet  toothbrush  paste right tags circled                                                                                            pra                                                                         dynamicbayesnet     butions labels based objectuse data                      given object “knife” use activity “making                                                                               pro    prb   salad” action “chop knife” quite likely                           fore technique common sense based joint training                         given class labels viola jones  shown                                                                                                             hmm             automatically effectively select relevant features using                                                                                                                      mspbased  boosting adapt scheme work distributions                                 objectaction  labels joint model able perform      b’                    b’    classifier  parameter estimation feature selection little human                                                                                                       boosteddecision  involvement                                                      b’     stumpensemble  b’    evaluate techniques data generated peo                                                                                     ple performing  activities involving  actions  ob         mf’                mf’  jects deﬁned simple commonsense models activi  ties using average  english words activity combin  ing action data objectuse manner increases pre figure  joint models activity action recognition  cisionrecall activity recognition   joint dbn derived layered model used  automated actionlearning techniques yielded  paper dotted arrows represent assignment  precisionrecall  possible objectaction classes map estimate variable layer observed  knowledge work ﬁrst demonstrate simple value  commonsense knowledge used learn classiﬁers  activity recognizers based continuous sensors hu  man labeling sensor data                          accelerometer microphones sampling bit audio khz                                                        irvisible light highfrequency light barometric pressure                                                        humidity temperature compass data roughly    sensors                                             samples second shipped real time  figure  shows sensors use wear bracelets offboard device cellphone currently stores  dominant wrist radio frequency identiﬁca later processing near future hope  tion rfid reader called ibracelet fishkin et al  form processing inference particular realtime  detecting object use personal sensing cellphone compact focus data extract  reader called mobile sensing platform msp lester et   features including mean variance energy  al  detecting arm movement ambient condi spectral entropy fft coefﬁcients cepstral coefﬁcients  tions                                                bandpass ﬁlter coefﬁcients endresult stream     ibracelet works follows rfid tags attached dimensional feature vectors generated hz write  objects toothbrush tube toothpaste fig sn  ssn stream sensor readings  ure  use detected tags small each si paired object vector msp features  cent batteryfree stickers embedded processor  antenna bracelet issues queries tags hz faster  techniques  queried reader cm away each tag responds  using energy scavenged reader signal unique  problem statement  identiﬁer identiﬁer matched separate database let  ai set activity names “making tea”  determine kind object bracelet stores  bi set action names “pour”  oi  timestamped tag ids onboard transmits read tags wire set object names “teabag”  mi  lessly ambient base station lasts   hours set possible msp feature vectors  charges bracelet detects tagged object assume coarse “commonsense” information linking  object deemed use hand proximity objects objects activities actions let oa  oaa ∈    implies object use                                   oa      oona  st oi used    msp includes sensors sixdegreeoffreedom oamake tea kettle milk sugar teabag let                                                    ijcai                                                    boa     bao  bbmao ∈ ∈     given initial guesses derivable oa boa  oa st bi performed using object conditional probabilities problem jointly  make tea milk pour pick            estimating parameters estimating mo se    monitoring peoples’ daytoday activities relatively lecting small discriminatory subset features based  easy large quantities unlabeled sensor data sn partially labeled data viewed semisupervised  ting labeled data harder follows assume structure learning problem traditionally solved structural  labeling data finally training data variants em friedman  structural em  consist synchronized objectuse personal sensor known difﬁcult apply tractably effectively  data test data contain just expect end trade potential gain learning joint model  users transition areas rfid simplicity layered model  strumentation    given domain information observed data  layered model  wish build classiﬁer msp data         figure shows layered model use new struc    • infers current action performed object ture motivated fact recent work viola jones      performed                    lester et al  shown tractable effec                                                        tive way automatically select features “sea pos    •                                 combines objectuse data available sible features” boost ensemble simple classiﬁers                                               produce better estimates current activity     sequentially possible features new model    • efﬁciency reasons uses   features replaces node original dbn separate dis                                                        criminative classiﬁer smoothed hmm classiﬁcation    joint model                                    layered structure proceeds follows  dynamic bayesian network dbn figure cap   each time slice  features fed  tures relationship state variables  boosted classiﬁer described obtain  dashed line ﬁgure separates variables represent likely current actionobject pair b∗  classiﬁ  ing state adjacent time slices each cation obtained prone transient glitches  node time slice graph represents random variable passed level smoothing  capturing state time slice activity  action currently progress msp data  hmm simple temporal smoother actions                                                          hidden states smoothed action estimates  object   currently observed directed edges                                b∗  inserted each random variable node induced observations unsmoothed output en                                                            semble classiﬁer map sequence smoothed ac  graph independent nondescendants given parents            ∗                                                            tionobject pairs bs passed layer ob  each node xi parameterized conditional probability                                                            servations hmm set uniform observation  distribution cpd xiparentsxi joint distribution  Π                                probability uniform high selftransition probability                  parents                      dbn encodes following independence assump       just require action classiﬁcation msp data  tions each time slice                             threshold smoothed class margin mar                                                            gin exceeds threshold tsmooth set hand    msp signal independent ongoing ac    classes report class report “unknown”      tivity given current object action bfor      instance hammering nail action “hammer” object  wish combine inferred action object      “nail” yield accelerometer audio sig data predict activity pass smoothed action      natures regardless you’re ﬁxing window class dbn dbn level trun                                                          cated version described previously treats      hanging picture hand directly                         b∗                                                        action observations ﬁnds      dependent    particular hand mo                           tion varies action “pull” depending object likely activity       “door” object “laundry line” pulled simi inference requires parameters dbn known      larly pulling door entails different motion push commonsense information oa boa      ing                                           verted crude estimate conditional probabilities                                                        dbn follows    action depends unconditionally current ac                     −p                                                          • oa      ∈ oa      tivity object currently use instance        na      o−na essentially      activity “making pasta” probability action divide probability mass typically        “shake” depend using object   likely objects divide remainder      “salt shaker” “pot” similarly object “pot” unlikely ones      probability action “scrub” depend            p             −p                                                          • bta     ∈ bao            activity “making pasta” “washing dishes”                mao           b−mao                                                            note mao na deﬁned section     object used directly dependent activity                                                          •                     −       particular action generic   t−     a− t−    tand            “lift” use object “iron” signiﬁcantly increases wise temporal smoothing encourages activities      probability activity “ironing”                continue adjacent time slices                                                    ijcai                                                        initialize weights wi                 make tea       iterate                                eat cereal       lift mouth                                                             make sandwich    scoop       tfms ←ﬁtw  features           ←       ic                        make salad       chop        fm      ic ic      fm                         dust             spread          ∗       ←  arg minf efm                                   brush teeth      dust                                                             tend plants      brush       αm ← log  − ef ∗mef ∗m                                                            set table        wipe horizontally         ←         α  ic  ∗             ic exp                           clean windows    wipe vertically       renormalize wi                                medication  drink      output                                               shave            shave                                                          shower       sarg maxc   αmic   tf ∗ms                                                              table  activities actions performed      whereﬁtw           ←    wipisif wipi                                                             action precision action recall activity precision activity recall      t− ←     wipi−sif   wipi−                                                                ←  t−                                                                    return λs  sgns − sgnt − −                                                                                                                                          table  virtualboost algorithm                                                                                                                                                                                                                           percent   correct  hyperparameters     currently selected         hand change activities classiﬁed ob   served data crude estimates treated priors                                                                parameters dbn reestimated unlabeled                                                                 data sn using em semisupervised parameter learn         noa    noa  ing schemes                                                            size data set observations    remains learn boosted classiﬁer ap      figure  overall precisionrecall  proach viola jones  scheme  ventional boostingbased scheme requires labeled examples                                        sn  given unlabeled msp data  need ror attributing weight αm classiﬁer high  augment usual scheme simple way errors result low weights reweighting examples  maplabel use objectuse data                                             focus newly problematic examples virtualboost          dbn derive likely simply replaces computations standard algorithm          bbn                            bioi  sequence          actions treat pair   expect individual class labels ci expectation  label each time step approach potential distribution pic label straightforward  problem actionobject pairs compara show new variant sound sense   ble likelihood step considers toprated pair spcsipicsn pnc sequence  label ignores explore input virtualboost yields classiﬁer  “sam                                                                        alternate form feature selection algorithm called vir ple sequence”  sici sicisicik   tualboost works data labeled label distributions cij samples picwhenfedtotheconven  individual labels use dbn objectuse tional algorithm produce classiﬁer large  data generate marginal distribution each time  slice refer technique marginallabel  evaluation methodology  boosted classiﬁer trained using “virtual evidence”  pearl  virtualboost allows trainer consider evaluation focuses following questions  possible labels proportion weight           good learned models particular    table  speciﬁes virtualboost simplicity assume better models activity action infor  classes algorithm generalizes multiple mation combined good action models  classes standard algorithm recovered  setting pic  removing sums classes                                     ≤                   does classiﬁer performance vary design  goal algorithms identify features  choices hyperparameters  corresponding singlefeature multipleclass classiﬁers tf ∗m  weights αm weighted combination classiﬁers  necessary sophisticated aspects  maximally discriminative                              design simple techniques    standard algorithm works each iteration mﬁt answer questions collected ibracelet msp  ting classiﬁers tfm each feature labeled data data researchers performing  activities containing  weighted focus previously misclassiﬁed examples iden  distinct actions using  objects instru  tifying tf ∗m classiﬁer minimizes weighted er mented apartment activities derived state                                                    ijcai                                                                                                                                          precision  recall                                                                                                                                                                                                                                                                                              precision                      percent   correct                                                                                                                                                                                                                                                                                          recall                                            activity  action class                                                              figure  precisionrecall vs margin threshold            figure  precisionrecall breakdown                                                          observations  io  assumes msp observa  mandated activities daily living adl list monitoring tions action classiﬁer addition each conﬁgu  activities elder care professionals ration report pr activity action detection  executions each activity recorded pe conﬁguration yields similar results sowe  riod weeks ground truth recorded using video focus  each sensor data frame annotated postpass three points key comparing corresponding  actual activity action during frame bars activity adding msp data does  designated “other”                            improve overall pr   second    table  lists activities actions performed each ac action classiﬁer based msp data  pr given  tivity followed number tagged objects  underlying actionobject classes fairly  number actions labeled activity making evenly represented data far better naive  tea tagged  objects spoon kettle tea milk sugar guesser low precision reﬂects automaticallytrained  saucer tracked action scoop spoon classiﬁer’s inability identify action  restricted action activity al happening  false positives mislabeled “other”  work multiple actions slots relatively high action pr  just  tag multiple objects activity  activities make tea objects reveals limitation dataset  eat cereal make salad make sandwich set table clean win objectuse data available possible predict cur  dow share object activity note rent action additional msp data  work list track ex dataset each activityobject combination action  haustively objects actions activity associated guessing action given activityobject  important consideration practical       fairly easy    experiments trained classiﬁed unseg figure  breaks pr case activ  mented sensor data using leaveoneout crossvalidation ities  actions  main point  activities trained instances each unfortunately apparent ﬁgure interaction  activity tested rotated left object mspbased sensing combining  report aggregate statistics time slices sensors yields jump recall     respec  labeled “other” actions activities use tively detecting activities     respectively  precision fraction slices claim correct activity deteriorating cases activities involved  recall fraction slices detected non”other” shared objects actions helpful ac  class correctly cases report measure tivity  making salad particularly hard hit  prp     standard aggregate goodness measure objects used knife bowl used activities  precision recall               solving ambiguity improves pr sole action asso                                                        ciated making salad     results                                              figure  shows pr action detection changes                                                        margin threshold tsmooth section  varies    figure  displays overall activityaction detection preci use tsmooth  − section varied boost  sionrecall pr conﬁgurations each ing iterations      best matching  ﬁguration form oa attempts  pr rates       detect activities  table  detects use    io conﬁguration assume just rfid figure  compares virtualboost simpler approaches                                                    ijcai                                                    
