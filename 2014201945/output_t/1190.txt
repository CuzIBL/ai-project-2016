                           dynamic probabilistic relational models                               sumit sanghai pedro domingos daniel weld                              department science engineeering                                           university washington                                            seattle wa                                   sanghaipedrodweldcswashingtonedu                          abstract                          human beings paper addresses problems                                                          introducing extension dbns exposes domains      intelligent agents function uncertain world relational structure developing methods efficient     containing multiple objects relations change inference representation     time unfortunately representation currently formalisms represent objects relations op•    available handle issues allowing posed just variables long history ai recently     principled efficient inference paper ad• significant progress combining     dresses need introducing dynamic probabilistic principled treatment uncertainty particular probabilis•    relational models dprms dprms extension    tic relational models prms friedman et al      dynamic bayesian networks dbns each time  extension bayesian networks allows reasoning     slice dependences previous slices repre• classes objects relations representation intro•    sented probabilistic relational model prm parti• duce paper extends prms sequential problems     cle filtering standard method inference dbns way dbns extend bayesian networks     severe limitations applied dprms dynamic probabilistic relational models dprms     able greatly improve performance through develop efficient inference procedure dprms     form relational raoblackwellisation gains adapting raoblackwcllised particle filtering stateofthe    efficiency arc obtained through use abstrac• art inference method dbns murphy russell      tion trees novel data structure successfully apply introduce abstraction trees data structure reduce     dprms execution monitoring fault diagnosis computational cost inference dprms     assembly plan complex product gradu• early fault detection complex manufacturing processes     ally constructed subparts                      greatly reduce cost paper apply dprms                                                          monitoring execution assembly plans show    introduction                                         inference methods scale problems thou•                                                         sand objects thousands steps domains   sequential phenomena abound world uncertainty envisage dprms useful include robot control vi•  common feature currently power• sion motion language processing computational modeling   ful representation available phenomena dynamic markets battlefield management cell biology ecosystem   bayesian networks dbns dean kanazawa   modeling web   dbns represent state world set variables rest paper structured follows   model probabilistic dependencies variables sections briefly review dbns prms introduce   time steps major advance previ• dprms methods inference following   ous approaches dbns unable compactly represent section reports experimental study assembly plan   realworld domains particular domains contain monitoring paper concludes discussion related   multiple objects classes objects multiple future work   kinds relations objects relations   appear disappear time example manufactur•  dynamic bayesian networks   ing plants assemble complex artifacts cars computers   aircraft large numbers component parts using mul• bayesian network encodes joint probability distribu•  tiple kinds machines operations capturing do• tion set variables directed acyclic   main dbn require exhaustively representing graph set conditional probability models each node   possible objects relations raises corresponds variable model associated   problems computational cost us• allows compute probability state vari•  ing dbn likely prohibitive second able given state parents set parents   reducing rich structure domain large denoted set nodes arc   flat dbn render essentially incomprehensible graph structure network encodes                                                                                   probabilistic inference sertion each node conditionally independent weighted distribution particles tend stay   nondescendants given parents probability ar• clustered probable regions state space ac•  bitrary event computed                  cording observations                                                            particle filtering scored impressive successes     dynamic bayesian networks dbns extension practical applications significant   bayesian networks modeling dynamic systems dbn limitations particular concern   state time represented set random variables tends perform poorly highdimensional state spaces                        state time dependent number particles required main•  states previous time steps typically assume tain good approximation state distribution grows   each state depends immediately preceding state rapidly dimensionality problem greatly   firstorder markovian need attenuated analytically marginalizing vari•  represent transition distribution    ables technique known raoblackwellisation murphy   using twotimeslice bayesian network fragment russell   suppose state space divided   tbn  contains variables subspaces   parents variables andor variables   computed analytically efficiently      parents typically assume need sample smaller space  requiring far fewer   process stationary transition models time particles obtain degree approximation each   slices identical                           particle composed sample   dbn defined pair bayesian networks     plus parametric representation   represents initial distribution pzo example variables discrete independent   twotimeslice bayesian network discussed each given store each variable vector   defines transition distribution                    parameters corresponding multinomial distribution     set commonly divided sets unob• probability each value   served state variables observed variables    observed variables assumed depend cur•  probabilistic relational models   rent state variables  joint diwstribution represented   dbn obtained unrolling tbn      relational schema set classes                                                          each class associated set propositional                                                          attributes set relational attributes refer•                                                         ence slots  propositional attribute class                                                          denoted ca domain assumed finite denoted                                                          vca relational attribute denoted cr                                                          domain power set target class     various types inference dbns possible words cr set objects belonging   useful state monitoring known filtering class example aircraft schema used   tracking goal estimate current state represent partially completely assembled aircraft   world given observations present classes corresponding different types parts like metal   compute distribution proper state                  sheets nuts bolts propositional attributes bolt   monitoring necessary precondition tor rational decision• include color weight dimensions rela•  making dynamic domains inference dbns np    tional attributes include nut attached   complete resort approximate meth• metal sheets bolting instantiation schema   ods widely used particle filter set objects each object belonging class   ing doucet et   particle filtering stochas• propositional relational attributes each object   tic algorithm maintains set particles samples specified example instantiation aircraft schema                approximately represent distribution particular airplane parts properties   possible states time given observations each parti• arrangement specified   cle contains complete instance current state probabilistic relational model prm encodes proba•  sampled value each state variable current distribution bility distribution set possible instantiations    approximated                                schema friedman et al  object skeleton                                                          instantiation set objects attributes                                                          unspecified relational skeleton instantiation                                                          set objects relational attributes specified                                                          propositional attributes unspecified simplest case    state represented byis       relational skeleton assumed known prm spec•     particle filter starts generating tv ifies probability distribution each attribute each   particles according initial distribution class parents each attribute variables   each step generates state each parti• depends attributes attributes   cle sampling weights   samples according likelihood assign ob• lcr defined function   servations resamples particles             choose simpler convention       probabilistic inference                                                                                 classes related slot chain slot chain    composition relational attributes general   used aggregation function reduces    variable number values single value example   parent attribute bolt aircraft schema   avgboltplatenutweight average weight nuts   metal plates bolt attached    definition  probabilistic relational model prm ii   relational schema defined follows each class   each propositional attribute €                                                              dprms extended case object                                                          skeleton each time slice known way                                                          prms adding definition  set parents con•                                                         ditional probability model each relational attribute                                                          parents previous time slice                                                          object skeleton known objects                                                          appear disappear time tprm includes ad•                                                         dition boolean existence variable each possible object                                                          parents previous time slice                                                          dbns wish distinguish observed                                                          unobserved attributes objects addition wc con•    prm relational skeleton unrolled sider action class single attribute domain   large bayesian network variable each attribute set actions performed agent   each object skeleton prms correspond painting metal plate bolting plates   bayesian networks cycles valid         distribution instantiations time slice de•    generally object skeleton known pend action performed time slice example   case prm needs specify distribution action high probability pro•  relational attributes getoor et al  air• duce lower probability set   craft domain prm specify distribution jmate object parts class im•  state assembly airplane probabilities differ• properly performed resulting fault   ent faults bolt loose wrong plates just prm unrolled bayesian network   bolted                                         dprm unrolled dbn note                                                          dbn general contain different variables dif•   dynamic probabilistic relational models              ferent time slices principle perform inference   section extend prms modeling dynamic sys• dbn using particle filtering filter   tems way dbns extend bayesian networks likely perform poorly nontrivial dprms   begin observation dbn viewed state space huge contain variable   special case prm schema contains class each attribute each object each class relational   propositional attributes za single rela• attributes general large domains over•                                                         come adapting raoblackwellisation relational   tional attribute previous object zt each time   slice previous attribute connects object setting make following strong assumptions   previous time slice given relational schema  relational attributes unknown values appear   extend each class relational attribute cprevious dprm parents unobserved at•  domain initially assume re• tributes slot chains   lational skeleton each time slice known                                                          each reference slot occupied object   define twotimeslice prms dynamic prms follows                                                          proposition  assumptions   imply given                                                         propositional attributes known relational attributes                                                         times —  joint distribution unobserved                                                         relational attributes time product multinomials                                                         each attribute                                                            notice assumption  unobserved proposi•                                                        tional attributes sampled regard unobserved                                                         relational ones raoblackwellisation applied                                                              notice attributes nonexistent objects need      plus auxiliary deterministic variables required aggre• specified definition attributes objects   gations omit formula simplicity depend getoor et al                                                                                      probabilistic inference propositional attributes objects  experiments   relational attributes raoblackwellised particle section study application dprms fault   composed sampled values propositional attributes detection complex assembly plans use modified ver•  objects plus probability vector each relational at• sion schedule world domain aips plan•  tribute each object vector element corresponding                                                          ning competition problem consists generating plan           probability relation holds obj assembly objects operations painting pol•  zth object target class conditioned values ishing each object attributes surface type   propositional attributes particle  color hole size add relational operations     raoblackwellising relational attributes vastly re• domain bolting welding assume actions   duce size state space particle filtering needs faulty fault model described experi•  sample relational skeleton contains ments generate plan using ff planner hoff•  large number objects relations storing updating mann nebel  monitor plans execu•  requisite probabilities quite expen• tion using particle filtering pf raoblackwellised particle   sive ameliorated contextspecific independen• filtering rbpf rbpf abstraction trees   cies exist relational attribute independent consider three classes objects plate bracket   propositional attributes given assignments values oth• bolt plate bracket propositional attributes   ers boutilier et aly  replace vector weight shape color surface type hole size hole type   probabilities tree structure leaves represent relational attributes parts welded   probabilities entire sets objects precisely de• bolts bolting parts platebolt corre•  fine abstraction tree data structure relational attribute sponds fourth bolt hole plate  bolt class   objr target class  follows node tree propositional attributes size type weight propo•  composed probability logical expression sitional actions include painting drilling polishing   propositional attributes schema let change propositional attributes object rela•  set objects satisfy tional action bolt sets bolt attribute plate bracket                                                          object bolt object weld action sets weldedto at•                                                         tribute plate bracket object plate bracket                                                          object                                                            fault model global parameter fault proba•                                                         bility  probability   action produces                                                          intended effect probability  possible                                                          faults occurs propositional faults include painting oper•                                                         ation completed wrong color used                                                          polish object ruined probability dif•                                                         ferent propositional faults depends properties                                                          object acted relational faults include bolting                                                          wrong objects welding wrong objects proba•                                                         bility choosing particular wrong object depends                                                          similarity intended object similarity depends dif•                                                         ferent propositional attributes different actions differ•                                                         ent classes objects probability particular                                                          wrong object chosen uniform objects                                                          relevant attribute values                                                            dprm includes following observation model                                                          instances each attribute true                                                          observed observed observed                                                          selected time steps specifically action per•                                                         formed attributes objects involved ob•                                                         served observations noisy proba•                                                         bility true value attribute observed                                                          probability incorrect value observed incorrect                                                          values propositional observations chosen uniformly                                                          incorrect values relational observations chosen                                                          probability depends similarity incorrect                                                          object intended                                                            notice domain consisted exclusively                                                          propositional attributes actions exact inference                                                          possible dependence relational at•                                                         tributes observations propositional attributes                                                              url httpwwwcstorontoeduaips       probabilistic inference                                                                                 creates complex dependencies making ap•  proximate inference necessary      natural measure accuracy approximate infer•  ence procedure kl divergence distribu•  tion predicts actual cover thomas    computing requires performing exact inference   nontrivial dprms infeasible estimate   kl divergence sampling follows let   kl divergence true distribution   approximation let domain   distribution defined                                                              figure  comparison rbpf  particles pf                                                           particles  objects varying fault prob•  term simply entropy hx ability   constant independent approximation method   mainly interested measuring differences perfor•  mance approximation methods term ne•  glected kl divergence approximated   usual way taking samples true distribution       probability zth sample according   approximation procedure subscript indi•  cates estimate offset hx   evaluate accuracy pf rbpf dprm   generating   sequences states observations   dprm passing observations particle fil•  ter inferring marginal probability sampled value   each state variable each step plugging values   formula averaging variables notice figure  comparison rbpf  particles pf   sampled value rep•               particles fault probability  varying   resented particle empirical estimates kl number objects   divergence obtain optimistic sense   true kl divergence infinity estimated   finite unless values zero predicted kl divergence rbpf increases slowly                                                         combinations parameters tried abstraction trees reduced   probability sampled does preclude meaningful                                                          rbpfs time memory factor   took   comparison approximation methods                                                         average times longer  times memory pf   average worse method produce                                                         particle note ran pf  times   earlier time sequence report average                                                         particles rbpf rbpf using time   kl divergence infinity time step                                                         memory pf performing far better accuracy   infinity                                                            ran experiments measuring kl     figures   show results experiments per• divergence joint distribution state op•  formed observation noise parameter set posed just marginals rbpf performed better   value fault probability action compared pf case tends blow   performed each time step number time steps sooner step     length plan graphs show kl divergence   objects rbpf continues de•  pf rbpf th step rbpf grade slowly   abstraction trees graphs interrupted   point kl divergence infinite   runs infinite kl divergence  related work   went finite runs point dynamic objectoriented bayesian networks doobns   labeled average time step blowup oc• friedman et al  combine dbns oobns pre•  curred seen pf tends diverge rapidly decessor prms unfortunately efficient inference                                                                                       probabilistic inference 
