                              learning walk through imitation              rawichote chalodhorn david grimes keith grochow rajesh rao                                          neural systems laboratory                               department science engineering                                          university washington                                       seattle wa  usa                           email choppygrimeskeithgraocswashingtonedu                         abstract                          achieve stable walking gait learning approaches                                                         reinforcement learning sutton barto         programming humanoid robot walk chal      lenging problem robotics traditional ap      flexible adapt environmental change       proaches rely heavily prior knowledge   methods typically directly applicable humanoid       robots physical parameters devise sophisticated robots curse dimensionality problem engen      control algorithms generating stable gait dered high dimensionality fullbody joint space       paper provide knowledge robot        demonstration humanoid robot learn             walk directly imitating human gait obtained         motion tracking         low dimensional subspace       motion capture mocap data training using                                     representation       human motion capture intuitive flexible       approach programming robot direct usage         mocap data usually results dynamically                            stable motion furthermore optimization using          kinematics mapping      mocap  data humanoid fullbody jointspace       typically intractable propose new model      free approach tractable imitationbased learning  learning complex task  robot dynamics compensa                                                                                                       humanoids represent kinematic information                                        tion      human motion capture low dimensional       subspace map motor commands low      dimensional space sensory feedback learn       predictive dynamic model model used       optimization framework estimate op      timal motor commands satisfy initial kine figure  framework learning human behavior imitation       matic constraints best possible through sensorymotor mapping reduced dimensional spaces       time generating dynamically stable motion       demonstrate viability approach       paper propose modelfree approach       providing examples dynamically stable walking  achieving stable gait acquisition humanoid robots       learned mocap data using simulator    imitation framework method shown figure       real humanoid robot                         motion capture transforms cartesian posi                                                        tion markers attached human body joint angles    introduction                                        based kinematic relationships human                                                         robot bodies employ dimensionality reduction   imitation important learning mechanism bio represent posture information compact lowdimensional   logical systems including humans rao meltzoff  subspace optimization wholebody robot dynamics   easy recover kinematic information human mo match human motion performed low dimensional   tion using example motion capture imitating space particular sensory feedback data recorded   motion stable robot dynamics challenging research robot during motion causal relationship  problem  traditional modelbased approaches based tween actions low dimensional posture space   zeromoment point zmp vukobratovic borovac    expected sensory feedback learned learned sensory   kajita tani   inverted pendulum motor mapping allows humanoid motion dynamics  model yamaguchi et al   require highly accurate optimized inverse mapping reduced space   model robot dynamics environment order original joint space used generate optimized                                                       ijcai                                                    motion robot present results demonstrating analysis pca parameterize lowdimensional motion   proposed approach allows humanoid robot learn subspace  nonlinear dimensionality reduction   walk based solely human motion capture methods used macdorman et al    need detailed physical model robot      grochow et al  standard linear pca                                                         method sufficient classes motion studied     human motion capture kinematic                 paper        mapping                                             result linear pca thought linear                                                         operators map high low low                                                         high dimensional spaces respectively low dimensional                                                                representation joint angle space hoap robot                                                         executing walking gait absence gravity                                                         shown figure                                                                                                                                                                                       figure  kinematic mapping used approach left   right human body human skeleton robot skeleton robot   body respectively                                             paper manually map joint angle data    motion capture kinematic model fujitsu      hoap humanoid robot generate desired motion           sequence robot capture example motions                                                                                                     human subject map joint settings ro                                                                                                          bot  initially set markers attached human sub                                                                                                                   ject positions markers recorded                                                                                              each pose during motion  use vicon optical   running hz set  reflective markers  figure  posture subspace example poses dimensional   recorded marker positions provide set cartesian points reduced space representation postures hoap robot   capture volume each pose  obtain final during walking motion applied linear pca  dimensions   subject poses marker positions assigned po joint angle data robot mapped human kine  sitional constraints character skeleton derive joint matic configuration described section  blue diamonds   angles using standard inverse kinematics ik routines function approximated trajectory represent different      depicted figure  order generate robot joint robot postures during single walking cycle red circles mark                                                         various example poses shown numbered images    angles simply replace human subject’s skeleton    robot skeleton dimensions  example use straightforward standard linear pca method   shoulders replaced three distinct dimensional map low highdimensional posture spaces   rotating joints dimensional ball joint  vectors highdimensional space mapped   ik routine directly generates desired joint angles lowdimensional space multiplication transfor  robot each pose  limitations mation matrix  rows  consist eigenvec  technique motions robot’s                                                         tors computed singular value decomposition svd   joints approximate human pose reasonable                                                         motion covariance matrix svd produces transformed   way interested classes human                                                         vectors components uncorrelated ordered   motion robot handle method proved                                                         according magnitude variance    efficient way generate large sets human motion                                                           example let ×  vector joint angles   data robotic imitation                                                         highdimensional space × vector space      sensorymotor representations                     calculate  space using rcq                                                        × vector principal component coefficients    lowdimensional representation postures          ×  transformation matrix    particular classes motion walking kicking pick three elements  corresponding   reaching object intrinsically lowdimensional three principal components  inverse mapping   apply known method principal components   computed likewise using pseudo inverse                                                        ijcai                                                                                                                                  ∑   xˆˆ ii ×                                                                                                                                                               zθ                         action subspace embedding                                                 ∑   xˆˆ ii ×    highlevel control humanoid robot reduces select                                                                                                                                ing desired angle each joint servo motor discussed xθ chosen align maximal variance  previously operations space robot joint                                                         plane orthogonal zθ  finally yθ specified  angles tend intractable leverage redundancy   posture space use reduced dimensional sub thogonal xθ zθ  final embedded training data   space  constrain target postures desired posture obtained cylindrical conversion rhφ   referred action represented radial distance height xyθθ−  plane   point ∈                                                           φ  angle xy− plane angle φ      periodic movement walking represented                θθ  loop shown figure  general case interpreted phase angle motion    sider nonlinear manifold representing action space given loop topology latent training points   ⊆  nonlinear parameterization action space parameterize   function φ  embed  allows reduction dimensionality embed ded action space represented learned approximation   dimensional representation original motion function   three dimensional posture space use constructing            rh φ                                        constrained search space optimization discussed   section  using feature representation set ini  ≤≤φ π  approximation function  tial training examples xii cz convert each point formed using radial basis function rbf network   representation cylindrical coordinate frame   establishing coordinate frame three basis  learning predict sensory consequences   directions xyzθθθin feature space zero point   coordinate frame empirical mean μ data   actions   points reduced space recenter data central component proposed framework learning   new zero point denote resulting data xˆ    predict future sensory inputs based actions using                                                        learned predictive model action selection goal                                                         predict future sensory state robot denoted                                                           general state space sz ×Ρ  cartesian                                                                                                                   product highdimensional joint space                                                         space percepts Ρ  percepts include                                                         example torso gyroscope accelerometer foot                                                        pressure sensors information camera images                                                         goal learn function  sa×  maps                              xθ                          yθ                           current state action state paper                                                       assume  deterministic                                  zθ                              perceptual state st  sufficient pre                                                        dicting future states cases learn higher                                                         order mapping based history perceptual states                                                                    actions given nth  order markovian function                                                                                                                                                                            st  tn tn                figure  embedded action space humanoid walking gait use radial basis function rbf approximator   training data points reduced posture space shown blue learn sensorymotor experience particular   dots converted cylindrical coordinate frame relative rbf network approximates learning function   coordinate frame xyzθθθ points represented  α   β    function angle φ forms embedded action space   shown redsolidcurve action space represents single                                                                                           −  gait cycle                                                    β  ∑∑w  exp−− αμt      αμ −                                                                                    kk                                                                                           compute principal axis rotation zθ                                       μ      Σ−                                                        represents number kernels                                                         mean inverse covariance thek th kernel respec                                                      ijcai                                                               tively output weight vector wk  scales output   objective function used paper measure              each kernel appropriately input output  torso stability defined following function                                                              gyroscope signals                α   β   respec                   tn tn                             tively convenience instead view rbf                                                                            Γω  λ ωλ ω λ ω                      time delay network lang et al  input           xx    yy   zz                      α                                                    simplifies   satt previous state action                                                             ω ω ω  refer gyroscope signals              puts implicitly remembered network using recur xyz                                                                                              λ  λ λ             rent feedback connections                      axes respectively constants xyz   allow                 paper use secondorder   rbf net weight rotation each axis differently objective              work state vector equal threedimensional function  provides measure stability posture                             ≡ ω             gyroscope signal stt discussed previous during motion secondorder predictive function              section action represents phase angle radius optimization problem searching op                                             ≡∈χ              height data latent posture space   timal stable actions given                                                                               motion optimization using learned                    χ   arg minΓf ω  ω  χ χ                                                                                  tttttχ ∈                         predictive model                                                                                                                                     ⎡⎤φ             algorithm present section utilizes optimiza                                                                                                      ⎢⎥             tion sensory prediction select optimal actions                 ⎢⎥rs                                                                                                 ⎢⎥             control humanoid robot closedloop feedback sce                 ⎣⎦hs             nario figure  illustrates optimization process  allow efficient optimization restrict search               express desired sensory states robot space local region action subspace given              attain through objective function Γs  algo      φ   φφ≤    ε                                                                                tt   φ                     rithm selects actions aa predicted       εε≤≤                                  tt                                         rarsa                      future states ss optimal respect  Γs        εε≤≤                       tt                                                     hah   sa                                    Γ                                                      ε    π                     assaat  arg minf   tn   tn            φ                                                                                                                   rh gφ                                                                                           aa                                    controller                                                                                                                    φ                                                             phase motion command search range begins                                 χ′            ωp              ωmin                                           position phase motion command previous                       optimization                                    model predictor          time step φ  radius search range begins                       algorithm                                                                                                                       point action subspace embedding defined                                                               positive negative directions ra                                 χ                 ω                                                                         ε                                                               distance   search range hs  defined                                     humanoid robot                                              gyroscope signal manner according ε  ex                                                                                                                                                       periments parameters εφ  ε ε  chosen               ω                       χ                                                                min  minimum gyroscope signal  posture command             ωa       actual gyroscope signal               ensure efficiency time allowing reason                                      χ′             ωp       predicted gyroscope signal  tentative posture command able range searching stable postures example                                                              search space walking motion shown figure                                                                  selected actions truly optimal sen             figure  model predictive controller optimizing posture stabil             ity optimization algorithm sensorymotor model pre sorymotor predictor accurate periodically                                                              retrain prediction model based new posture com             dictor produce action ≡∈χ used posture                                                            mands generated optimization algorithm sen             control humanoid robot resulting gyroscope signal sory feedback obtained executing commands              fed predictor retraining optimization algorithm three iterations sensorymotor prediction learning              utilizes predicted gyroscope signal ω order optimize actions                                                            improved dynamically balanced walking gait obtained              posture stability                          trajectory optimized walking gait low di                                                             mensional subspace shown figure                                                                                                                                                                                             ijcai                                                                                                              repeat steps  through  satisfactory gait                                     original data      obtained                                      embed function          search space                                    optimized data  experimental results                                                                   target pattern                                                            final result   scale                                                                               scale                                                                                      scale                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              figure  optimization result walking motion pattern                                                                        lowdimensional subspace based action subspace embed                                                                                                              ding   summarize entire optimization action figure  motion pattern scaling target motion pattern   selection process                              scaled produce stable motion start motion        use pca represent reduced space ini optimization process        tial walking gait data human motion capture        employ nonlinear embedding algorithm pa section explains optimization methodology        rameterization gait                previous section used conjunction mocap        start learning process projecting actions data study motion pattern reduced        original joint space executing corre subspace scale mo       sponding sequence servo motor commands tion pattern similar humanoid motion patterns ex       webots hoap robot simulator webots  cept changes magnitude motion scale                                                   pattern reduced subspace produces        use sensory motor inputs previous                                                   smaller movement humanoid robot resulting       step update sensorymotor predictor                                                  maller changes dynamics during motion strategy        scribed section  state vector given scale pattern dynamically stable        gyroscope signal each axis action motion start learning point apply motion                   φ       variables  lowdimensional sub optimization method section  scaleddown pattern        space                                     dynamic performance reaches optimal point        use learned model estimate actions according scale trajectory optimization result        model predictive controller framework target motion pattern experiments        scribed figure                   scaling  original motion pat       execute computed actions record sensory gyro tern typically stable start learning process         scope feedback                           final optimization result obtained using procedure                                                   shown trajectory red circles figure  corre                                                  sponds  scale motion                                                  ijcai                                              
