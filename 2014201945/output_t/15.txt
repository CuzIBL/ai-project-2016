       maximum posteriori path estimation input trace perturbation           algorithms application credible rating human routines                       daniel wilson                            matthai philipose                       robotics institute                             intel research                  carnegie mellon university                            th floor                        forbes ave                             ne th street                     pittsburgh pa                             seattle wa                      dwilsoncscmuedu                        matthaicswashingtonedu                      abstract                          using rating example professor grading anesthesi                                                        ology students performing intubation want indicate      rating routine activity performed notion good performance transparency      valuable variety domains making rat mean able justify      ing inexpensive credible key aspect signed particular rating ideally justiﬁcation      problem formalize problem map esti    constructive suggest lowrated perfor      mation hmms incoming trace needs     mance altered obtain highrated      repair present polynomial time algorithms       techniques rating activity routines designed      computing minimal repairs maximal like  satisfy requirements lower incremental cost      lihood hmms hidden semimarkov models        choose representation easily learned activi      hsmms form hmms constrained       ties rated modeled variants hid      fragment temporal logic ltl present  den markov models hmms intend models      results show promise approach especially given simple prior information learned eas                                                        ily training examples crucially formulate    introduction                                       justiﬁcation rating relative model generically  rating person performs routine activity set edits required trace generated rated ac  broadly useful capability applications professors tivities require special identiﬁcation  train medical students rating execution established modeling errors causes fundamental weak  procedures caregivers assess wellbeing wards ness models ﬁrst order preventing  rating able perform activities daily capturing certain important correlations aug  living managers workﬂow experts identify poorly ment markov models intuitive constraint formal                                                                                                    performed procedures cause bottlenecks al ism small fragment temporal logic ltl   al  rating routine activity certainly useful conven lows raters explicitly state relevant constraints given  tionally expensive – each activity perfor relevant easytoconstruct models formulate rating  mance requires dedicated human observer expert likelihood possibly edited observation sequences  situations gauging performance routine core paper consists efﬁcient algorithms  activities helpful rated compute maximum likelihood paths minimally edited ver  rated cursory manner clearly opportunity exists sions incoming observations respect various repre  automated techniques reduce cost rating sentations activities including hmms hsmms tem  paper explore methods automatically rating perfor porally constrained hmms algorithms use dynamic  mances routine activities                         programming technique used great effect    basic classiﬁcation task rating going obser known viterbi algorithm preliminary evaluation shows  vations scores amenable variety standard ap promise techniques  proaches rating challenging wish  make incrementally inexpensive credible  overview  deﬁne incrementally inexpensive rater rater section expect  extra cost rating new activity relatively low used sketch supports usage  main determinant cost rating new activity model paper goal develop  requires custom classiﬁer developed scratch rates elder performs daytoday activities  generic classiﬁer kind easily cus great eldercare industry  tomized task credible rater rel ory caregivers assess elders’ wellbeing consult  evant transparent relevant mean classi ing ratings summaries credible explanations perfor  ﬁcation model particular rating task reﬂect mance deﬁcits example recognize  straints activity performance important elder longer able prepare daily bowl soupand report can’t reach cabinet difﬁculty holding generating rating justiﬁcation given  spoon                                                   strained model λ threshold automated    endusers represents activities set rater ready use person rated generates  steps each step duration set observed actions trace      ym rated automatically                                                                                                 ˆ  performed succeeded steps instance rater ﬁnds constrained map likelihood ly path  activity “making soup” particular elder                                                            sˆy  ˆs     ˆsm ym  assigns  following steps “preheat water” “open can” “mix                                                            rating  rˆl   fail rater attempts  boil ingredients” “serve” “clean up” step “open                                                                         produce repaired trace trace         can” average duration  seconds contain                                                                                                 edit distance  small  following actions “use utensil drawer” “use opener”                                                                                           possible ˆl   words closest  “use can” “use pantry door”                                                                                                trace passes rater offers rating    concreteness assume follows                                                            activity appropriate δ ˆ ˆ  set edits  using rfidbased  sensors directly sense                         sy sy                                                                               ˆ      ˆ  action using particular objects actions needed transform sy sy   justiﬁcation  form “use x” object inherently rating  requires actions observable sensors described rating employs key  given activity trace trace actions constitutes nonstandard pieces machinery  particular execution activity provides                                                                                                            rating pass fail grade fail pro  method compute repaired observation trace   vides alternate sequence actions close original minimum edit distance given trace  possible elicited pass grade essentially likelihood prespeciﬁed threshold  constructive justiﬁcation grade use  method compute constrained map likelihood  proceeds follows                        function cmapm  learning model human demonstrator performs      routine exemplary fashion collects  trace repair hidden markov models      traces     yn routine each trace yi hidden markov model hmm λ  π com      sequence timestamped observations                                                    imi   monly used stochastic model dynamic systems       demonstrator’s actions traces used formally pose trace repair problem variation esti      learn dynamic stochastic model hmm mating likely state sequence given sequence ob      hsmm parameters λ hidden states  servations classically solved viterbi algorithm          sn model correspond “activity                                                        hmm deﬁned follows let qa      qn       steps” labelled     ln names                                                        states process modeled ob      om       step                                      observation signals possibly generated process  adding global constraints typically ﬁrstorder model use metavariables st yt denote states      learned previous step capture important observations respectively time aij probabil      higherorder correlations instance successful ity pst  qjst  qi transitioning state qi      soupmaking routine stove used time qj time   bij probability      tually turned turned turning pyt  ojst  qi generating observation oj        happen “preheat water” step turn state qi write biyt bij yt  oj initial      ing happen end “serve” step state distribution πi  ps  qi      human rater explicitly adds set constraints      sequence hidden states observations spec  repaired map path estimation problem      ify required higherorder correlations case formulate problem map path estimation given      possible constraint form use“stove observation sequence allowed ﬁrst make lim      control knob” use“stove control knob” read “a ited number edits “repairs” sequence begin      use stove control knob eventually succeeded formalizing notion edit state      use stove control knob”                paired map path estimation problem present variation  learning rating thresholds human rater rates each trace viterbi algorithm solve                                                                     yi rating ri ∈ pass fail let    let    set lengthn strings observa      strained map likelihood trace given λ tions ﬁnite alphabet     ekn                                                                                                                ˆ                                           ˆ     bn  sn  lengthn kedit vector       ly  cmapm  likelihood path sy                                        maximum posteriori map likelihood given λ bi boolean si strings   ≤i≤n bi                                                                                                            satisﬁes perform simple thresholding si instance yˆ  “cat” string        computation calculate likelihood threshold false “bb” false “” true “r” edit vector                                                                given classiﬁcation function rl    applying edit vector string yˆn     yn writ                         ˆ                                                          ˆ      fail pass rlyi   ri yi eˆy results new string obtained follows                                                                                                            possible intuitively separates passes  ≤ ≤ let ebi true replace yi yˆi      fails                                            replace yi yiesi esi appended yi example                                                        initialization         ≤ ≤              added observations original observations                                                             δtk      δtik      ψtik  −                    yτ  yt  yt                                                           iteration  ≤ ≤                                                   δ ψ                                     …ti  ti               ψtikδtik    argmax    δτjκbiyit aji                                     δ                                      tik                              τjκ st κatdτtk                                   …  …                                ψτ δ          state                          …                                 j…τj δ                                 δ    tik                                  τjκ                     termination  tm                                 … …                                 …                                 δ                                  τjk                     ψtikδtik    argmax   δτiκ  im  argmax δtik                                                                   τjκ st κatdτtk     ≤i≤n                                  τ                                                       backtracking  ψ                             time step                                               tm im                                                               ˙t y˙t  qi yit ← ψtik        figure  trellis kedit viterbi hmms                                                             table  kedit viterbi algorithm hmms                               ˆy  “cbbar” string yˆ kedit yˆ                      kn             kn              adds add column  tm     rows  exists edit vector yˆ  ˆy     represent possible hidden states    ready specify problem map estima end result algorithm forward path shown  tion repairs                                    light grey ﬁgure  through trellis unlike  deﬁnition  repaired map path estimation problem    conventional viterbi algorithm jump nodes  rmap  given observation sequence yˆt  hmm λ      nonadjacent time slices path jumps slice  π edit distance ﬁnd observation sequence original observation yi position obser     yˆt  ˙    y˙t  kedit yˆt path sˆt   vation input string yˆ conclude yi deleted                                                  s˙     s˙t  maximizing pˆst   yˆt    sˆt  yˆt   yˆ path passes through    discussing solution deﬁne string yˆ sequence added nodes intervening original node                                 kn            kn  kaedit string yˆn yˆ  ˆy  yi ﬁrst original observation left se   kn                           kn   sn ≤  additionally bn     quence observations nodes yi      yin    kn   sn     aedit string requires conclude string yi    yin added i’th  character preserved replaced spot incoming string forward path required                                                                    character characters added edits com solution sˆt  string observations path                                                                        pose follows dνn  − ν       edited string yˆ   ν αkn ν  α ≤ ν  α  algorithm uses three intermediate variables dtτ                                   kayˆ                                               lemma   edit composition let yn set  variable                                                              kayˆ         − τ  aedits npreﬁx string yˆ  yn  τt       represents number deletes skipping                καyˆ                                                            τ      yˆ yy ∈ yˆ ∈ yν  ν αkn κ  dνn   original observations  observa                                                                                                    table  speciﬁes algorithm kedit viterbi kev tion considered processing state slice  note  algorithm solve rmap kev iterates origi process original observations time slices                                                               nal observations incoming observation string each            “added” slices need  original observation iterates possibilities propose observed value added simple inef                                                                                                     added observations position total  ﬁcient approach consider each state value                                                                                         ∈  iterations each iteration corresponding original ober iteration  possible observable candi  vation  div     added observation  date fact consider single observation instead                                                        ob key insight processing state  mod  kev computes likelihood δtik  likely path ending state given observation string added slice sufﬁcient consider adding observable                                                                                                  tedit    edit vectors kev likely observable state let                                                   sets lengthn sequences states observables let  records ψtik penultimate state edit path                                                        y˙i  argmax bij let sqˆ result appending state  following chain ψtik’s start state iteration ≤j≤m  gives map repaired path                                                        sequence sˆ similarly yyˆ  qi ∈ qa    trellis ﬁgure  illustrates kev columns                                                                                 lemma      max     pˆsqi yˆ   max pˆsqi yˆy˙i                                                                      trellis represent edits considered inclusion ﬁnal  sˆ yˆ ∈sn yn     sˆ yˆ∈sn yn  string large circles represent original observations small                                                          follows  fact max pˆsqi yyˆ   ones represent adds technical reasons allow skipping                            yi  ﬁrst original observation add distinguished start max π                                                                                   sy  ≤i≤nsiqj ∈sˆn ij jyj sn iyi                                                         yi  state new start probabilities π   ai  πi                                                        πs    asn max biyi  πs    asn iy˙i given identity  ai   add column   processed initializa     yi  tion step allow skipping original observation optimal observable added state qi set yit                                                        init term bactracking table   y˙i “added” timeslice yt    ready establish soundness kev iteration  ≤ ≤                       algorithm let sn set lengthn sequence states                       tik                                ψtikδtik   argmax  δτjκpyκkτtiajidiyκkτti  ending state qi let yn set lengthn strings       ≤τ≤tjκyκkτti  observables tedits    yt    lemma   ψtikδtik  argmax pˆs yˆ                 table  kedit viterbi algorithm hsmms                              tik                       nsˆ∈snyˆ∈yn    proof sketch proof induction focus table  speciﬁes variant kev solve problem  inductive case δ ψ replace “max” “argmax” ﬁgure  shows trellis algorithm trellis                                                        identical used kev represent added nodes   δtik    max ajibiyit δτjκ∀jτκ st κ   dτt             τjκ                                       single small circle use different fo           inductive hypothesis               cus δtik calculated each timestep state                                                        edit distance kev iterate previous            maxajibiyit   max     pˆs yˆ            τjκ              τjκ                       nsˆ∈snyˆ∈yn                    timesteps states edit distances τ κ                               n−                    time instead discarding observations intervening  given sn sn independent sˆ  yˆ                                                         timesteps seek subsequence yκkτti assume         ps     sˆ   yˆ ∀       τjκ     step ends stay state qi begins immediately     ji                    nsˆ∈sn−yˆ∈yn                                                        stay qj ended step τ eτt number ed           psn  qisˆ yˆ ∀    τjκ                             nsˆ∈snyˆ∈yn              yκkτti added nodes included  original nodes ignored  similarly yn given sn                       require κ   eτt  problem maximizing                                                        likelihood path ending reduces                                               τjκ   biyit    pyn  yitsˆ sn  qi yˆ ∀nsˆ∈s yˆ∈y                                                    problem ﬁnding yκkτti maximizing pyκkτtidiyκkτti                                                          ﬁnd maximum iterating through durations  substituting aji biy using pa                                                        each iterate through predecessors τ κ  pabpb twice κ   dτt                                                             ﬁnding sequence yκkτti length high    δtik      max       psn  qi sˆ yn  yit yˆ                     τjκ                              est probability running tally maximum         τjκnsˆ∈snyˆ∈yn                                                        pyκkτtidil finding yκkτti reduces identifying na  lemma  ensures maximizing yyˆ maximizes added nodes include yκkτti original nodes  strings yyˆ  lemma  maximizing yyˆ yˆ ∈ ignore na   − κ − satisfy   τjκ                    tik     maximizes yˆ ∈  finally ∀      sˆ    kedit criterion na  − τ −                                 ≤j≤nsˆ∈snqi  ∀          sˆ modifying previous equation reﬂect satisfy duration constraint equations ﬁx na   ≤i≤nsˆ∈sn  insights                                       added nodes probability                                                        y˙i  pˆoiqi doesn’t matter particular na pick     δtik      max     pˆs yˆ  max     pˆs yˆ   hand pick original nodes low           nsˆ∈si yˆ∈y tik    nsˆ∈si yˆ∈y tik                                            est probability observation exclusion                                                        sorting original nodes ot log  time ofﬂine                                                        ol access during execution sequence nodes    soundness kev follows straightforward way picked yκkτti simply multiply observation  lemma given trellis transition probabilties pyκkτti process  ot kn  nodes each node compute ok δ takes operations yκkτti   ol  ψ values consult onk preceding data values                                                        given ot nk  trellis nodes computing ok δ ψ  complexity kev ot  values each node consulting odnk preceding values                                                        each value spending ol each preceding value    trace repair hsmms                             considered entire algorithm takes ot dlk   hidden  semimarkov  model hsmm      λ       steps note fairly common case  π identical hmm duration unbounded running time ot  distribution hmm generates single observa  tion according each visit state hsmm gen  erates independent observations each visit  drawn according dsl  pls added ﬂexibility  useful modeling human activities duration  stay state restricted geometric bi  ased small values hmms follows assume  ﬁnite set size durations  longest duration steps    rmap problem given hsmm π obser  vations yˆt limit ﬁnd  argmax       pˆs yˆ           figure  trellis kev hsmms                                                                 tsˆ∈qayˆ∈ob yˆ kedit yˆ  trace repair constrained hmms                  ments compare regular hmm timesensitive hsmm  deﬁne  temporally constrained hmm tchmm     regular hsmm hsmm temporal logic  λ     π temporal constraint constraints respectively                                                          compare output hmms versus hsmms  form  φeφe    eφc φi proposi  tional boolean formulas state labels observa three activity traces different activity models  tions φ   statelobsyφ ∧ φ¬φ path sufﬁx  row figure  each activity trace intentionally     observations    satisfy constraint suf incorrect making tea preparation step hur                                                ried making sandwich ingredients  ﬁx cj    φj    φw ≥ φjsk yk im  plies         satisfy  written collected grooming brushing teeth combing hair                                        performed rapidly row figure   sk    st  yk    yt   cj intuitively  mula constraint sequence true wrt head plotted maximum likelihood values each step  stateobservation sequences formulas activity traces “step” considered state tran  follow eventually true speciﬁed sition hmms fail detect problem exhibiting high  der later sequences constraint statecook ∧ likelihood hsmm likelihoods plummet  obsoilestatewash∧obssoap instance cap sensitivity time spent each state  ture constraint oil used cooking step kedit trace correctly adds proper number observa  making dinner soap used eventual required tions each state resulting high likelihood  washing step                                           second compare output hsmms    rmap problem reformulated given   temporal logic constraints tlcs row  tchmm   constraints observations yˆt limit figure  intentionally chose incorrect sequences  ﬁnd sy         argmax       φˆs yˆ sy  three activities making tea stove turned                                                  turned preparing sandwich refriger           tsˆ∈qayˆ∈ob yˆ kedit yˆ    solution rmap estimation restricted formulas ator door opened closed grooming  form φ  statelφ∧φ¬φ disallow dependences sink water turned turned  observables small modiﬁcation kev algorithm row figure  plotted maximum likelhood values  enables polynomial time solution problem use each step activity traces regular hsmms fail detect  trellis kev each timestep state edit problem reporting high likelihood hsmms tlcs  distance maintain additional cvector report low likelihood allowed                                                        sider statetransitions satisfy constraints  element δtikm  ≤  represents likelihood  map path ending state time slice traces constraints broken alternate lowlikelihood                                                        paths considered kedit trace correctly adds  edits requires constraint sufﬁx cm satis                                                        necessary steps turn stove shut refrigerator  ﬁed δtik outstanding constraints  satisﬁed likelihood computed compositionally turn sink resulting high likelihood  δτjκµ τ  κ µ pointwise ≤ does rating change increases kedits                                                     viterbi algorithm provides advice edits ideally  ot   steps formulas φi evaluated  op  steps size formulas desire trace likelihood threshold    map estimation trace perturbation minimum number edits method incremen  tchmm’s apparently formulated solved tally increase threshold exceeded rea  previously potentially quite powerful son interested likelihood changes  stance constrained inference work culotta et al  creases  special case tchmm kedit map estimation  experiment ran kedits viterbi hsmms                                                        trace “making tea” activity figure      stateqestateqi map estimation  special case rmap estimation   variant plotted overall likelihood each trace number  kev performs map estimation possible edits increased dashed line threshold  ingly   allow general version showing likelihood acceptable “good” trace ob  formulas φ retain fast running time open viously original sequence low likelihood  general remaining tractable instance increased three algorithm forced  constraints viewed fragment linear tem assemble partially complete activity traces  poral logic ltl  interesting consider larger frag lower overall likelihood   algorithm formed  ments candidates                                  complete trace met threshold increased                                                        algorithm tweaked sequence slightly higher like                                                        lihood likely possible path reached      evaluation                                         “oddeven” effect algorithm  does model choice affect advice kedit viterbi al forced add new likely observations oppor  gorithm dispenses advice based parameters activ tunistically delete observations ≥  likeli  ity models credibility advice suffer hood drops algorithm performs modiﬁcations  differences models reality repre trace unable reach optimal solution  sent order illustrate point conducted exper intuitive advice examine advice  iments three different activity models experi dispensed kedits viterbi scenarios ran
