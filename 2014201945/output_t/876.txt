                          hierarchical diagnosis multiple faults                                       sajjad siddiqi   jinbo huang                         national ict australia australian national university                                       canberra act  australia                                sajjadsiddiqi jinbohuangnictacomau                                                                                            ¬okx ∨∨¬¬a ∨∨¬¬c                      abstract                                                                                                                            ¬okx ∨ ∨                                                                                  large search spaces diagnosis combina                               ¬oky ∨ ∨∨¬¬d      tional circuits practical ﬁnding sin                           ¬oky ∨ ∨∨¬¬d      gle double faults principle mod                                  ¬oky ∨∨¬¬b ∨∨¬¬c ∨      els compiled tractable representation      dnnf faults arbitrary cardi        figure  circuit cnf encoding      nality efﬁciently large circuits      compilation bottleneck      large number variables necessary model consider example figure  reproduced huang      health individual gates propose novel darwiche  hd models circuit proposi      method greatly reduces number allowing tional formula each signal circuit translates                                                                                  compilation diagnosis scale propositional variable    each gate extra                                                                okx oky      larger circuits basic idea identify variable         introduced model health      regions circuit called cones domi propositional formula health variables      nated single gates model health each true remaining variables constrained model      cone single health variable cone   functionality gates instance ﬁrst      possibly faulty diagnose clauses shown ﬁgure equivalent sentence                                                        okx  ⇒ ⇔¬c                                      identifying cones inside               modeling health inverter       til reach base case show results com given typically abnormal valuation inputs      bined hierarchical sessions sound  outputs circuit called observation consistency      complete respect minimumcardinality  based diagnosis valuation health variables      diagnoses implement method     consistent observation model      diagnoser developed huang darwiche     instance given observation ¬a ∧ ∧¬d diagno       present evidence signiﬁcantly sis ¬okx ∧ oky  meaning inverter broken      improves efﬁciency scalability diagnosis andgate healthy known      iscas circuits                         model compiled dnnf compute compact                                                        representation diagnoses time linear size                                                        dnnf  darwiche     introduction                                         major advantage hd dnnf known  work consider fault diagnosis combinational cir strictly succinct representation obdd  cuits observed abnormal input output values supports efﬁcient algorithms compute diagnoses arbi  circuit implementation given trary cardinality minimum cardinality darwiche  diagnosis engine ﬁnds possible sets faulty gates  approach applied large circuits  explain observation                              compilation models dnnf    diagnosis tool implementing modelbased approach bottleneck large numbers health variables  recently presented huang darwiche    propose solution problem based hierar  systems diagnosed modeled propositional chical diagnosis start abstraction circuit  formulas conjunctive normal form cnf certain regions circuit called cones “carved  compiled decomposable negation normal form dnnf out” based structural analysis abstract model  darwiche  tool shall refer hd generally simpler allows larger circuits compiled  shown particularly improve efﬁciency scalabil diagnoses computed cones diagnosed  ity earlier tool torta torasso  based identiﬁed toplevel diagnosis possibly  compiling models ordered binary decision dia faulty discuss intricacies involved properly diag  grams obdd bryant                           nosing cones redundancy avoided results                                                    ijcai                                                                                                             abstraction circuit                                                        circuit abstracted treating maximal cones                                                        black boxes maximal cone contained                                                        cone contained exactly cone                                                        circuit example cone treated                                                        virtual gate inputs output                                                        similarly cone abstracted treating cone                                                         virtual gate abstraction circuit                                                        deﬁned original circuit minus nonroot gates                                                        maximal cones formally                                                        deﬁnition  abstraction circuit given circuit                                                        let c  single output let c                                                        augmented dummy gate collecting outputs cs                                                                      Θ                              ∈              figure  circuit cones           abstraction circuit set gates                                                        path output c                                                        does contain dominator  combined hierarchical diagnosis sessions sound example Θc  tuvabc ∈ Θc  complete respect minimumcardinality diagnoses reach output passing through awhichis    implement new approach hd using dominator similarly Θa  ∈ Θa  iscas benchmark circuits show di path contains dominator  agnose circuits arbitrary fault cardinality  ﬁrst time circuits handled hd  dnnfbased diagnosis  observe signiﬁcant improvement diagnosis time                                                        presenting new algorithm brieﬂy review                                                        baseline diagnoser hd huang darwiche     notation deﬁnitions                            based compiling model circuit  shall use circuit figure  running example case cnf dnnf darwiche   numbers shown alongside gate outputs values dnnf graphbased representation propositional  signals ignored moment         theories speciﬁcally each dnnf theory dag directed                                                        acyclic graph single root leaves labeled    circuits dominators cones                  literals nodes labeled                                                        addition decomposability property sat  use denote circuit set gates                                                        isﬁed children andnode share variables  circuit including inputs trivial gates identify                                                          model converted dnnf consistency  gate output signal set inputs circuit                                                        based diagnoses minimumcardinality diagnoses  denoted ic set outputs oc example ic                                                         computed time polynomial size dnnf  oc  tuv circuit figure                                                         darwiche  key decomposability allows    observe certain regions circuit nonobservables projected linear time allows  limited connectivity rest circuit                                        diagnoses computed children combined par  example dotted box containing gates              ent andnode simply crossconcatenation note di  subcircuit contributes single signal atothe                                              agnoses computed children naturally unioned  rest circuit box containing gates      parent ornode  example refer subcircuit new algorithm aims improve efﬁciency scal                                       cone known fanout free formula lu et al ability approach context circuit diagnosis          formally deﬁne                 continue model circuit cnf formula rely    fanin region gate ∈ set                                                      dnnf compilation compute diagnoses main  gates path passing through going output novation structurebased method reduce number  gate fanin region gate figure  example                                  health variables required model dif                                                       ﬁculty compilation maintaining soundness  deﬁnition  dominator gate fanin region completeness diagnoser rest paper  gate dominated conversely dominator assume minimumcardinality diagnoses sought  path gate output circuit contains  kirkland mercer                            hierarchical diagnosis    notion cone corresponds precisely set key idea new algorithm start obtain  gates dominated gate denote Δg ing abstraction Θc circuit deﬁned section   example dotted box mentioned corresponds diagnose pretending gates Θc  Δa    meaning faulty basic technique signiﬁcantly  clear simply use refer cone rooted reduce number health variables required                                                    ijcai                                                     model allowing compile diagnose larger circuits algorithm  hdiag  hierarchical diagnosis algorithm  toplevel diagnosis session ﬁnishes gate ap function hdiag  obs   pearing diagnosis root cone inputs circuitset gates obssetofgatebool  abstracted attempt diagnose cone output set sets gates  similar hierarchical fashion                         local variables oc ic Π  set gatesΛ dset sets    things worth noting details gates Ωcnf set gates  cones singleoutput circuits diagno  oc ← outputs   sis cones alway produce diagnoses cardinality  ic ← inputs                                                           finddominators oc  findcones oc   second diagnosis cone performed simply               obs               recursive tempted expect  propagateinputs   sav values                                                            setobsoutputs  oc obs   later diagnosis sessions distinct initial                                                          ← traverse Θc  oc ic  attachoks   level session reason avoiding redundant  Ω ← genmodel oc ∪ ic   computation discuss later section  Λ ←callhd Ω obs  orderbydepth Λ     present hierarchical diagnosis algo  restorevalues   rithm refer hdiag pseudocode  ← φ  hdiag  given algorithm                         Π ∈ Λ                                                           ← ∪ findeqdiagnoses Π     algorithm                                         return  step  dominators  hdiag  starts identifying nontrivial dominator gates algorithm  traverse Θc  traverses level  circuit trivial dominator dominates function traverse Θc  oc ic   dominators gate obtained inputs ocic set gates  dominators gate gate union intersection output set gates  dominators parents kirkland mercer  local variables set gates yo gate  simple breadthﬁrst traversal  ← singleoutput oc   circuit starting outputs during process non  ←o ← φ  trivial dominators identiﬁed finddominators im  ¬isempty  plements procedure line  algorithm         ←  pop                                                ∈ ic    example dominator sets                ←  t∪y     respectively domi                                                            ¬isdominator      nator set  ←              ← ∪                                                            children     easily seen gates  trivial dominators  return  nontrivial dominators  step  cones inputs                                                        tors toplevel hierarchy plus nondominators  each nontrivial dominator deﬁnes cone ab                                                        sit dominators outputs oc  stracted identify inputs cones            Θ  depthﬁrst traversal circuit suppose cone circuit traverse traverses toplevel hierarchy                                                        circuit singleoutput line  algorithm  im  inputs ig traversing fanin region                                                        plements attachment dummy gate described deﬁ  reach input circuit                                                        nition  traverse Θc implemented soon  gate does belong Δg add ig                                                        encounters input circuit nontrivial domina  track findcones implements procedure line                                                         tor root line  algorithm  backtracks  algorithm     cone example traverse fanin region inputs excluded assumed healthy                                                        attachoks   associates health variables each gate  order gates added                                                        hierarchy  inputs cone backtrack ∈ Δdthe  inputs cone                       create abstract model similar                                                        model used huang darwiche  abstract  step  toplevel diagnosis                          model contains description cnf set  rest algorithm proceeds phases ﬁrst observables ic ∪ oc nonobservables cic ∪ oc  phase abnormal observation cir model generated function genmodel  cuit ﬁrst propagate values inputs bottomup turned Ω note clauses representing gates  setting expected value each internal gate cir marked attachoks additional health variables  cuit values saved reference later observed hd called Ω observation perform  outputs circuit set abnormal diagnosis diagnoses obtained referred  propagateinputssav  valuesandsetobsoutputs        toplevel diagnoses nontrivial dominator ∈ Θc  lines   algorithm  implement procedures ported possibly faulty enter second phase    health abstraction circuit Θcisthen diagnosing cone  diagnosed achieved associating health vari example figure  given inputs outputs  able gate Θc Θc contains domina circuit butallofthemare ob                                                    ijcai                                                     algorithm  findeqdiagnoses   diagnosis cones     speciﬁcally need set values inputs output  function findeqdiagnoses  Π                         cone observation pass hd  inputs Π set gates                             restore expected values gates circuit line   output set sets gates                        algorithm  findeqdiagnoses  local variables    Λ   set  sets gates                                                                                 ix set gates gate Ωcnf want diagnose cone assumption  set gates obssetofgatebool                gates gi ∈ Π faulty need propa    ←Π ←Π                                    gate fault effect gi subcircuit faults    ¬isempty                             circuits propagate bottomup set gates     ← pop                                      each diagnosis decreasing order depth circuit     propagatefault                               orderbydepth    line  algorithm  fault pro     ∈ cone cessed simply ﬂipping output faulty gate       circuit                                       propagating effect each ∈ Π separately           ∈                                              order appear Π desired         ← ∪x                                                        effect setting observation cone ix ∪x         ← traversecone    ix ← inputs              ←           Θ                      consistent observation overall circuit           traverse         attachoks                  Ω ← genmodel   x∪ix                   cone   ready diagnosis        obs ← valuation x∪ix                                                      Θ                    Λ ←            Ω obs            Λ          note abstraction cone di            callhd          setdiags          agnosed mentioned earlier sim                                                             ply recursive algoritm  needs handled        Λ ← diags       ∈ Λ                               differently algorithm  traversecone line  iden                                                                                                      Δ        ← pop                                  tiﬁes returns set gates cone                                       valuation  returns set gate bool pairs repre          ← substitute                   sents currently assigned values set gates x∪          ← ∪s ←  ∪s                    ix passed input line  returned set serves    restorevalues                                  observation cone given cone observables   cleardiags                                    nonobservables health abstraction diagnosed   return                                          using hd set singleton diagnoses Λ                                                        saved line  diagnoses retrieved diags                                                                              servation introduce health variables set gates line  substitute   generates new diagnosis                                                        replacing line  finally clear  Θcic   tuvabc create model abstrac  tion circuit pass model obser diagnoses returning function line   vation ¬t ∧¬u  ∧¬v  ∧ ∧ ∧ hd     diagnosis cones similar overall cir  diagnoses returned hd ¬oka ∧¬okb ∧¬okc cuit given algorithm  details  use alternative notation rest paper worth mentioning cone diagnosed hierarchically  use notation expressing diagnosis set cone diagnose toplevel hierarchy  faulty gates cone enter second phase Θx ii single findeqdiagnoses  step  diagnosis cones                           cone diagnosed ensured line  algorithm                                                         sufﬁcient explained later iii new  suppose Π  ggn diagnosis                                                        diagnosis generated substitution added set  toplevel phase ∈ Π root cone                                                        processing line  algorithm  iv  clear given faulty output xifthere                                                        fault effect diagnosis propagated diagnosis  gate ∈ Δx assumed faulty permits                                                        processed undone substitutions  value replacing yield valid                                                        gates newly generated diagnosis  global diagnosis way try expand toplevel                                                        depth order discussed reorder  diagnoses procedure findeqdiagnoses line                                                         reasons clear soon  algorithm  given algorithm     mainly each cone each toplevel diagnosis Π continuing example reorder  ﬁnd diagnosis hierarchically identify bacweﬂipb  propagate effect ﬂips  subcircuit single output inputs ixthe   remains  stage ﬂip  minimum cardinality diagnoses  gate irrelevant diagnosis cone note  mentioned earlier replace singleton di correct output cone  given  agnoses Π produce new global diagnoses puts  place health variables gates  process iterated reach base case cones Θaia  generate model cone aand  left diagnosed treat each Π diagnoses gen pass hd observation ¬a ∧ ∧¬bwhich  erated single class diagnoses use avoid returns three diagnoses cardinality  redundant computation explained section      note trivial diagnosis substituting    cone diagnosed circuit toplevel diagnosis bacwegettwonew  order ﬁnd correct diagnoses diagnoses bdc bec                                                    ijcai                                                                                                           sis soundness minimumcardinality diagnosis                                                        hdiag completeness                                                          soundness clear diagnoses                                                        hdiag  fact valid                                                        cardinality  toplevel diagnoses step                                                         cardinality virtue hd  substi                                                        tutions step  alter cardinality cones                                                        roots Θc overlap gates toplevel             figure  redundancy scenarios            diagnosis substituted gate step                                                           remains show cardinality diag                                                        noses smallest possible suppose    avoiding redundancy                              contrary exists diagnosis Π smaller car  cones shared different diagnoses cone dinality Π let each gate Π replaced  potentially visited ﬁnal diagnoses highest dominator circuit produce Π clearly                                                                                            computed redundant diagnose Π remains valid diagnosis ii Π ⊆ Θc iii  cone multiple times three cases consider Π≤Π ii imply Π diagnosis                                                                  Θ              Π    • suppose toplevel diagnosis cone appears abstraction iii implies  means                                                                            Θ      diagnoses  shown fig toplevel diagnoses step  mini      ure seen lies mum cardinality contradicting soundness baseline      fanin region cone fault af diagnoser hd      fect values inputs output cone means completenessletΠ diagnosis minimum cardi      diagnosis obtained used nality let each gate Π replaced highest dom                                                        inator circuit produce Π ii      processing toplevel diagnoses                                           case currently implemented code    Π   implies Π                                                        hdiag step  virtue completeness    • figure lie fanin region            Θ    Π                                                  hd diagnosing         cone   faults  affect values substitutions step  virtue completeness      inputs output cone consider                                                    diagnosis cones easily established induc      fault effect inputs output tion diagnoses cones cardinality      fault effect      diagnosis cone during pro      cessing  completely different  experimental results                                           during processing    cone    order compare efﬁciency scalability ap      diagnosed twice case clear proach huang darwiche  ran      diagnoses return findeqdiagnoses   systems set iscas circuits using randomly gener      algorithm                                    ated diagnostic cases each circuit randomly gener    • figure assume  toplevel ated set inputoutput vectors accordingly correct      diagnosis diagnosis obtained during behavior circuit randomly ﬂipped outputs      processing  cardinal ranging   each inputoutput vector      ity diagnosis cone  value seen abnormal observation minimum cardinality      output fault diagnoses close number ﬂipped outputs      seen fault effect experiments conducted ghz pentium       faults individually gb ram running diskless linux time limit      needs diagnosed  hour imposed each experiment      diagnoses idea extends level substitution results given table  fourth column shows      diagnosing cone yields new diagnoses number health variables introduced hdiag      reason reorder gates newly toplevel diagnosis recall baseline approach hd      generated diagnoses findeqdiagnoses accord  requires health variable gate clear      ing depth case taken care line  proposed technique signiﬁcantly reduces number      condition findeqdiagnoses              health variables required observe cir                                                        cuits hdiag able solve signiﬁcantly larger num    soundness completeness                         ber cases hd particular hd solve  prove following theorem relying fact cases circuits hdiag suc  baseline diagnoser hd property    ceeded columns table com                                                        pare running times systems cases  theorem  hdiag  sound complete respect solved new approach clearly results better efﬁciency  minimumcardinality diagnoses                          finally note programs reported exactly    proof let circuit question show set diagnoses each case solved  diagnosis hdiag minimumcardinality diagno expect given theorem                                                     ijcai                                                     
