                  symmetry breaking quantiﬁed boolean formulae                          gilles audemard∗     sa¨ıd jabbour    lakhdar sa¨ıs                                         cril  cnrs fre                                      universit´e d’artois  lens france                                audemardjabboursaiscrilunivartoisfr                          abstract                          space symmetries widely investigated considered                                                        important task deal intractability com      reasoning task combinatorial problems    binatorial problems constraint satisfaction problems      exhibit symmetries exploiting symmetries    csp satisﬁability boolean formula sat      proved important reducing    previous work symmetry breaking predicates qbf      search efforts breaking symmetries using addi   proposed audemard  et al  authors      tional constraints currently used use hybrid qbfsat approach set gener      approaches extending symmetry breaking      ated breaking predicates separated qbf formula      techniques quantiﬁed boolean formulae qbf consequently approach solver dependent      challenging task paper approach solve hybrid qbfsat formula dpllbased qbf      break symmetries quantiﬁed boolean formu   solvers need adapted kind solvers      lae proposed makes original use univer skizzo used context      sally quantiﬁed auxiliary variables generate new paper propose preprocessing approach      symmetry breaking predicates new ordering   solver independent taking input qbf symme      qbf preﬁx computed leading    tries generate new qbf formula symmetries      new equivalent qbf formula respect valid equivalent original wrt validity break      ity experimental evaluation stateoftheart symmetries extend sat approach proposed craw      qbf solver semprop shows signiﬁcant improve      ford crawford  aloul et al       ments orders magnitude   paper organized follows prelimi      qbfs instances                                   nary deﬁnitions quantiﬁed boolean formulae symmetry                                                        framework qbfs presented symmetry breaking    introduction                                       approach qbf described experimental validation                                                        approach given showing signiﬁcant improvements  solving quantiﬁed boolean formulae qbf wide range qbf instances finally promising paths  attractive important research area years future research discussed conclusion  increasing related different fac  tors including fact important artiﬁcial intel  ligence ai problems planning non monotonic reasoning  technical background  formal veriﬁcation reduced qbf  quantiﬁed boolean formulae  considered canonical problem pspace com                                                        let ﬁnite set propositional variables lp  plexity class important reason comes language quantiﬁed boolean formulae built  cent impressive progress achieved practical resolu ing ordinary boolean formulae including propositional  tion satisﬁability problem solvers qbfs stants  ⊥ plus additional quantiﬁcation ∃ ∀                                proposed recently giunchiglia et al propositional variables  zhang malik  letz  benedetti                                                         paper consider quantiﬁed boolean formula Φ  obtained extending satisﬁability results                                                        prenex clausal form Φqkxk qxΨ     surprising qbfs natural extension sat                                                        short qxΨ  qx  called preﬁx Ψ matrix  isﬁability problem deciding boolean formula                                                        qi ∈∃  ∀ xkx disjoint sets variables  conjunctive normal form satisﬁable vari                                                        Ψ boolean formula conjunctive normal form consecu  ables universally existentially quantiﬁed                                                        tive variables quantiﬁer grouped    classes qbfs encoding realworld application                                                                      ﬁne varΦ     i∈k xi set variables Φ  andor ai problems contain symmetries exploiting varuΦ   xx ∈ varΦ universal  structures lead dramatically reducing search                                  literal                                                        occurrence propositional variable positive    ∗                                 supported anr “planevo” project jc    negative form ¬l litΦ  i∈k litxi set                                                    ijcai                                                    complete literals Φwherelitxixi ¬xixi ∈  different quantiﬁer groups mapped each  xi set literals encoded using integer numbers second condition deﬁnition   positive resp negative literal resp ¬l associ detect symmetries nauty applied graph  ated positive number α resp −α deﬁne representation qbf  absolute value    given variable ∈ varΦ st ∈ xkwedeﬁne     breaking symmetries qbfs  rankxk variables appearing quantiﬁer                                                        symmetry breaking extensively investigated  group equally ranked                                                        context constraint satisfaction satisﬁability problems    symmetries quantiﬁed boolean formulae         different approaches proposed break symmetries                                                        conveniently classiﬁed dynamic static schemes  let ΦqxqmxmΨ       beaqbfandσ      apermu                        Φ      σ   litΦ → litΦ    dynamic breaking generally search break symmetries  tation literals                                                                σ    Φ                        σΦ     ing breaking predicates benhamou sais   permutation   deﬁned follows                           σx   σx  σΨ                  Ψ         gent smith   static breaking schemes refer tech                        example    niques detect break symmetries preprocessing  clausal form σΨ  σcc ∈  Ψ σc  σll ∈                                          step sat symmetries generally broken generat                                                       ing additional constraints called symmetry breaking predi  deﬁnition  let ΦqxqmxmΨ      quantiﬁed  cates sbp crawford  aloul et al suchsbp  boolean formula σ permutation literals Φ eliminates models each equivalence class sym  σ symmetry Φ iff                              metric models general case                                                        set symmetry predicates exponential size    ∀x ∈ litΦσ¬x¬σx                                                        aloul et al  aloul et al extend approach craw    σΦ  Φ σΨ  Ψ ∀i ∈m σxi    ford crawford  using group theory concept      xi                                               nonredundant generators leading considerable reduc    let note each symmetry σ qbf Φ sym tioninthesbpsize  metry boolean formula Ψ converse true brieﬂy recall symmetry breaking technique intro                      Φ                                 duced crawford crawford et al letΨ  set symmetries subset set symmetries         σ     Ψ                                                 cnf formula                 symmetry                                                        Ψthesbp    associated σ deﬁned follows    symmetry σ seen list cycles cn                                                        ≤  each cycle ci list literals li lin  st ∀ ≤                                                       → ≤  kniσili  li    σili li wedeﬁneσ                          ni                               ci ci number literals ci    ci∈σ                                                  xn−  yn− → xn ≤ yn    known breaking symmetries lead  general case exponential number clauses craw sbp deﬁned expresses ∈                 ford et al   paper efﬁciency clarity rea  −  xi yi equivalent truth  sons consider symmetries binary cycles value xk truethenyk assigned truethis  approach extended symmetries cycles arbi reasoning extended qbf provided symme  trary size                                           try follows preﬁx ordering    detecting symmetries boolean formula equiva  lent graph isomorphism problem crawford   motivation  crawford et al  problem ﬁnding                                                    following example show main difﬁculty  mapping graphs   problem extension sat symmetry breaking predicates sbp  proved npcomplete polynomial algorithm qbfs  known context deal graph automorphism                                                                      Φ∀x    ∃x Ψ                 Ψ  problem ﬁnding mapping example  let          qbf                                                        ∨¬x  ∧y  ∨¬y  ∧¬x  ∨¬y   ∨x  ∨y   particular case graph isomorphism pro                             permu                                                              σ                Φ  grams proposed compute graph automorphism tation             symmetry breaking                                                                    σ  let mention nauty mckay  efﬁ symmetry  using traditional approach induces                                                                 sbp    ¬x  ∨  ∧ ¬x ∨¬x   ∨  ∧ ∨  cient practice                                    following                                                                                         ¬x  ∨             ¬x ∨     recently aloul et al aloul et al  proposed     clause    universally quantiﬁed                                                                                         sbp  interesting technique transforms cnf formula Ψ new obtained qbf adding original  agraphgΨ   vertices labeled colors qbf leads invalid qbf formula  colored vertices considered searching automor overcome main drawback addition classi  phism graph vertices different colors cal sbp new breaking predicates called qsbp  gen  mapped each                          erated symmetries containing universal cycle    audemard et al  simple extension qbfs deﬁnition  case variables ex  formulae given extension simply obtained istentially quantiﬁed variables associated  troducing different color each set vertices lit new additional universally quantiﬁed variables rela  erals belong quantiﬁer group way literals tionships expressed generated qsbp  safely                                                    ijcai                                                    add qsbp  original qbf formula new preﬁx deﬁnition  let σ  ck cn st ck xkyk  ordering computed                                  ≤ ≤ universal symmetry deﬁne qsbp σ    formal presentation approach single ∪qsbpσyk  ≤ ≤ nstyk universal  symmetry generalization arbitrary set symmetries qsbp associated σ qsbp σ built using  described                                       following steps    breaking single symmetry                                                           adding auxiliary variables  each universal cycle  formally introduce approach breaking sym ck xkyk  ∈ σ associate new universal vari  metries qbf                                                                                                             able yk outliteral yk universal quantiﬁer                                                               deﬁnition  let Φqx    qixi qmxm   Ψ        substituted existential quantiﬁer  qbf σ symmetry Φ deﬁne σ ↑ xi sub   generating new predicates   sequence symmetry σ restricted cycles involving                                                              • xy universal cycle st   variables xi symmetry σ rewriten                                                                                                  qsbσy  ¬x → ↔  following preﬁx ordering σ σi σm                                                              •∀k            σi  σ ↑ xiwhenσ  respect preﬁx ordering called               universal cycle                                                                qsbpσy   pordered                                                             following constraints                                                                                                                                                 –  ¬xk → yk ↔ yk xk  yk    sequel symmetries considered pordered                                                                                          –  ¬xj ∧ yj → yk ↔ yk ∀j st  ≤ jk  example  let Φ∃xy∀xy∃xy   ¬x ∨ ∨ ∧                                                        example   let consider qbf Φ given example   ∨¬x ∨yx ∨x ∨x∧¬x ∨¬y∧x ∨xx ∨                                                        symmetry σ Φ contains universal cycle xy  ∧ ¬x ∨¬y ∨¬x   ∨¬yΦhas symmetry   σ                                                                                              using deﬁnition  new variable associated  xyxyxy reordering σ respect                                                        variable existentially quantiﬁed  preﬁx leads σ  σσσ st σ  σ ↑ xy                                                                                           qsbpσ qsbpσy ¬x → ↔  σ  σ ↑ xy σ  σ ↑ xy                                                          described generate qsbp new variables  deﬁnition  let Φ qbf σ symmetry Φ   cycle σ deﬁne resp inliteral introduced sequel variables                                                        integrated qbf preﬁx  resp outliteral cycle called universal  universally quantiﬁed symmetry σ called universal deﬁnition  let Φqx qmxm Ψ qbf  contains universal cycle called σ  σ σj σm universal symmetry let st  existential                                          qj    ∀ σj    σ ↑  xj    xy xnyn                                                              y y   existential symmetries qbf classical sbp craw          set new variables associated                                                        yn respectively deﬁne new ordering  ford et al  translated linearly cnf                                                                                                varσj  ∪  follows  rankxk ranky       mula thanks new additional variables obtained set                                                                                                  rankyk st  ≤ ≤  clauses added qbf matrix preserving                                                                  deﬁne   σj       as precedence graph associ  validity main problem arises breaking universal                                                                                       ated σj            xkyky      symmetries example  safely break universal                ≤k≤n                                                                       y  y   symmetries keeping classical sbp ﬁrst reorder ≤k≤n         symmetry variables belonging universal quan rewrite quantiﬁer group qjxj qbf formula  tiﬁer group new ordering allows determine literals deﬁnition  new ordering derived applying topo  likely implied sbp secondly implied uni logical sort algorithm precedence graph let note  versal literals lead invalidity qbf original graph acyclic ﬁgure  graph represen  approach proposed deal literals tation σj  σ ↑ xj illustrated ordering xn                                                               following problem universal implied literals il yny yn considered  lustrated approach motivated                                                                                           σ  xyxkyk                                                          let                             universal symme                          yn                                                                                n     try given qbf Φ xkyk universal cycle                                mentioned σ ordered according preﬁx Φ                                                                                                                 suppose xi yi  ≤ ≤ −  assigned                         n  truth value xk assigned true universal literal  yk implied sbp avoid case univer   figure  graph representation σj  sal quantiﬁer yk substituted existential quanti  ﬁer xi yi assigned different truth                                                    deﬁnition  let Φqx   qmxm   Ψ  qbf σ   values assigned false remain universally σ σ                        ∈   quantiﬁed manage cases new universal vari   universal symmetry                                                       σj   σ ↑ xj   xyxnyn quantiﬁer  able yk introduced variable plays role                                                              qjxj   Φ  yk second case ﬁrst case group rewritten   useless relation variables expressed • qj  ∀ σ ↑ xj  ∅                                                                                                using new predicates called qsbpσyk                qj xj  ∀xjvarσj xn∃α∀y yn∃y yn                                                    ijcai                                                                                           ﬁgure  st  xj ∪y  α new                                                                                      variable                                              Ψ ∧      sbpσi ∧          qsbpsx    •          qpxp                                                 ≤i≤n             x∈varuΦ  Φ rewritten                  Φ   qx  qi xi qmxm  Ψ ∧ sbp  ∧ qsbp          preﬁx ordering                                                        let show new qbf preﬁx built  remark   deﬁnition  new variable α introduced                                              sidering set symmetries single symmetry deﬁ  constrain set variables  assigned nition  set symmetries σσn consider  fore y y                                                      each universal quantiﬁer group qkxk projections                                                                                  property  let Φ qbf σ symmetry ΦthenΦ σ  ↑ xk  each symmetry σ  new quantiﬁer group                                                          valid iff Φ valid                              qkxk  obtained precedence graph representation                                                                                                         σi  sketch proof property  consider qbf given projections let recall each symmetry                                       Φ                considered pordered additionally avoid cycles  example  applying approach  obtain                                                                            graph representation σ ↑ xk ≤ ≤ each pro  qbf                                                                                                              jection σ ↑ xk considered lexicographically ordered    Φ   ∀x∃α∀y∃yxy  Ψ ∧¬x ∨y∧¬x  ∨¬x ∨   ∧ ∨¬x ¬y   ∧ ∨ ∨¬y  ∧ ∨¬y  ∨ y                                               deﬁnition  let σ  xyxnyn set   assigned value true clause cycles σ called lexicographically ordered lexordered  ¬x   ∨                  true          deduce     assigned short iff xi   xi ≤yi  ≤ ≤ xi xi  value false original universal variable deduced  ≤                substitution equivalent thanks added                                                      example   let Φqx           qmxm   Ψ     constraint ¬x → ↔ yasranky rankywe                                                          y             qbf  σ   σ   symmetries Φ   st   σ   ↑  need substitute occurrences                                                                                                         xx¬x ¬xxx σ   ↑        breaking symmetries                          xxx ¬x   ∀  respect lexi                                                        cographical order σ ↑  xxxxxx  generating qsbp                                                                                                      σ    ↑         xxx ¬x figure   considering symmetries eliminate                                                        shows   precedence graph  representation  independently processing each single symmetry                                                                     σ  ↑    σ   ↑    applying topological sort  ing single symmetry breaking approach described sec                                                                             algorithm quantiﬁer  rewritten  tion  needs consider interactions qp xp  ∀x ∃α∀x x ∃x ∀x x ∃x  different symmetries considering universal                                                             literal yk associated new variable yktheqsbpσyk                                                y                  express conditions literals                                                                               equivalent variable yk introduced                                                                                                                                                                                                         each universal outliteral ykwhenyk appears sym                                                                                                                                                                                                                                    metries different conditions leading equivalence    z                                                                                                                                                                             need combined                                                                                                                                                       deﬁnition  let  Φ       qbf     σ                                                                                                       xy xiy  σ  zw zjy   figure  precedence graph σ ↑ σ ↑  symmetries Φ universal outliteral qsbp’s  associated respect σ σ written                                                        dealing universal cycles form yx  following form deﬁnition                      z¬x    • qsbpσy  α →  ↔ y α → ↔ y                                                     preserve equivalence wrt validity orig                                                  • qsbpσ  β → ↔  βm → ↔    inal qbf new generated let address  deﬁne binary correlation operator η σ σ problem arising interactions differ  follows                                           ent symmetries illustrated following example                                     ησy σ  α ∧ β → ↔  α ∧ βm  → problem arises symmetries universally quantiﬁed                                                                                                 ¬x  ↔  αn ∧ β → ↔  αn ∧ βm  → ↔ outliteral appears positively   negatively    y                                                       example   let Φqx  qixi qmxmΨ    qbf                                                                                 σ σn                         σ σ symmetries Φ st σ ↑ xi  xy  deﬁnition  let              set symmetries   given qbf universal literal deﬁne     σ  ↑ xi  ¬yqi  ∀                                 sy    •syσ    ∃x ∈ σ   σ σ                using approach quantiﬁer group qixi rewritten                                                                                                                     sy           ∀xivarσ σ ∀xx∃α∀y∃y generated sbp    • qsbpsy  ηηησ σ  σ                                                                                                             σ contains clause ¬x ∨ xforσ corre                                                                                       deﬁnition  let  σ σ  set symmetries sponding sbp contains clause ¬x ∨¬yas                                            given qbf Φqx   Ψ new qbf matrix Ψ deﬁned  universal variable substituted existential  follows                                           applying qresolution rule kleineb¨uning et al                                                    ijcai                                                     c leads universally quantiﬁed resolvent giunchiglia et al set qbf  ¬x  ∨¬x consequently new obtained qbf stances contains different families like toilet  fpga  invalid finding new ordering avoid problem qshifter comparison run stateoftheart  challenging task example  problem dplllike solver semprop letz  qbf instances  avoided considering new ordering breaking symmetries time limit ﬁxed  instead used lexordering possible solution  seconds results reported seconds symme  actually investigation apply composition try computation time including detection qsbp genera  symmetries precisely consider σ ◦ σ ◦ σ tion reported second cases                         obtain new symmetry σ ¬x addition σ  σ consider σ previous resolvent gen                                                                 erated using qresolution universally quantiﬁed  outliteral universal quantiﬁer sub  stituted existential resolvent contains    literal ¬x associated variable existentially quan                                                                  tiﬁed finally quantiﬁer group qixi rewritten                     qi xi  ∀x∃α∀x∃x∀y∃y    discussion gives idea solve      general case problem arising symmetries  universal cycles form yx z¬x paper    problem simply avoided using following restric  tion                                                                                                                                                   deﬁnition  let Φqx      qmxmΨ    qbf  ∈  varuΦ                              Φ                   set symmetries                 figure  semprop comparison  deﬁne sy  ↓      σ   ↓  yσ  ∈syfor  σ              σ↓                              deﬁne         scatter plot log scale given ﬁgure  illustrate  yk   xyxk−yk− restriction                     rts yσσ    ∈  σy     comprative results semprop letz  each qbf  wrt    deﬁned                                  instance Φ Φs respectively xaxis resp yaxis  ∅σ¬y∅ ∪ sy     ∪s¬y↓¬y    set                                                        corresponds cpu time tx resp ty obtained sem  variables varuΦ    vvvaruΦ deﬁne                                                                            prop Φ resp Φ  each dot tx ty coordinates  rts aruΦ  rtrts                                          varuΦ        corresponds qbf instance dots resp                                                                                                       Φ  note sy∅ s¬y∅thenrts ysnat    diagonal indicate instances original formula                                                                      tx  ty               tx  ty  urally given set symmetries new qbf formula solved faster resp slower                                                                     Φs  generated using rts aruΦ way obtained qbf formula   formula equivalent wrt validity original figure  clearly shows computational gain obtained                                                        ing symmetry breaking predicates  instances  complexity                                            solved efﬁciently cases gain   let σ symmetry qbf cnfqsbp  σ   ders magnitude course exists instances  cnf representation qsbp σ worst case spacial breaking symmetries decreases performances                                         complexity cnfqsbp  σ oσ  considering sempropabout  instances remaining instances  σ  σσn σi xiyi  ≤ ≤ ntheworst  performance solver remains  case reached when cycles σ universal breaking symmetries       qsbp  σ          qsbpσ  qsbp σ   case             ≤i≤n                           table  provides detailed results different qbf         qsbpσy  qsbpσy        −                              nb    ≤i≤n                    equal          families second column   represents number                                                                                                deﬁnition  qsbp σ  ≤i≤n  instances each family column   indicates                  nn                                instances contain universal symmetries   equal        interestingly using                  tt  new variables introduced cnfsbp size each family   represents total number  qsbp  σ linear unfortunately solved instances total runtime needed solving  correlations different symmetries qsbp asso instances  seconds added each unsolved  ciated set symmetries exponential worst case respectively  practice considered qbf instances num table  gives comprehensive  ber applied correlations deﬁnition  does exceed  sults respect each family breaking symmetries  consequently qsbp reasonable size signiﬁcantly improves semprop performances qbf                                                        families leading solved instances  instances sec                                                        ondly existence universal symmetries    experiments                                        important factor reducing search time surpris  experimental results reported section ob ingly noticed symmetries literals  tained xeon  ghz  gb ram performed     occurring innermost quantiﬁer group useless  large panel symmetric instances  available deed symmetries does lead great reduction                                                    ijcai                                                    
