       efﬁciently exploiting symmetries real time dynamic programming                      shravan matthur narayanamurthy          balaraman ravindran                             department science engineering                                   indian institute technology madras                              shravmncseiitmacin ravicseiitmacin                          abstract                          ﬁnding functionally equivalent smaller model using ap                                                        proach forms crux model minimization paradigm      current approaches solving markov decision     identifying symmetrically equivalent situations frequently      processes mdps sensitive size sults useful abstraction informally symmetric      mdp applied real world problems  invariant certain transformations      mdps exhibit considerable implicit redundancy    obvious class symmetries based geomet      especially form symmetries existing    ric transformations rotations reﬂections transla      model minimization methods exploit tions existing work model minimization mdps      dundancy symmetries work    givan et al  zinkevich balch       given symmetries present timeefﬁcient handle symmetries fail consider state      algorithm construct functionally equivalent action equivalence provide speciﬁc algorithms      duced model mdp present     minimize mdp considering stateaction equivalence      real time dynamic programming rtdp algo          article consider notion symmetries      rithm obviates explicit construction form symmetry groups formalized ravindran      reduced model integrating given symmetries barto  objective present algorithms      rtdp algorithm solves reduced    provide way using symmetry information solve      model working parameters origi mdps achieving enormous gains normal solu      nal model given symmetries rtdp uses  tion approaches present timeefﬁcient algorithm      experience determine states backup greduced image algorithm construct reduced model      focuses parts reduced state set given symmetry group reduced model obtained      relevant results signiﬁcantly faster functionally equivalent original model pre      learning reduced overall execution time serves dynamics original model solu      algorithms proposed particularly effective tion reduced model lead solution origi      case structured automorphisms    nal model reduced model signiﬁcantly      reduced model does fewer features    smaller compared original model depending      demonstrate results empirically symmetry information supplied solv      mains                                            ing reduced model lot easier faster fur                                                        ther identify explicit construction reduced                                                        model essential use symmetry information    introduction                                       solving mdp use greduced image algorithm  markov decision processes mdps popular way basis present reduced real time dynamic pro  model stochastic sequential decision problems grammingrtdp algorithm integrates symmetry  modeling solution approaches mdps scale poorly formation rtdp algorithm barto et al  used  size problem real world problems tend solving mdps algorithm works directly  large yield readily current original model considers portion original  lution techniques models real world problems model does exhibit redundancy relevant  exhibit redundancy eliminated reducing size achieving goals focus relevance states  problem                                       results signiﬁcantly faster learning leading huge savings  way handling redundancy form abstractions overall execution time make algorithms ef  humans ignoring details needed performing fective especially terms space advocate use  immediate task hand researchers artiﬁcial intelli certain structural assumptions mdps use  gence machine learning long recognized impor domains demonstrate improvement obtained using  tance abstracting away redundancy operating com reduced rtdp algorithm  plex realworld domains amarel  given model introducing notation background informa                                                    ijcai                                                    tion sec  present greduced image algorithm set induces partition equivalence relation                                                                                          sec  present reduced rtdp algorithm                                                                          ≡                        ⊆   ×  sec  experiments results achieved pre equivalent written letb partition  sented sec  finally conclude article giving arbitrary sets projection                                                                                                 directions future work sec             partition bx ∈                                                                                                                                                                block containing pair                                                                                                                                                 component contains pair component    notation background                                                                                                                         block containing pair component    markov decision processes                                                        contains pair component  markov decision process tuple s Ψ rwhere    set states ﬁnite set actions deﬁnition  mdp homomorphism mdp                                                              Ψ             m      Ψ    Ψ ⊆ × set admissible stateaction pairs  Ψ ×   mdp                                                                                     Ψ   Ψ  →   transition probability function ps  surjection  deﬁned tuple surjections                                                           ∈                     →     probability transition state state gs  gs wheref                 Ψ →                                      →     ∈   ∀   ∈  ∈  action aandr          expected reward function   gs                  rs expected reward performing action                                                   ∈ Ψ⊆                                                            state sletas            denote set                                                                       ∀  ∈                   gs                   actions admissible state assume                             ∈   nonempty                                                                                                                                                            stochastic policy π mapping Ψ →   st              gs                      ∈  π     ∀ ∈ thevalue  state pol                              icy π expected value discounted sum future use shorthand hs hs  rewards starting state following policy π                         π                                                                           ∈  value function corresponding policy π deﬁnition  mdp homomorphism      gs                                                                           Ψ           m     mapping states values π mdp             mdp             π                                             Ψ                               m  shown satisﬁes bellman equation                   mdp isomorphism                                                           bijective said isomor                                                                          π                                   π           phic vice versa mdp isomorphism mdp            π        γ                                           automorphism            ∈                  ∈                                                                                                                                  ≤ γ discount factor                   deﬁnition  set automorphisms mdp                                            π∗           denoted autm forms group composition ho    solution mdp optimal policy uni                                            formly dominates policies mdp momorphisms group symmetry group          π∗   ≥ π      ∈            π  words                  let  subgroup autm  subgroup                                                        duces partition Ψ           factored markov decision processes                                        bg      bg                                                        exists ∈gsuch hs   factored mdps popular way model structure said equivalent written ≡g  mdps factored mdp deﬁned tuple    Ψ                 ≡                                          p        bgs write shorthand                                           ⊆            ≡  state set given features variable si gs proved exists homomorphism                                                                            si set permissible values feature  partition induced                                                                                                 ﬁnite set actions Ψ ⊆ × set admissible                                                                                bh isthesamebgtheimageof      called  stateaction pairs transition probabilities greduced image  scribed twoslice temporal bayesian network tbn adding structure state space representation allows  state transition probabilities factored consider morphisms structured projection                         m                             homomorphisms sec  ravindran barto                                                 ps      probs pres       shown symmetry groups result projec                                                    tion homomorphisms degenerate cases                                                                                simple class structured morphisms lead        denotes parents node          pre si                          si            useful symmetry groups generated permutations  tbn corresponding action each probabilities                                                      feature values let set possible permuta  probs pres  given conditional probabilitiy table                                                                                   tions m given structured set ⊆   associated node  reward function simi                                                               si                                  permutation σ ∈   deﬁne permutation  larly represented                                    σ                                                                        xm      xσ   xσm  valid permu                                                                        ∈                      ∈    homomorphisms symmetry groups                tation xσi xi xm  section adapted ravindran barto deﬁnition  permutation automorphism structured                                                  mdp    s Ψ r bijection Ψ deﬁnedbya                                      ∈                                                   let partition set xforanyx denotes tuple bijections gs  gs                                                                 ∈        →  block belongs function set    valid permutation                                                    ijcai                                                         →     ∈   ∀   ∈  ∈          compute image mdp parameters algo  gs                                                                        rithm terminates representative each                                                           gs                              equivalence class examined proof                      m                                transition probabilities actually represent                                                      duced image app algorithm presented                        probs   pre                                                sumes states reachable initial state                                                                  easy modify algorithm suitably assuming         gs                            explicit representation symmetry group table                                                      lookup takes constant time algorithm run time                ∈                  pre sj pre            Ψg                                                      proportional      explicit representation  assigned according                            demands exorbitant memory order gΨ                                                          discussed sec  structured morphisms used    greduced image algorithm                          advantageously reduce state space advantage                                                        morphisms forming symmetry group need    motivation                                       stored explicitly deﬁned features instead  large family tasks symmetry groups known states  speciﬁed designer through su example let consider case permutation auto                                                                                                perﬁcial examination problem straight forward ap morphisms check ≡g   need                                                                                                proach minimization using symmetry groups require generate states equivalent   applying  enumerate stateaction pairs mdp each ∈g each application incurs time linear  symmetry group given constructing number features case time complexity                                                                                                duced mdp explicit enumeration takes time proportional algorithm presented order Ψ gmwhere  Ψg                                           number features space needed    present fig  efﬁcient incremental algorithm storing explicitly  building reduced mdp given symmetry group sub restricting class automorphisms func  group adaptation algorithm proposed tions deﬁned features instead states  emerson sistla  constructing reduced models incur additional time function number  concurrent systems                               features signiﬁcantly number states                                                        drastic decrease space complexity use   given  s Ψ r g≤autm              factored representations leads reduction space                                  construct mbg  s   Ψ                needed storing transition probabilities reward                                  set initial state ←s          function making algorithm presented effec   nonempty                               tive use generic case just sub      dequeueq                                   group algorithm work little symmetry     ∈                                    information designer                                              g     ∈ Ψ                                Ψ  ←  Ψ  ∪                                                         reduced rtdp algorithm            ←  ∪                           rs                           motivation           ∈ ps                                                       given real world problem modeled mdp state              ≡g  ∈                                                   space invariably consists vast regions rele                  ←   ps vant achieving goals minimization approach leads                                                                   certain degree abstraction reduces extent                 ←  ∪                                                       regions nonetheless reduced image contains                  ps             regions relevant achieving goals                 add                          reduced model goal ﬁnd pol                                                        icy acting original model forgo explicit  figure  incremental algorithm constructing construction reduced model integrating informa                                    g≤      reduced image given mdp        aut    qis    tion symmetry group algorithm solves  queue states examined terminates original model variety ways                                            representative each equivalence class solve mdp choose rtdp uses ex  examined                                             perience agent focus relevant sections                                                        state space saves time spent explicit construction                                                        reduced model    comments                                           greduced image algorithm presented doesn’t  algorithm does breadthﬁrst enumeration states skip preserve structure transition probabilities  ping states stateaction pairs equivalent reward function existed use  visited encountering stateaction pair equiv factored representations consequently reduced image  alent visited examines states reachable considerably space original model                                                    ijcai                                                     given  s Ψ r g≤autm              reduced image normal rtdp converges optimal   hashtable ← nil action value function    action value function barto et al  reduced rtdp   repeat each episode                                                       converges long continues states     initialize ←s                          reduced image     choose using policy derived                                                         complete construction reduced image        greedy policy                                 considerable time mapping irrelevant     repeat each step episode                                                states reduced model use        ≡g     ∈                                                    algorithm near optimal policies                           ←    ←                              construction reduced image complete faster                                              normal rtdp algorithm state space reduced           continue                                  use symmetry group information        action observe reward                             state                               choose using policy derived      experiments results          eggreedy policy        ps              experiments three domains explained                                            ≡g  ∈               show effect degree symmetry consid                                            ←   ps ered domain consider fold symmetry                                                 strict subgroup autmthatisg  autm                                                                                  ← ∪                              symmetry      aut   compare reduced rtdp al                                ps                gorithm using  degrees symmetry normal                                         rtdp algorithm present learning curves representing           add                           decrease number steps taken ﬁnish each episode           qs ←                                 show time efﬁciency reduced rtdp algorithm        qs ← rs                             present bar chart times taken reduced rtdp al                                                       gorithm using  degrees symmetry normal rtdp                                                    γp  max qs           algorithm completing  episodes each domain                              ∈                                                                                   γ                ∈s                                    algorithms used discount factor   epsilon                                                        greedy policy    used choose actions            ←   ←                                                 each step lack space present graph                                                        domain experiments different sizes  figure  rtdp algorithm integrated symmetries each domain results similar cases note  computes action value function reduced mdp exceptions relevant  explicitly constructing                                                          deterministic gridworlddgw  algorithm present fig  tries achieve best  worlds works original model gridworlds sizes  includes state space reduction integrating terministic actions going right left  symmetry group information rtdp algorithm   implemented initial state  goal                                                        states   respectively    convergence reduced rtdp                      fold symmetry states nesw diagonal xy                                                        yx equivalent grid size ×  algorithm modiﬁcation rtdp algorithm          −                −   steps previous algorithm integrated lines  let maxx  maxy    sym                                                       metry case states xy yx maxxxmaxyy maxy   assume reduced mdp  leaving lines   lines   leaves ymaxxx equivalent state action equivalence  normal rtdp algorithm run reduced image ﬁned accordingly                                        explained ∈ Ψ   rs  equivalence tests lines   algo  probabilistic gridworldpgw  rithm maintains policy considers reduced gridworlds sizes actions  state space app lines   compute transi                                                     going right left implemented  tion probabilities reduced image eqn  unlike deterministic domain actions led rele  expected reward reduced image     ∈ Ψ                                   vant grid probability  left state            update equation changed probability  initial state   line  rewritten                                                                                                                             goal states                                                  spectively fold symmetry states nesw di    qs   γp  max qs                                       ∈               agonal xy yx equivalent sym                     ∈                                                             metry case states xy yx maxxxmaxyy maxy  update equation reduced im ymaxxx equivalent state action equivalence  age exactly similar running normal rtdp ﬁned accordingly                                                    ijcai                                                                                                                                                                                                                                  normal rtdp                      normal rtdp                                                                                                                                                 reduced rtdp                                           reduced rtdp                    fold symmetry                                        fold symmetry                   steps episode                                                               reduced rtdp                                                                   steps episode reduced rtdp                           symmetry                                         symmetry                                                                                                                                                                                                                       episodes                                                                                                                                 episodes  figure   learning curves deterministic grid  worldx grid                                    figure  learning curves probabilistic towers                                                        hanoi disks                                                                        hanoi  disks                                                    normal rtdp                                                                                                                             reduced rtdp                        fold symmetry                                                                               steps episode                           reduced rtdp                                                      symmetry                                                                                                                                                                         episodes                                                                       timescaled  taken  episodes                                                                          figure   learning curves probabilistic grid                                   worldx grid                                                         different domains                                                              figure  comparison running timesscaled    probabilistic towers hanoiptoh  towers hanoi domain implemented  pegs  domains   disks imple  discussion  mented actions allowed transfer smaller disk                                                        results expected comparisons show  larger disk peg permitted                                                        reduced rtdp algorithm learns faster normal rtdp  actions did transfer disk probability                                                         symmetry case fold sym  left state unchanged probability  initial                                                        metry case reduced rtdp algorithms  state case  disks                                                             using symmetry better lesser    disk case goal states designed                                                        symmetry reﬂected running times algo  allow various degrees symmetry fold symmetry                                                        rithms symmetry case  times faster  goal states considered states disks                                                        normal rtdp fold symmetry faster  peg   equivalent states                                                        normal rtdp  disk positions pegs   interchanged sym  metry case goal states considered states observation contrary graph shown bar  disks peg equivalent states graph fig  reduced rtdp algorithms  disk positions interchanged possible permutation used small domains like disk towers hanoi  pegs state action equivalence deﬁned accordingly overhead involved checking equivalence states                                                        weighs beneﬁt reduction symmetry    time efﬁciency                                   able quantify exact extent                                                        tradeoffs involved feel expected  bargraph fig  shows running times scaled length trajectory goal state initial state  graph normal rtdp reduced rtdp small comparison state space beneﬁts ob  fold symmetry reduced rtdp symmetry tained using symmetry group information masked  ﬁrst cluster deterministic gridworld domain  grid second cluster probabilistic gridworld running times domains lesser size follow pat  grid probabilistic towers tern indicated graphs sec                                                     ijcai                                                    
