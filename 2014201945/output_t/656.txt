                                casebased multilabel ranking                                    klaus brinker    eyke hullermeier¨                                     data knowledge engineering                            ottovonguerickeuniversitat¨ magdeburg germany                                brinkerhuellermiticsunimagdeburgde                          abstract                          cation sports irrelevant somewhat                                                             present casebased approach multilabel      mlc point view additional order informa      ranking recent extension wellknown prob tion useful facilitates postpro      lem multilabel classiﬁcation roughly speak   cessing predictions considering      ing multilabel ranking reﬁnes multilabel clas relevant labels regarding relation mlc      siﬁcation sense mlr furthermore like emphasize points firstly      splits predeﬁned label set relevant ir seen technical mlr      relevant labels furthermore puts la demanding mlc respect training informa      bels parts bipartition total tion multilabel ranker trained multilabel      order introduce conceptually novel frame   classiﬁcation data secondly inducing ranker      work essentially viewing multilabel ranking useful eventually interested mlc      special case aggregating rankings sup roughly speaking mlr model consists compo      plemented additional virtual label nents classiﬁer ranker interdependencies      ties permitted frame tween labels learned ranker help      work amenable variety aggregation pro ful discovering compensating errors      cedures focus particular technique classiﬁer just illustrate suppose classiﬁer esti      computationally efﬁcient prove com mates label relevant second      putes optimal aggregations respect gen additional conﬂicting information typically      eralized spearman rank correlation underly ranked estimation ques      ing loss utility function propose tion repair misclassiﬁcation      elegant generalization loss function                                                          hitherto existing approaches operating ranking scenar      empirically show increases accuracy                                                        ios typically modelbased extensions binary classiﬁca      subtask multilabel classiﬁcation                                                        tion techniques induce global prediction model                                                        entire instance space training data harpeled                                                        et al  furnkranz¨ hullermeier¨  ap    introduction                                       proaches brieﬂy reviewed section  suffer substantially  multilabel ranking mlr recent combination increased complexity target space multi  supervised learning tasks multilabel classiﬁcation label ranking comparison binary classiﬁcation  mlc label ranking lr studies prob having high level computational complexity  lem learning model associates instance moderate number class labels  bipartition predeﬁned set class labels relevant sections   present alternative framework  positive irrelevant negative labels mlr using casebased methodology concep  considers problem predict rankings total orders tually simpler computationally complex  class labels mlr consistent combination main contributions paper casting multilabel rank  types prediction viewed ing special case rank aggregation ties  extended ranking containing additional information casebased framework approach limited  kind “zero point” extended mlc containing ad particular aggregation technique focus compu  ditional information order labels parts tationally efﬁcient technique prove computes op  bipartition brinker et al  example docu timal aggregations respect wellknown general  ment classiﬁcation context intended meaning mlr ized spearman rank correlation accuracy measure  pol x ecoedu x spo instance  doc section  show casebased approach compares  ument classes  topics politics economics favorably modelbased alternatives  relevant edu spect complexity terms predictive accuracy                                                    ijcai                                                       problem setting                                    calibrated ranking simply ranking extended                                                        label set l∪λ ranking induces ranking  socalled label ranking problem learn mapping                                    instance space rankings ﬁnite set labels real labels bipartite partition                                                         straightforward way px given labels    λ λc function maps instance                                                        ranked higher λ nx ranked  ∈xto total strict order x λi x λj means                                                        lower semantics virtual label clear  instance label λi preferred ranked higher  λ                                                   construction training examples binary learners   ranking conveniently represented         λ  permutation τ  τi denotes position label known relevant preferred virtual                                                        label λi x λ likewise λ preferred irrelevant la  label λi ranking set permutations                                                        bels adding preference constraints preferences  labels subsequently referred sc taken  target space label ranking                    extracted regular labels calibrated rank                                                        ing model learned solving conventional ranking    multilabel ranking mlr understood learning             model associates query input ranking problem labels discussed approach                                                        advocate similar idea extending  x bipartition multilabel classiﬁcation mlc  label set relevant positive irrelevant negative casebased learning multilabel ranking scenario  labels subsets pxnx ⊆lsuch px ∩ nx  ∅  px ∪ nx  brinker et al  furthermore rank  casebased multilabel ranking  ing bipartition consistent sense                                                        casebased learning algorithms applied success  λi ∈ px λj ∈ nx implies λi x λj                                                        fully various ﬁelds machine learning pattern    aside note according                                                        recognition dasarathy  previous work pro  sistency requirement bipartition pxnx implicitly                                                        posed casebased approach tailored label rank  contains ranking information relevant labels ranked                                                        ing exploit bipartite data does sup  irrelevant ones mlr model                                                        port predicting zero point multilabel ranking sce  trained standard mlc data considers                                                        nario brinker hullermeier¨  algorithms  extended prediction task                                                        fer processing training data estimation new                                                        instance requested property distinguishing    modelbased multilabel ranking                     modelbased approaches particular advantage  common modelbased approach mlc binary rele  layed processing learning methods estimate  vance learning br br trains separate binary model mi target function locally instead inducing global prediction  each label λi using examples λi ∈ px posi model entire input domain data  tive examples λj ∈ nx negative ones typically small subset entire training data  classify new instance submitted models examples similar query retrieved  px deﬁned set λi mi predicts combined order make prediction exam  relevance                                            ples provide obvious means “explaining” prediction    br extended mlr problem straightfor supporting humanaccessible estimation process  ward way binary models provide realvalued conﬁdence critical certain applications blackbox predictions  scores outputs ranking simply obtained order acceptable label ranking problems appeal  ing labels according scores schapire singer ing property difﬁcult realize algorithms using com   hand approach simple efﬁ plex global models target function com  cient hand adhoc disad plex structure underlying target space typically entails  vantages example good estimations calibrated scores solving multiple binary classiﬁcation problems rpc yields  probabilities hard obtain ap cc  subproblems requires embedding training  proach extended general types prefer data higher dimensional feature space encode prefer  ence relations partial orders detailed sur ence constraints cc  vey mlc mlr approaches including casebased  contrast modelbased methodology suf  methods refer reader tsoumakas et al  fers substantially increased complexity target    brinker et al  presented uniﬁed approach cal space mlr present casebased approach  ibrated label ranking subsumes mlr special complexity target space solely affects aggrega  case framework enables general label ranking tech tion step carried highly efﬁcient manner  niques modelbased ranking pairwise compar knearest neighbor algorithm knn arguably  ison rpc furnkranz¨ hullermeier¨  constraint basic casebased learning method dasarathy  classiﬁcation cc harpeled et al  incorporate simplest version assumes instances represented                                                                                         exploit partitionrelated information generalize feature vectors xn  ndimensional  settings predicting separation relevant space  rn endowed standard euclidian metric  irrelevant labels required approach does assume distance measure extension instance  underlying binary classiﬁers provide conﬁdence scores spaces general distance measures d· · straight  instead key idea calibrated ranking add virtual forward query feature vector submitted  label λ split point relevant irrelevant labels knn algorithm retrieves training instances closest                                                    ijcai                                                     point terms d· · case classiﬁcation learn ing σ necessarily unique lσminτ lτ  ing knn algorithm estimates query’s class label remaining step actually solve multilabel ranking  frequent label neighbors ing casebased methodology incorporate methods  adapted regression learning scenario replacing compute approximately optimal solutions lat  majority voting step computing weighted mean ter optimization problem exploit particu  target values                                    lar property metric approach provides general    order extend basic knn algorithm multilabel framework allows plug optimization tech  learning aggregation step needs adapted suit nique suitable metric rankings ties order  able manner simplify presentation focus aggregate nearest neighbors query instance  standard mlc case training data provides complexity computing optimal aggregation  bipartition relevant nonrelevant labels each pends underlying metric form bottleneck  stance later discuss incorporate optimization problem nphard kendall’s tau  complex preference ranking data training       bartholdi et al  spearman’s footrule metric                                                                                         let consider example pxnx standard bucket orders dwork et al   computing  mlc training dataset stated key idea cali optimal aggregation feasible relatively small la                                                               λ λ   brated ranking introduce virtual label λ split point bel sets   exist approximate algo                                                                                        separate labels px nx respectively asso rithms quadratic complexity achieve                                                                                                          ciate set binary preferences adopt stant factor approximation minimal sum distances  idea virtual label instead associating preferences kendall’s tau footrule metric fagin et al   use direct approach viewing sequence approximate techniques fact provide viable op  label sets px λnx ranking ties referred tion present computationally efﬁcient exact  bucket order fagin et al  precisely method generalization sum squared rank differ  bucket order transitive binary relation  ences metric following section implement version  exist sets bm form partition domain casebased multilabel ranking framework  given  l∪λ   case  λ   λ ijsuch  aggregation analysis                λ ∈ bi λ  ∈ bj using notation mlr sce spearman rank correlation coefﬁcient linear transfor  nario corresponds generalized ranking setting three mation sum squared rank differences metric  buckets  px  λ  nx        natural wellknown similarity measure strict rankings    training data provides bipartition pxnx spearman  generalized case rank  ranking ties labels parts ings ties way spearman footrule met  additional information naturally incorporated ric integer rank values strict rankings sub  sume px nx form bucket orders bi− stituted average bucket locations                                                                          bi bj respectively combine addi bucket orders σ σ  generalized squared rank difference  tional information single ranking ties straight metric deﬁned                                                                                forward way bi−bibi bj bi                                                                     σ σ        σ − σ   λ represents split point note following anal                                ysis assumes training data converted              λi∈d  rankings ties virtual label specifying rel following theorem shows optimal aggregation  evance split point cover training data respect metric computed ordering  standard mlc case complex mlr labels according generalized mean ranks  scenario                                                        theorem   let σ σk rankings ties    bucket order induces binary preferences labels                                                                                                       λ λc suppose σ permutation labels  forms natural representation general                                                                                 λ                            σ   izing various metrics strict rankings rankings ordered according  ties broken  ties end deﬁne generalized rank σi arbitrarily  each label λi ∈das average overall position σi                                                                                                                     bl   bj bucket bj    lj                                                               lσ σj ≤ min  lτσj              λ                                                                          τ∈sc  tains fagin et al  proposed generalizations                   wellknown metrics kendall’s tau spear  man footrule distance written proceed formal proof note key                                                                                                    distance generalized ranks σ σ associated point theorem  minimum taken                                                                                                     σ σ          σ − σ              wellknown minimizer mean  bucket orders       λi∈d             given metric natural way measure quality rank vector strict rankings unique mean rank values  single ranking σ aggregation set rank optimalaggregation property proved dwork et  ings σ σk compute sum pairwise distances                                                          case strict complete rankings solving aggregation  σ        σ σ           aggregation rankings leads problem requires polynomial time spearman’s footrule metric  optimization problem computing consensus rank dwork et al                                                     ijcai                                                     al  proof general case nonunique providing efﬁcient aggregation technique note  rank values derived hullermeier¨ furnkranz¨ method aggregates rankings ties single                                                  strict ranking related problem aggregating    following proof adaptation hullermeier¨ ranking ties allowed forms interesting area  furnkranz¨  ranking pairwise comparison research case lmetric required  voting procedure complete strict rankings analyzed complexity open question multilabel rank  probabilistic risk minimization scenario essential ing requires predicting strict rankings intermedi  building block proof subsequent observation ate aggregation ranking ties entail ad  permutations                                         ditional postprocessing step forms intuitive  lemma   hullermeier¨ furnkranz¨  let mi  approach problem                                                                                        λ   real numbers ordered  ≤ ≤ ≤ stated virtual label  associated                                                                             λ   ···≤mc permutations τ ∈sc             second bucket        order provide rele                                                        vance split point initial empirical investigation ob             c            c                                                                       −  ≤     −                  served optimal rankings nn multilabel ranking                               τi            yield good performance respect standard evaluation                                                measures ranking performance accuracy                                                                        def                terms multilabel classiﬁcation measures reached reason  proof theorem  let deﬁne mi       σji                                                   able entirely satisfactory level observation                                                          attributed fact lmetric penalizes misplaced    k            k c                                 labels equally labels including λ particu                                           lτσj       τi − σji                   larly context multilabel classiﬁcation λ carries                                            special degree importance misclassiﬁcations                  c k                                 aggregation step penalized strongly                         τ −     − σ           words reversing preference labels                                                                           λ                                                especially bad labels  means mis                                                        classifying second label mlc sense                  c k                         τ −   −  τ −   ·        remedy problem approach extended                                          consistent elegant manner instead single virtual                                                                         label λ consider set virtual labels λ λp                                                                        mi − σji  mi − σji     associated split bucket bi doing                  c  k                               theoretical analysis aggregation remains valid                                                       parameter provides means control penalty mis                        τi − mi                                                classiﬁcations aggregating rankings note compu                                                        tational complexity does increase expansion                                                                                          set virtual split labels conducted implicitly                     −   τ −        − σ                                          computing prediction set virtual labels                                                    merged single label consistent way                        k                             labels mean rank value                                                                mi − σji                  illustrate “gap broadening” control mechanism let                                                    look simple aggregation example three                                                        mlcinduced rankings using single virtual label  equation midterm equals        k               k   k        k                           λλλλλλ            − σ            σ  −    σ                      λ λ   λ   λ λ λ                                                                                                                                                                    λλλλλλ                                       def k  furthermore term constant  jmi − bucket orders aggregated total order                                                                 ∅       λ  λ    σji does depend τ obtain                   mean rank                                                        λ mean rank greater including           k                 c                                                                                                                            using set virtual labels obtain                 lτσjct     τi − mi             order labels determined randomly                                                finally three virtual labels   proof follows directly lemma               aggregated calibrated ranking corresponds multi                                                        label classiﬁcation  λ  λλλ λ    proved loptimal aggregation respect  set permutations computed ordering la  empirical evaluation  bels according mean ranks regarding complex  ity method requires computational time order purpose section provide empirical com  okc  log computing sorting mean ranks parison stateoftheart modelbased approaches                                                    ijcai                                                                                                       ramaniyan et al  measured accuracy terms                                                    generalized spearman rank correlation coefﬁcient                                                                                    −                                                    malized evaluates  reversed                                                     identical rankings section                                                                                             support vector machines demonstrated stateofthe                                                art performance variety classiﬁcation tasks                                                                                         used underlying binary classi                                                     hamming  loss                              ﬁers binary relevance br calibrated ranking                                                                                              pairwise comparison crpc approaches multilabel                                                        learning previous studies elisseeff weston                                                                   brinker et al  regarding associated kernel                                                    considered linear kernels lin marginerror                                         ∈−                                                          penalty              polynomial kernels poly                                                        degree varied   ∈−   figure  gap ampliﬁcation functional yeast dataset each parameter combination validation accuracy  estimated hamming loss clearly decreases param estimated training randomly selected subsample  eter controls number virtual labels used comprising  training set testing remain  splitting relevant irrelevant labels             ing  ﬁnal model trained                                                        training set using parameter combination achieved                                                        best validation accuracy similarly number nearest  novel casebased framework using lminimizing ag neighbors ∈       determined  gregation technique datasets included addition original knn mlr approach  experimental setup originate bioinformatics ﬁelds cluded version denoted sufﬁx “r” ex  multilabeled data frequently pre ploits mlc training data pxnx common exten  cisely experiments considered types genetic data sion knn learning leading slightly modiﬁed aggrega  phylogenetic proﬁles dna microarray expres tion step average ranks weighted distances  sion data yeast genome consisting  genes respective feature vectors query vector referred  gene represented associated phylogenetic knn∗  proﬁle length  using proﬁles input features experimental results table  clearly demonstrate  investigated task predicting “qualitative” mlr knn approach competitive stateoftheart  representation expression proﬁle actually proﬁle modelbased methods precisely knn∗ crpc  gene sequence realvalued measurements each poly achieve highest level accuracy followed  represents expression level gene partic knn small margin br outperformed  ular time point converting expression levels ranks methods observation surprising br  ordering time points  labels according uses relevance partition labels training  sociated expression values using spearman correla exploit additional rankings labels similarly  tion similarity measure proﬁles motivated mlc versions knn perform worse mlr coun  balasubramaniyan et al  ex terparts crpc polynomial kernels performs  tend representation replacing rankings multilabel slightly better linear kernels br sub  rankings end use zero expression level stantial difference observed inﬂuence gap  natural split point sets px nx correspond ampliﬁcation demonstrated figure  mlc task  spectively time points gene replicated elisseeff weston  genes  expressed important biological meaning yeast dataset discussed    used data microarray experiments giving sociated functional categories  rise prediction problems using input fea ticipated behalf theoretical analysis section   tures different target rankings worth mentioning table  impressively underpins computational efﬁciency  experiments involve different numbers measure approach empirical perspective  ments ranging   context each mea  surement corresponds label obtain ranking problems  concluding remarks  quite different complexity origi  nal measurements realvalued expression presented general framework multilabel ranking  proﬁles containing ties each datasets randomly ing casebased methodology conceptually simpler  split training test set comprising   computationally complex previous modelbased  respectively instances compliance balasub approaches multilabel ranking empirical perspec                                                        tive approach highly competitive stateoftheart    data publicly available                 methods terms accuracy substantially faster  httpwwwcscolumbiaeducompbioexpphylo           conceptually modular aggregation step provides    transformation motivated biological means extend approach directions  data analysis point view                       example ha haddawy   proposed appealing                                                    ijcai                                                     
