                             primitive based generative model             infer timing information unpartitioned handwriting data                            ben williams marc toussaint amos storkey                                            edinburgh university                                           school informatics                                           benwilliamsedacuk                        abstract                          switched quickly modify movement trajec                                                        tory movement primitives superimposed kargo      biological movement control planning based giszter       motor primitives approach pre     primitive handwriting domain short time      sume each motor primitive takes responsibil extended block pen motion brought corre      ity controlling small subblock motion  sponding block muscle activations blocks su      containing coherent muscle activation outputs  perimposed each create coherent movement       central timing controller cues subroutines case character      movement creating complete movement strategies     reliably model natural handwriting introduce fully      built overlaying primitives cre generative model allowing proper modelling handwriting      ating synergies muscle activation partition variation adaptation irrespective character drawn      ing allows movement deﬁned sparse  handwriting output primitive type sub      code representing timing primitive activa blocks generative model represent primi      tions paper shows possible use tives allow efﬁciently model internal handwriting      factorial hidden markov model infer primitives encoding      handwriting data variation handwrit section  introduce generative handwriting      ing data large extent explained timing model based primitives terms factorial hidden      variation triggering primitives markov model section  covers generalisation      appropriate set primitives inferred timing primitives create timing model section       characters represented set tim present typical samples results using      ings primitive activations variances model ﬁnally discussion section       giving compact representation charac      ter model naturally partitioned low   model      level primitive output stage topdown primi      tive timing stage partitioning gives generative handwriting model capable reproduc      sight behaviours scribbling ing class characters trained      learnt order write new character      suming motor commands motor primi                                                        tives handwriting contain projections                                                        primitives assuming motor primitives ﬁxed    introduction                                       adaptable long time scales short term adaptability                                                        learning come timing selection dif  biological systems strongly superior current robotic ferent primitives  movement control systems despite having noisy sen assuming individual primitives independent  sors unpredictable muscles each linearly superimposed controller se  nature preplanning biological movement extremely lect primitive onset timing necessary similar nature  interesting strong evidence exists suggest biological piano model key pressing controls onset time  motor control systems modularised motor primitives extended clips sound listener hears superim  ﬁrst conclusively frogs bizzi et al  posed waveform  d’avella bizzi  d’avella et al  stim  ulation single spinal motor afferent triggered complete  deterministic piano model  sweeping movement frog’s leg review mod formalise model generative way output  ularisation motor control spine bizzi et al time deﬁned                                                                         evidence suggests particular subsection             αmnwmt   − τmn           movement commenced unexpectedly                        mn                                                    ijcai                                                                                                          factor state zero allows write                                                                                                                                                expectations hidden states st                                                                                                                                                           probability distribution individual states st  each                                                        latent factor markov chain deﬁned state transition                                                        probabilities initial state distribution                                                                                                                                                     iπi   pst       st− jpij                                                          πm  kdimensional parameter vector giving                                                        initial hidden state distribution k×k parameter                                                        matrix denoting state transition probabilities                                                        seen figure  each factor independent means                                                        joint probability distribution factorised  figure  graphical representation factorial hidden markov  model showing independence separate markov chains                     t  observable output dependent state ytstp sp ys stst−p ytst  entire internal states evolve interdependencies               sm   denotes hidden state vector time factor                                                                                                                   m             t m  wmt primitives τmn represents time            πmp         mp          th                                                                                         activation primitive αmn deﬁnes ac                       tivation strengths primitives deﬁnition enu                                         merates primitives whilst enumerates occurrence  primitive sample window time τmn    given fully parameterised modelling framework learn    similar models used modelling real piano ing parameters using expectation  operation cemgil et al  transfer maximisation em method structured variational ap  piano roll sound uses note onset damping proximation chosen estep inference  set key timing information reproduction sound details various arguments choice  karklin lewicki  present generative model refer ghahramani jordan  provides  speech waveforms ‘sparse shiftable kernel tails fhmm model learning procedure  representation’ similar nature piano model pre em method iterative algorithm  sented                                          step infers expectations hidden states given set    data samples handwritten characters seg parameters mstep updates parameters  mented keyed common start point apart pen maximumlikelihood values given inferred hidden state  touching paper reliable keying time distributions case estep ﬁts primitives  primitive activation ﬂexible model used infer data inferring primitive onset timings each sample  primitives infer shape primi mstep infers shapes primitives  tives timing onsets idea piano straints imposed parameters primi  model basis model probabilistically using facto tives progressed monotonically states  rial hidden markov model fhmm                      rest state primitives gave zero output contribution                                                          fhmm reconstruct data using set maxi    factorial hidden markov model                    mally statistically independent primitives appropriate  graphical model fhmm seen figure  hidden state values constraints imposed  each time step observable output yt vector dimen hidden state transitions state values reduced                                                   set primitive activation timings spikes  sion dependent hidden variables                                                       spike timing information primitive model run  output multivariate gaussian                                                        separately seen figure  thought                    yt ∼nμtc                     primitive babbling reconstruct character prim           ×                                      itives need coordinated activated appropriate         parameter matrix output covariance times achieved introducing separate                         m                              model centralised timing controller                                                 μt        st                                                                       timing model  ddimensional output mean time × centralised timing controller capable repro  parameter matrix giving output means each factor ducing spiking characteristics areas char  output mean μt linear combination acter variable time spike  columns weighted hidden state activations   existence spike words primitives    each hidden variables different necessary occurring character sample roughly  states equation  encoded kdimensional exactly place occur occasionally                                    state vector st using ink code sti mth production case crucially short time                                                    ijcai                                                                                                                         scale heavy dependency spikes ﬁt average matrix constructed taking linear  long term simply dependent character interpolations                                                                        drawn                                                            τ                                                                       knn    chosen stochastic integrate model              kn    δtnδln      generation spikes model local tempo          ral dependency characteristic allows variance precisely optimize temporal offset strecht  total number spikes sample                   ing iteratively ﬁnding δtn δln gradient ascent                                                        maximize objective function                                                                              integrate integrate model orig                                                                                                      τknnit                 inates simpliﬁed models biological neurons treats            nmt  neuron leaky capacitor charge built                                                                        inputs time voltage ca ﬁnds matrix best reﬂects average prim  pacitor reaches noisy threshold level neuron ﬁres pro itive onset probability matrix separate linear  ducing spike output discharging capacitor shifting stretching factor associated each char  means leak term long time scale acter sample used parameterise model  inputs different times independent generates spike timing information needed run  short time scale shortterm running fhmm generatively  sum inputs causes neuron ﬁre desir  able primitive model timing neces  implementation  sary primitive variable character samples handwriting data gathered using intuos   neuron ﬁre long receives wacom digitisation tablet httpwwwwacomcom  inputs during temporal memory window             productinfoxcfm provided  dimensional    straight forward model using neurons data hz dimensions data xposition  attribute neuron primitive inputs yposition pen tip pressure pen tilt angle pen orienta                                                                  ◦  neurons determine timing primitives tion   normalised ﬁrst differential data  character written particular primitive used data mean close zero providing                                       probability spike time λt  given requirements zero state assumption model                                              constraints section   dimensions data         λt λt−  λt−it  − lt         used xposition yposition pressure sig                                   λt λt−  −  lt                  nal noise ratio low provide                     lm  νpλm                       usful data data collected separated samples                             t−                   characters processing purposes parame                                                    ters ﬁtted data using algorithm generated  input excitations leak term pro  portional accumulated probability given datasets characters ‘g’ ‘m’ ‘a’ ‘b’ ‘c’ ‘d’ ‘g’  common set primitives character deﬁned tempo character set largest character set                                                      httphomepagesinfedacuks  ral excitation matrix  parameterises model  matrix learnt spiking statistics charac datamixoutgmat character sets ‘g’ ‘m’  ter training set seen                      chosen explore differences primitives inferred    during estep fhmm hidden state dis contrasting characters figure  characters ‘a’                                                      ‘b’ ‘c’ ‘d’ chosen explore sharing prim  tribution st  inferred transition matrix  constrained primitives progress monotonically itives different characters ability create                                                      distinct reconstructions seen figure   through states information st  sum  marised onset probabilities different primitives data set size                                                            ‘g’    st rows st  state  ﬁrst  state each primitive set primitives ﬁt data ‘m’   probabilities close zero form ‘abcd’   sparse matrix containing spikes representing primitive  activation appropriate reconstruct single character sample  results  data set effectively average samples typical subset primitives learnt fhmm data  spiking matrices needed parameterise gcharacters shown figure  demonstrating vari                                        model  ease notation let τtn  st ation shape length paper primitives  posterior onset probability time mth primitive reconstructed example  primitives  data sample                                length  used model data set  characters    allow differences start point time aver average length  average error reconstruction  age speed each character sample parameters velocity space data     sociated each data sample temporal offset δtn using primitives fhmm model reconstruct  linear temporal stretching factor δln parameters original character shown figure  using posterior                       optimised τtn matrices nth sample best timings st inferred data estep                                                    ijcai                                                                                                                             primitive timing data  pen space reconstruction                 primitive timing data  pen space reconstruction                                                                                                                                                    ←←                                                  ←   ←                                                    ← ←                                                                                          ←←                                                                                                                       ←                                                                                                                ←                                                       ←                                  −                                                                                    ←                                                                                           ←                                                                                                                                                                             ←                                   −                                                              ←←                                            ←                                                          ←                                                                                                                                                                          ←                                                      ←                                     −                                   −                           primitive                           ←           primitive                                                                                                                                                                                         ←                                                                                                     ←  ←←                                                                                                  ←                                                                                          −                                   −                                                                                                                        ←                                                                                            ←                                                 ←                                        − ←                                   −                                                                                     ←                                          ←                                               −                                                                                                      −                          − − −                             −                        time sample                                         time sample                                                                                         figure  examples character reconstructions using timing information derived estep inference  timing information shown left reproduction sample right onset each primitive marked  arrow  primitives length  time steps used model ‘g’ dataset  characters  primitives length   used model ‘m’ dataset  characters                                                                                                                                                                    −                                                                                 −                                                                   −            −                                                                     −          −                                                                     −          −                                                                     −          −              −                                                      −           −   −      −   −     −                    − − −                                                                                                     figure   samples generated using primitives speciﬁc timing information posterior timing learnt timing  model generated using primitives inferred ‘g’ dataset generated using primitives ‘m’ dataset starting  point reconstructions                                                                ijcai                                                                                  −                                                                                                 −                                         −                                                −      −          −              −    − −                                                            −         −                           −         −                                                                             −         −                     −         −              −−−−  − −                                                                                                                                                       −                                         −                                                   −                                                        −                                  −   − − −                                                                  figure  sample  primitives used reconstruction  figure axis values refer normalised distance    paper primitives shown reconstruction penspace   raw data dimensional velocity space  data normalised ignoring physical size pixels            meaningless provide units axes thickness  corresponds pen pressure refer section  explanation figure  graphical representation distribution spikes                                                                                                                       given ‘g’ character set    primitive extraction stage timing information seen  left figures representation poste  rior probabilities onset primitives whilst reconstruct  ing data set probabilities inferred during  estep reveal expected hidden state values  fhmm furthermore given sufﬁcient set common prim  itives model data reliably probabilities  represented spike timings provide compact  encoding character timing information  modelled using timing model investigated section     timing model used learnt                                                                                                                                       timing model hidden state posterior extracted                                                                                           −                              data run primitive model gener       −                          −                                                                                       atively ignoring precise timing information sam        −                          −                                                                    −                          −                                                                                       pling model states priors calculating       −                          −                                                                      −                          −  posterior distributions result random superposi                                                                                         −                          −    tion primitives producing scribbling form output   −                        −                                                                      −                          −  shown figure  seen primitives     − − −       − − −     precise timing information controlling ac                                                                                                                                 tivation generate samples capture aspect                                                                                                                         training set extracted allowing                            temporal shifting stretching described section        −                          −                                                                                                                                                       −                          −  produces distribution spiking patterns  seen figure  ‘g’dataset sampling dis   −                        −                                                                    −                          −  tribution using integrate ﬁre approach described                                                                                             −                           −  produces samples reliably model variation     − −       − − −     data set seen figure  clearly                                                        figure  samples generated generative model  examples character ‘g’ pen trajectory given learnt primitives fhmm timing model                                                                                        vastly different each example reﬂecting variance parameterized spike distribution shown figure   original data set inferring primitives range char  acters possible figure  shows  different characters  drawn using primitives despite variation  characters particular alphabet actual hand  ments controlling pen similar  come surprise possible use primi                                                    ijcai                                                    
