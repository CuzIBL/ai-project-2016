                mcmc approach solving hybrid factored mdps                        branislav kveton                             milos hauskrecht                  intelligent systems program               department science                    university pittsburgh                     university pittsburgh                      bkvetoncspittedu                           miloscspittedu                          abstract                          patrascu  methods exponential                                                        treewidth discretized constraint space limits      hybrid approximate linear programming halp      application realworld problems addition ε      recently emerged promising framework grid discretization blindly impacts quality      solving large factored markov decision processes  approximation monte carlo methods farias roy      mdps discrete continuous state ac  hauskrecht kveton  offer alternative      tion variables work addresses major com εgrid discretization approximate constraint space      putational bottleneck – constraint satisfaction halp ﬁnite sample unfortunately efﬁciency      large structured domains discrete continuous monte carlo methods heavily dependent appropriate      variables analyze problem propose  choice sampling distributions ones yield good ap      novel markov chain monte carlo mcmc method      proximations polynomial sample size bounds closely      ﬁnding violated constraint relaxed related optimal solutions rarely known priori      halp method does require discretiza farias roy       tion continuous variables searches space overcome limitations discussed constraint sat      constraints intelligently based structure isfaction techniques propose novel markov chain monte      factored mdps space complexity linear carlo mcmc method ﬁnding violated      number variables test method straint relaxed halp method directly operates      set large control problems demonstrate im domains continuous variables takes account      provements alternative approaches           structure factored mdps space complexity pro                                                        portional number variables separation ora    introduction                                       cle easily embedded ellipsoid cutting plane  markov decision processes mdps bellman  puter method solving linear programs constitutes  man  offer elegant mathematical framework key step solving halp efﬁciently  solving sequential decision problems presence paper structured follows introduce hy                                                                                              certainty traditional techniques solving mdps brid mdps halp guestrin et al    computationally infeasible realworld domains frameworks modeling solving largescale stochastic  factored contain discrete continuous state decision problems second review existing approaches  action variables recently approximate linear program solving halp discuss limitations com  ming alp schweitzer seidmann  emerged pactly represent constraint space halp formulate  promising approach solving large factored mdps optimization problem ﬁnding violated  farias roy  guestrin et al  work fo straint relaxed halp fourth design markov chain  cuses hybrid alp halp guestrin et al  ad solve optimization problem embed cut  dresses major computational bottleneck – constraint satis ting plane method finally test halp solver  faction domains discrete continuous variables set large control problems compare performance    state action variables discrete halp alternative approaches  volves exponential number constraints  variables continuous number constraints inﬁnite  hybrid factored mdps  approximate constraint space halp techniques factored mdps boutilier et al  allow compact rep  proposed εhalp guestrin et al  resentation large stochastic planning problems exploit  monte carlo constraint sampling farias roy  ing structure section review hybrid factored  hauskrecht kveton  εhalp formulation mdps guestrin et al  extend formalism  laxes continuous portion constraint space ε domains discrete continuous variables  grid compactly satisﬁed methods hybrid factored mdp distributed actions hmdp  discretestate alp guestrin et al  schuurmans guestrin et al  tuple  wherex       xn state space represented set stationary deterministic puterman   state variables      action space repre policy greedy respect optimal value function  sented set action variables x′  stochas ∗ ﬁxed point bellman equation bellman  tic transition model state dynamics conditioned pre  bertsekas tsitsiklis   ceding state action choice reward model                                                  signing immediate payoffs stateaction conﬁgurations  ∗                  x′   ∗ x′  x′                                                          sup   γ                state variables state variables discrete contin                 ′                                                                           ′                                                                                                                                                                                   uous discrete variable xi takes values ﬁnite               domain domxi following hauskrecht kveton                                                 assume continuous variable bounded  hybrid alp    subspace state represented vector value value iteration policy iteration linear programming  assignments  xd xc  partitions discrete fundamental dynamic programming dp methods  continuous components xd xc                  solving mdps puterman  bertsekas tsitsiklis  action variables action space distributed repre  computational complexity grows expo  sented action variables composite action deﬁned nentially number used variables makes  vector individual action choices  ad ac  unsuitable factored mdps built  partitions discrete continuous components ad assumption ﬁnite support optimal value function  ac                                               policy exist continuous variables  transition model transition model given present recently feng et al  showed solve gen  ditional probability distribution x′  eral statespace mdps performing dp backups piece  x′ denote state variables successive time steps wise constant piecewise linear value functions ap  assume model factors x′ x′   proximate method lower scaleup potential halp         ′       ′    xi  parxi compactly represented does require design basis functions  dynamic bayesian network dbn dean kanazawa  linear value function value function approximation                               ′        usually parent set parxi ⊆ ∪ small standard approach solving large factored mdps  subset state action variables allows local favorable computational properties linear value function  parameterization model                        approximation bellman et al  roy   parameterization transition model onestep dynamics                                                                                    state variable described conditional proba             wifi                      ′        ′       ′                                          bility distribution xi  parxi xi continuous                   variable transition function represented mixture extremely popular recent research guestrin et  beta distributions hauskrecht kveton      al  schuurmans patrascu  farias roy                                                         hauskrecht kveton  guestrin et al              ′         Γαj  βj  αj −    βj −   parxi  πij             −x         approximation restricts form value function                       Γα Γβ                                                                                                                                                                                linear combination   basis functions fi                                                         vector tunable weights basis function  πij weight assigned jth component                                                        deﬁned complete state space  mixture α  φα parx′ β  φβ parx′                    ij              ij          restricted subset state variables   arbitrary positive functions parent set mixture                          beta distributions provides general class transition  halp formulation  functions allows closedform solutions integrals                                                        various methods ﬁtting linear value function ap  halp x′ discrete variable transition model                                                      proximation proposed analyzed bertsekas  parameterized domx′ nonnegative discriminant func                                                      tsitsiklis  adopt variation approximate linear            θ       ′                    tions θj  φijparxi guestrin et al         programming alp schweitzer seidmann  hy                                                        brid alp halp guestrin et al  extends                     ′          θj           parxi         ′                framework domains discrete continuous vari                            domxi                                 θj                 ables halp formulation given    reward model reward functionp additive function minimizew    α                                                                          rj   local reward functions deﬁned                                                                             subsets state action variables                                     optimal valuep function policy quality pol  subject wifi    −   ≥  ∀                                                                           icy measured inﬁnite horizon discounted reward                 ∞     γ rt γ ∈   discount factor rt αi denotes basis function relevance weight  reward obtained time step optimality cri                                                   ∗  terionp guarantees exists optimal policy π  αi        ψxfix dxc                                                                                                                                                               xd      general state action space mdp alternative        hybrid mdp term hybrid does refer dynamics ψx state relevance density function weighting qual  model discretetime                        ity approximation fix  fix − γgix ais difference basis function fix dis monte carlo constraint sampling monte carlo methods  counted backprojection                               approximate constraint space halp ﬁnite sam                                                        ple farias van roy  analyzed constraint sam                          ′          ′   ′       gix        afix  dx        pling discretestate alp bounded sample size                      ′                                   ′                                                                        achieving good approximations polynomial num                                                      ber basis functions state variables hauskrecht  say halp relaxed subset                                                        kveton  applied random constraint sampling solve  straints satisﬁed                                                        continuousstate factored mdps later reﬁned sam    halp formulation reduces discretestate alp                                                        pler heuristics kveton hauskrecht   schweitzer seidmann  schuurmans patrascu                                                          monte carlo constraint sampling easily applied   farias roy  guestrin et al                                                         tinuous domains implemented space propor  state action variables discrete continuous                                                        tional number variables proposing efﬁ  state alp hauskrecht kveton  state vari                                                        cient sampling procedure guarantees polynomial bound  ables continuous quality approximation                                                        sample size hard knowing optimal policy  studied guestrin et al  bounded                                                      farias roy  lower high number  spect minw kv ∗ −     k·k    max                        ∞l          ∞l            sampled constraints relaxed halp monte carlo sam  norm weighted reciprocal lyapunov function plers embedded cutting plane method tech                  wi fi  integrals objective function nique similar kveton hauskrecht  yields signiﬁ  equation  constraints equation  closedform speedup drop quality approximation  solutionsp basis functions state relevance densities  chosen appropriately hauskrecht kveton   example mixture beta transition model equation   mcmc constraint sampling  yields closedform solution equation  basis func address deﬁciencies discussed constraint satis         ′  tion fix  polynomial finally need efﬁcient faction techniques propose novel markov chain monte  straint satisfaction procedure solve halp         carlo mcmc method ﬁnding violated                                                        straint relaxed halp proceed compactly    constraint satisfaction halp                  represent constraint space halp formulate op  state action variables discrete halp involves timization problem ﬁnding violated constraint  exponential number constraints vari representation  ables continuous number constraints inﬁnite  approximate constraint space techniques  compact representation constraints  proposed recently εhalp guestrin et al  guestrin et al  schuurmans patrascu   monte carlo constraint sampling farias roy  showed compact representation constraints es  hauskrecht kveton                          sential solving alp efﬁciently following ideas  εhalp  εhalp formulation relaxes continuous deﬁne violation magnitude τ wx  portion constraint space εgrid discretiza                                                        tion continuous variables  new constraint τ  −  wifix − γgix  rx   space spans discrete variables compactly sat                                                                              isﬁed methods discretestate alp guestrin et al                             schuurmans patrascu  example schu solution violates                                                        straints relaxed halp represent τ wx compactly  urmans patrascu  search violated                                 straint respect solution wt relaxed alp inﬂuence diagram id decision                                                        nodes x′ random variables id representation                                                                                   x′                                                     built transition model        arg min      fix − γgix − rx                                                            xa                                           factored contains dependencies variables                                                     x′                                                               extend diagram three types reward  add linear program violated constraint nodes each term equation  rj  rjxj  aj            optimal solution alp          local reward function hi  −wifix basis                                                                                ′    space complexity constraint satisfaction meth function gi  γwifix  backprojection  ods guestrin et al  schuurmans patrascu  construction completed adding arcs represent  exponential treewidth constraint space dependencies reward nodes variables finally                                                                                                                                                  ′  limitation cardinality discretized verify τ     ep xa ihigi rj  variables grows resolution εgrid roughly decision maximizes expected utility  discretized variables replaced binary treewidth id corresponds violatedp constraint  increases multiplicative factor logε   conclude algorithm solving ids  ε   number discretization points single used ﬁnd violated constraint special  dimension problems relatively small properties id representation allow simpliﬁ  treewidth intractable small values ε addition cation basis functions chosen conjugate tran  εgrid discretization blindly impacts quality sition model section  obtain closedform solution  approximation                                 ep x′xagi equation  random variablesx′                                                               z∗     marginalized diagram new repre −i −i assignments variables zi  sentation contains random variables know cost original proposed states discrete variable                                                                                           ∗                                                                                         −               network guestrin et al                       conditional pz∗    zzi zi ziznm                                                                         −i        pzzi−ziziznm                                                                                   zi    separation oracle                                derived closed formp zi continuous variable                                                        closed form cumulative density function likely  ﬁnd violated constraint cost network exist allow sampling conditional embed  use metropolishastings mh algorithm metropo mh step original chain experimen  lis et al  hastings  construct markov tal section use metropolis algorithm accep  chain invariant distribution converges vicinity                              ∗                                                                             ∗           pzi  −i                                                      tance probability azi   min      zi  arg maxz τ   ∪                                     pzi −i                                                             ∗  joint set state action variables metropolis zi correspond original andn proposed valueso zi  hastings algorithm accepts transition state note sampling conditionals performed                                                                       proposed state z∗ acceptance probability az z∗  space τ locally           ∗     ∗         pz qzz         ∗                            finally nonhomogenous markov chain               ∗       proposal distribu                                        −  ∗  min   pzqz                                                                    tt                                                                                z∗               zi  −i                                                        acceptance probability    min  −  tion nand pz targeto density mild restrictions                              zi −i  pz qz∗  chain converges target converges vicinity mostn violated constrainto  density pz andrieu et al  rest sec similar chain derived yuan et al  applied  tion discuss choice pz qz∗  solve ﬁnd maximum posteriori map conﬁguration ran  optimization problem                                 dom variables bayesian networks  target density violation magnitude τ wz turned                                                        constraint satisfaction  density transformation pz  expτ  monotonic character pz retains set global mcmc oracle converges violated constraint                                               maxima τ search arg maxz τ necessarily violated polynomial time guar  performed pz prove pz density antees ellipsoid method solve halp poly                                                        nomial time bertsimas tsitsiklis   show normalizing constant pz dzc                                         zc   discrete continuous components vergence chain arbitrary precision requires                                                exponential number steps geman geman   vector  zd zc  integrand zc restricted                                                      bound weak practical  ﬁnite space   integral proper long                                                   suggests time complexity ﬁnding violated    bounded riemann integrable                                                    constraint dominates time complexity solving halp  ﬁnite prove bounded bound  let                                       τ          search violated constraints       denote maximum onestep reward hmdp  rmax                                                  formed efﬁciently convergence speedups directly ap  basis functions unit magnitude typi                                        wi              ply work include hybrid monte carlo hmc du  cally bounded            −      consequently                wi ≤ γ − γ rmax                    ane et al  slice sampling higdon  rao                  −            τ   ≤   γ − γ  rmax                  blackwellization casella robert   bounded treated density function                                                        evaluate mcmc oracle embed cutting    ﬁnd mode  adopt simulating plane method solving linear programs results                                       nealing approach kirkpatrick et al  simulate novel approach solving halp oracle guar  nonhomogeneous markov chain invariant distribution anteed converge violated constraint run           tt  equals   tt decreasing cooling schedule cutting plane method ﬁxed number iterations  limt→∞ tt   weak regularity assumptions having stopping criterion schuurmans      ∞     probability density concentrates patrascu  section  mcmc solver differs                          set global maxima  andrieu et al  monte carlo solver samples constraints based  cooling schedule decreases tt ≥ logt   potential improve existing solution sub  problemspeciﬁc constant independent stitutes unknown problemspeciﬁc sampling distribu                                          chain converges vicinity arg maxz τ   tion comparing εhalp method mcmc oracle  probability converging  geman geman  directly operates domains continuous variables  schedule slow practice especially space complexity linear number variables  high initial temperature following suggestion ge  man geman  overcome limitation select  experiments  ing smaller value required convergence  criterion result convergence global optimum performance mcmc solver evaluated            arg maxz τ longer guaranteed               alternative constraint satisfaction techniques εhalp  proposal distribution advantage factored uniform monte carlo sampling space limitations  character adopt following proposal distribution comparison focuses irrigationnetwork problems  geman geman                               guestrin et al  conclusions likely gen                                                        eralize variety control optimization tasks                   pz∗    z∗                 irrigationnetwork problems challenging stateofthe      qz∗         −i      −i   −i                                               art mdp solvers factored state action spaces                 ½ ring topology                                                                                                          ov     reward  time   ov     reward   time   ov      reward   time                                      ±        ±          ±                       εhalp    ε       ±        ±        ±                                        ±       ±        ±                                          ±        ±         ±                      mcmc             ±      ±        ±                                         ±      ±      ±                      mc                    ±      ±        ±        ringofrings topology                                                                                                 ov     reward  time   ov     reward   time   ov      reward   time                                      ±        ±         ±                      εhalp    ε       ±      ±      ±                                        ±      ±      ±                                          ±        ±        ±                      mcmc             ±      ±       ±                                         ±      ±      ±                      mc                    ±      ±       ±     figure  comparison halp solvers irrigationnetwork topologies varying sizes solvers compared  objective value relaxed halp ov expected discounted reward corresponding policy computation time  seconds expected discounted reward estimated monte carlo simulation  trajectories εhalp  mcmc solvers parameterized resolution εgrid ε number iterations    figure  goal irrigation network operator informative search violated constraints mcmc  select discrete waterrouting actions ad optimize contin solver quality mcmc policies    uous water levels xc multiple interconnected irrigation close εhalp ones ε   does surpass  channels transition model parameterized beta dis signiﬁcantly irrigationnetwork problems ε  tributions represents water ﬂows conditioned op halp policies ε   close optimal  eration modes regulation devices reward function hard improve mcmc solver reaches  additive given mixture normal distributions higher objective values εhalp solver policies  each channel optimal value function approximated improve suggestive relationship                                                                               ∗     linear combination univariate piecewise linear true objective minw kv − k∞l objective                                                                              basis functions each channel guestrin et al  halp minw kv ∗ − guestrin et al                                                                               ψ  state relevance density function ψ  uniform compre finally computation time εhalp solver se  hensive description irrigationnetwork problems riously affected topologies tested networks  guestrin et al                         explained follows small ε large    εhalp solver implemented method time complexity formulating cost networks grows approx  schuurmans patrascu  described section  imately rates ε   ε    monte carlo solver uniformly generates million ring ringofrings topologies respectively εhalp  straints establishes baseline comparison solver spends signiﬁcant time formulating  uninformatively behaving sampling method chain cost networks makes decent time complexity  mcmc oracle simulated  steps ini ring topology quadratic ε   deteriorate  tial temperature   yields decreasing cooling ringofrings topology cubic ε   similar cross  schedule   ≈  parameters topology comparison mcmc solver shows  chosen empirically demonstrate characteristics computation times differ multiplicative factor   approach maximize performance difference increased complexity sampling  mcmc oracle experiments performed dell    ∗                                                         pzi  −i caused complex local depen  precision  workstation ghz pentium  cpu dencies treewidth ringofrings topology  gb ram linear programs solved simplex  method lp solve package results exper  iments reported figure                          conclusions    based results draw following conclusions development scalable algorithms solving large factored  mcmc solver   achieves highest ob mdps challenging task mcmc approach presented  jective values problems higher objective values paper small important step direction  interpreted closer approximations constraint space particular method overcomes limitations existing  halp solvers operate relaxed versions halp approaches solving halp works directly  second quality mcmc policies   sur tinuous variables generates constraints based poten  passes monte carlo ones solvers consume ap tial improve existing solution space complexity  proximately computation time result linear number variables mcmc
