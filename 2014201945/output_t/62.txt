            using predictive representations improve generalization                                       reinforcement learning                     eddie rafols mark ring richard sutton brian tanner                                     department computing science                                            university alberta                                   edmonton alberta canada tg                             erafolsmarkringsuttonbtannercsualbertaca                        abstract                          weightings set features agent’s past                                                        present perceptions good generalization occurs      predictive representations hypothesis holds   features chosen roughly independent each      particularly good generalization result predictive representations generally used      representing state world terms conjunction function approximation each predic      predictions possible future experience  tion treated feature      hypothesis central motivation   function approximation complex issue      hind recent research example psrs    quiring choices method optimization learning param      td networks paper present ﬁrst    eters each inﬂuence results      explicit investigation hypothesis show way avoid confusion test predictive      reinforcementlearning example gridworld representations hypothesis directly controlled      navigation task predictive representation possible confounding effects function approxima      tabular form learn faster  tion developing strictly tabular form predictive repre      tabular explicitstate representation tabular sentation furthermore focus predictive repre      historybased method                             sentations affect generalization representa                                                        tions acquired assume    introduction                                       acquired process  predictive representation describes world illustrate power predictive representations  terms predictions future observations predictive gridworld navigation task agent’s action ob  representations hypothesis holds representations servation space chosen particularly impoverished  particularly good generalization good representation imposing high degree perceptual ambiguity  captures regularities environment form small subset predictions necessary  useful learning agent reinforcementlearning representation environmental state reinforcement  task “useful” increases agent’s ability learning agent learn quickly achieve nearly opti  receive rewards representations generalize mal performance  regularities capture allow agent learn ef  ﬁciently increase cumulative reward          predictive representations    believe predictive representations recently introduced methods modeling dynamical  generalize particularly good generalization tends systems inspired predictiverepresentations  result similar situations similar representations hypothesis predictive state representa  interactive tasks situations similar executing tions psrs littman et al  temporaldifference  action sequence leads results networks td networks sutton tanner  current  executing action sequence regardless research predictive representations focused principally  action sequence similar results tend acquisition representation use  similar situations control beginning explored james et al   similar predictive representations izadi precup     predictive representations hypothesis makes espe psrs based concept core test—a sequence  cially broad claim result especially resistant actions followed observation—similar tests  testing proof particular questions regarding representa rivest schapire  agent records outcome  tion generalization involve confounding issues each core test success failure depending  function approximation representation acquisition — predicted observation matches actual obser  issues developed speciﬁc measures avoid vation agent maintains probability success  reinforcement learning example generalization com each core test value feature agent’s  monly achieved through function approximation learning representation world knowledge world beexpressed function generally linear combination say states identically predictive value  features core tests continually acquired belong identically predictive class similar  features form sufﬁcient statistic means cap states rivest schapire’s simpleassignment au  ture relevant knowable information environment tomata  constrained  maintain information time step given environment identically predictive  said sufﬁcient statistics classes arbitrarily number  through    td  networks consist conceptually separate net agent visits environmental state observes number  works question network answer network  state’s identically predictive class number  question network poses questions possible future ob agent’s predictive representation tabular form  servations answer network learns predict answers example suppose       questions questions analogous  panel consists three tests each action  core tests psrs answer network analogous each test result observation    function computes probabilities coretest suc  possible panel conﬁgurations    cesses units question network make state aggregated classes labeled   predictions just agent’s observations through  agent observes          values network units predictions each state visits  predictions allow td network represent possi general increases increase  ble core tests compact form furthermore predic fewer states class average agent’s represen  tions generally necessarily action conditional tation environment expressive    approaches just outlined share common aspi                                                          panel conﬁgurations necessarily  ration representing world set predictions                                                        represented environment clearly  future observations research predictive represen                                                        classes environmental states  tations nascent phases attempt make pre                                                           tests equivalent meaning  diction possible future observations                                                        environmental states tests yield different  spirit pose following question method does                                                        results furthermore increases increases exponen  prove successful acquiring predictive representations                                                        tially tends increase quite slowly environments  representations good generalization                                                        moderate regularity    tabular predictive representations                   eventually increasing longer increases                                                        classes represent sufﬁcient statistic point  order focus exclusively prediction basis gen environmental states  eralization unclouded issues involving representation ac distinguished test length  quisition assume agent acquired abil  ity make correct predictions eliminate issues involving  sarsa identically predictive classes  function approximation consider deterministic tasks  single binary observation method agents paper trained using reinforcement  applied multiple binary observations learning algorithm known episodic tabular sarsa sut  extension futurework section accommodating ton barto  traditional markov case—  tinuous observations stochastic environments agent directly observes environmental state—  focus tests choose look predictions actionvalue function learned space environ  contingent agent’s actions restriction mental states actions algorithm estimated  requirement predictive representations general value qs each experienced state–action pair                                                        updated based immediate reward estimated    identically predictive classes                   value state–action pair  start set binary tests resembling psr core tests  each test length meaning sequence   ∆qs  αr  qs − qs  actions followed single observation bit construct  possible tests length  through produce panel test α learningrate parameter  results each state entry test given binary tests episodic tabular sarsa implemented predic  panel distinct conﬁgurations outcomes tive state space mapping environmental states cor  assuming environment deterministic agent responding identically predictive classes described  actions available distinct tests previous section function c· provides mapping  length number tests length resulting classes treated sarsa agent                                                      environmental states                                                     ai                                                                                                                                              ∆qcs  αr  qcs   − qcs                                                        −                      distinction states  states distinguished tests class learning occurs environmental state ap  panel results identical states plies states mapped class                                                      tests reduce number classes change                                                        way states assigned classes                                                          agent predictive representation sufﬁcient                                                        statistic distinguish environmental states                                                        idea illustrated figure   distinct                                                        environmental states orientations each grid cell                                                          given agent three actions rotate ◦ right                                                        rotate ◦ left advance observes                                                        wall directly each arm  figure  agent world  orienta cross produce exactly sets predictions  tions each  grid squares observation consists predictive agent arms identical test  “nose touch” bit senses distinguish state arm corresponding  wall directly chooses actions rotate states three arms inﬁnitelength tests    ◦               ◦   right rotate  left advance environment maximum    distinct environmental states predictive representa identically predictive classes orientations arm  tion identify  identically predictive classes cells plus center orientations                                                        center identically predictive    performance generalization                     example illustrates agent’s learning speed                                                        improved through use predictive representa  episodic tasks performance reinforcementlearning tions task navigate cell marked agent  agent quantiﬁed total reward receives observing identically predictive class numbers learn  episode given inﬁnite time agents observe markov optimal policy faster agent observing environ  state environment achieve optimal performance mental state predictiveclass agent    practice learning optimal policy quarter situations learn requires  arbitrarily long arbitrarily large state space far experience learn possible situations  days rarely ﬁnd time let inﬁnite  arbitrary desirable  cases use methods speed learning  tabular historybased representations  ﬁnal solution absolutely optimal              obvious competitors predictive representations    anticipate tradeoff agent’s asymptotic historybased representations ﬁxedlength  performance speed learning increases markovk approaches ring  mccallum   classes closely resemble markov state envi mitchell  clearly lend tabular  ronment agent’s asymptotic performance approaches mat promote fair comparison representations  optimal decreases fewer distinct cases deﬁne klength history observation followed  learn learning speed improves risk actionobservation pairs tabular format each possible  states comprising class disagree op history uniquely labeled  timal action class disagreement lead predictive representations ﬁxedlength history repre  suboptimal action selection extreme cases sentations offer fundamentally different kinds generaliza  ﬂict catastrophic precluding discovery tion speciﬁcally environmental states reached  reasonable policy good representation ﬁnd multiple different paths each corresponding different  low values minimizing disagree history conversely single action sequence history  ment classes predictiverepresentations hypothe reach multiple environmental states starting different  sis speciﬁcally holds classes formed through predic states mapping environmental states  tive representations just               ﬁxedlength history sequences                                                        mapping environmental states identically pre    predictive classes sufﬁcient statistics      dictive classes  agent’s representation world sufﬁcient statis conceptually reason difference agent  tic improved through experience paths arrive state  world case predictive representations set possible futures set possible futures  sufﬁcient statistic implies additional predic absolutely ﬁxed each environmental state example  tions add knowledge improve performance   agent ways reaching state  hand adding predictions sufﬁcient statis figure —rotating right rotating left    tic worsen asymptotic performance           different histories each state number    tabular case sufﬁcient statistic consists ﬁxedlength history representations lead each  classes number additional tests increase environmental state increases exponentially  adding test end classes increases exponential number cases   original representation agent learn problem does automatically  sufﬁcient statistic did represent knowledge disappear using function approximation methods  captured newest − class distinctions contrast set possible futures available each                                                                              unique      environmental                                                         agent                observations       states                                                         markov                                                                                      predictive                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              fixedhistory                                                                                                                                                                                                figure  “ofﬁce layout” gridworld used naviga                                 tion task agent starts episode                              rooms ﬁnishes square marked                                                                                                      random         case  state matter state reached                            result number predictive classes                            number distinct environmental states nature                                mapping makes generalization predictive case far  intuitive extent predictiverepresentations figure  representational schemas tested  hypothesis based clearer intuition        stantiations degree state aggregation each case                                                        predictive case “unique observations” column rep    experiment design                                  resents number identically predictive classes                                                        ﬁxedlength history column represents number  examined predictiverepresentations hypothesis unique histories occurred during training  ﬁrst designing gridworld large degree regularity  figure  tested sarsa agents different  methods representation task environment label predictive case agent observed label cor  each method able exploit environment’s responding identically predictive class described  regularities                                         section  different values each value    agent’s task navigate goal cell marked states assigned classes described section   randomly chosen square rooms ﬁxedhistory case agent observed label correspond  environment designed resemble typical ofﬁce ing kstep history just experienced section   layout task likened ﬁnding quickest ﬁve different values results  route staircase representations generalize predictive case merely beneﬁcial properties  allow respective agents exploit regularities state aggregation tried randomly assigning states  environment improve speed learning classes training according equation     figure  agent onebit observation figure  shows vital stats each representa  three possible actions rewards task  tional methods tested state aggregation  reaching goal state − timesteps occurs each method shown terms ratio unique  transitions environment deterministic envi observations environmental states  ronment total  states  possible  start states average  steps op  results  timal path start goal task formulated                                                        performance  results different representational  undiscounted episodic agent transported                                                        schemas given figure  graphed figure   randomly chosen starting position reaching goal                                                        exception random state aggregation method    case actions chosen according greedy                                                        formed poorly graphed meaningfully  policy  set  α set                                                           each point graph represents average number  typical values sarsa agents episodic tasks                                                        steps episode previous  episodes    representational schemas tested                                                        curves averaged  trials each trial     • markov                                            episodes end each trial agent’s action values    • ndepth predictive classes                        reset learning begins scratch course    • kstep ﬁxedlength histories                       episodes markov case shows smooth steadily                                                        improving curve  th episode performing    • random state aggregation                          close optimal    markov case agent directly observed current ﬁxedlength history representations learn  environmental state each state represented unique slowly methods learning speeds                                                                                                                   steps                                                                                                                                                                                                                                                                                                                                                                                                                                                    environmental                                                                      state                                                                                                                                                                                                                                                                       episodes    figure  comparison three representational methods task figure  representational schemas shown  explicit environmental state historybased representations   through  identically predictive classes    through  vertical axis shows average steps taken episode past  episodes training note axes  logarithmic vertical axis intersects horizontal axis optimum    fastest small values ﬁnal results best graphs agents performed poorly  large values demonstrating tradeoff repre  state aggregation  states aggregated ran  sentational expressiveness learning speed number dom state aggregation brought catastrophic failure  histories increases exponentially negatively  agents tested meaning show  impacts learning speed positively impacts ﬁnal results progress training avoid catastrophic failure  learning interestingly individual trials curves  agents state aggregation  history representation resemble step function appar  meaning state shared  ently greedy action selection chooses poorly class state  episodes agent suddenly learns key piece contrast cases catastrophic failure  information dramatically improves performance agents using predictive representations  grows agent takes longer discover piece infor argued predictive representations bene  mation converges better solution       ﬁt unfairly preprocessing create classes    results look promising predictive representations historybased methods did  allow speedy learning convergence good actual learning agent reasonably expected ac  policy general results identically predictive quire argued historybased methods  representations similar ﬁxedhistory rep augmented combine ways reaching  resentations convergence speed decreases conver state equivalence classes tabular representations  gence quality increases increases predictions objections miss fundamen  trast ﬁxedhistory representation number identi tal aspects research predictive representations  cally predictive classes increases quite slowly general intention prove supe  generalization beneﬁt predictive classes clear riority particular learning algorithm  representation effectively aggregates similar states allowing test advance research direction  agent converge nearoptimal solutions result predictive representations looks promising evidence  closely matches intuition expectations collected clearly gives reason optimism second acqui    case improvement learning speed sition predictive representation directed  dicating maximum degree state aggregation acquisition sufﬁcient statistic agent acquires  learning speed improved—also ex predictions necessary sufﬁcient statistic  pected intuitive result section  results principle create class mappings used fact      cases match trends shown mappings fall directly td network rep  graph vaguely readable    resentation merely subset clear    case random state aggregation shown equivalent sufﬁcient statistic historybased
