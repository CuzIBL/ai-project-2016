 wrong—automatic detection interaction errors brain waves                                     pierre ferrez jose´ del millan´                                          idiap research institute                               rue du simplon   martigny switzerland                                    pierreferrez josemillanidiapch                          abstract                          subject suffering severe motor disabilities                                                        tact cognitive capabilities greatly gain autonomy      braincomputer interfaces interaction applications virtual keyboard gen      modality based physiological signals body  erally provide alternative way communication      channels muscular activity speech ges outside world birbaumer et al  wolpaw et al       tures prone errors recognition sub millan´ et al       ject’s intent paper exploit unique fea bcis—as interaction modality      ture “brain channel” carries based physiological signals body channels mus      information cognitive states crucial cular activity speech gestures—are prone errors      purposeful interaction states recognition subject’s intent errors fre      awareness erroneous responses different quent welltrained subjects rarely reach       physiological studies shown presence  success possible way reduce errors consists ver      errorrelated potentials errp eeg recorded iﬁcation procedure each output consists op      right people aware er posite trials success required validate      ror humancomputer interaction outcome wolpaw et al  method greatly      central question errp elicited reduces errors requires mental effort      error interface during subject reduces communication rate      recognition subject’s intent longer      errors subject paper contrast interaction modalities unique fea      port experimental results three volunteer sub ture “brain channel” conveys informa      jects during simple humanrobot interaction tion derive mental control commands      bringing robot left right side operate brainactuated device information      room reveal new kind errp cognitive states crucial purposeful interaction      satisfactorily recognized single trials millisecond range states      recognition rates signiﬁcantly improve perfor awareness erroneous responses number groups      mance brain interface                     recently started explore way improve                                                        formance bcis schalk et al  blankertz et al                                                         parra et al  late different physiolog    introduction                                       ical studies shown presence errorrelated poten                                                        tials errp eeg recorded right people aware  braincomputer interface bci translates error carter et al  falkenstein et  intention subject represented brain waves al  holroyd coles   typically electroencephalogram signals control sig studies show presence errp typical choice  nal using activity muscles peripheral nerves action tasks carter et al  falkenstein et al   millan´  wolpaw et al  electroencephalogram blankertz et al  parra et al  kind tasks  eeg recorded noninvasively means electrodes subject asked respond quickly possible  placed scalp features extracted stimulus errp referred “response errp”  eeg sent classiﬁer response trans arise following errors subject’s incorrect motor ac  lated action making possible mental control tion subject pressed key left hand  different devices instance recent studies shown responded right hand recently  days training subjects able studies shown presence errp typi  trol miniature robot indoor environment cal reinforcement learning tasks subject asked  rooms corridors doorways using signals make choice errp referred “feedback  rived eegbased bci millan´ et al  errp” arise following presentation stimulus  used drive wheelchair dicate incorrect performance holroyd coles  infigure  exploiting errorrelated potentials errp braincontrolled mobile robot subject receives visual feedback indicating  output classiﬁer actual execution associated command “turn left” feedback generates errp left  command simply ignored robot stay executing previous command command sent robot right    cases response errp feedback errp ob reveal new kind errp satisfactorily  served negative potential eeg frontocentral recognized single trials recognition rates signiﬁ  scalp distribution figure  subjects make er cantly improve performance interface  rors negative potential probably generated  brain area called anterior cingulate cortex crucial  experimental setup  regulating emotional responses    important aspect described errp test presence errp feedback indicating errors  follow error subject interface recognition subject’s  subject make selection errp arise simply tent simulated real interaction robot  occurrence error choice reaction task subject wishes bring robot side room  feedback indicating error reinforcement learning task left right delivering repetitive commands ro  context bci humancomputer inter bot reaches target virtual interaction implemented  action general central question           means horizontal progress bars  steps    “are errp elicited error inter each bars goes center screen  face during recognition subject’s intent” left side left bar bar progresses right    order consider implications question side right bar figure  shows left right horizontal  let’s imagine subject’s intent make robot reach progress bars used feedback  target left happen interface fails isolate issue recognition errp  recognize intended command robot starts turning difﬁcult general problem bci er  wrong direction errp present roneous feedback nonoptimal performance  subject did make error perceive interface classiﬁer embedded inter  interface performing wrongly                      face user following experiments    objective paper investigate errp subject delivers commands manually mentally  used improve performance bci simply presses left right key left right  ﬁrst explore errp follow feedback hand way error feedback wrong  dicating incorrect responses interface longer recognition interface subject’s intention  errors subject errp elicited three volunteer healthy subjects participated ex  case integrate bci following periments subject sends command stimulus  way shown figure  translating subject’s livered word “go” appears screen  tention control command bci provides feedback ﬁlled bars error rate   command actually executed each step  probability robot  errp follows feedback greatly increase movement wrong direction subjects performed  se  reliability bci later course new ries  progress bars delay  consecutive steps  interaction protocol depends ability detect errp  consecutive “go”  seconds  longer averages large number trials schalk et al random delay prevent habituation duration each   each single trial using short window following teraction experiment ﬁlling progress bar   feedback shows response classiﬁer embed seconds breaks  minutes series  ded bci                                       break interaction experiments series    paper report experimental results three vol eeg potentials acquired portable  unteer subjects during simple humanrobot interaction biosemi activetwo means cap  integrated  bringing robot left right side room electrodes covering scalp located according tofigure  left right horizontal progress bars goal interaction experiment ﬁll bars simulates real  interaction robot needs reach side room left right ﬁlls bars error rate  each  step  probability robot movement wrong direction                                                                                  th  standard  international sampling rate µk center prototype class ck   hz signals measured dc raw eeg Σk covariance matrix class ck Σk  potentials ﬁrst spatially ﬁltered subtracting each determinant matrix usually each prototype                                                                               electrode average potential  channels each covariance matrix Σk order reduce number  time step aim rereferencing procedure sup parameters restrict model diagonal covariance  press average brain activity seen underly matrix Σk common prototypes class  ing background activity information coming ck posterior probability yk class ck  local sources each electrodes applied                                                                                          xnp   hz bandpass ﬁlter errp known relatively                                slow cortical potential finally eeg signals subsam                                 akx                                                                                akx      pled  hz  hz took point   ykx  pxck                           classiﬁcation entirely based tempo                   ax     xnp                                                                                                 ral features actual input vector statistical                             akx  classiﬁer described second window starting                               ms feedback ending  ms feed                                                        ak activity class ck total activity  channels cz fz choice channels network response classiﬁer input  follows fact errp characterized frontocentral vector simply class highest probability  distribution midline figure  dimen initialize center prototypes µi  class  sionality input vector  concatenation                                                                                    ck run clustering algorithm—typically selforganizing  windows  points eeg potentials each           maps kohonen  initialize diagonal    artifact rejection algorithm removing ﬁltering variance matrix Σ class setting  eye muscular movements applied trials                                                                                                  kept analysis worth noting             ¡     i∗¢ ¡    i∗¢t                                                                 Σk            − µk   − µk           visual aposteriori check trials evidence       sk  muscular artifacts contaminated              x∈sk  dition differently                    sk set training samples belonging                                                                                               ∗                                                        class ck sk cardinality set nearest    statistical classiﬁer                              prototype class sample                                                          during learning improve initial estimations iter  different classes recognized gaussian classiﬁer atively stochastic gradient descent minimize  trained classify single trials “correct” “error”                                                                                  mean square error    yk − tk  tk  output statistical classiﬁer estimation pos kth component target vector form ofc  terior class probability distribution single trial target vector class “error” coded   taking  probability given single trial belongs class “correct” gradient error function yields  class “error” present classiﬁer quite similar                      ¡      ¢  proposed millan´ et al  framework eeg                                                                                                      ∂e       akx  − µk  based bcis main difference update rules     ∆µkxα     xα              ekx                                                                           ∂µ         ax    Σk    statistical classiﬁer gaussian unit represents           prototype classes recognized use  prototypes mental task assume class                         ¡      ¢                                                                        ∂e        ai − µi  conditional probability density function class ck su                                                                                      ∆Σkxβ       xβ        ¡   ¢   ekx                                                                                              perposition nk gaussians prototypes classes          ∂Σk       ax    Σ  equal prior probabilities case classes                          number prototypes np addition assume α β learning rates ekx                                                                                                          prototypes equal weight np drop tkx−ykx− jyjxtjx−yjx updating µk                                   th                       ping constant terms activity ak prototype Σk each training sample covariance matrices  class ck input vector sample derived trial prototypes class averaged obtain  described                                 common class covariance matrix Σk simple operation                     ³                         ´        leads better performance separate covariance ma            −          ¡    ¢t −¡    ¢   akxΣk     exp  −  x−µk   Σk   x−µk        trices kept each individual prototype worth                                                                       difference               difference                               correct                  correct                              error                   error                                                                                                  µ                µ                                                                                      amplitude                  amplitude   −           −                                 subject                subject                   −                       −                                                                                       time                          time                                                                           difference               difference                               correct                  correct                              error                   error                                                                                                  µ                µ                                                                                      amplitude                  amplitude   −           −                                 subject                 average                  −                       −                                                                                       time                          time  figure  left average eeg error correct difference errorminuscorrect channel cz three subjects plus grand average  feedback delivered time  seconds negative ne positive pe peaks show  ms    ms feedback respectively right scalp potentials topographies grand average eeg three subjects occurrence  ne pe small ﬁlled circles indicate positions electrodes frontal cz middle scalp    noting small number training samples peak negative deﬂection respectively appears ∼ ms  “error” class preferible single feedback time course response errp deﬁnitely  covariance matrix common classes obtained different peaks show faster  averaging individual Σk                                                          single trial classiﬁcation    experimental results                               explore feasibility detecting singletrial erroneous  protocol ﬁrst necessary investigate wether responses fold crossvalidation study  errp present reaction error testing set consists recorded sessions  subject reaction erroneous response way testing different recording  interface indicated feedback visualizing session used training model yields  recognized subject’s intention figure  shows differ better estimation actual generalization capabilities  ent curves error correct difference errorminuscorrect cause brain activity naturally changes time figure   channel cz three subjects plus grand average illustrates panels show average eeg  three subjects ﬁrst sharp negative peak ne secutive series  interaction experiments each channel cz  clearly seen  ms feedback subject subject  panels show samples single   later positive peak pe appears   trials series variability evident  ms feedback finally additional negative peak  occurs ∼ ms feedback figure  shows table  percentages correctly recognized error trials correct                                                        trials  subjects average  scalp potentials topographies grand average eeg                                                                  subjects  error   correct   three subjects occurrence maximum  ne pe ﬁrst central negativity appears  ms          ±  ±  followed frontocentral positivity  ms                      ±  ±    experiments reveal new kind error                 ±  ±  related potentials convenience “interaction  average   ±   ±  errp” general shape errp quite similar                                                          table  reports recognition rates mean standard  shape response errp choice reaction task                                                        deviations three subjects plus average  timing similar feedback errp reinforcement                                                        different hyperparameters—ie learning rates  learning tasks case response errp interac                                                        centers diagonal covariance matrices number pro  tion errp exhibits ﬁrst sharp negative peak followed                                                        totypes commonsingle covariance matrices each  broader positive peak quite different shape                                                        class—were chosen model selection training sets  feedback errp characterized small neg                                                        regarding learning rates usual values − −  ative deﬂection hand time course                                                        centers − − variances  interaction errp bears similarities feed                                                        usual number prototypes small    errp cases ﬁrst distinctive feature negative                                                        results show singletrial recognition erroneous    space limitations experiments showing response responses  average recognition  feedback errp reported                     rate correct responses slightly better  quite im                                                                                                   difference                difference                                              correct                   correct                                             error                    error                                                                                   µ                        µ                                                                                          amplitude               amplitude                                  −                       −                                            average   min        average   min                                −                       −                                                                                             time                 time                                                                                                         error                    error                                                correct                  correct                                                                                                                                          µ                        µ                                                                                          amplitude               amplitude                                 −                       −                                           single trials   min single trials   min                                −                       −                                                                                             time                 time  figure  average eeg error correct difference errorminuscorrect consecutive experimental series channel cz  subject  samples single trials error correct series    portantly subject worse detection rates subject’s intent ﬁgures compared   key point exploitation formance standard bci integrating errp  automatic recognition interaction errors reported performances case nc   translate actual improvement performance  mindcontrolled robot described millan´ et al  bci measure terms bit rate  case standard class class bci                                                        performances   bits trial respectively    bit rate improvement                             results indicate signiﬁcant improvement  traditional measure performance formance case stopping outcomes  bit rate information communicated unit  average higher  subjects  time bit rate usually expressed bits trial bits surprisingly replacing leads smaller improvements  selection single trial nc possible outcomes case subject  signiﬁcant degradation  probability outcome correct accuracy  bci ﬁnally each outcomes table  performances bci integrating errp  subjects                                                        average  probability selection  − pnc −   information transfer rate bits trial bpt            nc         nc         nc                                         µ       ¶                       stop         stop        replace                                           −            subjects bpt   gain   bpt   gain   bpt   gain   bpt   logncp logp−p log                                                    nc −                                                                                                                      let’s consider performance bci                             changes introducing errp detects average              proportion erroneous trials proportion correct  trials general case detecting erroneous trial  outcome interface simply stopped sent  discussion  brainactuated device new accuracy bci                                                       paper reported ﬁrst results detection   · cpt pt  ·   − ·  −  new information transfer rate bits trial neural correlate error awareness improving                                                        formance reliability braincomputer interfaces par           µ                             µ      ¶¶                                        −p          ticular new kind error   bpt pt  logncp logp −p log                                           nc −        related potential elicited reaction erroneous recog                                                     nition subject’s intention importantly    case class bci nc   detecting shown feasibility detecting singletrial erroneous  erroneous trial possible replace “wrong” sponses interface leads signiﬁcant improvements  outcome opposite yields accuracy  information transfer rate bci  ·   − · information transfer rate case given promising results obtained simulated  calculated replacing equation  humanrobot interaction currently working ac  stopped outcome                          tual integration errp detection bci    table  reports performances bci integrates parallel exploring increase recognition  errp  subjects average rate singletrial erroneous correct responses ba  assumed accuracy  recognition sic issue ﬁnd kind feedback elicits
