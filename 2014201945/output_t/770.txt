                              modelbased diagnosis hybrid systems                                      sriram narasimhan gautam biswas                                        qss group dept eecs  isis                               nasa ames research center vanderbilt university                                 moffett field ca  nashville tn                                      sriramfajarcnasagov gautambiswasvanderbiltedu                             abstract                               tinuous models   discrete event approaches hy•                                                                 brid diagnosis based abstractions nomi•       recent years seen proliferation em•                                                                 nal faulty behavior behavior event trajec•       bedded systems combine digital discrete                                                                  tories process result loss information        supervisory controller analog continu•                                                                 critical fault isolation control work con•       ous plant diagnosing faults hybrid sys•                                                                 tinuous diagnosis demonstrated behavior tran•       tems require techniques different                                                                  sients key quick diagnosis abrupt faults        used discrete continuous systems                                                                  computationally expensive pre       addition algorithms deployed                                                                  enumerate possible nominal faulty behavior tra•       online meet real time requirements em•                                                                 jectories traditional algorithms continuous diagnosis        bedded systems paper presents method•                                                                 use single model does accommodate discrete        ology online tracking diagnosis hybrid                                                                  changes discrete effects mode changes        systems demonstrate effectiveness                                                                  modeled complex continuous nonlinear        approach experiments conducted fuel                                                                  functions hard analyze online real time        transfer fighter aircraft                                                                    recent work diagnosis hybrid systems                                                                     focused discrete faults requires pre   introduction                                                 enumeration model modes perform diag•  paper addresses problem designing im•          nosis present online modelbased diagnosis meth•  plementing online monitoring diagnosis systems         odology parametric faults hybrid systems   complex systems behavior hybrid discrete            based tracking hybrid behaviors continuous behaviors   continuous nature hybrid modeling covers naturally        interspersed discrete changes unlike hybrid   occurring systems cellcycle control systems       automata models  preenumeration   biology capture behavior embedded            modes avoided generating models runtime   systems common avionics automotive       mode switches occur   robotics domains wide applicability hybrid sys•         fault isolation task account possi•  tems inspired great deal research con•      ble mode changes during diagnostic analysis occur•  trol theory theoretical science                  rence fault necessarily implies longer      focus special class embedded hybrid sys•         correct model behavior mode   tems characterized continuous plant dynamics         changes correctly predicted address   discrete supervisory controller plant dynamics        fault isolation task incorporates search process   defined continuous state variables associated      mode changes hypothesized   components plant controller generates actua•       incorporated consistencybased diagnosis   tor signals discrete time points change        scheme fault isolation process   plant configuration turning components          complicated fault detection delayed diagno•  changing component parameter values set            sis algorithm roll modes identify mode   points regulators hybrid models          fault occurred developed generic   seamlessly integrate discrete continuous be•       tracking fault detection fault isolation scheme   havior analyses using multiple models re•         address issues outlined   sult tasks like monitoring fault diagnosis control      rest paper presents hybrid modeling track•  require appropriate model selection switching        ing diagnosis scheme solving hybrid diagno•  performed online behavior evolves                   sis problem     paper discusses methodologies model  based diagnosis mbd hybrid systems current tech•          unified modeling framework   niques mbd apply dynamic systems                                                                  use unified modeling framework called hybrid bond   behavior modeled discrete event   con•                                                                 graphs extends continuous bond graph modeling                                                                                                                  diagnosis                                                                vided input fsa overall mode sys•                                                                 tem determined parallel composition modes                                                                  modes individual switched junctions                                                                    formally hybrid bond graphs defined tri•                                                                 ple hbg  bg bg bond graph                                                                  model   mkf set finite state                                                                  automata mapping each                                                                 junction bond graph each finite state                                                                  automaton type described output                                                                  function maps each state                                                                  mode change defined junction                                                                  automata changing state results new bond                 figure  fuel schematic                  graph model   provide compact representations hybrid models      figure  illustrates fuel transfer use   component based hierarchical representation ex•         experiments fuel designed pro•  pressed topological structures facilitate causal       vide uninterrupted supply fuel constant rate   analysis dynamics provides standard         aircraft engines time maintain   techniques deriving state space input output equa•     center gravity aircraft symmetri•  tion formulations suitable tracking esti•     cally divided left right parts   mation tasks                                              schematic supply tanks left wing                                                                  lwt right wing rwt left transfer ltt    bond graphs                                                right transfer rtt initially during engine   bond graph bg domainindependent topological          operation fuel transferred supply tanks   representation captures energybased interactions         receiving tanks left feed lft right feed rft   different physical processes make        based predefined sequence fuel transfer se•  vertices graph represent subsystems         quence controlled valves pipes outlet   modeled generic physical processes capacities iner•       supply tanks inlet feed tanks hy•  tias dissipators linear nonlinear      brid bond graph segment connection   behaviors bonds energy pathways subsys•          wing tank feed tank shown figure  illustrates   temsprocesses exchange energy addi•        componentoriented modeling approach hbg   tional types vertices   junctions represent do•     element called switching implements finite state   main independent generalizations kirchoff laws        automata discussed earlier hbg framework   used connection points subsystems         associates parameters compo•  exist systematic techniques construct bond        nents exploit defining componentbased   graph description                          diagnosis methodology faults components                                                                  represented deviations parameter values    hybrid bond graphs                                         example potential fault candidates                                                                  fuel transfer subsystem figure  pump efficiency   additional mechanisms introduced continu•         wing tank pipe switched feed earlier work   ous bg language include discrete transitions            shown equivalence hbg   model switching use switched junctions proposed         framework hybrid automata representation    mosterman biswas  each junction   bond graph switched activated de•          alternate model representations   activated activated junction behaves like conven•  tional bg junction bonds incident junction       bond graph used systematically derive al•  turned inactive play        ternate model representations three representations   dynamics note activating de•       used solve different subtasks diagnosis scheme   activating junctions affect behavior adjoining junc•    state space equations tracking continuous be•  tions                                                         havior ii temporal causal graphs qualitative fault      finite state automaton fsa implements junc•         isolation iii input output equations parameter   tion switching function fsa              estimation refinement fault isolation results   states each state maps mode   causes junction turn mode   junction turns junction mode transitions de•  fined solely external controller signals define con•  trolled switching expressed internal vari•  ables crossing boundary values define autonomous   switching controlled switching control signal   provided input fsa autonomous switching   function determining transition condition pro•      diagnosis                                                                                                              detailed description temporal causal graphs tcg     repeated essentially    tcg captures causal temporal relations    variables vertices graph repre•   sent variables edges labels    represent types relations variables       mbd architecture    diagnosis architecture implements scheme track   nominal dynamics using observer    robust model uncertainties noise measure•  ments uses fault detection scheme trigger fault    isolation scheme discrepancies detected be•   tween observed predicted measurements tracks   analyzes fault transients using fault signatures    isolate fault employs quantitative parame•    ance matrices assumed wk incorporates   ter estimation scheme determine magnitude               term captures modeling errors   fault work focuses component parameter faults         work matrices determined em•  multiplicative faults directly affect     pirically extended kalman filter algorithm follows   dynamics models discussed earlier hybrid       methodology presented    nature complicates tracking diagno•        mode change calculations based   sis tasks mode transitions cause model switch•        mode time step continuous state   ing included online behavior            discrete controller signals plant   tracking fault isolation algorithms pragmatic         assumed known controlled transitions assume   reasons simplify algorithms making single        signal input time step appropriate   fault assumption                                              mode transition time step qk                                                                  autonomous transitions estimated state vector         developed novel approach combines                                                                                                                                   used compute boolean functions signal mode   qualitative quantitative algorithms fault isolation                                                                  transitions note transition functions   extends earlier work  fault isolation                                                                  triggered simultaneously combined derive   continuous systems qualitative approach overcomes                                                                  new mode mode transition results new   limitations quantitative schemes convergence                                                                  state equation model matrices     accuracy problems dealing complex non                                                                                                                                 recalculated online developed efficient   linearities lack precision parameter values                                                                  symbolic solver construct state equation models   models plays significant role cutting                                                                  equation fragments equation fragments corre•  computational complexity enabling online algorithms                                                                  spond constituent equations defining component be•  fault isolation hybrid framework qualita•                                                                 havior junction relations switching oc•  tive reasoning scheme fast effective lim•                                                                 curs sets equation fragments deactivated   ited discriminatory ability uniquely identify true                                                                  activated new state equations   fault candidate employ quantitative parameter esti•                                                                 derived incrementally simplify analysis assume   mation scheme returns magnitude                                                                  mode changes faults occur kalman   deviated parameter                                                                  filter state estimate converged optimal behav•   tracking fault detection                               ior details observer implementation                                                                  presented    hybrid observer implemented combination                                                                    fault detection performed computing esti•  extended kalman filter ekf hybrid automaton                                                                  mates output variables  state estimates   track continuous behavior individual modes op•                                                                                                        xk compute smoothed estimate yk using fir   eration discrete mode changes controlled                                                                  filter finally compute residual ykok ok   autonomous respectively mode changes new                                                                  observations time step residual rk   state space model initial state      threshold predefined number time   recomputed model uncertainty measurement noise            steps fault signaled   implemented white uncorrected gaussian distri•  butions zero mean state space model mode         fault isolation identification   defined                                                                  fault detected fault isolation identi•                                                                 fication performed uniquely isolate fault                                                                  determine magnitude fault isolation identifi•                                                                 cation architecture presented figure  involves three   distributed noq distributed nr     steps qualitative rollback ii qualitative roll  process measurement noise covari         forward iii quantitative parameter estimation                                                                                                                 diagnosis    hybrid systems discontinuous changes meas•  ured variables occur point failure   points discrete mode changes occur plant   behavior time points plant behavior   continuously differentiate advantage     fact qualitative analyses measured variables yk   residual rk variable defined differ•  ence measure plant output nominal   expected plant output continu•  ously differentiable fault occurrence   each mode change residual approximated   taylor scries expansion                                                     •                fig  fault isolation identification architecture      represent residual coefficients                                                                  solve problem advantage fact   magnitude higher order derivative terms                                                                  sequence mode transitions order   residual instead representing quantitative                                                                  lead end state follows   form qualitative values    used indicate                                                                  fact each mode transition essentially changes   coefficient zero                                                                  status switched junction hybrid bond graph      qualitative analyses comprise rollback                                                                  representation based observation each hy•  rollforward steps work qualitative coeffi•                                                                 pothesis apply controlled transitions assuming   cients detection fault signal symbol                                                                  autonomous transitions occurred   generator responsible converting measured ob•                                                                 occurred hypothesized fault mode es•  servations symbolic form each time step dis•                                                                 timated current mode known rollforward   cussion computation residual con•                                                                 process   verting symbolic form presented                                                                     use model tcg predict ex•  repeated                                                                  pected qualitative values residuals signatures      rollback algorithm summarized follows                                                                  current estimated mode each hypothesis   given observer estimated mode trajectory                                                                     through forward propagation algorithm             use propagation algorithm                                                                   fault hypotheses estimated current mode com•  generate hypotheses mode deviated symbols                                                                  pared symbols generated signal symbol   time fault detection propagated                                                                  generator using progressive monitoring scheme    through temporal causal graph mode     identify                                                                mismatch hypothesis dropped   causes deviations fault oc•                                                                 immediately assume autonomous mode transi•  curred previous modes mode                                                                  tion caused mismatch apply possi•  trajectory create hypotheses each previous                                                                  ble autonomous transitions current estimated mode   modes number deter•                                                                 derive new estimated current modes hy•  mined externally diagnosability studies during                                                                  pothesis number possible autonomous   crossover mode previous mode symbols                                                                  transitions each new modes gen•  need propagated mode change                                                                  erate qualitative signature using forward propagation   using inverse reset functions                                                                     compare observations case mis•  associated mode transition example                                                                  match hypothesize occurrence autonomous tran•  symbols propagated mode       obtained                                                              sitions repeat process total number               hybrid hypotheses generation algorithm                                                                  transitions controlled  hypothesized autonomous ex•  returns hypotheses set  each                                                                  ceeds diagnosability limit mismatches sig•  hypothesis threetuple qpk represents                                                                  natures symbols eliminate hypotheses   mode fault hypothesized oc•  curred parameter deviation corresponds        work  shown limited dis•  fault direction deviation parameter       criminatory capabilities qualitative progressive      occurrence fault change parameters       monitoring scheme leads multiple fault   functions determine autonomous transitions         hypotheses reported diagnostic result   leading observer incorrectly predict predict   left hypothesis determining   autonomous transition current mode esti•         magnitude parameter associated hy•  mated hybrid observer actual mode        pothesis essential continue tracking plant behav•  hypothesized fault conditions need         ior faulty situation use parameter estimation   estimate current mode each hy•        technique based leastsquares estimation method   pothesis quantitative       fault isolation identification applying   value faulty parameter implying        statistical hypothesis testing scheme error   accurately determine current mode        fault identification task leads unique fault isolation       diagnosis                                                                                                               estimate deviated parameter value con•         reduced candidate set  faults measure•   sider input output equation form                         ments deviated time left wing tank pressure                                                                  left feed tank pressure candidate set fur•   arc inputs outputs bs    ther refined mode changes required rederivation    constant coefficients forward delay operator    models computation new signa•   typical parameter estimation task estimate      tures track behavior qualitative scheme    bs using measurements optimal          reduced candidate set  parameter    estimate given  vec•                       estimation scheme invoked resulted generat•   tor bs regression vector        ing correct fault hypothesis correct estimation    current output vector single fault assumption im•        faulty parameter    plies parameter unknown each    remaining hypothesis rewrite terms corre•        experimental results    sponding hypothesized fault parameter assume       demonstrate effectiveness diagnosis    order polynomial relation possible extend     scheme real world example fuel    arbitrary polynomial relations                      fighter aircraft fig  pumps modeled    matrix constants re•         source effort pressure transformation factor    formulate estimation problem obtain optimal       defines efficiency pipes modeled    estimate                                            nonlinear resistances                                                                    diagnosis experiments used controller sequence                                                                  provided boeing performance hybrid ob•                                                                 server tracking nominal data  noise                                                                  through mode transfers illustrated figure                                                                   transfer manifold left wing tank pressure measure•                                                                 ments dots represent measured data                                                                  black line shows observer estimates number                                                                  diagnosis experiments run different noise values                                                                  fault magnitudes  details                                                                            table  fuel diagnosability          each remaining hypothesis compute input   output equations estimated current   mode bond graph achieved   computing temporal causal graph bond   graph tcg used compute signal   flow graph used derive input output         table  summarizes different fault classes   equations note signal flow graph        distinguished diagnosis algorithms fault   contains parameters symbolic form opposed ac•         classes follows wing tank pump wtp ii   tual numeric values gives parameterized input       wing tank resistance wtr iii fuselage tank pump   output equation calculate matri•       ttp iv fuselage tank resistance ttr   ces finally accumulate values estimate      switched pipe resistance spr vi feed tank pump   using expression used         ftp vii feed tank resistance ftr   fault isolation plugging estimated parameter      mark row column indicates fault class   state space equations computing predicted       distinguished fault class mark indicates   values outputs hypotheses predicted out•        current controller sequence set measure•  values statistically different actual output     ments sufficient distinguish pair   values eliminated table  illustrates experimental    question table distin•  run left wing tank pump degradation  loss       guish tank pump faults tank outlet pipe re•  time step  initial change observed         sistance faults true pump ef•  transfer manifold pressure time step   fig    ficiency tf decrease pipe resistance increase   mode changes occurred fault occurrence        pump efficiency increase   detection roll process employed        pipe resistance decreases leaks uniquely   produced initial list  candidates detect•   identified classes faults distinguished   ing transfer manifold pressure discontinuous                                                                                                                 diagnosis 
