     protein quaternary fold recognition using conditional graphical models       yan liu      jaime carbonell        vanathi gopalakrishnan                  peter weigele      school science      dept biomedical informatics          biology department       carnegie mellon university         university pittsburgh   massachusetts institute technology          pittsburgh pa               pittsburgh pa             cambridge ma        yanliu jgccscmuedu            vanathicbmipittedu               pweigelemitedu                        abstract                          side chains sequencedistant residues reach struc                                                        turally stable domain folds commonly exist      protein fold recognition crucial step infer proteins contribute signiﬁcantly evolutionary stability      ring biological structure function paper examples include enzymes hemoglobin ion channels      focuses machine learning methods predict  viral adhesive viral capsids      ing quaternary structural folds consist   date signiﬁcant progress protein ter      multiple protein chains form chemical bonds  tiary fold single chain topology recognition ranging      side chains reach structurally stable  sequence similarity matching altschul et al  durbin      domain complexity associated model     et al  threading algorithms based physical forces      ing quaternary fold poses major theoretical jones et al  machine learning methods cheng      computational challenges current machine learn baldi  ding dubchak howeverthere      ing methods propose methods address  three major challenges protein sequencetostructure      challenges show  domain knowledge      mapping hinder previous work applied      encoded utilized characterize structural quaternary fold recognition  proteins adopt      properties using segmentation conditional graph  structural fold apparent sequence similarities      ical models  model complexity han     property violates basic assumption machine      dled through efﬁcient inference algorithms   learning algorithms similar observations tend share      model follows discriminative approach   labels  amino acids distant sequenceorder      informative features representa distance known priori different chains      tive overlapping longrange interactions form chemical bonds threedimensional structures      used conveniently model applied pre bonds essential stability struc      dict important quaternary folds triple β tures considered accurate prediction       spirals doublebarrel trimers crossfamily val furthermore previous methods predicting folds sin      idation shows method outperforms   gle chains directly applicable complex      stateofthe art algorithms                      ity greatly increased biologically computationally                                                        moving quaternary multichain structures    introduction                                         machine learning perspective protein fold recog                                                        nition falls general problem predicting structured  proteins chains amino acids tend adopt unique three outputs learns mapping input variables  dimensional structures native environments structured interdependent output variables conditional  structures play key roles determining activities graphical models conditional random ﬁelds crf  functions proteins important issue computation lafferty et al  maxmargin markov networks taskar  ally inferring threedimensional structures amino et al  semimarkov crf sarawagi cohen  acid sequences protein fold recognition alignment  demonstrated successes multiple applications  given target protein fold   task seeks predict address challenges protein fold recognition  test protein sequence adopts fold provides velop new segmentation conditional graphical model  sequencetotopology alignment fold      extension crf model deﬁnes hidden nodes    different kinds protein folds based labels assigned segments subsequences corresponding  structural properties paper focus com secondary structure element individ  plex ones quaternary structural folds consist ual amino acid connects nodes edges hy  multiple protein chains form chemical bonds pothesize chemical bonds conditional probability                                                        hidden variables segmentation each structure ele    protein folds typical spatial arrangements welldeﬁned ment given observed sequence deﬁned exponen  secondary structures appear repeatedly different proteins tial form features addition efﬁcient approximation                                                    ijcai                                                     algorithms examined ﬁnd optimal nearoptimal example motivates task accurate protein  lutions compared previous work crf model fold recognition alignment prediction problem set  novel capturing longrange dependencies different ting follows given target protein fold  subunits chain chains         asetofn   training sequences xxn including    major advantages approach protein fold positive negative examples structural annota  recognition include  ability encode output struc tion coordinates each atom proteins predict  tures interchain intrachain chemical bonding new test sequence xtest structural annota  ing graph  dependencies segments tion adopts fold yes identify speciﬁc  nonmarkovian chemicalbonding distant location sequence  amino acids captured  permits convenient  use features measure property segments  representation domain knowledge  biologists identiﬁed    remainder paper organized follows sec seen fold recognition task typical seg  tion  introduces basic concepts protein structures mentation labeling problem need ad  fold recognition section  describes details model dress following questions represent domain knowl  followed discussion efﬁcient inference algorithms edge  represent states  capture struc  training testing section  examples tural information observed sequences  quaternary folds show successful experimental chemical bonding physically exists atomic level  sults paper concludes suggestions future work sidechains amino acids structural                                                        topology interaction maps conserved sec                                                        ondary structure level possible insertions    protein structure basics fold                  deletions protein sequence natural     recognition                                        state labels assigned segments subsequences cor  study protein structures biologists deﬁned responding secondary structure element  ceptual hierarchies based current understanding pri individual amino acids connect nodes edges  mary structure simply refers linear chain amino indicating dependencies threedimensional structures  acids secondary structure thought lo deﬁne formal representation structure  cal conformation protein chains intuitively building formation protein fold discuss incorporate  blocks global structures three types domainknowledge features help prediction  standard secondary structures nature αhelix rod  shape peptide chain coiled form helix structure βsheets  protein structure graph psg  peptide strands aligned direction undirected graph   called protein struc  parallel βsheet opposite direction antiparallel βsheet ture graph psg deﬁned target protein fold  stabilized hydrogen bonds types sec  set nodes corresponding  ondary structures connected remaining irregular secondary structure elements fold  regions referred coilthetertiary structure global node represent elements outside fold  threedimensional structures single protein chain set edges neighboring elements sequence  times multiple chains associated each form der polypeptide bonding edges indicating long  uniﬁed structure quaternary structures   range dependencies elements threedimensional    protein folds identiﬁable spatial arrangements sec structures chemical bonding hydrogen bonds  ondary structures observed exist lim disulﬁde bonds figure  shows example simple β  ited number topologically distinct folds nature αβ motif notice clear distinction   discovered millions protein se edges colored red black terms probabilis  quences result proteins fold tic semantics similar chainstructured crf black  demonstrate sequence similarities reveal edges indicate state transitions adjacent nodes  important information structural functional conser red edges used model longrange interactions  vation common ancestors example triple β unique protein structure graph psg qua  spiral fold processive homotrimer serves ﬁbrous ternary fold derived similarly ﬁrst construct psg  connector main virus capsid cterminal knob each component protein component monomeric psg  binds host cellsurface receptor proteins fold homomultimers add edges nodes  identiﬁed commonly exist adenovirus dna different chains chemical bonds forming  virus infects humans animals reovirus complex similarlystructured quaternary psg  rna virus infects human bacteriophage prd   given deﬁnition protein structure graph  dna virus infecting bacteria similarity question automatically build graph partic  tween protein sequences low  sim ular fold answer depends type protein folds  ilarity identifying examples triple βspiral fold concern knowledge bring bear  help biologists establish com folds biologists studied years ac  mon fold nature reveal important evolutionary cumulated basic knowledge properties ex  lationships viral proteins               ample βαβ motif βhelix topology graph                                                    ijcai                                                                                                   structure graph mi number segments                                                         th                                                                      ij    ij ij ij  ij ij     ij                                           chain                                                                                                            state starting position ending position jth seg                                                        ment following deﬁnition decompose                                                        potential function cliques product unary                                …                                                pairwise potentials                                                                                            k                                                                                   figure  graph structure βαβ motif struc yyc xxc exp        θkfkxi wij                                                                                   ture protein structure graph node greenbetastrand                          wij ∈vg  yellowalphahelix cyancoil whitenonβαβ inode                         k                                                                                      θkgkxa xb wau wbv  constructed easily communicating experts         wauwbv ∈eg  fold structure totally unknown biolo                                                        fk gk nodefeatures pair features respec  gists follow general procedure following                                                        tively θk θk corresponding weights  steps ﬁrst construct multiple structure alignment                                                        normalizer possible segmentation conﬁgurations  positive proteins second segment                                                        sequences jointly figure  graphical model  alignment disjoint parts based secondary struc                                                        representation notice joint inference required  tures majority proteins draw graph nodes                                                        quaternary fold stabilized chemical bonding  denoting resulting secondary structure elements                                                        tween component proteins key computa  add edges neighboring nodes finally add long                                                        tional challenge  range interaction edge nodes average dis  tance involved residues threshold  feature extraction  required sidechain hydrogenbonding skip scgm model provides expressive framework han  tails case separate line research dle structural properties protein fold recognition  assume given reasonably good graph                                                        choice feature functions fk gk play  perform learning focus paper key role accurate predictions following feature                                                        deﬁnition crf model factor features fol    segmentation conditional graphical models                                                        −       scgm                                           lows fkxi wij fkxipij qij  sij  qij                                                        pij ∈ length ranges  gkxa xb wau wbv  given structure graph deﬁned chain protein                                                                                              gkxa xbpauqaupbvqbv sau  sbv   qau −                                                                                                       sequence   possible segmen av ∈ length range bv − bv ∈ length range                                                                                          tation label sequence  wherem                                          number segments  sjpjqj inwhichsj     discuss deﬁne segmentbased features  pjanddj state starting position ending position                          th                                              fk gk node feature fk covers properties  segment following idea crf condi individual segment example “whether speciﬁc motif  tional probability segmentation given observation appears subsequence” “averaged hydrophobicity”  deﬁned follows                               “the length segment” pairwise feature g cap                                                                                                                                                    tures dependencies segments correspond                   exp   λkfkxc          ing subsequences form chemical bonds structures                                         c∈c                              example previous work structural biology suggests  normalization constant               different propensities form bonds amino    generally given quaternary structure graph acids pairs pairwise features  chains xii segmentation ini propensity scores subsequences form hydrogen  tiation each chain yi mi wi deﬁned protein bonds notice feature deﬁnitions quite gen                                                        eral limited examples discriminative                                                        setting model enables use kinds informa                            …                                  mj        tive features additional costs                             …                              mi               efﬁcient inference                                                        ﬁnd best conformation test sequences need                                            consider labels protein chains jointly                  …  ni                          …              chain contributes stability structures given                        nj          enormous search spaces quaternary folds need ﬁnd                                                        efﬁcient inference learning algorithms  figure  graphical model representation scgm model  multiple chains notice longrange inter  training phase  actions represented red edges chain feature weights θk θk model parame  tween chains                                          ters training phase estimate values maxi                                                    ijcai                                                      mizing regularized conditional probability training  state transition given segmentation yi mi wi   data                                             select segment uniformly state value s                                                                                 y∗              ∗        ˆ  ˆ                                                uniformly state set set  sij      θ θ                                                                                                                                                 position switching given segmentation mi                         θ  θ  arg max   log py   yc   xc  σ  σ  select segment uniformly position                                                                                             ∗                                                         signment ∼ udij− dij − setyi  yi                                                              ∗        closed form solution equation dij     fore use iterative searching algorithm lbfgs  segment split given segmentation yi mi wi   limitedmemory quasinewton code largescale uncon        ∗       ∗   ∗        ∗                                                         propose yi mi    wi  mi  mi  segments   strained optimization taking ﬁrst derivative log splitting jth segment randomly sampled   likelihood lθθwehave                                              ∗                                                         umsetwik    wik −                                                           ∗                                        ∗    ∂l                                                   wik  wik  misampledj                                                                                          ∂θk                                                 udj dj −  probability  wesetsj∗  sj                                                                  new      new  n                                                    sj∗      sampled probabil                 −                 θk                fkxi   wij   nfkxi  wij     ity  reverse                                               σ                                                   n∈v                                              segment merge given segmentation mi       wij                                                                             th              th                                                         propose mi  mi−  merging segment                                                         segment sampled uniformly − set              n                                          ∗                                 ∗    ∂l                                                   wik  wik − andwik−   wik                         gkxa xb wau wbv −                                                           mi   ∂θk                      wauwbv ∈eg                           general protein folds regular arrangements                                                  θk   secondary structure elements state tran                    ngkxa xb wau wbv                                                 σ     sitions deterministic deterministic                                                         operator state transition removed seg   psgs complex graphs loops multi ment split merge greatly simpliﬁed   ple chains average degree  each node cases interchain intrachain interactions   explored efﬁcient approximation methods estimate fea stochastic additional operators necessary   ture expectation three major approximation ap including segment join adding interaction edge pro   proaches graphical models sampling variational methods tein structure graph segment separate deleting   loopy belief propagation sampling techniques teraction edge graph details similar state   widely used statistics community transition omit discussion limited space   problem use naive gibbs sampling notice   each sampling iteration dimension hidden variables  testing phase   yi varies cases number segments mi                                                                                                     variable unknown number structural repeats given test example multiple chains    folds reversible jump markov chain monte carlo need search segmentation yields highest   reversible jump mcmc algorithms proposed ditional likelihood similar training phase   solve problem demonstrated success various ap optimization problem involving search multidimensional   plications mixture models green  hidden space computationally prohibitive search   markov model dna sequence segmentation boys  possible solutions using traditional optimization meth   henderson                                      ods simulated annealing reversible jump mcmc                                                         used shown theoretically empirically   reversible jump markov chain monte carlo              converge global optimum andrieu et al    given segmentation yi mi wi goal propose algorithm shows detailed description reversible               ∗   new yi  satisfy detailed balance deﬁned jump mcmc simulated annealing parameter                                                    ∗                                  β   mcmc algorithm auxiliary random variables trol temperature reduction rate set                                               ∗   introduced deﬁnitions experiments rapid convergence   guarantee dimensionmatching requirementie dyi            ∗         dvdyi dv   onetoone mapping             ∗                                             experiments   yiv yi  function Ψ Ψyiv     ∗        −  ∗     yi  Ψ yi yiv acceptance rate demonstrate effectiveness different recognition                                ∗   proposed transition yi yi              models choose protein folds examples includ                                                         ing triple βspiral van raaij et al  virus ﬁber       min posterior ratio × proposal ratio × jacobian                                                       doublebarrel trimer benson et al whichisa                        ∗                ∗                  yyi yc xi   ∂yi          min    ∂y  building block virus capsid hexons choose                                                folds speciﬁcally involved im   term determinant jacobian matrix portant biological functions shared viruses dif     construct markov chain sequence segmenta ferent species reveal important evolution rela   tions deﬁne types metropolis operators   tionships viral proteins tbs ﬁt                                                     ijcai                                                        algorithm reversible jump mcmc simulated annealing                    van raaij etalinnature   input initial value output optimized assignment    set yˆ     ←  ∞         ← βtift return  yˆ        sample value ynew using reversible           jump mcmc algorithm           described section  ∇e  ynew − yˆ        ∇ethensetyˆ   ynew set yˆ            ynew probability exp∇et    return yˆ    predictive framework structure repeats         nb      nb  dbt extremely challenging lack                                                                                     structural regularity folds complex structures              fh  positive examples structurallyresolved proteins               notice model used protein folds           fh    advantages evident predicting                                                                               complex challenging protein folds                                   fh                                                              c’                    protein structure graph target fold                                      triple βspiral fold tbs processive homotrimer figure  topleft demonstration graph triple βspirals  sisting three identical interacting protein chains figure structures view red block shaft region target fold   provides structural stability adhesion protein black block knob region topright view maps  initiate viral attack target cell wall hydrogen bonds chain chains  three proteins fold resolved structures psg triple βspirals  structural repeats chain                                                            common existence viruses different species mirror chain better visual effects dotted line  reveals important evolutionary relationships indicates interchain interactions solid line intrachain interactions  tbs common fold nature pairs characters edges indicate hydrogen  examples identiﬁed far              bonding residues denoted characters    provide better prediction model notice follow  ing structural characteristics tbs consists three iden  tical protein chains varied number repeated struc doublebarrel trimer dbt protein fold  tural subunits each subunit composed  βstrand coat proteins kinds viruses sug  runs parallel ﬁber axis  long solventexposed gested occurrence dbt common icosa  loop variable lengths  second βstrand forms hedral dsdna viruses large facets irrespective  tiparallel βsheets ﬁrst slightly skewed host benson et al  straightforward  ﬁber axis  successive structural elements uncover structural conservation through sequences ho  chain connected tight βturns weigele mology positive proteins se  et al  components β quence similarity low  strands quite conserved sequences van raaij et al dbt fold consists eightstranded jelly rolls  characterize labeling each position using character βbarrels figure  component βstrands  ‘a’ ‘o’ van raaij et al  speciﬁcally io labeledasbcdefghandirespectivelysomegeneral  ﬁrst strand ah second strand figure descriptive observations include  lengths  right based discussion deﬁne psg βstrands vary ranging   residues  tbs fold figure   states altogether layout strands ﬁxed loops insertions  correspond com strands general short    residues  ponents each repeated structural subunits respectively exceptions example long insertions  null state refers nontriple βspiral region strand    residues long  ﬁx length   respectively loops strand    residues short β  sequence conservation addition set length turn  chemical bonds stabilize  oftandtin      individually longer trimers located fg loops unfortunately  insertions bring instability structures ex speciﬁc location bonding type remain unclear  ample prior biological knowledge constraining model note fg loop ﬁrst doublebarrel trimer fg  space pairs interacting residues marked second fg based discussion  edges used deﬁne pairwise features deﬁne psg doublebarrel trimer shown                                                    ijcai                                                     
