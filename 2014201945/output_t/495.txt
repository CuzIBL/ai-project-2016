                     fast image alignment using anytime algorithms              rupert brooks   ∗                    tal arbel                       doina precup     centre intelligent machines   centre intelligent machines    school science           mcgill university                 mcgill university                 mcgill university            montreal canada                 montreal canada                  montreal canada        rupertbrooksmcgillca             arbelcimmcgillca              dprecupcsmcgillca                        abstract                          maximize chosen similarity measure number op                                                        timization techniques smooth functions gradient      image alignment refers ﬁnding best transfor                                                        descent used problem provide good      mation ﬁxed reference image new image                                                        solutions wide range image types      scene process guided similar                                                        approaches slow reduces usefulness      ity measures images computed based                                                        timesensitive applications realtime video registra      image data timecritical applica                                                        tion wildes et al  medical image registra      tions stateoftheart methods computing simi                                                        tion during surgeryeg pennec et al  possible      larity slow instead using image                                                        increase speed processing using subset      data compute similarity use subset                                                        pixels compute easily lead reduc      pixels improve speed comes                                                        tion accuracy reliability determining size      cost reduced accuracy makes                                                        subset use typically adhoc fashion using      problem image alignment natural application                                                        heuristics applicable certain domains fur      domain deliberation control using anytime al                                                        thermore different number pixels needed      gorithms research                                                        different stages optimization ﬁxed subset neces      direction paper present                                                        sarily compromise      anytime versions computation com      mon image similarity measures mean squared dif    paper propose deliberation control frame      ference mutual information offline learn work using anytime algorithms dean boddy       performance proﬁle speciﬁc each measure     horvitz  arrive principled solution speed      used online select appropri vs accuracy tradeoff problem ﬁrst step      ate pixels process each optimiza learn properties similarity measure consider      tion step tested existing techniques ation terms accuracy vs computation time training      method achieves comparable quality ro    offline image pairs transformation param      bustness signiﬁcantly computation      eters known given new pair images align                                                        use knowledge determine number pixels    introduction                                       need considered each step optimization  need align register images ba paper explore effectiveness approach  sic problems vision deﬁned using common similarity measures mean squared dif  task ﬁnding spatial mapping places elements ference mutual information gradient descent opti  image meaningful correspondence elements mizer tested algorithm types images  second image essential data fusion tasks medical images everyday scenes multimodal medical images  imaging hajnal et al  remote sensing cole earth observation data landsat radarsat images  rhodes et al  widely applied tracking cases using deliberation control approach faster  automatically mosaicking photographs szeliski  computing transformation using image data    straightforward widely used ap gives reliable results simply performing opti  proaches referred direct image alignment works mization using arbitrary ﬁxed percentage pixels  deﬁning similarity measure function refer remainder paper organized follows sec  ence image template image warped transforma                          φ                             tion  review image alignment problem section  tion parameters  computation typi  review methods deliberation control using anytime  cally requires examining pixels each image align                                               φ        algorithms details deliberation control  ment problem ﬁnding values implemented context image alignment given    ∗mr brooks partially supported national science section  finally sections   experimental  engineering research council postgraduate studies award setup results conclusions                                                    ijcai                                                      image alignment                                    support partial evaluation knowledge  direct approaches image alignment work deﬁning algorithms perform different amounts computation  function measures similarity ﬁxed ref class algorithms supporting partial evaluation  erence image rx new image wxφ time algorithms horvitz  dean boddy   consider images rx continuous func provide solution run length time  tions position deﬁned space coordinates solution quality guaranteed improve  coordinate space warped wxφ map computation performed deliberation control strategies  ping parameterized φ translation ing anytime algorithms applied theoreti  rotation images actually sets pixels located cal practical problems including robot control vlassis et  integer coordinate positions use linear interpolation al  constraint satisfaction wah chen   needed determine values wxφ xφ shape extraction image processing kywe et al    integer similarity measure func formulate effective deliberation control strategy  tion transformation parameters φ problem ing anytime algorithms necessary metalevel  image alignment optimization problem knowledge performance function  solved using standard techniques gradi computation performed dean boddy  horvitz  ent descent secondorder methods stochastic programming  knowledge stored performance proﬁle  techniques require repeated calculation performance proﬁles based theoretical knowledge  andor gradient ∇φd different points space algorithm empirical testing performance  possible transformations far computa different computation levels combination  tionally intensive process               case decision continue computation    recently feature based approaches alignment seen based estimate accuracy current result  considerable success operate faster direct ap estimate potential improvement algorithm  proaches applications direct ap continues run dean boddy  horvitz   proaches yield higher overall accuracy continue larson sandholm   used ﬁnal adjustment step szeliski simplest type performance proﬁle static  difﬁcult match features reliably im predicts accuracy function com  ages question modality direct putation completed problem  approaches method choice applications equivalent simply using ﬁxed arbitrary percent  medical imaging hajnal et al  geomatics cole age pixels feedback current run  rhodes et al  high precision required algorithm available incorporated  multimodal imagery common                         phisticated approach dynamic performance proﬁle lar    long known numerical optimization ap son sandholm  uses feedback estimate accu  proaches signiﬁcantly accelerated using sub racy algorithm progresses described func                                                                         set pixels images estimate similarity func tionsa ˆ pfwd  maps percentage computation  tion example implementations mutual infor completed feedback parameter  expected                                                                                       mation ibanez et al  use random subset accuracya ˆ otherp ˆ prev mapsa  image data suggested efﬁ expected percentage computation requiredp ˆ conceptu  cient include pixels high derivatives calcu ally functions inverses  lation szeliski  size subset maintained general facilitate decision making  used ﬁxed adhoc fashion unfortunately ﬁxed controller use functions gradually increase  size usually regions parameter computation performed estimated accu  space little furthermore different types racy adequate task  images behave differently difﬁcult come  subset size appropriate cases instead  deliberation control image alignment  use deliberation control mechanism choose                                                        mentioned section  computationally inten  computation perform each step optimization                                                        sive image alignment repeated evaluation                                                        similarity measure gradient ∇d optimization    deliberation control anytime                  algorithm needs information order step     algorithms                                         parameter space optimal setting note  artiﬁcial intelligence tasks planning quality calculation accurate ensure  solution obtained depends time spent step correct determining values exactly                                                                                                        ∇  computations tradeoffs necessary necessary propose implement  cost suboptimal solutions cost spending time anytime algorithms learn performance proﬁles  doing computation process called deliberation scribing accuracy different levels computation  control investigated context realtime ar  tiﬁcial intelligence number approaches  anytime similarity measures  proposed horvitz zilberstein  deliberation implemented popular image similarity measures  trol methods rely key components algorithms anytime algorithms resulting implementations                                                    ijcai                                                    able support partial evaluation continue true bsplines satisfy partition unity  interrupted calculation efﬁciently achieve constraint mutual information computed  deﬁne each similarity measure dφ function dφ using usual formula  parameters φ percentage pixels                                                                       φ            α   φ   used avoid biasing computation area            pkl               pkl                                                          dmiφ ∑  ∑         log                                                                                 ∑    φ ∑   φ   image pixels processed random order        pn        pk     pkl   mean squared difference                               note second factor denominator just  negative mean squared difference dmsd intensity histogram original image com  common similarity measures szeliski andis puted optimization process  suitable images modality original form rd order bspline differentiable gradient  dmsd simply average negative squared differences                                                        joint histogram ∇φpklφ computed  intensity corresponding pixels negative usual way stored φ tables each dimension  simply similarity distance measure × linth´evenaz unser  shown                                                      pn                           using formulation derivative dmi                                                    dmsdφ p−       ∑  rxi − tw xiφ                     pn                                                                                                                                          pklφ                                                            ∇φdmiφ p∑∑γ∇φpklφ    plog  total number pixels image gra                              ∑k    φ                                                                                          k pk  dient similarity measure easy compute                                                                                                  −                                                      γ normalization factor γ pn                        pn                                                                     ∇φd    φ      ∑  rx  − twx φ        derivative required compute        msd       pn                                                                   joint probability distribution gradient                                                          algorithm maintains unnormalized probability dis                       ·∇w xiφ∇φwxiφ                   φ     ∇      φ                 tribution unnormalized partial derivatives  note dmsd  φdmsd    updated  scribed easily updated pixels  incrementally usual fashion                   added table entries simple sums dis  mutual information                                    tance measure gradient computed needed  mutual information mi image similarity measure viola table  wells iii  useful images different modal  ities anytime implementation based efﬁcient  performance proﬁles  mutual information implementation proposed th´evenaz exploiting partial evaluation possibilities anytime  unser  relies bspline windowed rep similarity measures requires dynamic performance proﬁles  resentation joint probability distribution inten describing expected accuracy different computation    sity levels images speciﬁcally let brk levels feedback values notion accuracy   kbeasetofk   bins width dr intensity developed terms optimization method used                                            values reference image starting minr  simi paper used simple steepest descent optimizer                                                                                           larly let bins intensity values template described ibanez et al   carter           tl                                            analyzed similar class optimizers proven  image  bins begin bt  mint                                                     convergence using following measure relative error  width dt  unnormalized joint distribution               ×                                                          ∇  − ∇       array size ltheentrypkl equal number             ε    true    measured              pixels intensity falls bin               ∇trued  tensity corresponding pixels transformed image  falls bin                                         dynamic performance proﬁle requires feedback param                                                eter indicates progress particular calculation           pn                                                       rxi −        xiφ −  run based equation gradient magnitude  φ ∑  δ             δ                  kl                                                   ideal candidate designed performance                    dr                  dt       δ                                                proﬁles tables mapping computation level gradi   equal  arguments equal zero ent magnitude accuracy construct sampled  th´evenaz unser  use instead soft ver gradient different computation levels points  sion compute entries table based bspline transformation space each computation level pwe  parzen windows similarly work use grouped gradient magnitudes bins computed                                                             pn            −             φ −  expected accuracy e¯p gradient each bin follows                      xi            xi      pklφ ∑ β  −           β  −                        dr                   dt                            ∇   dφ  − ∇ dφ                                                               e¯   − ∑                         β      β                                                               ∇     φ      th rd order bspline parzen win                        dows respectively normalization factor pkl                                                                                                                  speciﬁc information class documen                                                        tation httpwwwitkorgdoxygenhtmlclassitk             αφ p∑   ∑ pklφ ppn                                                 regularstepgradientdescentoptimizerhtml                                                    ijcai                                                    φi sampled points transform space    optimizer uses table progressively increase  computation performed estimated ac  curacy reaches criterion acceptability analy  sis carter  indicates signiﬁcant computational  gains small ε ≈  reduction ac boat      boat       boat  curacy choose optimizer seek  expected accuracy  each gradient computes    simple example table used control  computation shown figure  table act  performance proﬁle functionsa ˆ  pfwd   pˆ  prev implemented through simple lookup  example suppose optimizer requires accuracy  grafﬁti      mri       mri  initial probe case current esti  mated performance  examining row applying   prediction    obtain desired accuracy level arrow  perform  ing  computation suppose   accuracy  arrow  meaning com landsat   landsat    landsat  putation required required estimated   arrow  case parameter  percentage pixels processed image feedback  parameter magnitude gradient                                                              radar      radar     radar      figure  dynamic performance proﬁle example values  table represent expected accuracy results                                                            mri       mri        ct    experiments                                               figure  images used experiments   test anytime algorithm approach number  generating performance proﬁles  formance proﬁles generated alignments  formed classes images shown figure  performing alignments performance proﬁles  image pairs each used testing process each combination image class similarity measure  ﬁrst image class typical digital photos dp images generated offline proﬁles constructed using  ad selfaligned aligned training image pairs modalities ones                                                        aligned training data separate test  afﬁnely images scene taken                                           ∇  different camera positions images bc using similarity ing data used later each training pair value  measures second class images images ef computed  points transform space   slices tweighted magnetic resonance imaging mri different computation levels proﬁle constructed                                                        using method described section  resulting  volumes selfregistered using dmsd measure  class images eo patches georefer formance proﬁles shown figure  note each                                                        proﬁle roughly similar shape large values  enced orthorectiﬁed landsat  radarsat imagery                ∇    registered each using mutual information feedback parameter φd  little computation needed  measure rows   ﬁnal class images good result smaller values progressively  slices previously registered volumes different medical computation needed agrees intuition  imaging modalities including weighted mri image noise level remains constant small values  computed tomography ct row images progressively harder measure curved shape  aligned each using mutual information measure graphs allows realize important performance                                                        gains constant fraction pixels inevitably    images mikolajczyk httpwww feedback values  inrialpesfrlearpeoplemikolajczyk      landsat     despite basic similarity important  radarsat images ghij kl natural resources differences proﬁles example note  canada httpgeogratisgcca medical images similarity measures medical images require  courtesy montreal neurological institute greater percentage computation accurate result                                                    ijcai                                                         image                rms pixels                    run time              failure rate        pair     gd    gd      gd     agd     gd  gd  gd   agd   gd  gd  gd  agd      aa dp ± ± ± ±                    dd dp ± ± ± ±                    ab dp ± ± ± ±                   ac dp ± ± ± ±                    ee ± ± ± ±                        ff ± ± ± ±                        msdavg   ± ± ± ±                                                         results msd measure      image                rms pixels                    run time             failure rate       pair     gd     gd      gd     agd     gd  gd   gd  agd   gd  gd   gd   agd    mo ± ± ± ±                      ± ± ± ±                    mn ± ± ± ±                       gj eo ± ± ± ±                     hk eo ± ± ± ±                  il eo ± ± ± ±                   aa dp ± ± ± ±                    dd dp ± ± ± ±                     miavg   ± ± ± ±                                                         results mi measure  table  experimental results results image pair combined each measure rows  algorithms gdx  standard algorithm using pixels agd  anytime algorithm entries shown plain font signiﬁcantly  different gd italic ambiguous text items bold signiﬁcantly differ gd       performance profiles msd performance profiles mi test algorithms capture range optimizer                                        digital photos                         each combination image similarity measure algo                 mri slices                                                    rithm true transform composed starting                                                        positions result used initialize alignment                                                    process alignments performed using standard ap                                                      proach labeled gd graphs standard approach         pixels required       pixels required            using speciﬁed percentage pixels labeled gdx                                                          digital photos         pixels used anytime approach com                                 medical imagery                                 landsat−radar          putational efﬁciency measured terms running time                                −      −       −    −      −                                                   each reported time obtained ghz amd athlon          gradient magnitude    gradient magnitude      machine gb ram  figure  performance proﬁles percentage computa determine observed reductions runtime came  tion required achieve ep                      expense performance measured qual                                                        ity reliability algorithms quality result  given gradient magnitude alignment tests discussed measured rootmeansquare rms position er  reveal images require computation ror compared true transformation position calcu                                                        late  randomly placed points unit square  align successfully note dmi performance pro  ﬁles geographic data medical images indicate scaled image extent transformed   pixels used ing known true transformation computed transfor  classes images using method                  mation reported rms square root mean                                                        squared coordinate differences points    alignment tests                                    reliability each method measured num  implemented approach extending existing ber failed alignments particular run considered  tested image alignment implementation speciﬁcally failed registration converged transforma  used implementation similar example multiresim tion lead rms pixel position errors greater  pix  ageregistration ibanez et al  pp – els registration failed converge answer  appropriate transforms extensions added op practice criterion rarely  timizer measures support deliberation control ex biguous alignment yield results  perimental procedure follows three sets  ran better rms value worse failed runs  dom starting positions created each set dif calculated average times registration error  ferent effective distance identity transform order each algorithm tested run set                                                    ijcai                                                    
