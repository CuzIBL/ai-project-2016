                   online speed adaptation using supervised learning                        highspeed offroad          autonomous driving                           david stavens gabriel hoffmann sebastian thrun                                 stanford artiﬁcial intelligence laboratory                                         stanford ca                                 stavensgabehthrunroboticsstanfordedu                        abstract                          damage vehicle mechanical actuators elec                                                        tronic components second key perceptive technology      mobile robotics community traditionally   laser range scanning relies accurate estimation orien      addressed motion planning navigation terms tation shock causes vehicle shake violently making      steering decisions selecting best accurate estimates difﬁcult shocks substantially      speed important – relationship duce traction during oscillations finally demonstrate      stopping distance lateral maneuverability shock strongly correlated speed independently      consider highspeed  mph autonomous vehi   subjectively difﬁcult terrain minimizing shock      cle driving offroad through challenging desert ter implies slowing challenging roads necessary – cru      rain vehicle drive slowly terrain cial behavior mitigate risk vehicle      poses substantial risk daw                                                          algorithm uses linear relationship shock      dle safe terrain paper address                                                        speed derive analytically algorithm      aspect risk – shock vehicle present                                                        three states vehicle drives maximum allowed      algorithm tradingoff shock speed real                                                        speed shock threshold exceeded second vehicle      time human intervention tradeoff                                                        slows immediately bring shock threshold      optimized using supervised learning match hu                                                        using relationship speed shock finally      man driving learning process essential                                                        vehicle gradually accelerates returns ﬁrst state      discontinuous spatially correlated nature                                                        second threshold exceeded during acceleration      control problem – classical techniques      directly apply evaluate performance hun   maximize safety vehicle react shock      dreds miles autonomous driving including   slowing immediately resulting discontinuous      performance during  darpa grand chal     speed command accelerate cautiously      lenge approach deciding factor rough terrain tends clustered property      vehicle’s speed nearly  darpa com  demonstrate experimentally reasons pos      petition – constraint sible determine optimal parameters using classical      darpaimposed speed limits – resulted  trol techniques selection parameters tuned      fastest ﬁnishing time                            physical model performance                                                        best measured statistically driving experience                                                          generate actual parameters al    introduction                                       gorithm – shock threshold acceleration rate – using  mobile robotics motion planning navigation tra supervised learning algorithm generates reasonable  ditionally focused steering decisions paper presents match human teacher course humans proac  speed decisions crucial planning – tive using perception make speed decisions use  relationship speed obstacle avoidance concerns inertialonly cues difﬁcult assess terrain  stopping distance lateral maneuverability consider roughness perceptive sensors accuracy required ex  highspeed  mph autonomous vehicle driving offroad ceeds obstacle avoidance substantial margin  through challenging desert terrain want vehicle cause rough patches just centimeters height  drive slower dangerous terrain experimental results indicate reactive approach  want minimize completion time robot effective practice  tradeoff speed risk realtime natural pro algorithm software suite developed  cess human drivers trivial endow stanley autonomous vehicle entered stanford univer  robot ability                              sity  darpa grand challenge darpa     address tradeoff component risk stanley shown figure  grand challenge  shock vehicle experiences minimizing shock impor robot race organized government  ve  tant reasons shock increases risk hicles navigate  miles unrehearsed desert ter                                                    ijcai                                                    figure  stanley won  darpa grand challenge  completing  mile desert route just  hours  algorithm described paper deciding factor  stanley’s speed nearly  race –  constraint darpaimposed speed limits                                                          figure  ﬁnd empirically relationship  rain algorithm described played important role perceived vertical acceleration amplitude vehicle speed  event speciﬁcally deciding factor static obstacle approximated linear function  robot’s speed nearly  competition – operational region  constraint darpa imposed speed limit  resulted fastest ﬁnishing time robot                                                        example teams carnegie mellon university    related work                                       cmu used “preplanning” speed selection gutierrez et                                                        al  urmson et al   nova  extensive work terramechanics bekker                                                        months members cmu teams collected extensive en    wong  guidance autonomous vehi                                                        vironment data general area competition  cles through rough terrain work generally falls                                                        thought held precise route revealed  categories focuses highspeed navigation                                                        darpa hours race team preprogrammed  requires terrain maps topology known                                                        speeds according previously collected data end  hand shimoda et al  spenko et al                                                         result cmu approach similar  analyzes terrain ruggedness online fashion driving                                                        fullyonline method requires human intervention  sadhukhan et al  brooks iagnemma                                                         prior knowledge terrain distinction par  iagnemma et al  vehicle speed slow                                                        ticularly important desert terrain readily changes   mph classiﬁcation focused ter                                                        time factors including weather  rain type roughness work combines strengths  categories online terrain roughness assessment  highspeed navigation                                   speed selection algorithm    successful obstacle detection systems built                                                        algorithm derived three steps derive  highspeed autonomous driving thrun et al                                                        linear relationship speed shock second  urmson et al   kelly stentz                                                        leverage relationship build algorithm determin  mentioned section  precision needed                                                        ing appropriate speed finally tune parameters  determining terrain ruggedness exceeds required ob                                                        algorithm using supervised learning  stacle avoidance substantial margin  systems excellent detecting avoiding static obsta  acceleration mapping filtering  cles protect vehicle effects road  roughness                                            mapping vehicle speed shock experienced    work explicitly considered speed important fundamental technique shock measured  path planning example fox et al  presents amplitude acceleration vertical zdirection  method trading “progress” “velocity” regard vehicle’s main body vehicle’s speed posi  number type obstacles present slower tion path ground varies height zgp  speeds desirable cluttered environments faster pushing stifﬂy car’s tires ground modeled  speeds better open spaces concept applied sum sinusoids large number unknown spatial  desert driving analogous slowing turns road frequencies amplitudes consider component  discrete obstacles vehicle exhibits behav summation spatial frequency ωs amplitude                                                         iors separate algorithm zgωs  motion vehicle frequency time                                                               ω  vω  paper                            gωs      taking derivatives accelera                                                            z¨                    vωa    entrants  darpa grand challenge tion gωs  amplitude zgωs frequency  alized importance adapting speed rough terrain vωs acceleration input vehicle’s tire                                                    ijcai                                                                                                          nance suspension   hz followed                                                        exponential drop az¨ zero                                                          acceleration approximately linear func                                                        tion barrier use pure zaccelerometer inertial                                                        measurement unit imu data acceleration reﬂect                                                        inputs road roughness projection                                                        gravity vector zaxis changes pitch                                                        road causes large low frequency offset second                                                        driveline nonuniformities wheels cause higher                                                        frequency vibrations                                                          remove effects pass imu data through                                                        tap fir band pass ﬁlter extract excitation                                                        suspension   hz band band                                                        experimentally reject offset gravity                                                        eliminate vibrations unrelated suspension                                                        eliminating vibration response suspension                                                          comparison raw ﬁltered data shown fig  figure  filtered vs unﬁltered imu data tap fir ure  mean raw data acquired terrain  band pass ﬁlter extracts excitation suspension sys slope mean ﬁltered data  tem   hz band removes offset solely presentation ﬁgure  gravity terrain slope varies higher frequency noise subtracted raw data  engine vibration unrelated oscilla  tions vehicle’s suspension                      generating speed recommendations                                                        speed selection algorithm velocity controller    model response suspension use three states each road assumed speed limit γin  quarter car model gillespie  tire modeled mph represents upper bound vehicle speed  connection axle road spring road vehicle travels speed limit  stiffness kt suspension modeled road event generates shock exceeds acceptable  connection axle vehicle’s main body threshold α gs second reduces speed                                                                                    α  ing spring stiffness ks damper coefﬁcient cs event  finally accelerates  using model amplitude acceleration main rate β mphs speed limit  body vehicle easily approximated assuming formally recall given rough segment  inﬁnitely stiff tires                          road shock experienced vehicle linear                                                       spect speed dt seconds vehicle takes reading                             vω                                                           z¨        vωa                                  current location route filtered shock     zω¨   zgωs vω   − mvω       speed observed optimal speed                                                                                                               mass quarter vehicle  magnitude acceleration input tire taken                      vωa      described resonant frequency                v∗     α       zgωs                                                                    z¨                  standard automobile   hz fre                         quency amplitude increases zero  hz slowly v∗                                                        velocity delivered max  exponentially frequency frequency               α                                  csvωs                 imum acceptable shock   vehicle  plitude increases linearly approaching   modern                                                ∗                                      zgωs            instant recommendation vehicle speed  active damping systems quench effect reso                                                                                             tice vehicle slowing reactively reactive behavior  nant frequency leading curve nearly linear fre                                                        effect shock instant random clustered  quency noise sensors                                                        approach relies shock event “announcing”  measure effect random forcing disturbances                                                        arrival momentarily experimental results    frequency ω directly proportional speed vso                                                        hundreds miles desert indicate effective strat  amplitude acceleration response vehicle                                                        egy  approximately linear function velocity su         ∗                                                          consider observation algorithm incorpo  perposition considering sum responses com                                                              rates observations time generating actual rec  ponents terrain proﬁle spatial frequencies     vr                                                        ommended speed   plitude acceleration response vehicle az¨isthe                                           sum approximately linear functions                                                                                                                   ∗   approximately linear theoretical analysis       minγv      −  βdt           veriﬁed experimentally figure                                                                                                                  vr    approximation assumed inﬁnitely stiff tires reality purposes clamp                                                                            vr  ﬁnite stiffness tires leads higher frequency reso  mph series velocity plan                                                    ijcai                                                                                                            model driver reaction time correct                                                        delay imu ﬁltering data driver ve                                                        locity position vehicle’s recorded velocity po                                                        sition according ukf algorithm’s velocity                                                        position decision velocity controller consider                                                        ing data including imu ukf data points                                                        logged position                                                          parameterization learned α βgs                                                         mphs illustrated figure                                                         halves ﬁgure show training test sets                                                        respectively horizontal axis position                                                         grand challenge route miles vertical axis speed                                                        mph practical reasons rounded parameters                                                          respectively essentially identical                                                        terms vehicle performance robot used parame                                                        ters during grand challenge event evaluated                                                        extensively future sections                                                          notice reasonable match human driving                                                        penalty speeding closer match possible  figure  results coordinate descent machine learning                                                        parameterization causes vehicle drive aggres  shown learning generated race parameters                                                        sively doubt human driver uses   gs  mphs good match human driving note                                                        perceptual cues determine speed  human drives speed limit suggests  importance algorithm desert driving     notice speed limits greater                                                        safe speed human algorithm selects                                                        demonstrates importance technique blindly    supervised machine learning                      following provided speed limits notice  use supervised machine learning select α βsome human algorithm times exceed speed  argue select parameters using explicit limit allowed actual robot experi  hardware lifetime calculations matching human ments section  permit simplify  teacher autonomous vehicle hundreds scoring function learning process idea match  components analyzing effect shock each ing human driver’s speed  require great deal time costly – each  component break determine  experimental results  limit believe matching human’s speed provides  useful efﬁcient bound acceptable shock   qualitative analysis    velocity plan generated speciﬁc parameterization ﬁrst experiment evaluate algorithm sections  scored human driver’s velocity decisions offroad driving identify qualitatively partic  parameters iteratively modiﬁed according ularly easy alternatively challenging purpose  scoring function coordinate descent              experiment spotcheck performance seek       vh                                         let speed human driver position verify algorithm tuned learning does  objectivescoring function wish minimize     drive slowly easy terrain fast difﬁcult terrain                                                         select seven mile stretches  grand                                                    challenge route ﬁrst stretch includes miles                 ψ vh − vr αβ−                                                 easy terrain consisting wide dirt roads dry lakes                                                      second includes miles  terrain chal       ψ     vr ≤  vh    ψ                 ψ                 term   lenging narrow mountain road  ft drop  penalizes speeding relative human driver value  side sections graded smoothed large plow  selected arbitrarily αβ− term penalizes parameter long grand challenge event based video  izations tolerate great deal shock accelerate collected vehicle darpa mountain road  slowly                                               clearly challenging drive    experiment human driver drove  miles obviously greater potential vertical shock  previous year’s  grand challenge route vehi figure  presents results ﬁrst seven miles  cle’s state vector estimated unscented kalman fil course – easy example ﬁgure points represent  ter ukf julier uhlmann  ukf combined single shock event route vertical axis plots  measurements novatel gps omnistar differen shock vehicle experiences driving route  tial corrections gps compass imu wheel speed velocity controller horizontal axis plots shock expe  encoders gps devices produced data hz rienced driving speed limits notice things  devices ukf produced data hz data shock threshold rare  logged millisecond accurate timestamps       ﬂects particularly straightforward driving conditions                                                    ijcai                                                    figure  each point indicates speciﬁc shock event figure  each point indicates speciﬁc shock event  velocity controller vertical axis versus speed limits velocity controller vertical axis versus speed limits  horizontal axis high shock events horizontal axis high shock events  easy terrain velocity controller does reduce difﬁcult terrain velocity controller reduces shock  shock speed                                  speed great deal    second notice shock experienced speed vehicle travels road – regardless  limits events roughly expe human autonomous control – map  rienced velocity controller shock road velocity control experiments each raw imu read  linear speed velocity controller did signiﬁcantly ing logged vehicle’s velocity position  reduce speed easy terrain supports idea according ukf ofﬂine each imu reading  algorithm learned parameters does cause ﬁltered divided vehicle’s speed generates  vehicle drive slowly easy terrain figure  sequence position tagged road roughness values  type plot axis ranges figure  units gsfeltpermileperhour use sequences  plot data difﬁcult segment section evaluate velocity controller  miles  terrain poor perceptive sensing loss calculate completion time summing time spent                                                                                              traction – excessive shock – result traversing each route segment accord  tal vehicle loss velocity controller active lower ing average speed driven during segment dt  ing vehicle speed lower speed results reduced shock hz velocity controller change speed                                                                        better traction generally favorable conditions instantly each track velocities outputs –  successful navigation challenging terrain    simulations – simple controller restricts                                                        maximum change velocity succes    quantitative analysis                            sive pi’s approximating vehicle capabilities limits                                                         mph increases  mph decreases use  experimental setup                                                        controller output completion time shock calculations  having veriﬁed basic function algorithm  proceed analyze performance long stretches time vs shock desert routes  driving long stretches intractable com consider tradeoff shock versus completion time  pare algorithm performance human decisions sec desert routes figure  horizontal axis plots  tion  relative qualitatively assessed terrain condi completion time vertical axis plots shock felt  tions section  consider algorithm normalized speed limits each  metrics long stretches driving use aggregate curves represents different desert route   reduction large shocks measure algorithm effectiveness grand challenge route  grand challenge route    evaluate reduction large shocks routes outside phoenix arizona usa created  simply sum shock extreme shock rare testing purposes individual points curves depict   readings  grand challenge speed completion time versus shock tradeoff particular set  limits maximum acceptable shock α α β values curves α ﬁxed β varied  threshold aggregate effect frequent small shock asterisk each curve indicates tradeoff generated  mask algorithm’s performance rare large shock parameters selected section  ﬁfth aster  avoid problem th power “l metric” isk topleft indicates happens speed limits  shock adding sum accentuates large notice routes completion time  shocks diminishes small ones aggregate score creased   baseline                                                    ijcai                                                    
