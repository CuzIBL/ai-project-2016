                      continuous time associative bandit problems∗          andras´  gyorgy¨   levente kocsis    ivett szabo´  csaba szepesvari´                  automation research institute hungarian academy                              sciences machine learning research group                 gyaszitbmehu kocsissztakihu ivettgmailhu szcsabasztakihu               budapest university technology economics department stochastics                         university alberta department computing science                        abstract                          continuous values time instants decisions      paper consider extension multi place continuous values supercom      armed bandit problem generalized setting puter ﬁxed cost running whilst centre’s income      decision maker receives side information based quality solutions delivered given      performs action chosen ﬁnite set time single task executed supercomputer      receives reward unlike standard bandit  admittedly assumption looks absurd ﬁrst sight      settings performing action takes random pe context example think results      riod time environment assumed sta extended general case number      tionary stochastic memoryless goal algorithms run simultaneously bounded      maximize average reward received unit  stant trouble decided stick      time maximize average rate return simplifying assumption      consider online learning problem      allocation rule decides based side information      decision maker initially does know available task just received algorithm use      environment learn  processing goal maximize return rate      trial error propose “upper conﬁdence   note criterion different maximizing total      bound”style algorithm exploits structure reward fact processing task takes time dur      problem show regret al ing tasks processed rate maximiza      gorithm relative optimal algorithm tion problem solved selecting algorithm      perfect knowledge problem grows  highest expected payoff tasks look difﬁcult      optimal logarithmic rate number decisions solve best thing drop      scales polynomially parameters sults payoff exchange learner does suffer      problem                                          loss processing possibly rewarding                                                        tasks note possible pres                                                        ence side information case problem    introduction                                       simplify usual multiarmed bandit problem  multiarmed bandit problems ﬁnd applications various needs ﬁnd best option highest reward rate  ﬁelds statistics control learning theory eco example illustrates learner aim quickly learn  nomics popular seminal paper good allocation strategy rate maximization solve  robbins  enjoy perpetual popular problems simultaneously predicting longterm val  ity                                                  ues available algorithms given information    version bandit problem consider mo task processed balancing exploration ex  tivated following example imagine sequence ploitation loss selecting inferior options  tasks arrive processing center regret kept minimum problem  single supercomputer each tasks number sider thought minimalistic example  alternative algorithms applied information learner faces problems simultaneously  tasks available used predict bandit problems continuous time studied ear  algorithms try processing time depends lier number authors kaspi mandel  task hand algorithm selected baum  karoui karatzas  references    ∗this research supported ministry econ earlier results concern construction op  omy transport hungary grant gvop timal allocation policies typically form gittins   hungarian national science foundation grant dexes given parametric form distributions  j´anos bolyai research scholarship random variables involved contrast consider  hungarian academy sciences                        agnostic case particular parametric form assumed                                                    ijcai                                                     environment supposed stationary stochas  tic agnostic nonparametric case studied             δixe  δix  extensively discrete time case fact problem denote expected reward delay respectively op  ﬁrst considered robbins  introduced tion chosen presence sideinformation  certaintyequivalence rule forcing article exact protocol decision making follows  robbins showed rule asymptotically consistent cision making happens discrete trials let τ  sense frequency time instants best let τt denote time beginning tth trial  arm selected converges surely recently beginning tth trial decision maker receives               agrawal   suggested number simple samplemean side information xt based value xt infor  based policies showed resulting policies’ regret mation received decision maker prior trials  decisions olog known al cision maker select option executing  location rule achieve regret lower cp log                                                        decision maker receives reward rt  rittxt suf  appropriate problem dependent constant cp lai rob                                                        fers delay δt  δittxt time point  bins  agrawals’ policies unimprovable apart available decision maker select option  constant factors lately auer et al  strengthened                                                        τt  τt  δittxt  results suggesting policies achieve logarithmic goal decision maker ﬁnd good allocation  regret uniformly time just asymptotically policy formally allocation policy maps possible histories  added beneﬁt policies simple index set gain average reward rate  implement                                            delivered allocation policy given    base algorithm algorithm ucb auer et                                                                                                                   al  agrawal  assume stationary                   t rt                                                                       λ   lim sup         memoryless stochastic environment side informa                n→∞    δt   tion iid process taking values ﬁnite set payoff                                                                                        delay sequences jointly distributed options rt reward sequence δt delay se  distribution depends side information quence experienced policy used optimal allo  precise assumptions listed section like cation policy maximizes gain note  ucb algorithm decides option choose based problem stated special case semimarkov decision  samplemeans corrected upper conﬁdence bounds problems puterman  theory semimarkov  case separate statistics kept option  cision problems furnishes necessary tools char  sideinformation pairs main result shows result acterize optimal allocation policies let deﬁne optimal                                                        gain  ing policy achieves logarithmic regret uniformly time               ∗                                                                                  λ  supλ    unimprovable apart constant factors                        paper organized follows deﬁne problem                                      ∗      proposed algorithm section  main result policy said optimal satisﬁes λ  λ  logarithmic regret bound algorithm’s performance follows generic theory exist determinis  presented section  conclusions drawn section  tic stationary policies optimal optimal action                                                        ∈xcan determined ordering options                                                        relative valuestherelative value option ob    algorithm                                      serving expected reward collected minus  problem previous section formalized fol expected reward gained during time takes  lows let denote number options available let collect reward  denote set possible values side information          ∗                  ∗                                                                       qi xrix − δixλ   assumed ﬁnite let xxxt bearan  dom sequence covariates representing side information intuitively clear policy selects  available time tth decision generated indepen options best relative values optimize  dently distribution supported  each deci gain fact follows theory semimarkov  sion point decision maker select option decision problems case stationary                    receives reward rt  rit txtwhere deterministic policy  x→ais optimal  ritxt reward decision maker received obeys constraints  chosen option unlike classical bandit problems              ∗                    ∗                                                             ruxx − δuxxλ maxrix − δixλ    collection reward takes random time op                        i∈a  tion selected side information equals time                                                        simultaneously ∈x  δitx assume ﬁxed ritxδitx                                                          total regret allocation policy deﬁned  iid sequence independent xt                                                        loss suffered selecting optimal option each  sume ritx ∈ rminrmax δitx ∈ δminδmax                                                        time step interested expected regret  δmin   expect boundedness assumptions                                                        regret deﬁnition uses optimal gain λ∗  relaxed δitx ≥  appropriate moment conditions                                                                                      δitx ritx let                                                                                                                                       ∗                                                                       rn  λ     δt −    rt                                             rix   rix                                                                                                  ijcai                                                     value ﬁrst term maximum reward cts appropriate deterministic sequence se                                                                                                         collected during time ﬁrst decisions ex lected simultaneously policies ∈u λt  pected regret compares expected value                                                                        cttutvicinity λ high probability se  expected value actual total payoffs received quence explicitly constructed during proof  follows allocation policy minimizes regret make sure depends known quantities  optimize rate return                     words λn optimal gain decision maker                          δitxand    single element problem guarantee high probability given data seen  reduces classical stochastic bandit problem far  stochastic bandit problems regret lower bounded                         ucb                                                          proposed allocation policy ut  selects op          seeking policies regret grows     ucb  olog                                              tions  ut xt rule  logarithmic rate                                                                                                                                         ucb                    −    idea underlying algorithm develop upper  ut    argmax  ritx δitxλt ˆcttixt                         ∗                                              i∈a  estimates values qi appropriate conﬁdence  bounds just like auer et al  upper conﬁ similarly cts cˆts appropriate deterministic  dence estimates selected ensure given sequence chosen later  px   options ultimately selected inﬁnitely  time suboptimal options selected mainresult  increasingly rarely                                  main result following bound expected regret    algorithm follows let consider tth deci theorem  let assumptions previous section hold                                   ∗                                                                   ucb  sion good estimate λt λ  given ritδitxtletrn nstep regret policy   base decision estimates relative      ≥         ∗                                                                                 −                                          values qi options given δ xλ                         ritx denotes average rewards during ﬁrst deci     ∗          π                                                        rn ≤                   kx  kx  logn  sions time points side information              option selected δitx deﬁned analogously                                                                                                                                                         t                                                      logn                                                                                                                                                                                        Δix       ritx                 xs  rs                     iΔi x∈x                                                                     ∗        ∗                                                          δmaxλ −  rmin                                                                                                  ∗       ∗                                                           Δixmaxqj   − qi ≥ ik       δitx                xs  δs                 j∈a                  tix                                                        positive constant given  proof  tix denotes number times option theorem  selected side information present trials proof follows similar lines theorem  auer           t                                et al  main difference                                                                                     ∗             tix    xt             handle estimation error λ  prove theorem                                                    using series propositions                                                          ﬁrst proposition bounds expected regret terms    plan combine appropriate upper bounds rix number times suboptimal option chosen  lower bounds δix based respective sample                                                        proposition  following bound holds expected  averages ritx δitx tix obtain upper es           ∗                                            regret arbitrary policy uu  timate qi order sample based                                                                                                                              estimate need appropriate lower estimate λ∗                                                                                  ≤          ∗             ∈u∗  estimate deﬁned follows                       rn      pxl       utx          let denote set stationary policies  uu        x∈x                                              x→apickanyu        ∈uletλt    denote empirical                                                                   ∗             ∗           ∗  estimate gain policy                               xi ∈aqi  xmaxqj                      t                                                                  j∈a                     uxs rs              λt   t                                  denotes set optimal options                          uxs δs                           ∗                ∗                                                                xmaxδjxλ    − rj                                                                              let tut denote number times option                                                        loss worst choice xfurtherbyl∗x ≤ l∗  ‘compatible’ policy selected                                                                                   t                                                        n                                                               ≤    ∗                  ∈u∗               tut      uxs                  rn          px       utx                                                                       x∈x                                                  ∗                                                     n  λt estimate λ deﬁned                             ∗              ∈u∗                                                                              utx    xxt                  λt maxλt  − ctt                               x∈x                        u∈u                                                            ijcai                                                                                                 ∗  proof   let consider tth term δtλ − rt proposition  assume following conditions sat                                          ∗  of expected regret   δtλ − rt      isﬁed             ∗                                                                      i∈a δtλ − rti   using  utxt                                                                                  λ    ≥  λt − ctt             ut depends past ft sigma algebra                                                                                             ∗       ∗                       ft−                                      ≤  δ δ    measurable                  λ       λt  cttu∗                                                                  ﬁrst condition meant hold stationary          ∗                                                      ∈u    δtλ − rti                             policies                   ∗ −                                              ∗ ≥   ≥   ∗ −          δitxtλ  ritxt                            λ    λt   λ   cttu∗                              ∗                                                                                δitxtλ − ritxti  ft−xt                                       −                                                        proof  let policy maximizes λt cttut                               ∗                                                                      δitxtλ − ritxtft−xt                                                                         holds  λt  λt − ctt  ≤                             ∗                                                                               δixtλ − rixtft−xt   u    ∗                                                        λ   ≤ λ  proving upper bound λt hand                           ∗                                                         ∗         iδixtλ − rixt                                       ≥    −                                                        choice  λt λt cttu∗t                                                                               ∗ −  using ut does depend xtweget  lower bounded λ cttu∗t using  proving                                                                                                                    ∗                                             lower bound λt     δtλ − rt                                                         following proposition shows λt lower                                   ∗                              ∗             utxtiδixtλ − rixt        bound λ high probability           i∈a                                                      proposition  let                         ∗                                                            −        pxqi xe utxi xt                                              i∈a x∈x                                                         logt                                                                    cts                          ∗                                                                    −        pxqi xe utxi              i∈a x∈x                                                                                                                                                                                                                                                    rmax − rmin  rmaxδmax − δmin                                                     max                                                                                                            δmin            δmin     ∗ −       −                ∗     δtλ   rt         px      qi  utxi                      x∈x     i∈u ∗x                                                                                                                            ∗ −             ∗      ≤                                    ∗                              λt λ    cttu∗  λ   λt                      −     px      qi xe utxi                                                              x∈x     i∈u ∗x                    proof according proposition   holds station                                                                                      ∗        ∗                                                                                       ≥   ≥   −  tt ∗                                   ∗                    ary policies  holds λ λ λ     let wtixe utxi ∈ux wtix                     ∗                   ∗                                                        order λt λ − ctt ∗ λt λ hold                                                                                 let μti x wti j∈a wtj xthen conditions proposition  vio        ≥                        ≤  μti  wti j∈a wtj   ﬁrst term lated using union bound                                                                                        expression upper bounded                 ∗                 ∗                                                         λt λ  − ctt ∗  λ  λt                                                                                                                                 ∗                                                             ∗            vt  −     px   qi xμtix              ≤            −             ∗                                                                   λ   λt   cttut    λ   λt  cttut                    x∈x                                         μtixif optimal μt deﬁnes optimal fix law total probability  stochastic policy bellman’s equation gives                                                                                                                                                                                          −                    −                                              λ   λt  cttut       λ   λt  ctstuts                                                                                    ∗                            ∗  δtλ − rt ≤−       px       xe utxi                                                      deﬁne                    x∈x     i∈u ∗x                                                               t                                                   ∗                                                                     ≤      pxl       utxi    rˆt         uxs rsr       pxruxx                  x∈x           i∈u ∗x                                              x∈x                                                                                           ∗                ∗                                                                  pxl xe utx ∈u                                                                                        δˆt        uxs δsδ      pxδuxx                  x∈x                                                                                       x∈x  summing expression gives advertised using elementary algebra                                                                                   bound                                                                                                                   λ   λt − ctstuts    statements used prove high prob                                                 ∗                              ≤   ctsδmin ≤ rˆ − tuts  ability λt good estimate λ  follows                                                                                        ∗   ∗                                         ∗                               ≤   − ˆu  denotes arbitrary ﬁxed optimal policy λt  λt          ctsδminrmax   δ   δt tuts                                                     ijcai                                                                         exploiting rˆt δˆt martingale sequences expectations second terms bounded                                                                                                         sorting slight variant hoeffdingazuma bound proposition  ﬁrst term multiplied zts   devroye et al  bound  bounded    −                                                             summing and analogous argument                         ∗              ∗                                                         −                         ∗                                             zts  rit−x δit−xλ ˆct−s    λ  λt  cttut  desired bound                                                                                                                            ∗        ∗       ∗                                                                        − δ  xλ − ctsˆct−s     ready prove main theorem                  t−      t−  proof superscript ‘∗’ quantity refers                   ∗               ∗                    expression equals fol  optimal policy  example rt xru∗xtx lowing events hold   ∗                 ∗  δt xδu∗xtx ttu∗xx tetc                                                        atss                                            ucb  proof theorem  proposition  applied shows    ∗       ∗     ∗   ∗     ∗    ∗              sufﬁces ﬁxed ∈xand suboptimal choice rt−x−δt−xλ ≤r x−δ xλ −ct−szts        ∗  ∈ux  derive olog upper bound ex  tss                                                 ucb          pected number times choice selected                  ∗             ∗                                                                            −          ≥     −                         side information need show rit−x δit−xλ rix δixλ ˆct−s zts                                                                     ∗       ∗    ∗               ∗                                                           tss      −             −          ts                                                                δ xλ rx    δ xλ ˆc                                                                              ∗                 ucb                                                     −            ut   xi xt   ≤  olog     ct−s ˆct−s δt ct−s let choices                                                    conﬁdence intervals deﬁne                                                                                                                                                                       let qitxritx − δitxλt using deﬁnition             uts   log       ucb      ucb  ut   ifut   xi    holds qitxˆcttixt    ∗                                                                                               √  qt xˆctt ∗xt integer  deﬁned cts proposition  cts  cuts                                                        deﬁned deﬁne cˆts implicitly  n                                                                               ucb                                            through deﬁnition cts deﬁned      ut  xi   ≤                                                        probability atss small let                                                                                                                                                                                ucb                                          maxrmax  − rmin rmaxδmax − δminδmin          ut   xi tix −  ≥ xxt                                                                                                                                                                                                                cts  auts  δmaxcdeﬁne               n                                      ≤               ucb             −    ≥                                                      ut   xi tix                                                                                                               cˆts auts using deﬁnitions bound  write tth term sum follows    probabilities three events start atss                                      ucb                                                                     ∗      ∗                              −   ≥                               tss ≤     ≤      −           ut   xi tix                                   cts  rt xz                                                                                      ∗                                ∗                                         ∗ ≤       −  ∗               qit−xˆctt xt− qt−xˆct−t ∗xt−           ctsλ   δt δ xzts                                                                                                                                                                                                                                                      ≤ exp  −cts srmax − rmin                     tix −  ≥                                                                                                                                            ∗                                                                                 −              max −  min                               ∗                                 exp    cts sλ  δ    δ                it−     t−s          t−s                xˆc     qt−xˆc                                  t    ss∈ht                                               used        xt  rt                                                        t                                                           xt  δt martingales                                                  abovementioned variant hoeffdingazuma                                                                                                                                                  inequality plugging deﬁnition cts     hts     ≤ ≤ − ≤ ≤ −                                         −        −                                                        probability event atss bounded                      −         ∗    −  zts     tix           probability btss bounded way                                                                                                                                                 expression cˆts cts  fix ∈ ht using deﬁnition qitx                                                          n                            ∗   qit−xˆct−s qt−xˆct−s                                atss btss                                                                      ss∈ht     ≤  rit−x − δit−xλt− ˆct−s                                                                  n                                                                                                                           π                    ∗        ∗                                ≤                           ≤                             rt−x − δt−xλt− ˆct−s                                                                                                          ss∈ht                   ∗           ∗             ≥  t− ≥    −                                                                          λ    λ      λ    ct−tu∗ t−                                                                                                                     deﬁne xa logt Δix                     ∗                     ∗                   −                                                                                            λt− λ    ct−tu∗ t−  λ   λt−     ctss holds Δix  ˆcts                                                     ijcai                                                     
