        approximating gametheoretic optimal strategies fullscale poker           billings burch davidson holte schaeffer schauenberg szafron                               department computing science university alberta                                          edmonton alberta tg canada                    email darseburchdavidsonholtejonathanterenceduanecsualbertaca                               abstract                                 computational limitations involved simpli•                                                                 fied poker variations solved past kuhn        computation complete approxima•           sakaguchi sakai  the•       tions gametheoretic optimal strategies      oretical methods feasible real        scale poker addressed abstraction tech•       games large orders magnitude        niques combined represent game            roller pfeffer        player texas holdem having size using            shi littman  investigated abstraction tech•       closely related models each having size           niques reduce large search space complexity        despite reduction size factor           problem using simplified variant poker takusagawa        billion resulting models retain key prop•         created nearoptimal strategies play three        erties structure real game linear pro•                                                                 specific holdem flops betting sequences selby         gramming solutions abstracted game used                                                                  computed optimal solution abbreviated game        create substantially improved pokerplaying pro•                                                                 pre flop hold em        grams able defeat strong human players                                                                    using new abstraction techniques produced vi•       competitive worldclass opponents                                                                  able pseudooptimal strategies game player                                                                  texas holdem resulting pokerplaying programs    introduction                                                 demonstrated tremendous improvement performance   mathematical game theory introduced john von neu•       previous best poker programs easily beaten   mann founda•     competent human player new programs capa•  tions modern economics von neumann morgenstern        ble defeating strong players hold    von neumann used game poker basic           worldclass opposition   model player zerosum adversarial games proved        domainspecific knowledge asset   fundamental result famous minimax theorem    creating accurate reducedscale models analogous methods   years later john nash added results ivplayer non    developed imperfect information do•  cooperative games later won nobel prize      mains generalized game trees general   nash  decision problems modeled using      method problem reformulation permits indepen•  game theory employed wide variety     dent solution subtrees estimating conditional prob•  domains recent years                                       abilities needed input each computation     particular existence optimal solutions  paper makes following contributions     nash equilibria optimal solution provides random•        abstraction techniques reduce     ized mixed strategy basically recipe play each      poker search space manageable   possible situation using strategy ensures agent       losing important properties game   obtain gametheoretic value game re•                                                                    pokerplaying program major improvement   gardless opponents strategy unfortunately finding                                                                       previous efforts capable competing   exact optimal solutions limited relatively small problem                                                                       worldclass opposition   sizes practical real domains     paper explores use highly abstracted mathemat•    game theory   ical models capture essential properties   real domain exact solution smaller prob•  game theory encompasses forms competition   lem provides useful approximation optimal strategy     agents unlike chess checkers poker   real domain application domain used game   game imperfect information chance outcomes   poker specifically texas holdem popular form    represented imperfect information game tree hav•  casino poker poker variant used determine    ing chance nodes decision nodes grouped   world champion annual world series poker            information sets       multiagent systems                                                                                                        nodes tree independent divide  andconquer methods computing subtrees   alphabeta algorithm applicable detailed   description imperfect information game tree structure   koller megiddo       strategy set riles choosing action ev•  ery decision node tree general ran•  texas   domized mixed strategy probability distribution     holdem   various alternatives player use pol•     icy nodes information set   players perspective indistinguishable each   differing hidden information component      conventional method solving problem   convert descriptive representation extensive form   linear equations solved lin•  ear programming lp simplex algorithm   optimal solutions computed simultaneously   players ensuring best worstcase outcome each player  figure  branching factors holdem abstractions      traditionally conversion normal form accom•  panied exponential blowup size prob•       abstractions   lem meaning small problem instances   solved practice roller et ai  described alter• texas holdem easily identifiable structure alternat•  nate lp representation called sequence form exploits   ing chance nodes betting rounds distinct   common property perfect recall players     stages highlevel view imperfect information game   know preceding history game obtain    tree shown figure    equations unknowns linear size     holdem reformulated produce similar   game tree exponential reduction representation    smaller games objective reduce scale   reopened possibility using gametheoretic analy•   problem severely altering fundamental structure   sis domains game tree      game resulting optimal strategies   large lp solution method limited  ways doing varying overall reduction   moderate problem sizes normally billion nodes   accuracy resulting approximation                                                                    accurate abstractions include suit equiv•                                                                alence isomorphisms offering reduction factor    texas holctem                                                  rank equivalence certain conditions   game hand texas holdem consists stages    rank nearequivalence optimal solutions ab•  each followed round betting                          stracted problems exactly     preflop each player dealt private cards face   small bounded error refer nearoptimal so•  hole cards                                             lutions unfortunately abstractions produce ex•    flop three community cards shared players     act nearexact reformulation produce large   dealt face                                                reductions required make fullscale poker tractable     tirn single community card dealt face               common method controlling game size deck                                                                 reduction using standard card deck greatly     river final community card dealt face                                                                 reduces branching factor chance nodes methods     betting active players reveal hole cards                                                                 include reducing number cards players hand   showdown player best fivecard poker                                                                 card hand card hand reducing num•  hand formed private cards public                                                                 ber board cards card flop ishi   cards wins money wagered ties possible                                                                 littman  game rhode island holdem     game starts forced bets blinds                                                                 koller pfeffer  used parameters generate   pot players turn act ei• wide variety tractable games solve gala sys•  ther betraise increase investment pot checkcall tem   match opponent bet raised fold quit                                                                    used number small intermediate sized   surrender money contributed pot                  games ranging cards suits ranks      bestknown noncommercial texas holdem program         cards three suits ranks purpose studying   poki playing online  earned abstraction methods comparing results known exact   impressive winning record albeit generally weak   nearoptimal solutions smaller games   opposition billings et aly  systems abilities    suitable use approximation texas holdem   based enumeration simulation techniques expert    underlying structures games different   knowledge opponent modeling programs weak•         produce good playing strategies fullscale poker look   nesses easily exploited strong players especially  abstractions real game alter basic   player game                                                                                                    multiagent systems structure                                                       effect truncation lessened through use      abstraction techniques used practice powerful    expected value leaf nodes instead ending game   terms reducing problem size subsume       abruptly awarding pot strongest hand   previously mentioned        moment compute average conclusion possible   cruder solutions pseudooptimal emphasize   chance outcomes round model ending turn   guarantee resulting approximations   rollout  possible river cards assuming   accurate reasonable lowrisk    betting alternately assuming bet player   propositions require empirical testing de• round each player awarded fraction pot cor•  termine merit                                    responding probability winning hand                                                                  round preflop model rollout  card combinations    betting round reduction                                    turn river   standard rules limit holdem allow maximum       extreme form truncation results  round   bets player roundl player limit poker  model foresight future betting rounds each    possible betting sequences   future round provides refinement approximation   occur practice remaining  sequences  end  reflect correct strategy real game par•  fold leading terminal node game tree  end  ticular betting plans extend round   carrying forward chance node using    deferring raise strong hand lost                                                                  entirely simplistic models   capital letters second player tree possible useful combined expected value leaf nodes   betting sequences each round                                                                    alex selby computed optimal solution game                                                                  preflop holdem consists betting round                                                                  followed ev rollout board cards deter•     local collection decision nodes betting   winner selby  se•  tree represent diagramatically triangle        rious limitations strategy based round model      betting round reduction each player allowed      incorporated selby preflop   maximum three bets round eliminating  programs psoptil described later section   sequences each line effective branching factor    contrast truncating rounds bypass certain   betting tree reduced seven does  early stages game frequently use postflop mod•  appear substantial effect play expected els ignore preflop betting round use single   value ev each player observation verified fixed flop three cards sec figure    experimentally contrast computed corresponding       natural consider idea independent betting   postflop models maximum bets player      rounds each phase game treated isolation   round radical changes optimal strategies    unfortunately betting history previous rounds   strongly suggesting level abstraction safe contain contextual information critical                                                                  making appropriate decisions probability distribution    elimination betting rounds                              hands each player strongly dependent   large reductions size poker game tree ob•   path led decision point ignored   tained elimination betting rounds     risking considerable loss information   ways generally significant impact  naive independence assumption viable certain   nature game game truncated   circumstances implicitly use design   eliminating round rounds holdem ignor•    psoptil bridge gap round preflop model   ing board card final betting round produces round postflop model   round model actual round game solution        possible abstraction explored merging   round model loses subtlety involved   rounds single round creating com•  true optimal strategy degradation applies primarily bined card turnriver clear ap•  advanced tactics turn smaller effect propriate bet size composite round   flop strategy strategy betting round case solutions models range possi•  significant changes incorporates out• ble bet sizes turned substantially different   comes future betting rounds use particular     round counterparts method re•  abstraction define appropriate strategy play  jected   round preflop model figure         rules allow unlimited raises players arc  composition preflop postflop models   involved occasions three legitimate raises   relatively rare greatly alter optimal strategy      technically player fold outstand• nodes imperfect information game tree   ing bet logically dominated folding independent general decomposition possible   does occur optimal strategy seen example subtrees resulting different preflop   practice                                                      betting sequences longer nodes belong       multiagent systems                                                                                                      information set subtrees postflop models    computed isolation provided appropriate    preflop                                          psoptil    preconditions given input unfortunately knowing    correct conditional probabilities normally entail solv•   ing game advantage       flop    decomposition                                                  turn                                              bet      simple postflop models dispense prior       river    probabilities postflop models used psoptio    psoptil simply ignore implications preflop    betting actions assume uniform distribution    possible hands each player different postflop solutions    computed initial pot sizes    bets corresponding preflop sequences zero    three raises ignoring player initially each    raise psoptil postflop solutions simply ap•   pended selby preflop strategy figure     simplifying assumptions technically wrong re•   sulting play surprisingly effective                       figure  composition psoptil psoptil      better way compose postflop models estimate    conditional probabilities using solution preflop                                                                   equivalence classes each player sufficient    model tractable preflop model means                                                                  each betting round mixed strategy    estimating appropriate strategy root de•                                                                 indicated optimal play cases like    termine consequent probability distributions                                                                  group hands similar probability distribution      psoptil round preflop model designed                                                                  action plans    solved resulting pseudooptimal strategy pre•   flop significantly different selby strat•   obvious crude bucketing function group    egy used determine corresponding distribution  hands according strength rank respect    hands each player each context provided nec• possible hands probability currently    essary input parameters each seven preflop betting lead improved considering rollout    sequences carry flop stage each    future cards giving unweighted estimate chance    postflop models given approximation    winning hand    perfect recall knowledge game fully   onedimensional view hand   compatible each properly integrated un•    types considered ivdimensional   der umbrella preflop model figure  theory   space strategies vast number different ways   equivalent computing larger tree   classify superior practical method   limited accuracy appropriateness   project set hands twodimensional space con•  proposed preflop betting model                                sisting rollout hand strength hand potential sim•                                                                 ilar hand assessment used poki billings et al    abstraction bucketing                                    clusters resulting scattergram suggest reason•  important method abstraction computa•      able groups hands treated similarly   tion pseudooptimal strategies called bucketing  eventually settled simple compromise   extension natural intuitive concept  available buckets allocate   rollout hand strength   applied times previous research sklansky   number hand types each class uniform   malmuth  takusagawa  ishi littman        classes strongest hands smaller    set possible hands partitioned equiv• mediocre weak hands allowing better discrimination   alence classes called buckets bins manytoone    smaller fractions hands raised re•  mapping function determines hands grouped        raised   ideally hands grouped according      special bucket designated hands low   strategic similarity meaning played strength high potential good draws flush   similar manner loss ev                        straight plays important role identifying good      hand played particular pure strategy    hands use bluffing known semibluffs sklansky   available choices perfect mapping malmuth  comparing postflop solutions use   function group hands follow plan  strength buckets solutions strength plus                                                                  highpotential bucket bluffs       each decision node tree labeled                                                                 taken special bucket played   cards known player path led   node nodes identical labels differ hidden informa• way strongest bucket confirmed   tion information set betting expectations highpotential bucket improve   history different subtrees nodes inter• selection hands various betting tactics increase   dependent                                                     overall ev                                                                                                    multiagent systems      original                                                   experiments       bucketing                                                                   testing players          transition                                                series matches programs con•      probabilities                                              ducted results shown table  win rates mea•                                                                 sured small bets hand sbh each match run       round                                                  games  games cases                                                                  variance game depends greatly styles        bucketing                                                                  players involved typically   sb standard                                                                  deviation each match outcome shown nor•    figure  transition probabilities buckets player mally   sbh                                                                    bot players                                                                    psoptil composed handcrafted round preflop      number buckets used conjunction  model providing conditional probability distributions each   round model small typically seven each seven round postflop models figure  models   player   pairs bucket assignments obviously   prototype used buckets player round   results coarsegrained abstract game  psoptil composed round postflop models un•  substantially different number distinctions der naive uniform distribution assumption  buck•  average human player make regardless      ets player round selbys optimal solution fox preflop   best currently given computational constraints   holdem used play preflop selby    approach                                                psoptio composed single round postflop model                                                                  wrongly assuming uniform distributions initial pot size      final thing needed sever abstract game  bets seven buckets player round   underlying real game tree transition probabilities program used alwayscall policy preflop betting   chance node flop turn represents particular  round   card dealt remaining stock  cards    poki university alberta poker program older   abstract game cards buckets effect version poki designed play player game   turn card abstract game dictate probability                                                                  defeated easily useful benchmark   moving pair buckets flop pair                                                                    antipoki rulebased program designed beat poki   buckets turn collection chance nodes                                                                  exploiting weaknesses vulnerabilities player   game tree represented tran•                                                                 game specific counterstrategy vul•  sition network shown figure  postflop models                                                                  nerable adaptive players   estimated walking entire tree enumerating                                                                    aadapti relatively simple adaptive player capable   transitions small number characteristic flops                                                                  slowly learning exploiting persistent patterns play   preflop models enumeration expensive en•  compassing  choose    possible flops      weak benchmark strategy   estimated sampling parallel enumeration    raise weak benchmark strategy   truncated tree                                              important understand gametheoretic optimal                                                                  player principle designed win purpose      round postflop model comfortably solve      lose implicit assumption opponent   abstract games seven buckets each player     playing optimally gained observing   each round changing distribution buckets  opponent patterns weaknesses   flop seven turn river does  simple game like roshambo known rock  appear significantly affect quality solutions paperscissors playing optimal strategy ensures break•  better worse                                               result regardless opponent does      final linear programming solution produces large ta•  insufficient defeat weak opponents win   ble mixed strategies probabilities fold raise tournament billings  poker complex   reachable scenario abstract game use theory optimal player win oppo•  pokerplaying program looks corresponding situa•   nent makes dominated errors time player makes   tion based hand strength potential measures   choice randomized mixed strategy   randomly selects action mixed strategy        gametheoretic optimal policy decision dominated                                                                  words possible play highly suboptimal      large lp computations typically day    manner break optimal player be•  using cplex barrier method use       cause choices strictly dominated   gigabytes ram larger problems exceed available          pseudooptimal strategies opponent model•  memory common large lp systems certain          ing guarantee especially effective   lp techniques constraint generation potentially  bad highly predictable players rely   extend range solvable instances considerably  fundamental strategic errors margin   probably allow use additional     victory relatively modest result   buckets player       multiagent systems                                                                                                     
