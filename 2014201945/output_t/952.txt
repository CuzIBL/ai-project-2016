       bayesian tensor inference sketchbased facial photo hallucination                              wei liu†       xiaoou tang†‡       jianzhuang liu†           †dept information engineering chinese university hong kong hong kong                    ‡visual computing group microsoft research asia beijing china                        wliu jzliuiecuhkeduhk xitangmicrosoftcom                        abstract                                              groundtruth                                                                          photosketch pair      paper develops statistical inference ap      proach bayesian tensor inference style trans      formation photo images sketch im      ages human faces motivated rationale      image appearance determined      operative factors image content image style      ﬁrst model interaction fac      tors through learning patchbased tensor model      second introducing common variation space      capture inherent connection photo     sketching                          hallucinating      patch space sketch patch space building      bidirectional mappinginferring      spaces subsequently formulate bayesian ap      proach accounting statistical inference      sketches corresponding photos terms      learned tensor model comparative ex      periments conducted contrast proposed      method stateoftheart algorithms facial      sketch synthesis novel face hallucination sce      nario sketchbased facial photo hallucination                   encouraging results obtained convincingly validate figure  bidirectional transforms photosketch pairs      effectiveness method                  forward transform synthesizing sketch image photo                                                        image backward transform hallucinating photorealistic    introduction                                       image sketch image  recently machine learning popu  lar applied vision community various ap particular image class human faces trans  plications methods learn lowlevel vision form photorealistic faces associative  proposed classical literature freeman et al sketch drawings shown promising applications fu  paper focus fascinating vision topic automatic ture recent years works ad  image sketching automatically generates alike sketch dress issues synthesizing sketches photos chen  images photo images sketches simplest form et al  tang wang  liu et al  drawings consist drawing lines sketchbased face recognition tang wang   artists distill identifying characteristics photo liu et al best knowledge  highlight small number critical strokes difﬁcult issue  backward transform sketches    implementing great idea learning vision success photos  seriously addressed paper  ful image sketching techniques try observe learn develop novel research topic hallucinating photorealis  artist’s works generate vivid expressive tic faces sketches termed sketchbased fa  sketches result examplebased methods widely cial photo hallucination design new face hallucination  studied latest years given set training images technique fulﬁll intractable backward transform  associated sketches drawn artists consider forward backward transforms  generate sketch image automatically input image order explore inherent relation bidirec  help machine learning techniques         tional transforms shown fig                                                     ijcai                                                      considering complexity image spaces higherorder tensor follows  spicuous distinction photos sketches global lin                                                                 c×  × ×  ear models tang wang  liu et al  tend oversimplify problem try ex      c× upatches × ustyles × ufeatures   tract local relations explicitly establishing connec known core tensor governs interaction  tion feature spaces formed patchbased mode matrices ···  moden matrix  sor model hold statistical dependencies pair contains orthonormal vectors spanning column space  wise patches styles precisely ﬂexibly matrix dn resulting moden ﬂattening unfolding  present bayesian tensor inference approach incorpo deﬁning tensor  c× ufeatures tensorpatches  rates advantages multilinear analysis techniques based  tensor bayesian statistics                                                                      t×         ×           rest paper organized follows section             patches   styles          elicit tensor model facial image ensemble far succeed decomposing twomodal patch  tailed rationale algorithm bayesian tensor inference feature space common variation space spanned                                                                    m×m  presented section  experimental results shown upatches ∈ special variation space spanned                                                                     ×  section  conclusions drawn section      ustyles ∈                                                             patch photo sketchstyle cor    tensor model                                       responding tensor representation                                                                                    recently multilinear algebra tensor modeling         t×    × sk             tracted considerable attention vision   graphics communities research efforts apply   contains patch parameters encoding common                                                        characteristics pairwise patches sk capturing style pa  ing tensor cover broad range topics including face                                                                                              rameters reﬂecting special properties style  denotes  modeling synthesis vasilescu terzopoulos                                                                                          photostyle  denotes sketchstyle th row vector  wang ahuja  vlasic et al   superresolution     wt                                                                          styleswhen   th row vector patches  liu et al                                                                         motivated previous multilinear approaches make sor representation th training patch th style                                                        obtained vector representation derived mode  use novel tensor model exclusively account                                   representation images styles photostyle   ﬂattening subtensor thatis                                                             new patch pair represents photostyle  sketchstyle small image patches account high  level statistics involved images patches denotes sketchstyle tensor representations  stitutive elements tensor model based corpus learned line eq                                                                                                containing image patches photo sketchstyles       pxt×      ×  ×  arrange patches highorder tensor       t×   wt  ×  st    ×  wt   sufﬁce encode latent connection styles                                                                                                                                                                                    t×   t×  constant    tensorpatches                                    tensors mode ﬂattening eq  results  based observation styles photo                                                                                               fa   axw  sketchstyles share common characteristics each                          style possesses special traits assume existence           fa   ayw             decomposition patch feature space com ∈d×m         ∈d×m  mon variation space reﬂects commonalities shared ax   ay         called inferring matrices                                                        shared parameter vector expected solved exists  styles special variation space relying                                                        common variation space solve through mapping  rationale employ multilinear algebra perform  sor decomposition large patch ensemble carrying pairwise patches common variation space follows  modalities                                                                  bxx    let divide training pairwise images overlapping                    byy                    small square patches assumed                                                                         −                 −   size pairs patches spatial neighborhood located bx ax ax ax ay ay ay  images collected form highorder tensor follow called mapping matrices fig  illustrates relations  ing nonparametric sampling scheme chen et al   allow smaller length each patch fea unknown inferring counterpart  ture vector resulting conﬂuence three modes style known style patch objective image  related patch examples patch styles patch features sketching hallucination combining eq  eq   order tensor d∈m××d   built grouping pairwise coarse estimation derived  patches pertaining neighborhood                                                                            ≈ aybxx                      paper adopts highorder svd lathauwer et al   nmode svd  vasilescu terzopoulos   details tensor decomposition lathauwer et  generalizations svd decompose al  vasilescu terzopoulos  elaborate                                                    ijcai                                                                                                          d×d tensorpatches obtained forming prod                   photo patch space                                                        uct c× ufeatures                                                          signiﬁcantly factors people position cru        bx mapping                   ax inferring     cial determine concrete patch encoded row vec                                                        tor spaces mode matrices upeople upositionsto                        common                          remove factor people position redundancies suppress                        variation                       effects noise truncation mode matrices                         space                          needed paper adopt nmode orthogonal                                                        iteration algorithm vasilescu terzopoulos         mapping                   ay inferring     perform factorspeciﬁc dimensionality reduction outputting                                                                                                  n∗r                                                        converged truncated mode matrices uˆ people ∈                     sketch patch space                                   m∗r                                                        uˆ positions ∈ rankreduced                                                        approximation tensor  figure  illustration relations common variation  dˆ  t×ˆ   uˆ     ×  uˆ       ×  uˆ      space photo patch space sketch patch space                     people   positions   styles                                                            analogy subsection new patch pair  coincides path shown fig  mapping xj  yj residing jth spatial position face images  “photo patch space” “common variation space” tensor representations derived similar  inferring “sketch patch space”             form eq     importantly coarse estimation offered eq                                                                                            pxjt×ˆ     ×  ×   aj ×  consistent sketch synthesis methods tang wang                                                                                                                       liu et al particular conditions consid pyjt×ˆ  × vj ×  aj ×     ering holistic photosketch image pair faces                                                              vt    st            ax ay sample matrices columns vec th th row vector mode  tors recording training sketch photo images eq  matrix uˆ positions uˆ styles respectively aj   equivalent eigentransform method tang wang                                                                                   t×ˆ  vj × aj   t×ˆ  vj × constant   contains linear combination coefﬁcients wrt                                                        tensors people parameter vector ∈r× maintains  training faces case ax contains nearest neigh                                                        solved new patch pairs  bors input photo patch training set bx collects  associative sketches neighbors eq  resembles mode ﬂattening eq  results                                                                                         local geometry preserving method liu et al fur             xj faj   axw  thermore eq  thought unconstrained solution                           lle roweis saul  weighting              yj faj   ayw             vector locally linear reconstruction                         d×r                                                        ax ay ∈     positiondependent inferring ma    tensorpatches facial image ensembles         trices note people parameter vector shared                                                                           structural characteristics face images adopt patch pairs  jj appearing                                                        son deﬁning concatenated photo feature vector ix   higherorder tensor order tensor modeled          md×                                                        ··· xm ∈     sketch counterpart iy   generic images facial image ensemble necessi        md×                                                        ··· ym ∈     enlarged md × matrices  tates modeling global structures local details face                        images                                      ax ax  ···ax  ay ay ···ay wehave    given multifactor people spatial positions patches                    multimodal styles natures patches develop                  ax  order tensor model explicitly account styles                 iy  ayw                 constituent factors facial patches suppose                                                        solve parameter vector square  pairs face images available training each di                                                        method  vided overlapping square patches styles                                                                                −  length each patch feature vector patches                                                                                              ax ax    ax ix  bxix  inﬂuenced modes people patches styles fea                           n×m××d                                                                   d∈                                                        −   tures order tensor           naturally built                                    grouping photosketch patches sampled training              ay ay    ay          faces perform tensor decomposition                                                                                        ax ax ay ay invertible md        c×  upeople × upositions × ustyles × ufeatures                                                       satisﬁed paper        t×  upeople × upositions × ustyles  core tensor governs interaction   bayesian tensor inference                                                n×n  modes encoded  mode matrices upeople ∈         learned tensor representations eq  model latent                m×m              ×  upositions ∈      ustyles ∈     ufeatures ∈    connection ix woriy concluded                                                    ijcai                                                    relations eq     originate factor signiﬁcantly function  quadratic consequently  composition implemented through tensor decompo minimizing quadratic optimization problem uncon  sition eq  gives direct inference strained globally optimal solution exists  lack analysis statistical dependencies taking derivative respect respec    utilizing merits superresolution techniques free tively partial gradients calculated  man et al  baker kanade  incorporate                                                                                                ∂e        ay ay             ay iy   bxua   bxμ  learned relations eq   tensor               −                          model entails bayesian framework entire infer ∂w    λ     λ            λ         λ  ence process called bayesian tensor inference                                                                                                                                                                             ∂e         bx bxu     −        bx − bxμ    formulation                                                            Λ     −                                                                              ∂a           λ                        λ  fulﬁll backward transform iy → ix through peo  ple parameter vector taking quantities ∂e∂w   ∂e∂a   obtain pair solu                                                                ∗  ∗  global optimization formulation inference ap tions   unique globally opti                                                                                    ∗  proach deduced canonical bayesian statistics ex mal optimal map solution given                                             ix                                        −  ploiting pca represent photo feature vector    ∗                  −        hallucinated advantage approach     bx bxuλΛ          bx                                                 account statistics latent variable ∈                                                                                                      λi − ca  iy   write eigenfacedomain representation                        −      μ                                                                                     bx            forming pca training photo vectors ix                           λ                 ix ua   μ  ε ≈ ua  μ            × matrix predeﬁned                                                                                          pca noise ε ignored prior pa easier                             −                                                                              λay ay  acquire                                                              −                                                  −                                  ci                                            pa ∝ exp−a  Λ                                         λ  Λ × diagonal matrix eigenvalues far accomplish task backward transform                                                                                                       ∗  diagonal                                             hallucinating photorealistic photo feature vector ix                                                            ∗    bayesian map maximum posterior criterion μ                       iy                         ∗                         ∗        given sketch feature vector basedonanavailable  ﬁnd map solution hallucinating optimal ix set myriad training photosketch image pairs  follows            ∗                                             algorithm             argmaxpw     aiy                                                   algorithm tackles intractable problem sketchbased               argmaxpiyw    apw              facial photo hallucination learningbased scheme                                                   successful relevant efforts facial               argmaxpiywpwapa                                                                                                           sketch synthesis examplebased sketch generation chen et                                                        al  takes pixels rendering elements computa    statistics iy considera tional efﬁciency somewhat low linear methods tang  tion learned relation eq iy  ayw wang  liu et al tend trivialize synthe  assume representation error iy wrt iid sized results statistical consideration fact  gaussian conditional pdf piyw obtained work improves existing techniques  follows                                               patchbased tensor learning bayesian inference coor                                                                                              dinated algorithm illustrated fig                             iy − ayw            piyw ∝ exp −                          collect large corpus training facial image pairs                                 λ                                                                               ix  iy styles divide each image  λ scales variance photo space analogy overlapping patches sketch image space  obtain condition pdf pwa doing  photo image space disparate terms graylevel inten  bxix using eq                                sities bring spaces correspondence use                                                                                                 horizontal vertical image derivatives features                         w − bxua   μ         pwa ∝ exp  −                           photo sketchstyle patches learning tensor                                 λ                     patches model concretely envision bayesian tensor  λ scales variance common variation space ference involving phases training testing phase    substituting pdfs given eq    eq training phase                                                             maximizing pw aiy equivalent minimizing based derivative feature representation build   following object function                             order tensor ∗ photosketch patch pairs sampled                                                                                                               training image pairs learn matrices ay bx              iy − ayw        w − bxua   μ                                                                                                      construct concatenated photo feature vectors ix                  λ                   λ                                                                                                                   run pca achieve eigensystem Λ                                  −                               Λ              mean vector μ                                                    ijcai                                                                                                          position centers eyes mouths each  ×  face                                                        image divided  overlapping  ×  patches                                                        way overlap adjacent patches three                                                        pixels                                                          display effectiveness bayesian tensor infer                                                        ence compare representative methods               training sketch photo pairs                                                        applied facial sketch synthesis including                                                        global method– eigentransform tang wang                                                         local method– local geometry preserving lgp liu et                  local geometry                                                 preserving                          al  fig  fig  illustrates results sketch                                                        based face hallucination asians europeans respec                                                        tively groups results patchbased meth    testing sketch face          initial result         ods consistently notably outperform global                                                    method high ﬁdelity local details indicates                  tensorpatches   gradient                                   correction            local model suitable modeling complex dis                                                        tributions images comparing results yielded                                                        lgp produced method                                           hallucinated face clearly inference algorithm performs sharper                    bayesian                      tensor                             realistic higher image quality lgp rea                    inference                           son employing patchbased tensor model                                                        cover common face structure local details   input image derivatives    inferred image derivatives  set scale parameters λ λ    figure  architecture sketchbased facial photo hallu respectively use standard svd pca train  cination approach  learn tensorpatches model taking ing photo feature vectors  eigenvalue total  image derivatives features training phase  ob retained applying lgp method obtain initial  tain initial result applying local geometry preserving hallucinated result step  testing phase choose  method  infer image derivatives target photo number nearest neighbors  ing bayesian tensor inference method given input image quantitative perspective table  lists average  derivatives extracted test sketch face  conduct rootmeansquare pixel errors rmse  different meth  gradient correction hallucinate ﬁnal result   ods baseline nearest neighbor method                                                        expected performance method does improve                                                        number training sample pairs increases     testing phase                                       training set  training set ii rmse                                          new sketch image ydivideitinto patches method larger lgp hallucinated im  way training phase using grayscale intensities ages look better detailed groundtruth face im  image features apply local geometry method liu et ages sum sketchbased face hallucination method                                             al estimate initial hallucinated result acquires best visually perceptual quality     construct concatenated sketch feature vector iy  ing overlapping patches exploit ay bx Λμ                                  ∗                          table  comparison hallucination methods  infer target photo feature vector ix according eq              training set training set ii             ∗                                              hallucination method     break ix patches afterward integrate                     rmse   red  rmse   red                                          patches holistic derivative maps ix ix  pix nearest neighbor           els overlapping area blended                         eigentransfrom                                               conduct gradient correction ix using derivative local geometry preserving                                                   maps ix  ix gradient ﬁeld render ﬁnal result ix  bayesian tensor inference        experiments                                                           conclusions  sketches styles example cartoon  sketch represents person exaggeratedly paper present statistical inference approach  paper focus sketches plain styles ex called bayesian tensor inference photo patch  aggeration applications law enforcement photo space sketch patch space based principle  search exaggeration allowed sketch images commonalities contribute inference process  sketches realistically real subjects virtue patchbased tensor model capture learn  sketch examples shown fig  fig   interspace dependencies bayesian map framework    conduct experiments database  persons integrates tensor modeling statistical optimization en   persons training rest testing sure inference performance difﬁcult vision prob  each person frontal face photo image sketch im lem sketchbased facial photo hallucination potency  age plain style drawn artist training method sufﬁciently shown comparative experi  testing images normalized afﬁne transform ﬁx ments achieving surprising photo rendering quality                                                    ijcai                                                    
