                     counting complexity propositional abduction                          miki hermann                                reinhard pichler                   lix cnrs umr                       institut f¨ur informationssysteme                     ecole´ polytechnique                     technische universit¨at wien                     palaiseau france                favoritenstrasse  wien                          abstract                          finally let set hypotheses given      abduction important method nonmo             weak defense weak attack star injured       notonic reasoning applications ai    pap abductive explanations  “solutions”      related topics paper concentrate                                                                                propositional abduction background           weak defense                                                                               knowledge given propositional formula         weak attack                                                                                           cision problems great existence        weak defense weak attack                                                                                         relevance problems complexity              weak attack star injured                                                                                           decision problems systematically            weak defense star injured                                                                                                      studied counting complexity proposi          weak defense weak attack star injured      tional abduction remained obscure goal      work provide comprehensive analysis obviously example solutions                                                        equally intuitive applications      counting complexity propositional abduction                                       various classes theories                   interested solutions given pap ac                                                        ceptable solutions acceptable context means                                                        minimal wrt preorder  powerset    introduction                                       natural preorder subsetminimality ⊆ criterion                                                        reﬁned hierarchical organization  abduction method nonmonotonic reasoning hypotheses according priorities cf   taken fundamental importance artiﬁcial intelligence text priorities considered qualitative version  related topics widely used produce explanations                                                        probability resulting preorder denoted ⊆p  observed symptoms manifestations hand solutions acceptable  important application ﬁeld diagnosis – notably corresponding preorder syntactic equality   medical domain  important applications                                                          example  solutions subset  abduction planning database updates data                                                        minimal suppose reason know  mining areas                                                           speciﬁc team weak defense likely    logicbased abduction formally described fol occur weak attack judgment formalized  lows given logical theory formalizing application                                                        assigning lower priority  aset  manifestations set hypotheses ﬁnd                                                        considered ⊆p minimal wrt priorities  explanation suitable set ⊆                                                          usually observed algorithmic problem logicbased  ∪ consistent logically entails paper                                                        abduction existence problem deciding  consider propositional abduction problems paps short                                                        solution exists given abduction problem  theory represented propositional formula                                                        wellstudied decision problem socalled rele  boolean algebra   ∨ ∧ ¬ → ≡ boolean                                                        vance problem given pap hypothesis ∈  ﬁeld   ∧ sets hypotheses                                                        acceptable solution  gether manifestations consist variables                                                        approach satisfactory especially database                                                        applications diagnosis datamining exist situ  example  consider following football knowledge base ations need know acceptable solutions       weak defense ∨ weak attack → match lost     abduction problem important          match lost → manager sad ∧ press angry        sequently enumeration problem computation          star injured → manager sad ∧ press sad       acceptable solutions received                                                          natural question concerned  let set observed manifestations   tal number solutions considered problem lat        manager sad press angry                   ter problem refers counting complexity abduction                                                    ijcai                                                          abduction                ⊆⊆p                  dual horn bijunctive theories section  ﬁnally       general case   ·conp    ·conp    ·Πp         afﬁne theories section  conclude section         horn                   ·conp     deﬁnite horn                            preliminaries      dual horn                             propositional abduction      bijunctive               ·conp        propositional abduction problem pap consists tu                                                                                                       ⊆        afﬁne       fp                       ple vhmt   wherev  ﬁnite set variables                                                        set hypotheses ⊆ set manifestations                                                        consistent theory form propositional   table  counting complexity propositional abduction formula set ⊆ solution called explana                                                        tiontop  ∪ consistent ∪  holds                                                        priorities             stratiﬁcation hy  clearly counting complexity provides lower bound                                                                   potheses  ∪···∪hk   ﬁxed number disjoint  complexity enumeration problem                                           ⊆  counting number abductive explanations useful sets subsetminimality priorities relation                                                        holds  exists ∈k  probabilistic abduction problems  ∩  ∩                    ∩       ∩  order compute probability failure given com hj hj jiand hi    hi  ponent diagnosis problem assumption paper follow formalism eiter gott                                                              preferred explanations equiprobable need count lob   allowing positive literals solutions                                                                                                           number preferred explanations number afﬁne case contrast creignou zanuttini   preferred explanations contain given hypothesis allow negative literals solutions apply                                                        afﬁne paps need possibility al    counting complexity started valiant                                                         gebraic setting assign variable    wellestablished complexity                                                          general case arbi  ory known class counting vari                                                        trary propositional formula consider special cases  ants decision problems proved pcomplete                                                        horn deﬁnite horn dual horn bijunctive  higher counting complexity classes exist                                                        afﬁne schaefer’s famous dichotomy result   commonly known counting equivalent polynomial                                                        frequently studied subcases proposi  hierarchy deﬁned hemaspaandra vollmer                                                         tional formulas propositional clause said horn  generic complete problems counting hier                                                        deﬁnite horn dual hornorbijunctive  archy classes presented                                                         positive literal exactly positive literal neg                                                        ative literal literals respectively clause                                                        afﬁne written form linear equation  results goal work provide comprehen  ···                           sive analysis counting complexity propositional ab xk   boolean ﬁeld atheoryt  duction various settings overview results horn deﬁnite horn dual horn bijunctive afﬁne  given table  columns table correspond conjunction equivalently set horn deﬁnite horn  three preorders considered deﬁning dual horn bijunctive afﬁne clauses respectively                                             notion acceptable solutions equality  subset  counting complexity  minimality ⊆ subsetminimality priorities ⊆p     apart general case theory arbi abduction problem problem counting num                                                                                      ⊆  trary propositional formula consider subclasses ber solutions pap abduction problem                                                                                                     ⊆  horn deﬁnite horn dual horn bijunctive afﬁne counts subsetminimal solutions     ories  aforementioned classes enjoy favorable abduction counts minimal solutions wrt priorities   properties instance closed conjunction formally counting problem presented using witness  existential quantiﬁcation conjunction function input returns set witnesses                                                                                           Σ∗ →pωΓ∗  mulas belongs class formula xawitness function function                                                                      Σ    Γ                    pωΓ∗  existentially quantiﬁed variable logically equiva alphabets collec                                                                               Γ∗  lent formula represent tion ﬁnite subsets  witness function  studied formulas logic complexity constraint satis gives rise following counting problem given string                                                          ∈ Σ∗                                        faction problems artiﬁcial intelligence mainly  ﬁnd cardinality witness set                                                                           schaefer’s famous result satisﬁability problem according complexity class decision prob                                                                      ·c  polynomial opposed npcompleteness lems deﬁne class counting problems  general case                        witness function satisﬁes following conditions                                                           polynomial pn ∈ Σ∗                                                            ∈ wx y≤px  structure paper paper organized follows                            ∈           recalling basic deﬁnitions results section   problem “given yisy ”   analyze counting complexity propositional abduc easy verify  ·p counting hierarchy  tion general theories section  horn deﬁnite horn ordered linear inclusion  particular                                                    ijcai                                                                                                                                                 ⊆  ·conp ⊆  ·Πp ⊆  ·Πp note select xi xi additional                                                                          course consider classes ·np ·Σp ·Σp formula ¬xi ∨¬xi enforces select                                                                                                         play role work         xi xi conditions value xi                                                                                        prototypical ·Πkpcomplete problem ∈ fully determined xi xi dual xi  Πksat    deﬁned follows given formula        easy check onetoone rela                                                                                   ⊆                ∀    ∃   ···                            tionship solutions models        ψ        qkyk  ϕ yyk          ∀yϕx   reduction parsimonious                                                                                       ϕ boolean formula yyk sets complementarity enforces each solution  propositional variables count number truth assign incomparable subset  ments variables satisfy ψ           minimal                                             completeness counting problems usually    according theorem abduction ⊆  proved means turing reductions reduc abduction counting complexity intuitively  tions preserve counting classes ·Πkpitisthere following equivalence cf  ⊆  fore better use subtractive reductions  preserve minimal solution pap solution  aforementioned counting classes write ·r ∈  solution  note following counting problem given string ∈ Σ∗ taking ⊆minimality account makes things poly  ﬁnd cardinality rx witness set rx associated nomially harder contrast soon  pri  counting problem ·a reduces ·b ority levels following effect occur suppose  strong subtractive reduction exist polynomial solution pap  solution  time computable functions each ∈ Σ∗ ∈ happen ∈                                                                                ∪       ⊆               −       set form       solution                        hypotheses higher priority checking                                                                    strong subtractive reduction bfx  ∅ called set particular set exists comes  parsimoniousasubtractive reduction transitive closure nondeterministic guess formally  strong subtractive reductions                     following complexity result                                                                         ⊆                      ·Π     general propositional theories                     theorem    abduction problem    com                                                        plete subtractive reductions  decidability problem propositional abduction                                                                   ⊆  shown Σpcomplete  hardness proof minimal solutions pap obviously  proved reduction qsat modiﬁcation computed nondeterministic polynomialtime turing                                                                                         ⊆  reduction yields following counting complexity result machine generates subsets checks                                                        solution pap ii checks                                                                   ⊆  theorem  abduction problem ⊆abduction minimal test –                                                                                      Π  problem ·conpcomplete                          expensive –  oracle                                                        problem testing ⊆p minimal                                                                                                           proof ·conpmembership clear fact following Σpalgorithm guess subset ⊆ st                                                                                           Δp test subset ⊆ solution resp ⊆p smaller check solution  subsetminimal solution given pap  proposition pap ⊆p abduction problem ·Πp   ·conphardness shown following par ·Πphardness shown following strong  simonious reduction Πsat let instance subtractive reduction Πsat let instance  Πsat   problem given formula                Πsat   problem given formula                                                                       ∀       ∃                          ψx∀yϕx                                      ψ          zϕx                                                        variables  xxk  yyland                                                                                              xxk    yyl  let   zm let xxkppk                                                               xxkrrkt denote fresh pairwise distinct vari yyl qqlrt fresh pairwise distinct vari                                                                                             ables let  xxk     rrk    ables    xxk   ppk                                                                deﬁne pap     vhmt    follows              yylandq    ql deﬁne              ∪   ∪  ∪   ∪                          paps follows                                                                                                                                 ∪  ∪ ∪  ∪ ∪ ∪ ∪r          ∪                                                                   ∪    ∪  ∪   ∪              ∪                                                                                                                                                                                                                         priorities             ¬xi ∨¬x  xi →  rix →  ri   ≤ ≤                                                               ∪   ∪               ∪       →                                                          ϕ                                                                                                                            ¬xi ∨¬xixi  → pixi →  pi   ≤ ≤  obviously reduction feasible polynomial time                                                                                           ∪¬yi  ∨¬yiyi →  qiyi → qi   ≤ ≤  show reduction parsimonious                                                                  ∪¬          →      manifestations formulas xi → ri           ϕ       xi →  ri enforce solution pap  ∪r ∧ ∧···∧yl →                                                     ijcai                                                     finally set   vhmt    vhmt      phardness modify reduction    obviously reduction feasible polynomial time positivesat problem theorem  let ψ xandg                                                                                                     let aψ denote set satisfying assignments deﬁned let  xxk  Πsatformula  ψ let bp denote set ⊆p   rrk fresh pairwise distinct variables  minimal solutions pap claim deﬁ deﬁne   vhmt  follows  nition paps strong subtractive                                                                        ∪  ∪ ∪  reduction                                                                                                                 ∪    bp ⊆ bp     aψ  bp−bp                                                               ∪                                                     lack space proof claim omitted    pi → giqi → gi   ≤ ≤                                                                                                                                                          ∪¬xi ∨¬x  xi → rix →  ri   ≤ ≤    horn dual horn bijunctive theories                                                                                                theideaofthevariablesx   additional manifesta  section consider special case                                                        tions exactly proof theorem   ory set arbitrary deﬁnite horn dual horn                                                                                actually formula ¬xi ∨¬xi omitted  bijunctive clauses minimality criterion applied                                                                                              fact subset ⊆ xixi ∈  solutions following result                                                                                                                    solution pthens  xi solution xi                                                        useless soon xi present note use  theorem  abduction problem horn deﬁnite horn                                                          derive ri absence xi subset  dual horn bijunctive clauses pcomplete                                                              minimal solution pap select xi                                                                                   ¬   ∨¬    proof pmembership easily seen fact xi formula xi xi remaining                                                                                                           checked polynomial time subset formulas deﬁnite horn dual horn  ⊆  solution satisﬁability consider paps ⊆p minimality turns  satisﬁability set dual horn bijunctive clauses deﬁnite horn dual horn clauses priorities  checked polynomial time                        leave counting complexity unchanged cases    phardness reduce positivesat   counting complexity increases  problem known pcomplete toit  show reduction parsimonious let arbitrary theorem  ⊆p abduction problem deﬁnite horn  instance positivesat given cnfformula dual horn clauses pcomplete                 ∨   ∧···∧    ∨             ψ             pn  qn                  proof phardness clear holds                                                                      i’s i’s propositional variables set priorities membership deﬁnite horn clauses                                                                                         xxk let ggn denote fresh proved follows let vhmt    consists                                                                                          pairwise distinct variables let    nthen     horn clauses according   theorem                                                    ⊆  deﬁne pap   vhmt  follows               check polynomial time                                                        ⊆p minimal solution pmembership deﬁnite        ∪                                        horn clauses proved                                                     suppose dual horn clauses                                                        form ¬p ¬p ∨ ∨···∨qmorq ∨···∨qm                                                               qqm ∈ ≥  let denote        pi → gi   ≤ ≤ n∪qi → gi   ≤ ≤  propositional variables occurring negative unit clauses                                                                       ¬   ∈     obviously reduction feasible polynomial time ien       solution                                                        ⊆  ∪  easy check onetoone                             ⊆    ⊆     lationship solutions ⊆ models inconsistent                                                        set s solution special form  ψ note clauses time deﬁnite     ∪  horn bijunctive dual horn                     dual horn  consistent monotonicity                                                         s ∪ implies    analogously case general theories counting let hhk denote priorities hnows  complexity remains unchanged restrict attention ⊆p minimal solution solution  subsetminimal solutions                          ∈k ∈ ∩ hi set                                                                     ∪     ∩    ∪···∪     ∩    theorem  ⊆abduction problem horn deﬁnite                  hi            hk                                       horn dual horn bijunctive clauses complete  solution test clearly feasible                                                                                                           proof pmembership holds analogously case polynomial time dual horn case  abduction subsetminimality following recall remark preceding theorem  ef  property  proposition  s⊆h subset fect  priority levels follows order check  minimal solution solution solution ⊆p minimal test  ∈sthesets  solution        exists solution form s  ∪                                                    ijcai                                                     hypotheses higher priority hin lack space proof claim omitted   general difﬁculty determining set exists  following choose small s  afﬁne theories  entail manifestations choose big                                                       section consider special case  ∪ inconsistent intuition underly                                                        ory set afﬁne clauses recall set  ing theorem  problem choosing big                                                        written linear ax  boolean ﬁeld  disappears deﬁnite horn dual horn clauses def                                                        change creignou zanuttini approach   inite horn candidate checked                                                        case need possibility set variable    hi ∪···∪hk    dual horn candidate                                                        minimality criterion applied solutions  hi ∪···∪hk    ∩ nwheren   takes care                                                        following result  theory contains negative unit clause ¬pthenp  included solution                                                        theorem   abduction afﬁne clauses fp                  ⊆  theorem   abduction problem horn bijunc proof given afﬁne pap                       ·conp                                                                 vhmt          tive clauses    complete                         afﬁne ax  reduce problem count                                                                                                     proof ·conpmembership established follows ing satisfying assignments linear systems                                                                 ∪                              ∈  given set variables  check means each                                                                   ∈       ∪              solution pap ii check ⊆p  each        entails   each                                                        ∈                                       ∪     minimal test dominates overall com  check                                                                      ∪                   plexity conporacle problem hold nonempty solution                                                                               ∈          testing ⊆p minimal fol force  trans                                                                                                 ⊆  lowing npalgorithm guess subset ⊆  st  ⊆p   form ax   ey    fzwherey                                                             ∩      ∅                    smaller check polynomial time horn    ey fz     ax transform                                                       ey  gaussian elimination smith normal form giving  bijunctive theory solution pap      case ⊆p abduction ·conp                  ife   row variable say                                                            ···         ≥                ·conphardness shown strong subtractive yi     yil   solution                                                                                        ···       reduction Πsat let instance Πsat  each solution compatible yi    yil                                                                                        ∈               problem given formula  ∀            compatible yij      ife                             ψ      yϕx                                                                                wlog  rows variable add ax                                                       ∈   assume    dnf equations each resulting new                         ϕ                                 form ∨···∨cn  each ci form ci     check satisﬁable    ∧   ∧                                        ∪      transform gaussian elimination smith normal  li li li lij ’s propositional literals                                                                        let                                      form ibx       each truth assignment variables       xxk  yyl         gn denote fresh pairwise distinct variables let satisfying linear determines solution                                                              ∈      ∪¬                                                                     let      xxk       yyl                                     qql  ggn deﬁne   linear ibx    rows                                                        hm−k                                         paps follows                                  different solutions              ∪    ∪  ∪    ∪  ∪  ∪   ∪                                                        ⊆                                                      theorem    abduction problem afﬁne clauses         ∪  ∪ ∪  ∪r                        pcomplete                                                       priorities                                    ∪   ∪                                     proof    membership clear fact                                                checked polynomial time set ⊆                                       ¬xi ∨¬xixi  → pixi → pi   ≤ ≤     subsetminimal solution afﬁne according                                             ∪¬yi  ∨¬yiyi →  qiyi → qi   ≤ ≤   proposition   problem minimal afﬁne ex                                                        tension given afﬁne ax             ∪zij →  gi   ≤ ≤  ≤ ≤                                                         partial assignment variables  count number                                                                                     zij form xk xk yloryl depending extensions minimal solutions ax  bis  literal lij ci form ¬xk xk ¬yloryl proved pcomplete  partial assign  respectively words zij encodes dual lij  ment contains  parsimonious reduction                                                                                                      ∪r →  gi   ≤ ≤ n∪r → yj   ≤ ≤  afﬁne pap      vhmt    follows let                                                                  ∈                                                                                xi     xi      andt      ax     let  finally set  vhmt        vhmt       ⊆  variables assigned let s¯    obviously reduction feasible polynomial time extension satisfying afﬁne set  let aψ denote set satisfying assignments         ∈     ¯    Π   sat                                    ⊆      variables   xi     xi       subsetminimal         formula ψ let denote set  solution extension s¯ minimal   minimal solutions pap  claim  following property                                                        theorem   ⊆p abduction problem afﬁne clauses    bp ⊆ bp     aψ  bp−bp      pcomplete                                                    ijcai                                                     
