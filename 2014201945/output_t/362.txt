                            permanents transportation polytopes                          positive deﬁnite kernels histograms                                                 marco cuturi                              institute statistical mathematics tokyo japan                                          cuturiismacjp                          abstract                            early applications kernel methods complex                                                        data structures histograms treated vectors      integral histograms rrd                                           used standard gaussian polynomial ker                equal sum    monge       nels joachims  adequate positive deﬁnite ker      kantorovich distance dmkr                       ×                          nels exploit speciﬁcity proposed      parameterized    distance matrix      kernels account fact      minimum costs ft taken matrices                                               tograms vectors nonnegative coordinates hein        transportation polytope   recent  bousquet  sum normalized      sults suggest distance negative deﬁ cast discrete probability measures treated      nite through schoenberg’s wellknown                −                                    der light information geometry lafferty lebanon      result exp mk positive deﬁnite   lebanon  histograms usually      kernel using directly                                                  deﬁned bins equally dissimilar       mk deﬁne similarity wepro     instance case color aminoacid histograms fur      pose paper investigate kernels                                                 ther kernels account priori interbin      based transportation polytope     similarity subsequently proposed kondor jebara      prove binary counts                                                     cuturi et al  hein bousquet       equivalent stating represent   context wellknown distance probability mea      clouds points equal size permanent sures space takes explicitly account      adequate gram matrix induced distance ma                                                                  geometry  optimal transportation distance villani      trix  positive deﬁnite kernel favorable  usually known mongekantorovich      conditions  show volume                                                 mk wasserstein distance distance popu      polytope   number inte  lar vision community rubner et al       gral transportation plans positive deﬁnite quan                                                    earth movers’ distance pre      tity   through robinsonschensted     liminary ﬁndings naor schechtman  suggest      knuth correspondence transportation ma   mk distance negative deﬁnite      trices young tableaux follow propos   used directly deﬁne positive deﬁnite kernels through      ing family positive deﬁnite kernels related schoenberg theorem negative exponentiation      generating function polytope through stance approximations distance      cent results obtained separately barvinok used far deﬁne positive deﬁnite kernels vision      hand cberg aj duran    applications grauman darrell  propose      hand ﬁnally present preliminary results paper consider optimal transport plan      led subset mnist database compare  transportation polytope characterize simi      clouds points through permanent kernel    larity histograms                                                          idea rooted approach vert et al     introduction                                       deﬁne positive deﬁnite kernel strings derived                                                        set string manipulations map string  deﬁning meaningful kernels histograms clouds                points – generally positive measures arbitrary string  sequences deletions substi  space – important topic ﬁeld kernel methods tutions insertions tokens known alignments vert  directly related deﬁnition kernels struc                                                           schoenberg theoremberg et al  theorem   tured objects seen bagsofcomponents states function ψ negative deﬁnite kernel equivalently  representations frequently used practitioners appli −ψ conditionally positive deﬁnite sch¨olkopf smola  cations notably images seen histograms colors texts  exp−tψ positive deﬁnite kernel  bagsofwords sequences groups subsequences gaussian kernel instance based fact  search active ﬁeld recently         vectors x − y negative deﬁnite                                                    ijcai                                                     et al  consider possible alignments π proposition  let set endowed kernel κ  associate each alignments π ascore xn set clouds points cardinal   sπ quantiﬁes efﬁciently sequence π aligns xxnxi ∈xletx   xxn   successive tokens consider yyn∈xnthen  ing score sπ optimal alignment π known                                                                    → perκxiyj ≤ij≤n   smithwaterman score context biological se                                                                                                               ×x  quences vert et al  propose deﬁne positive def positive deﬁnite kernel                                          eβsπ  inite kernel   through sum π       proof ﬁrst prove result sequences   β    experimental setting provides                                                       xxn yyn given permutation σ  better performance intuitively sum inter                                                                         write xσ sequence  σ σn proof  preted generating function set alignments follows work haussler  convolution ker  π discriminative power sim                                                                                              nels consider equivalence relation  ple use extremum sπ                         tween sequences xry ex                                                 π    context paper set alignments ists permutation σ ∈ sn xσ  consider  played set × transportation matrices ∈ kernel sequences  ur discrete histograms rrd                                                                                                           κ   ccd equal sum analog blo                          sum distance matrices aminoacids used vert et                              ≤i≤n  al  arbitrary × negative deﬁnite distance ma                                                                                     use deﬁne convolution kernel whichis  trix bins histograms ﬁnally cost positive deﬁnite deﬁnition  πσ simply frobenius dotproduct ft                        case vert et al  family kx         ku  volution kernels introduced haussler  plays im        u∈r−x v∈r−y  portant role proofs notably permanent kernel                                                                                              σ   clouds points introduced section  propose                 yσv                                                                      σ ∈s  σ ∈s  section  kernel histograms taking        un   vn    account volume ur show result                     κ                                                                                          σu σv  natural consequence robinsonschenstedknuth cor         σ ∈s  σ ∈s  ≤i≤n  respondence transportation matrices generalized         un      young tableaux finally inspired recent construction ob          perκxiyj  nperκxiyj    tained barvinok  through lemma berg          σu∈sn  duran  show section  weighted version                                                        positive deﬁniteness used clouds  generating function used deﬁne                                                                                 points represented through arbitrary pair se  positive deﬁnite kernels close paper section                                                         quences  discussing implementation computational issues brought  forward kernels preliminary experimental                                                          suppose interpretation purposes kernel  results led subset mnist database handwritten         e−dxy      digits                                               written               hilbertian                                                        metric hein bousquet   exists                                                        mapping φ arbitrary hilbert space    permanent kernel clouds points              dx yφx − φy case permanent  deﬁne section kernel clouds points interpreted sum possible matchings                                                        σ                                        e−dσ    xn  yn space en   the weight each total transport scheme                                                                               dowed kernel κ through kernel arbitrary sequence σ   σi quantity σ stands  representations xn  yn   tal transport cost cloudsofpoints given                                                                   σ                                 deﬁnition invariant reordering transport plan selected taken feature space  terms recall × matrix mij  illustrated figure   manent deﬁned quantity            note ﬁnally possible way deﬁne kernels                                                        clouds sizes respectively consider                            n                         sum pairwise kernels respective subsets                                                          iσi                 size ≤ minn mthatis                         σ∈sn                                                                                                                                 xdyd                                                                                      σ spans symmetric group sn set                                                                                                ∈x ∈y  permutations note deﬁnition                         permanent matrix differs determinant  volume transport polytope  signatures permutations taken ac  count permanent matrix invariant kernel marginals  permutation columns rows matrix fact write    set nonnegative integers  use proof proposition               consider integral histograms margins                                                    ijcai                                                                                                             partitions integer semistandard                                                        young tableau shape weight diagram shape                                                        containing ones twos arranged weakly                                                        right increasing rows strictly increasing columns                                                        consider instance  semistandard tableau                                                                                                                                                                                                                                                                                                                                                        shape     weights                                                               given partitions kostka number kuv                                                        equal number semistandard young tableaux                                                        shape weight                                                          proposition  kernel kvol Σdn deﬁned                                                                           kvolr cur                 optimal permutation σ                 symmetric positive deﬁnite                   permutation σ ∈ sn               proof proof derived theory                                                        symmetric functions robinsonschenstedknuth                                                        rsk correspondence knuth  approaches  figure  considering permanent matrix e−tij                                               mentionned diaconis gangolli  recall  ij    pairwise distances white brieﬂy second proof rsk bijective correspondence  dark points permanent kernel explicitly considers states matrix ∈ ur corresponds  costs possible matchings points                                 σ                     pair semistandard young tableaux identical shape  optimal permutation                 weights respectively sum                                                        ming possible partitions η used shapes                                                        young tableaux  corresponding statistical literature diaconis gangolli                     identical overall sum dimension el        ur   kη rkη   ements simplex lattice                                                  η                                d                                                                           defr    ∈ nd                  sufﬁcient prove volume   satisﬁes           Σdn                                mercer’s condition                                   consider polytope transport matrices  weighted generating functions  restricted integral matrices                                                        volume transportation polytope special case                                                                                                   ur cf  ∈ nd×d          evaluation generating function   barvi                                                        nok  given cost matrix  case null  ddimensional vector ones recall matrix generally deﬁned  optimal transportation cost symmetric                                                                                                        −ft   function deﬁned result opti      ft                 mization                                                                   ∈urc                      def             dmkr minft                         ∈urc                       computation general polytopes notably  ∈ rdd arbitrary distance matrix bins transportation subject extensive research sig  square matrices use frobenius niﬁcative developments carried recent years sum  dotproduct uv  truv    note optimal marized loera et al  generating function  plan                                                  expressed total weight ur use                                                                                                    e−tij              def             ft                  terminology barvinok  setting ij                  argminf  ∈urc                       note binary histograms marginals  computed through standard linearprogramming meth   values ur known birkhoff  ods polynomial time known  ver polytope ft  corresponds case permanent  tex polytope reconsider cost parameter kernel deﬁned proposition  κ set e−t  gen  section focus rest section eral case binary counts vol  volume ur polytope ur total ume ur regarded similarity  number integral transportation plans introduce ﬁrst based exclusively combinatorial properties regard  concept semistandard young tableaux          prior knowledge distance                                                    ijcai                                                                                                                                            each block aij ri × cj rectangular matrix                                                                                         −t                                                        coefﬁcients set constant γiγje ij                                                                                                                                                        kγt →                                                                                ···rdc ···cn                                                          positive deﬁnite kernel Σdn × Σdn                                                         proof ﬁrst map each marginal correspond                                                        ing sequences                                  ur                                                                         dd                                                                  ˜                                                                                    times times  rd times  figure  consider minimal value  ft reached vertex  propose use ˜ deﬁne positive deﬁnite kernel                                                                               −tij  cost criterion evaluated polytope                 κi jγiγje                                                           kernel indexed d×dwethen  bins hand optimal plan  corresponding using proposition   mongekantorovich distance ft takes                                 mk                                                          account information does reﬂect       ·                                                                                γt     per˜ ˜ ···r  ···c  formation carried distribution costs                           polytope having mind figure  pro →    ×       trivially positive                                                                        r···rd c···cd  pose deﬁne valid kernels ϕ consider criteri          ons consider distribution cost ft  deﬁnite γt product positive deﬁnite                                                        kernels  polytope ur introducing  weighted versions generating function through func  tion ϕ  ur → deﬁning                           use following lemma turn randomized setting                                                       proposed barvinok  sum positive deﬁnite                                    −tf            kϕ →      ϕf                   kernels                       ∈urc                        lemma  berg duran each  α≤   sequence                                                        nαn∈ determinate stieltjes moment sequence  note generating functionis recovered ϕ                                                         exists  unique nonnegative measure μα  ∞  generating function good candidate      ∞            α                                                          μα       ∈  kernel know moment                evaluations arbitrary matrices positive refer berg duran  proof result  deﬁnite functions provide instead family generally reference berg et al   functions ϕ ensures condition             exposition moment problems relationship  proposition  given e−tij  positive harmonic analysis semigroups note case                                                              α     μ  semideﬁnite having deﬁned  ≤ weight      standard exponential density                                                        α               μ  function ϕa  nd×d →                               measure   simply deﬁned dirac mass                                                                                                            ii      a−            ϕaf                fij                 lemma  barvinok  let  ≤    suppose γ                           fii                             i                    γγd distributed sequence independent ran                                                        dom variables identical law μa through identity  kϕa positive deﬁnite kernel Σdn                                                                          kϕ    kγt    symmetry kϕa ensured symmetry                                                  ϕa uc rur andwehavethat                                                        kϕa positive deﬁnite                 −ft           −f t            ϕaf        ϕaf                     proof ekγt trivially positive deﬁnite sum                                                        positive deﬁnite kernels follow barvinok’s proof prove  prove positivedeﬁniteness kϕ using following                                                      equality slight modiﬁcation barvinok considers   lemmas motivated recent characterization                                                        standard exponential variable γij arranged × matrix  carried barvinok  generating function                                                        consider sequence independent random  transport polytope terms random permanents                                                        variables γ γγd follow law μa  lemma   let    ×  cost matrix     let consider matrix deﬁned lemma   e−tij                               γ    γ γ      ≤ij≤d positive semideﬁnite       permutation σ sn let  sequence nonnegative real numbers ∈ Σdn  deﬁne × block matrix                                             n                                                                                                                                                            σ      kσk                      aij ≤ij≤d                                                                                                                               ijcai                                                     corresponding term               computational issues                                                                                    handle clouds points through proposition  requires                 eper      ehσ                                                        computation permanent × matrix                           σ∈s                                                      notoriously difﬁcult problem combinatorics millions  following barvinok permutation σ associate computations kernel evaluations usu  transport plan  dσ ur called pattern σ ally required ﬁll gram matrices tractable                                                                                   follows dij ≤ij≤d             moment number  points exceeds                                                        thirty points case kernel κ                                                                         bounded   recent advances computa                                             ij     ˜k  ˜σk                 tion approximations permanent through sequential                                                    monte carlo smc techniques jerrum et al  yield                                                                                  dij number indices ∈n complexity order log  problematic  σk block note  σ → large believe clouds points small  dσ ∈ ur surjective bijective size permanent useful kernel abil  low hσ through lemma        ity quantifying complex relationships through power                                                      combinatorics propose experiments                 −tij    dij      −tij dij dij dij   ehσe       γiγj           eγi  γj      compare  images handwritten digits sampling arti             ij                ij                     ﬁcially  black pixels each image compare                                                                                    clouds points through permanent pairwise ker              e−tij dij                               ii    ij                 nels points each cloud issue case           ij              i                     arises numerical stability computation  point follow exactly barvinok’s proof barvinok permanent values κ small  proves number permutations σ sn admit adequate answer problem  pattern                                     simple crossvalidation obtain reasonable entries                                                          general case histograms computa                       ···rdc ···cd                                                           crcd                                  tion volume   integration ϕ                             ij dij                   corresponds fisheryates distribution                                                        kϕ   computed through smc sampling method  yielding                                                                                                       ologies presented recent works chen et al                              −tij dij              volume exact calculations through toolboxes  eper         crcd          dii   dij                                                          latte loera et al  possible tractable            d∈u  rc      ij              i                                                     low dimensions diaconis gangolli  pro                                              pose adhoc numerical approximations small                                                       large                                    −tij dij    ekγt       ϕad                                                                                      d−  d                  d∈urc      ij                                    dk                                                                            Γ                   d−   k−                                                          ur                       ¯ri ¯ci                          ϕ  e−td                             Γddkd                                     ϕa                                                           d∈u  rc                                                       concludes proof                                                                                                                                                    −                                                                                           note obtain fisheryates dis                                  ¯i                                                                      −   wr           −   wc  tribution transportation matrices diaconis gangolli                                                                                           ¯i           ¯j                                       ϕ                                                             expressions symmetrized aver                            ij ij                                                                                    aging             positive deﬁniteness                                                     guaranteed tested datasets  case   yields weight depends  diagonal elements transport plan                                                          experiments                                                         fii                  following previous work kondor jebara                  ϕ                                           fii                     conducted experiments ﬁrst  images                                                       ×  pixels mnist database handwritten dig                                                        approximately  images each digit each    discussion experiments                               xi                          xi xi                                                         image     randomly sample set          discuss section complexity issues arise distinct black points image pixels  trying compute kernels presented tensity superior  represented points square  present preliminary results pattern recognition task  involves comparing clouds points               used experiments                                                    ijcai                                                     
